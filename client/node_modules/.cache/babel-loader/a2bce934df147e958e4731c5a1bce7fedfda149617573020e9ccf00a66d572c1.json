{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as e, isNone as t } from \"../../../../../core/maybe.js\";\nimport { TranslateAnchor as i } from \"../../vectorTiles/style/StyleDefinition.js\";\nimport { VTL_TEXTURE_BINDING_UNIT_SPRITES as n } from \"../definitions.js\";\nimport { WGLDrawPhase as r } from \"../enums.js\";\nimport { u32to4Xu8 as a } from \"../number.js\";\nimport o from \"./WGLBrush.js\";\nimport { TextureSamplingMode as s, CompareFunction as l, PrimitiveType as f, DataType as m } from \"../../../../webgl/enums.js\";\nclass c extends o {\n  constructor() {\n    super(...arguments), this._programOptions = {\n      id: !1,\n      pattern: !1,\n      sdf: !1\n    };\n  }\n  dispose() {}\n  drawMany(o, c) {\n    const {\n      context: u,\n      displayLevel: d,\n      state: p,\n      drawPhase: y,\n      painter: g,\n      pixelRatio: E,\n      spriteMosaic: M,\n      styleLayerUID: _,\n      requestRender: v,\n      allowDelayedRender: U\n    } = o;\n    if (!c.some(e => e.layerData.get(_)?.lineIndexCount ?? !1)) return;\n    const I = o.styleLayer,\n      P = I.lineMaterial,\n      x = g.vectorTilesMaterialManager,\n      T = I.getPaintValue(\"line-translate\", d),\n      D = I.getPaintValue(\"line-translate-anchor\", d),\n      S = I.getPaintProperty(\"line-pattern\"),\n      L = void 0 !== S,\n      N = L && S.isDataDriven;\n    let R, V;\n    if (L && !N) {\n      const e = S.getValue(d);\n      R = M.getMosaicItemPosition(e);\n    }\n    let h = !1;\n    if (!L) {\n      const e = I.getPaintProperty(\"line-dasharray\");\n      if (V = void 0 !== e, h = V && e.isDataDriven, V && !h) {\n        const t = e.getValue(d),\n          i = I.getDashKey(t, I.getLayoutValue(\"line-cap\", d));\n        R = M.getMosaicItemPosition(i);\n      }\n    }\n    const w = 1 / E,\n      A = y === r.HITTEST,\n      j = this._programOptions;\n    j.id = A, j.pattern = L, j.sdf = V;\n    const b = x.getMaterialProgram(u, P, j);\n    if (U && e(v) && !b.compiled) return void v();\n    if (u.useProgram(b), b.setUniformMatrix3fv(\"u_displayViewMat3\", p.displayViewMat3), b.setUniformMatrix3fv(\"u_displayMat3\", D === i.VIEWPORT ? p.displayMat3 : p.displayViewMat3), b.setUniform2fv(\"u_lineTranslation\", T), b.setUniform1f(\"u_depth\", I.z), b.setUniform1f(\"u_antialiasing\", w), A) {\n      const e = a(_ + 1);\n      b.setUniform4fv(\"u_id\", e);\n    }\n    if (R && e(R)) {\n      const {\n          page: t\n        } = R,\n        i = M.getPageSize(t);\n      e(i) && (M.bind(u, s.LINEAR, t, n), b.setUniform2fv(\"u_mosaicSize\", i), b.setUniform1i(\"u_texture\", n));\n    }\n    let z = -1;\n    for (const i of c) {\n      if (!i.layerData.has(_)) continue;\n      i.key.level !== z && (z = i.key.level, P.setDataUniforms(b, d, I, z, M));\n      const r = 2 ** (d - z) / E;\n      b.setUniform1f(\"u_zoomFactor\", r);\n      const a = i.layerData.get(_);\n      if (!a.lineIndexCount) continue;\n      a.prepareForRendering(u);\n      const o = a.lineVertexArrayObject;\n      if (!t(o)) {\n        if (u.bindVAO(o), b.setUniformMatrix3fv(\"u_dvsMat3\", i.transforms.dvs), u.setStencilFunction(l.EQUAL, i.stencilRef, 255), N || h) {\n          const t = a.patternMap;\n          if (!t) continue;\n          for (const [i, r] of t) {\n            const t = M.getPageSize(i);\n            e(t) && (M.bind(u, s.LINEAR, i, n), b.setUniform2fv(\"u_mosaicSize\", t), b.setUniform1i(\"u_texture\", n), u.drawElements(f.TRIANGLES, r[1], m.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * r[0]));\n          }\n        } else u.drawElements(f.TRIANGLES, a.lineIndexCount, m.UNSIGNED_INT, Uint32Array.BYTES_PER_ELEMENT * a.lineIndexStart);\n        i.triangleCount += a.lineIndexCount / 3;\n      }\n    }\n  }\n}\nexport { c as WGLBrushVTLLine };","map":{"version":3,"names":["isSome","e","isNone","t","TranslateAnchor","i","VTL_TEXTURE_BINDING_UNIT_SPRITES","n","WGLDrawPhase","r","u32to4Xu8","a","o","TextureSamplingMode","s","CompareFunction","l","PrimitiveType","f","DataType","m","c","constructor","arguments","_programOptions","id","pattern","sdf","dispose","drawMany","context","u","displayLevel","d","state","p","drawPhase","y","painter","g","pixelRatio","E","spriteMosaic","M","styleLayerUID","_","requestRender","v","allowDelayedRender","U","some","layerData","get","lineIndexCount","I","styleLayer","P","lineMaterial","x","vectorTilesMaterialManager","T","getPaintValue","D","S","getPaintProperty","L","N","isDataDriven","R","V","getValue","getMosaicItemPosition","h","getDashKey","getLayoutValue","w","A","HITTEST","j","b","getMaterialProgram","compiled","useProgram","setUniformMatrix3fv","displayViewMat3","VIEWPORT","displayMat3","setUniform2fv","setUniform1f","z","setUniform4fv","page","getPageSize","bind","LINEAR","setUniform1i","has","key","level","setDataUniforms","prepareForRendering","lineVertexArrayObject","bindVAO","transforms","dvs","setStencilFunction","EQUAL","stencilRef","patternMap","drawElements","TRIANGLES","UNSIGNED_INT","Uint32Array","BYTES_PER_ELEMENT","lineIndexStart","triangleCount","WGLBrushVTLLine"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLLine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../../core/maybe.js\";import{TranslateAnchor as i}from\"../../vectorTiles/style/StyleDefinition.js\";import{VTL_TEXTURE_BINDING_UNIT_SPRITES as n}from\"../definitions.js\";import{WGLDrawPhase as r}from\"../enums.js\";import{u32to4Xu8 as a}from\"../number.js\";import o from\"./WGLBrush.js\";import{TextureSamplingMode as s,CompareFunction as l,PrimitiveType as f,DataType as m}from\"../../../../webgl/enums.js\";class c extends o{constructor(){super(...arguments),this._programOptions={id:!1,pattern:!1,sdf:!1}}dispose(){}drawMany(o,c){const{context:u,displayLevel:d,state:p,drawPhase:y,painter:g,pixelRatio:E,spriteMosaic:M,styleLayerUID:_,requestRender:v,allowDelayedRender:U}=o;if(!c.some((e=>e.layerData.get(_)?.lineIndexCount??!1)))return;const I=o.styleLayer,P=I.lineMaterial,x=g.vectorTilesMaterialManager,T=I.getPaintValue(\"line-translate\",d),D=I.getPaintValue(\"line-translate-anchor\",d),S=I.getPaintProperty(\"line-pattern\"),L=void 0!==S,N=L&&S.isDataDriven;let R,V;if(L&&!N){const e=S.getValue(d);R=M.getMosaicItemPosition(e)}let h=!1;if(!L){const e=I.getPaintProperty(\"line-dasharray\");if(V=void 0!==e,h=V&&e.isDataDriven,V&&!h){const t=e.getValue(d),i=I.getDashKey(t,I.getLayoutValue(\"line-cap\",d));R=M.getMosaicItemPosition(i)}}const w=1/E,A=y===r.HITTEST,j=this._programOptions;j.id=A,j.pattern=L,j.sdf=V;const b=x.getMaterialProgram(u,P,j);if(U&&e(v)&&!b.compiled)return void v();if(u.useProgram(b),b.setUniformMatrix3fv(\"u_displayViewMat3\",p.displayViewMat3),b.setUniformMatrix3fv(\"u_displayMat3\",D===i.VIEWPORT?p.displayMat3:p.displayViewMat3),b.setUniform2fv(\"u_lineTranslation\",T),b.setUniform1f(\"u_depth\",I.z),b.setUniform1f(\"u_antialiasing\",w),A){const e=a(_+1);b.setUniform4fv(\"u_id\",e)}if(R&&e(R)){const{page:t}=R,i=M.getPageSize(t);e(i)&&(M.bind(u,s.LINEAR,t,n),b.setUniform2fv(\"u_mosaicSize\",i),b.setUniform1i(\"u_texture\",n))}let z=-1;for(const i of c){if(!i.layerData.has(_))continue;i.key.level!==z&&(z=i.key.level,P.setDataUniforms(b,d,I,z,M));const r=2**(d-z)/E;b.setUniform1f(\"u_zoomFactor\",r);const a=i.layerData.get(_);if(!a.lineIndexCount)continue;a.prepareForRendering(u);const o=a.lineVertexArrayObject;if(!t(o)){if(u.bindVAO(o),b.setUniformMatrix3fv(\"u_dvsMat3\",i.transforms.dvs),u.setStencilFunction(l.EQUAL,i.stencilRef,255),N||h){const t=a.patternMap;if(!t)continue;for(const[i,r]of t){const t=M.getPageSize(i);e(t)&&(M.bind(u,s.LINEAR,i,n),b.setUniform2fv(\"u_mosaicSize\",t),b.setUniform1i(\"u_texture\",n),u.drawElements(f.TRIANGLES,r[1],m.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*r[0]))}}else u.drawElements(f.TRIANGLES,a.lineIndexCount,m.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*a.lineIndexStart);i.triangleCount+=a.lineIndexCount/3}}}}export{c as WGLBrushVTLLine};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}