{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { clamp as t } from \"../../../../core/mathUtils.js\";\nimport { destroyMaybe as r } from \"../../../../core/maybe.js\";\nimport { watch as o } from \"../../../../core/reactiveUtils.js\";\nimport { createRenderScreenPointArray3 as s } from \"../../../../core/screenUtils.js\";\nimport { property as i } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as n } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { e as a, F as c, c as d, h as p, b as l, n as u } from \"../../../../chunks/vec3.js\";\nimport { c as h } from \"../../../../chunks/vec3f64.js\";\nimport m from \"../../../../geometry/Point.js\";\nimport { wrap as f } from \"../../../../geometry/support/ray.js\";\nimport { PropertiesPool as y } from \"../PropertiesPool.js\";\nimport { PointOfInterest as g } from \"./PointOfInterest.js\";\nimport { PaddingSide as _ } from \"../../webgl-engine/lib/Camera.js\";\nimport { TaskPriority as O, Task as j } from \"../../../support/Scheduler.js\";\nconst L = Array;\nlet P = class extends g {\n  constructor(e) {\n    super(e), this._propertiesPool = new y({\n      location: m,\n      renderLocation: L\n    }, this), this._dirty = !0, this.renderLocation = this._propertiesPool.get(\"renderLocation\");\n  }\n  initialize() {\n    this.handles.add([o(() => this.centerOnSurface.renderLocation, () => this.updateRenderLocation()), o(() => this.state.contentCamera, () => this.updateRenderLocation())]), this.scheduler && this.handles.add(this.scheduler.registerTask(O.POINT_OF_INTEREST_FREQUENT, this));\n  }\n  destroy() {\n    this._propertiesPool = r(this._propertiesPool);\n  }\n  get updating() {\n    return this._dirty || this.centerOnSurface.updating;\n  }\n  get location() {\n    const e = this._propertiesPool.get(\"location\");\n    return this.renderCoordsHelper.fromRenderCoords(this.renderLocation, e, this.state.spatialReference), e;\n  }\n  get running() {\n    return this._dirty;\n  }\n  runTask() {\n    const e = this._get(\"renderLocation\"),\n      r = this.centerOnSurface.renderLocation,\n      o = this.renderCoordsHelper,\n      s = this.state.contentCamera;\n    this._dirty = !1, o.worldUpAtPosition(r, S);\n    const i = Math.max(0, (Math.acos(a(S, s.viewForward)) - .5 * Math.PI) * (s.aboveGround ? 1 : -1));\n    if (Number.isNaN(i)) {\n      if (!e || !c(e, r)) {\n        const e = this._propertiesPool.get(\"renderLocation\");\n        d(e, r), this._set(\"renderLocation\", e);\n      }\n      return j.YIELD;\n    }\n    const n = 1 - t(i / (.5 * Math.PI), 0, 1),\n      l = n * n * n;\n    this._calculateScreenHorizontalEdgeOnSurface(C);\n    const u = this._propertiesPool.get(\"renderLocation\");\n    return p(u, r, C, l), e && c(e, u) || this._set(\"renderLocation\", u), j.YIELD;\n  }\n  _calculateScreenHorizontalEdgeOnSurface(e) {\n    const t = this.state.contentCamera,\n      r = t.getRenderCenter(s());\n    if (r[1] = t.aboveGround ? t.padding[_.BOTTOM] : t.fullHeight - t.padding[_.TOP], this.estimateSurfaceIntersectionAtRenderPoint(r, e)) return e;\n    const o = this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);\n    if (t.unprojectFromRenderScreen(r, v)) {\n      l(v, v, t.eye);\n      const r = u(v, v);\n      if (this.renderCoordsHelper.intersectManifold(f(t.eye, r), o, e)) return e;\n    }\n    return this.renderCoordsHelper.setAltitude(e, o, t.eye);\n  }\n  updateRenderLocation() {\n    this._dirty = !0;\n  }\n};\ne([i()], P.prototype, \"_dirty\", void 0), e([i({\n  constructOnly: !0\n})], P.prototype, \"scheduler\", void 0), e([i({\n  constructOnly: !0\n})], P.prototype, \"centerOnSurface\", void 0), e([i({\n  constructOnly: !0\n})], P.prototype, \"estimateSurfaceIntersectionAtRenderPoint\", void 0), e([i({\n  readOnly: !0\n})], P.prototype, \"updating\", null), e([i({\n  readOnly: !0\n})], P.prototype, \"location\", null), e([i({\n  readOnly: !0\n})], P.prototype, \"renderLocation\", void 0), P = e([n(\"esri.views.3d.support.pointsOfInterest.Focus\")], P);\nconst S = h(),\n  v = h(),\n  C = h();\nexport { P as Focus };","map":{"version":3,"names":["_","e","clamp","t","destroyMaybe","r","watch","o","createRenderScreenPointArray3","s","property","i","subclass","n","a","F","c","d","h","p","b","l","u","m","wrap","f","PropertiesPool","y","PointOfInterest","g","PaddingSide","TaskPriority","O","Task","j","L","Array","P","constructor","_propertiesPool","location","renderLocation","_dirty","get","initialize","handles","add","centerOnSurface","updateRenderLocation","state","contentCamera","scheduler","registerTask","POINT_OF_INTEREST_FREQUENT","destroy","updating","renderCoordsHelper","fromRenderCoords","spatialReference","running","runTask","_get","worldUpAtPosition","S","Math","max","acos","viewForward","PI","aboveGround","Number","isNaN","_set","YIELD","_calculateScreenHorizontalEdgeOnSurface","C","getRenderCenter","padding","BOTTOM","fullHeight","TOP","estimateSurfaceIntersectionAtRenderPoint","getAltitude","unprojectFromRenderScreen","v","eye","intersectManifold","setAltitude","prototype","constructOnly","readOnly","Focus"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/support/pointsOfInterest/Focus.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{clamp as t}from\"../../../../core/mathUtils.js\";import{destroyMaybe as r}from\"../../../../core/maybe.js\";import{watch as o}from\"../../../../core/reactiveUtils.js\";import{createRenderScreenPointArray3 as s}from\"../../../../core/screenUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{e as a,F as c,c as d,h as p,b as l,n as u}from\"../../../../chunks/vec3.js\";import{c as h}from\"../../../../chunks/vec3f64.js\";import m from\"../../../../geometry/Point.js\";import{wrap as f}from\"../../../../geometry/support/ray.js\";import{PropertiesPool as y}from\"../PropertiesPool.js\";import{PointOfInterest as g}from\"./PointOfInterest.js\";import{PaddingSide as _}from\"../../webgl-engine/lib/Camera.js\";import{TaskPriority as O,Task as j}from\"../../../support/Scheduler.js\";const L=Array;let P=class extends g{constructor(e){super(e),this._propertiesPool=new y({location:m,renderLocation:L},this),this._dirty=!0,this.renderLocation=this._propertiesPool.get(\"renderLocation\")}initialize(){this.handles.add([o((()=>this.centerOnSurface.renderLocation),(()=>this.updateRenderLocation())),o((()=>this.state.contentCamera),(()=>this.updateRenderLocation()))]),this.scheduler&&this.handles.add(this.scheduler.registerTask(O.POINT_OF_INTEREST_FREQUENT,this))}destroy(){this._propertiesPool=r(this._propertiesPool)}get updating(){return this._dirty||this.centerOnSurface.updating}get location(){const e=this._propertiesPool.get(\"location\");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get running(){return this._dirty}runTask(){const e=this._get(\"renderLocation\"),r=this.centerOnSurface.renderLocation,o=this.renderCoordsHelper,s=this.state.contentCamera;this._dirty=!1,o.worldUpAtPosition(r,S);const i=Math.max(0,(Math.acos(a(S,s.viewForward))-.5*Math.PI)*(s.aboveGround?1:-1));if(Number.isNaN(i)){if(!e||!c(e,r)){const e=this._propertiesPool.get(\"renderLocation\");d(e,r),this._set(\"renderLocation\",e)}return j.YIELD}const n=1-t(i/(.5*Math.PI),0,1),l=n*n*n;this._calculateScreenHorizontalEdgeOnSurface(C);const u=this._propertiesPool.get(\"renderLocation\");return p(u,r,C,l),e&&c(e,u)||this._set(\"renderLocation\",u),j.YIELD}_calculateScreenHorizontalEdgeOnSurface(e){const t=this.state.contentCamera,r=t.getRenderCenter(s());if(r[1]=t.aboveGround?t.padding[_.BOTTOM]:t.fullHeight-t.padding[_.TOP],this.estimateSurfaceIntersectionAtRenderPoint(r,e))return e;const o=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);if(t.unprojectFromRenderScreen(r,v)){l(v,v,t.eye);const r=u(v,v);if(this.renderCoordsHelper.intersectManifold(f(t.eye,r),o,e))return e}return this.renderCoordsHelper.setAltitude(e,o,t.eye)}updateRenderLocation(){this._dirty=!0}};e([i()],P.prototype,\"_dirty\",void 0),e([i({constructOnly:!0})],P.prototype,\"scheduler\",void 0),e([i({constructOnly:!0})],P.prototype,\"centerOnSurface\",void 0),e([i({constructOnly:!0})],P.prototype,\"estimateSurfaceIntersectionAtRenderPoint\",void 0),e([i({readOnly:!0})],P.prototype,\"updating\",null),e([i({readOnly:!0})],P.prototype,\"location\",null),e([i({readOnly:!0})],P.prototype,\"renderLocation\",void 0),P=e([n(\"esri.views.3d.support.pointsOfInterest.Focus\")],P);const S=h(),v=h(),C=h();export{P as Focus};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}