{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { smoothstep as t, clamp as e } from \"../../../../core/mathUtils.js\";\nimport { isNone as s, disposeMaybe as a, releaseMaybe as i } from \"../../../../core/maybe.js\";\nimport { n as r, s as h, e as o } from \"../../../../chunks/vec3.js\";\nimport { c } from \"../../../../chunks/vec3f64.js\";\nimport { ViewingMode as n } from \"../../../ViewingMode.js\";\nimport { ReadShadowMapBindParameters as m } from \"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";\nimport { createQuadVAO as _ } from \"./glUtil3D.js\";\nimport { ShadowHighlightPassParameters as p, ShadowHighlightTechnique as d } from \"../shaders/ShadowHighlightTechnique.js\";\nimport { vertexCount as u } from \"../../../webgl/Util.js\";\nconst l = .001953125,\n  g = 4e4,\n  w = 5e4;\nclass v {\n  constructor(t, e) {\n    this._rctx = t, this._viewingMode = e, this._maxOpacity = 1, this._passParameters = new p(), this._drawParameters = new m(), this._vao = _(this._rctx);\n  }\n  get _technique() {\n    return s(this._techniqueCached) && (this._techniqueCached = new d({\n      rctx: this._rctx,\n      viewingMode: this._viewingMode\n    })), this._techniqueCached;\n  }\n  render(t, e) {\n    if (!t.shadowMap.enabled || !t.linearDepthTexture || !this.isVisible) return;\n    const s = this._technique;\n    this._drawParameters.origin = t.camera.center, this._rctx.bindFramebuffer(e), this._rctx.bindTechnique(s, this._passParameters, t).bindDraw(this._drawParameters, t, this._passParameters), this._rctx.bindVAO(this._vao), this._rctx.drawArrays(s.primitiveType, 0, u(this._vao, \"geometry\"));\n  }\n  get gpuMemoryUsage() {\n    return this._vao?.size ?? 0;\n  }\n  setDefaultOptions(t) {\n    this._passParameters = {\n      ...this._passParameters,\n      ...t\n    }, this._updateMaxOpacity();\n  }\n  updateParameters(s, a) {\n    this._passParameters.opacityElevation = 1 - t(g, w, s.relativeElevation);\n    const i = this._viewingMode === n.Global ? r(y, s.center) : h(y, 0, 0, 1),\n      c = o(i, a);\n    this._passParameters.dayNightTerminator = t(0, 1, e(30 * c, 0, 1));\n  }\n  dispose() {\n    this._vao = a(this._vao), this._techniqueCached = i(this._techniqueCached);\n  }\n  get isVisible() {\n    const {\n      opacityElevation: t,\n      dayNightTerminator: e\n    } = this._passParameters;\n    return this._maxOpacity * t * e >= l;\n  }\n  _updateMaxOpacity() {\n    const t = Math.max(this._passParameters.shadowOpacity, this._passParameters.occludedShadowOpacity);\n    this._maxOpacity = t * this._passParameters.shadowColor[3];\n  }\n}\nconst y = c();\nexport { v as ShadowHighlight };","map":{"version":3,"names":["smoothstep","t","clamp","e","isNone","s","disposeMaybe","a","releaseMaybe","i","n","r","h","o","c","ViewingMode","ReadShadowMapBindParameters","m","createQuadVAO","_","ShadowHighlightPassParameters","p","ShadowHighlightTechnique","d","vertexCount","u","l","g","w","v","constructor","_rctx","_viewingMode","_maxOpacity","_passParameters","_drawParameters","_vao","_technique","_techniqueCached","rctx","viewingMode","render","shadowMap","enabled","linearDepthTexture","isVisible","origin","camera","center","bindFramebuffer","bindTechnique","bindDraw","bindVAO","drawArrays","primitiveType","gpuMemoryUsage","size","setDefaultOptions","_updateMaxOpacity","updateParameters","opacityElevation","relativeElevation","Global","y","dayNightTerminator","dispose","Math","max","shadowOpacity","occludedShadowOpacity","shadowColor","ShadowHighlight"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/webgl-engine/lib/ShadowHighlight.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{smoothstep as t,clamp as e}from\"../../../../core/mathUtils.js\";import{isNone as s,disposeMaybe as a,releaseMaybe as i}from\"../../../../core/maybe.js\";import{n as r,s as h,e as o}from\"../../../../chunks/vec3.js\";import{c}from\"../../../../chunks/vec3f64.js\";import{ViewingMode as n}from\"../../../ViewingMode.js\";import{ReadShadowMapBindParameters as m}from\"../core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{createQuadVAO as _}from\"./glUtil3D.js\";import{ShadowHighlightPassParameters as p,ShadowHighlightTechnique as d}from\"../shaders/ShadowHighlightTechnique.js\";import{vertexCount as u}from\"../../../webgl/Util.js\";const l=.001953125,g=4e4,w=5e4;class v{constructor(t,e){this._rctx=t,this._viewingMode=e,this._maxOpacity=1,this._passParameters=new p,this._drawParameters=new m,this._vao=_(this._rctx)}get _technique(){return s(this._techniqueCached)&&(this._techniqueCached=new d({rctx:this._rctx,viewingMode:this._viewingMode})),this._techniqueCached}render(t,e){if(!t.shadowMap.enabled||!t.linearDepthTexture||!this.isVisible)return;const s=this._technique;this._drawParameters.origin=t.camera.center,this._rctx.bindFramebuffer(e),this._rctx.bindTechnique(s,this._passParameters,t).bindDraw(this._drawParameters,t,this._passParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(s.primitiveType,0,u(this._vao,\"geometry\"))}get gpuMemoryUsage(){return this._vao?.size??0}setDefaultOptions(t){this._passParameters={...this._passParameters,...t},this._updateMaxOpacity()}updateParameters(s,a){this._passParameters.opacityElevation=1-t(g,w,s.relativeElevation);const i=this._viewingMode===n.Global?r(y,s.center):h(y,0,0,1),c=o(i,a);this._passParameters.dayNightTerminator=t(0,1,e(30*c,0,1))}dispose(){this._vao=a(this._vao),this._techniqueCached=i(this._techniqueCached)}get isVisible(){const{opacityElevation:t,dayNightTerminator:e}=this._passParameters;return this._maxOpacity*t*e>=l}_updateMaxOpacity(){const t=Math.max(this._passParameters.shadowOpacity,this._passParameters.occludedShadowOpacity);this._maxOpacity=t*this._passParameters.shadowColor[3]}}const y=c();export{v as ShadowHighlight};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}