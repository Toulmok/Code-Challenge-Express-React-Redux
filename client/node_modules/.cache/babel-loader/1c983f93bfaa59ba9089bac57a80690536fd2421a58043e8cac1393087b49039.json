{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from \"../../../../../../core/has.js\";\nimport { isSome as e, unwrap as t } from \"../../../../../../core/maybe.js\";\nimport r from \"../../../../../../core/workers/Connection.js\";\nimport { toQuantizationTransform as s } from \"../../../../../../geometry/support/quantizationUtils.js\";\nimport { convertFromFeatureSet as i, quantizeOptimizedFeatureSet as a } from \"../../../../../../layers/graphics/featureConversionUtils.js\";\nimport { queryOptimizedFeatureSet as o } from \"../../../../../../layers/ogc/ogcFeatureUtils.js\";\nimport { executeQueryPBFBuffer as n, executeQuery as c } from \"../../../../../../rest/query/operations/query.js\";\nimport { FeatureSetReaderJSON as u } from \"../../support/FeatureSetReaderJSON.js\";\nimport { FeatureSetReaderPBF as m } from \"../../support/FeatureSetReaderPBF.js\";\nclass p {\n  constructor(e) {\n    this.service = e;\n  }\n  destroy() {}\n}\nfunction f(e) {\n  return Array.isArray(e.source);\n}\nfunction l(e) {\n  return \"ogc-source\" === e?.type;\n}\nfunction y(e) {\n  const {\n    capabilities: t\n  } = e;\n  return l(e.source) ? new q(e) : f(e) ? new d(e) : t.query.supportsFormatPBF && has(\"featurelayer-pbf\") ? new v(e) : new F(e);\n}\nasync function h(e) {\n  const t = new r();\n  return await t.open(e, {}), t;\n}\nclass d extends p {\n  constructor(e) {\n    super(e), this._portsOpen = h(e.source).then(e => this.client = e);\n  }\n  destroy() {\n    this.client.close(), this.client = null;\n  }\n  async executeQuery(e, t) {\n    await this._portsOpen;\n    const r = await this.client.invoke(\"queryFeatures\", e.toJSON(), t);\n    return u.fromFeatureSet(r, this.service);\n  }\n}\nclass v extends p {\n  async executeQuery(e, t) {\n    const {\n        data: r\n      } = await n(this.service.source, e, t),\n      s = !e.quantizationParameters;\n    return m.fromBuffer(r, this.service, s);\n  }\n}\nclass F extends p {\n  async executeQuery(r, o) {\n    const {\n      source: n,\n      capabilities: m,\n      spatialReference: p,\n      objectIdField: f,\n      geometryType: l\n    } = this.service;\n    if (e(r.quantizationParameters) && !m.query.supportsQuantization) {\n      const e = r.clone(),\n        m = s(t(e.quantizationParameters));\n      e.quantizationParameters = null;\n      const {\n          data: l\n        } = await c(n, e, p, o),\n        y = i(l, f);\n      return a(m, y), u.fromOptimizedFeatureSet(y, this.service);\n    }\n    const {\n      data: y\n    } = await c(n, r, this.service.spatialReference, o);\n    return \"esriGeometryPoint\" === l && (y.features = y.features?.filter(t => {\n      if (e(t.geometry)) {\n        const e = t.geometry;\n        return Number.isFinite(e.x) && Number.isFinite(e.y);\n      }\n      return !0;\n    })), u.fromFeatureSet(y, this.service);\n  }\n}\nclass q extends p {\n  async executeQuery(e, r) {\n    const {\n      capabilities: i\n    } = this.service;\n    if (e.quantizationParameters && !i.query.supportsQuantization) {\n      const i = e.clone(),\n        n = s(t(i.quantizationParameters));\n      i.quantizationParameters = null;\n      const c = await o(this.service.source, e, r);\n      return a(n, c), u.fromOptimizedFeatureSet(c, this.service);\n    }\n    const n = await o(this.service.source, e, r);\n    return u.fromOptimizedFeatureSet(n, this.service);\n  }\n}\nexport { p as SourceAdapter, y as createSourceAdapter };","map":{"version":3,"names":["has","isSome","e","unwrap","t","r","toQuantizationTransform","s","convertFromFeatureSet","i","quantizeOptimizedFeatureSet","a","queryOptimizedFeatureSet","o","executeQueryPBFBuffer","n","executeQuery","c","FeatureSetReaderJSON","u","FeatureSetReaderPBF","m","p","constructor","service","destroy","f","Array","isArray","source","l","type","y","capabilities","q","d","query","supportsFormatPBF","v","F","h","open","_portsOpen","then","client","close","invoke","toJSON","fromFeatureSet","data","quantizationParameters","fromBuffer","spatialReference","objectIdField","geometryType","supportsQuantization","clone","fromOptimizedFeatureSet","features","filter","geometry","Number","isFinite","x","SourceAdapter","createSourceAdapter"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/2d/layers/features/controllers/support/sourceAdapters.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../../core/has.js\";import{isSome as e,unwrap as t}from\"../../../../../../core/maybe.js\";import r from\"../../../../../../core/workers/Connection.js\";import{toQuantizationTransform as s}from\"../../../../../../geometry/support/quantizationUtils.js\";import{convertFromFeatureSet as i,quantizeOptimizedFeatureSet as a}from\"../../../../../../layers/graphics/featureConversionUtils.js\";import{queryOptimizedFeatureSet as o}from\"../../../../../../layers/ogc/ogcFeatureUtils.js\";import{executeQueryPBFBuffer as n,executeQuery as c}from\"../../../../../../rest/query/operations/query.js\";import{FeatureSetReaderJSON as u}from\"../../support/FeatureSetReaderJSON.js\";import{FeatureSetReaderPBF as m}from\"../../support/FeatureSetReaderPBF.js\";class p{constructor(e){this.service=e}destroy(){}}function f(e){return Array.isArray(e.source)}function l(e){return\"ogc-source\"===e?.type}function y(e){const{capabilities:t}=e;return l(e.source)?new q(e):f(e)?new d(e):t.query.supportsFormatPBF&&has(\"featurelayer-pbf\")?new v(e):new F(e)}async function h(e){const t=new r;return await t.open(e,{}),t}class d extends p{constructor(e){super(e),this._portsOpen=h(e.source).then((e=>this.client=e))}destroy(){this.client.close(),this.client=null}async executeQuery(e,t){await this._portsOpen;const r=await this.client.invoke(\"queryFeatures\",e.toJSON(),t);return u.fromFeatureSet(r,this.service)}}class v extends p{async executeQuery(e,t){const{data:r}=await n(this.service.source,e,t),s=!e.quantizationParameters;return m.fromBuffer(r,this.service,s)}}class F extends p{async executeQuery(r,o){const{source:n,capabilities:m,spatialReference:p,objectIdField:f,geometryType:l}=this.service;if(e(r.quantizationParameters)&&!m.query.supportsQuantization){const e=r.clone(),m=s(t(e.quantizationParameters));e.quantizationParameters=null;const{data:l}=await c(n,e,p,o),y=i(l,f);return a(m,y),u.fromOptimizedFeatureSet(y,this.service)}const{data:y}=await c(n,r,this.service.spatialReference,o);return\"esriGeometryPoint\"===l&&(y.features=y.features?.filter((t=>{if(e(t.geometry)){const e=t.geometry;return Number.isFinite(e.x)&&Number.isFinite(e.y)}return!0}))),u.fromFeatureSet(y,this.service)}}class q extends p{async executeQuery(e,r){const{capabilities:i}=this.service;if(e.quantizationParameters&&!i.query.supportsQuantization){const i=e.clone(),n=s(t(i.quantizationParameters));i.quantizationParameters=null;const c=await o(this.service.source,e,r);return a(n,c),u.fromOptimizedFeatureSet(c,this.service)}const n=await o(this.service.source,e,r);return u.fromOptimizedFeatureSet(n,this.service)}}export{p as SourceAdapter,y as createSourceAdapter};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}