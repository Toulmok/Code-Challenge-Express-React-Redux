{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { nextPowerOfTwo as t } from \"../../../../../core/mathUtils.js\";\nimport { isSome as r } from \"../../../../../core/maybe.js\";\nimport { c as e } from \"../../../../../chunks/mat3f32.js\";\nimport { f as o } from \"../../../../../chunks/vec4f32.js\";\nimport { VTL_TEXTURE_BINDING_UNIT_SPRITES as i, VTL_HIGH_RES_CUTOFF as s } from \"../definitions.js\";\nimport { WGLDrawPhase as a } from \"../enums.js\";\nimport { u32to4Xu8 as n } from \"../number.js\";\nimport c from \"./WGLBrush.js\";\nimport { BufferObject as m } from \"../../../../webgl/BufferObject.js\";\nimport { TextureSamplingMode as f, CompareFunction as l, PrimitiveType as u, Usage as p } from \"../../../../webgl/enums.js\";\nimport { VertexArrayObject as _ } from \"../../../../webgl/VertexArrayObject.js\";\nclass d extends c {\n  constructor() {\n    super(...arguments), this._color = o(1, 0, 0, 1), this._patternMatrix = e(), this._programOptions = {\n      id: !1,\n      pattern: !1\n    };\n  }\n  dispose() {\n    this._vao && (this._vao.dispose(), this._vao = null);\n  }\n  drawMany(e, o) {\n    const {\n      context: c,\n      painter: m,\n      styleLayerUID: p,\n      requestRender: _,\n      allowDelayedRender: d\n    } = e;\n    this._loadWGLResources(e);\n    const h = e.displayLevel,\n      g = e.styleLayer,\n      v = g.backgroundMaterial,\n      y = m.vectorTilesMaterialManager,\n      b = g.getPaintValue(\"background-color\", h),\n      x = g.getPaintValue(\"background-opacity\", h),\n      M = g.getPaintValue(\"background-pattern\", h),\n      j = void 0 !== M,\n      U = b[3] * x,\n      w = 1 | window.devicePixelRatio,\n      L = e.spriteMosaic;\n    let A, P;\n    const I = w > s ? 2 : 1,\n      R = e.drawPhase === a.HITTEST,\n      k = this._programOptions;\n    k.id = R, k.pattern = j;\n    const T = y.getMaterialProgram(c, v, k);\n    if (d && r(_) && !T.compiled) _();else {\n      if (c.bindVAO(this._vao), c.useProgram(T), j) {\n        const t = L.getMosaicItemPosition(M, !0);\n        if (r(t)) {\n          const {\n            tl: e,\n            br: o,\n            page: s\n          } = t;\n          A = o[0] - e[0], P = o[1] - e[1];\n          const a = L.getPageSize(s);\n          r(a) && (L.bind(c, f.LINEAR, s, i), T.setUniform4f(\"u_tlbr\", e[0], e[1], o[0], o[1]), T.setUniform2fv(\"u_mosaicSize\", a), T.setUniform1i(\"u_texture\", i));\n        }\n        T.setUniform1f(\"u_opacity\", x);\n      } else this._color[0] = U * b[0], this._color[1] = U * b[1], this._color[2] = U * b[2], this._color[3] = U, T.setUniform4fv(\"u_color\", this._color);\n      if (T.setUniform1f(\"u_depth\", g.z || 0), R) {\n        const t = n(p + 1);\n        T.setUniform4fv(\"u_id\", t);\n      }\n      for (const r of o) {\n        if (T.setUniform1f(\"u_coord_range\", r.rangeX), T.setUniformMatrix3fv(\"u_dvsMat3\", r.transforms.dvs), j) {\n          const e = Math.max(2 ** (Math.round(h) - r.key.level), 1),\n            o = I * r.width * e,\n            i = o / t(A),\n            s = o / t(P);\n          this._patternMatrix[0] = i, this._patternMatrix[4] = s, T.setUniformMatrix3fv(\"u_pattern_matrix\", this._patternMatrix);\n        }\n        c.setStencilFunction(l.EQUAL, 0, 255), c.drawArrays(u.TRIANGLE_STRIP, 0, 4);\n      }\n    }\n  }\n  _loadWGLResources(t) {\n    if (this._vao) return;\n    const {\n        context: r,\n        styleLayer: e\n      } = t,\n      o = e.backgroundMaterial,\n      i = new Int8Array([0, 0, 1, 0, 0, 1, 1, 1]),\n      s = m.createVertex(r, p.STATIC_DRAW, i),\n      a = new _(r, o.getAttributeLocations(), o.getLayoutInfo(), {\n        geometry: s\n      });\n    this._vao = a;\n  }\n}\nexport { d as WGLBrushVTLBackground };","map":{"version":3,"names":["nextPowerOfTwo","t","isSome","r","c","e","f","o","VTL_TEXTURE_BINDING_UNIT_SPRITES","i","VTL_HIGH_RES_CUTOFF","s","WGLDrawPhase","a","u32to4Xu8","n","BufferObject","m","TextureSamplingMode","CompareFunction","l","PrimitiveType","u","Usage","p","VertexArrayObject","_","d","constructor","arguments","_color","_patternMatrix","_programOptions","id","pattern","dispose","_vao","drawMany","context","painter","styleLayerUID","requestRender","allowDelayedRender","_loadWGLResources","h","displayLevel","g","styleLayer","v","backgroundMaterial","y","vectorTilesMaterialManager","b","getPaintValue","x","M","j","U","w","window","devicePixelRatio","L","spriteMosaic","A","P","I","R","drawPhase","HITTEST","k","T","getMaterialProgram","compiled","bindVAO","useProgram","getMosaicItemPosition","tl","br","page","getPageSize","bind","LINEAR","setUniform4f","setUniform2fv","setUniform1i","setUniform1f","setUniform4fv","z","rangeX","setUniformMatrix3fv","transforms","dvs","Math","max","round","key","level","width","setStencilFunction","EQUAL","drawArrays","TRIANGLE_STRIP","Int8Array","createVertex","STATIC_DRAW","getAttributeLocations","getLayoutInfo","geometry","WGLBrushVTLBackground"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/2d/engine/webgl/brushes/WGLBrushVTLBackground.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{nextPowerOfTwo as t}from\"../../../../../core/mathUtils.js\";import{isSome as r}from\"../../../../../core/maybe.js\";import{c as e}from\"../../../../../chunks/mat3f32.js\";import{f as o}from\"../../../../../chunks/vec4f32.js\";import{VTL_TEXTURE_BINDING_UNIT_SPRITES as i,VTL_HIGH_RES_CUTOFF as s}from\"../definitions.js\";import{WGLDrawPhase as a}from\"../enums.js\";import{u32to4Xu8 as n}from\"../number.js\";import c from\"./WGLBrush.js\";import{BufferObject as m}from\"../../../../webgl/BufferObject.js\";import{TextureSamplingMode as f,CompareFunction as l,PrimitiveType as u,Usage as p}from\"../../../../webgl/enums.js\";import{VertexArrayObject as _}from\"../../../../webgl/VertexArrayObject.js\";class d extends c{constructor(){super(...arguments),this._color=o(1,0,0,1),this._patternMatrix=e(),this._programOptions={id:!1,pattern:!1}}dispose(){this._vao&&(this._vao.dispose(),this._vao=null)}drawMany(e,o){const{context:c,painter:m,styleLayerUID:p,requestRender:_,allowDelayedRender:d}=e;this._loadWGLResources(e);const h=e.displayLevel,g=e.styleLayer,v=g.backgroundMaterial,y=m.vectorTilesMaterialManager,b=g.getPaintValue(\"background-color\",h),x=g.getPaintValue(\"background-opacity\",h),M=g.getPaintValue(\"background-pattern\",h),j=void 0!==M,U=b[3]*x,w=1|window.devicePixelRatio,L=e.spriteMosaic;let A,P;const I=w>s?2:1,R=e.drawPhase===a.HITTEST,k=this._programOptions;k.id=R,k.pattern=j;const T=y.getMaterialProgram(c,v,k);if(d&&r(_)&&!T.compiled)_();else{if(c.bindVAO(this._vao),c.useProgram(T),j){const t=L.getMosaicItemPosition(M,!0);if(r(t)){const{tl:e,br:o,page:s}=t;A=o[0]-e[0],P=o[1]-e[1];const a=L.getPageSize(s);r(a)&&(L.bind(c,f.LINEAR,s,i),T.setUniform4f(\"u_tlbr\",e[0],e[1],o[0],o[1]),T.setUniform2fv(\"u_mosaicSize\",a),T.setUniform1i(\"u_texture\",i))}T.setUniform1f(\"u_opacity\",x)}else this._color[0]=U*b[0],this._color[1]=U*b[1],this._color[2]=U*b[2],this._color[3]=U,T.setUniform4fv(\"u_color\",this._color);if(T.setUniform1f(\"u_depth\",g.z||0),R){const t=n(p+1);T.setUniform4fv(\"u_id\",t)}for(const r of o){if(T.setUniform1f(\"u_coord_range\",r.rangeX),T.setUniformMatrix3fv(\"u_dvsMat3\",r.transforms.dvs),j){const e=Math.max(2**(Math.round(h)-r.key.level),1),o=I*r.width*e,i=o/t(A),s=o/t(P);this._patternMatrix[0]=i,this._patternMatrix[4]=s,T.setUniformMatrix3fv(\"u_pattern_matrix\",this._patternMatrix)}c.setStencilFunction(l.EQUAL,0,255),c.drawArrays(u.TRIANGLE_STRIP,0,4)}}}_loadWGLResources(t){if(this._vao)return;const{context:r,styleLayer:e}=t,o=e.backgroundMaterial,i=new Int8Array([0,0,1,0,0,1,1,1]),s=m.createVertex(r,p.STATIC_DRAW,i),a=new _(r,o.getAttributeLocations(),o.getLayoutInfo(),{geometry:s});this._vao=a}}export{d as WGLBrushVTLBackground};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}