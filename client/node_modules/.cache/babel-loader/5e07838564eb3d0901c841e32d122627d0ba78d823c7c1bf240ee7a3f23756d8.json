{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../Color.js\";\nimport i from \"../../../../analysis/LineOfSightAnalysisObserver.js\";\nimport a from \"../../../../analysis/LineOfSightAnalysisTarget.js\";\nimport r from \"../../../../core/Handles.js\";\nimport n from \"../../../../core/Logger.js\";\nimport { destroyMaybe as s, isSome as o, isNone as l, applySome as c } from \"../../../../core/maybe.js\";\nimport { watch as u, syncAndInitial as h, initial as p } from \"../../../../core/reactiveUtils.js\";\nimport { property as d } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as g } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { WatchUpdatingTracking as _ } from \"../../../../core/support/WatchUpdatingTracking.js\";\nimport { create as m, fromPoints as v } from \"../../../../geometry/support/lineSegment.js\";\nimport { getGraphicEffectiveElevationInfo as b, getConvertedElevation as y } from \"../../../../support/elevationInfoUtils.js\";\nimport f from \"../../../../symbols/support/ElevationInfo.js\";\nimport { LineOfSightRayIntersector as T } from \"./LineOfSightRayIntersector.js\";\nimport { LineOfSightToolConfiguration as C } from \"./LineOfSightToolConfiguration.js\";\nimport { createSphereManipulator as w, createSphereManipulatorRenderObjects as M } from \"./lineOfSightToolUtils.js\";\nimport { LaserlineVisualElement as L } from \"../../interactive/visualElements/LaserlineVisualElement.js\";\nimport { IntersectorType as k } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nimport \"../../../input/ViewEvents.js\";\nimport { AnalysisToolBase as V } from \"../../../interactive/AnalysisToolBase.js\";\nimport { createManipulatorDragEventPipeline as O } from \"../../../interactive/dragEventPipeline.js\";\nimport { ManipulatorStateCustomFlags as S } from \"../../../interactive/interfaces.js\";\nimport { createScreenPointFromEvent as D } from \"../../../support/screenUtils.js\";\nimport { MouseButton as E } from \"../../../input/IViewEvents.js\";\nvar I;\n!function (e) {\n  e.Ready = \"ready\", e.Creating = \"creating\", e.Created = \"created\";\n}(I || (I = {}));\nlet P = class extends V {\n  constructor(e) {\n    super(e), this.removeIncompleteOnCancel = !1, this.configuration = new C(), this.analysisViewData = null, this._latestPointerMovePointerType = null, this._laserlineVisualElement = null, this._grabbedManipulator = null, this._analysisHandles = new r(), this._handles = new r(), this._updatingHandles = new _(), this._manipulatorHandles = new r(), this._targetTrackerManipulator = null;\n  }\n  initialize() {\n    this._intersector = new T({\n      view: this.view\n    }), this._handles.add(u(() => this.state, e => {\n      e === I.Created && this.finishToolCreation();\n    }, h)), this._observerManipulator = this._createObserverManipulator(), this._handles.add([this._updatingHandles.add(() => ({\n      ...this.configuration.observer\n    }), () => this._updateObserverManipulatorStyle()), this._updatingHandles.add(() => this.analysisViewData?.elevationAlignedObserver, e => this._onObserverLocationChange(e), p), this._updatingHandles.add(() => ({\n      ...this.configuration.laserLine\n    }), () => this._createVisualElements(), p), this._updatingHandles.add(() => this._laserLineRendererDependencies(), e => this._updateLaserLineRenderer(e)), this._connectComputations(), this._updatingHandles.addWhen(() => !this._shouldRenderTracker, () => this._clearCursorTracker(), p)]);\n  }\n  destroy() {\n    this._updatingHandles = s(this._updatingHandles), this._handles = s(this._handles), this._manipulatorHandles = s(this._manipulatorHandles), this._analysisHandles = s(this._analysisHandles), this._observerManipulator = null, this._clearCursorTracker(), this._removeVisualElements(), this._intersector = null, this._set(\"analysis\", null);\n  }\n  get state() {\n    return this.active ? this.hasGrabbedManipulators ? I.Created : I.Creating : o(this.analysis.observer) && o(this.analysis.observer.position) ? I.Created : I.Ready;\n  }\n  get cursor() {\n    return this.active && this._showTracker ? \"crosshair\" : null;\n  }\n  get updating() {\n    return o(this.analysisViewData) && this.analysisViewData.updating || this._updatingHandles.updating;\n  }\n  get _showTracker() {\n    return this.active && \"mouse\" === this._latestPointerMovePointerType;\n  }\n  get _shouldRenderTracker() {\n    return this._showTracker && o(this.analysis.observer) && o(this.analysis.observer.position) && !this.hasGrabbedManipulators;\n  }\n  continue() {\n    this.view.activeTool = this;\n  }\n  stop() {\n    this.view.activeTool = null;\n  }\n  onEditableChange() {\n    this.analysisViewData.editable = this.internallyEditable;\n  }\n  onInputEvent(e) {\n    switch (e.type) {\n      case \"immediate-double-click\":\n        this._doubleClickHandler(e);\n        break;\n      case \"key-down\":\n        this._keyDownHandler(e);\n        break;\n      case \"pointer-move\":\n        this._pointerMoveHandler(e);\n    }\n  }\n  onInputEventAfter(e) {\n    if (\"immediate-click\" === e.type) this._clickHandler(e);\n  }\n  onShow() {}\n  onHide() {}\n  onDeactivate() {\n    this._clearCursorTracker();\n  }\n  _connectComputations() {\n    return this._updatingHandles.addOnCollectionChange(() => this.analysisViewData.computations, e => this._onComputationsCollectionChange(e), {\n      initial: !0,\n      final: !0\n    });\n  }\n  _onComputationsCollectionChange(_ref) {\n    let {\n      added: e,\n      removed: t\n    } = _ref;\n    for (const i of t) this._disconnectComputation(i);\n    for (const i of e) this._connectComputation(i);\n  }\n  _connectComputation(e) {\n    if (this.destroyed) return void n.getLogger(this.declaredClass).warn(\"Attempting to connect an analysis to a destroyed LineOfSight tool. Ignoring.\");\n    const t = this._analysisHandles;\n    if (t.has(e)) return;\n    const i = this._createTargetManipulator(e.target);\n    l(this._targetTrackerManipulator) && i.metadata.target === this.analysisViewData.cursorTarget && (this._targetTrackerManipulator = i, this._targetTrackerManipulator.available = !1, this._targetTrackerManipulator.interactive = !1, this._updateLaserLineRenderer()), t.add([this._updatingHandles.add(() => this._getLineOfSightManipulatorStateDependencies(e), () => this._updateManipulatorState(i, e), p), this._updatingHandles.add(() => e.elevationAlignedTargetLocation, e => this._onTargetLocationChange(e, i), p)], e);\n  }\n  _disconnectComputation(e) {\n    if (this.destroyed) return void n.getLogger(this.declaredClass).warn(\"Attempting to disconnect an analysis from a destroyed LineOfSight tool. Ignoring.\");\n    this._analysisHandles.remove(e);\n    const t = this._getTargetManipulator(e.target);\n    o(t) && (this.manipulators.remove(t), this._manipulatorHandles.remove(t), o(this._targetTrackerManipulator) && this._targetTrackerManipulator === t && (this._targetTrackerManipulator = null));\n  }\n  _clearCursorTracker() {\n    this.analysisViewData.cursorTarget = s(this.analysisViewData.cursorTarget);\n  }\n  _createManipulator(e, t, i) {\n    const a = w(this.view, e);\n    return a.metadata = i, this._manipulatorHandles.add([t(a), a.events.on(\"grab-changed\", e => this._manipulatorGrabChanged(a, e)), a.events.on(\"immediate-click\", e => this._manipulatorClick(a, e))], a), this.manipulators.add(a), a;\n  }\n  _createTargetManipulator(e) {\n    const t = this.configuration,\n      i = {\n        size: t.target.size,\n        customColor1: t.target.visibleColor,\n        customColor2: t.target.occludedColor,\n        customColor3: t.target.undefinedColor,\n        visible: !0\n      },\n      a = {\n        target: e,\n        type: \"target\"\n      },\n      r = this._createManipulator(i, e => this._createTargetManipulatorDragPipeline(e), a);\n    return o(e.position) ? r.elevationAlignedLocation = e.position : r.available = !1, r;\n  }\n  _getTargetManipulator(e) {\n    let t = null;\n    return this.manipulators.forEach(i => {\n      const a = i.manipulator;\n      l(t) && \"target\" === a.metadata.type && a.metadata.target === e && (t = a);\n    }), t;\n  }\n  _createObserverManipulator() {\n    const e = this.configuration,\n      t = {\n        size: e.observer.size,\n        color: e.observer.color,\n        visible: !0\n      };\n    return this._createManipulator(t, e => this._createObserverManipulatorDragPipeline(e), {\n      type: \"observer\",\n      intersection: null\n    });\n  }\n  _updateObserverManipulatorStyle() {\n    const e = this._observerManipulator,\n      t = this.configuration.observer,\n      i = {\n        size: t.size,\n        color: t.color,\n        visible: e.available\n      };\n    e.renderObjects = M(i);\n  }\n  _screenToIntersection() {\n    return e => {\n      const t = this._intersector.getScreenPointIntersection(e.screenEnd);\n      return l(t) ? null : {\n        ...e,\n        intersection: t\n      };\n    };\n  }\n  _createTargetManipulatorDragPipeline(e) {\n    return O(e, (t, i, a) => {\n      i.next(this._screenToIntersection()).next(this._updateTargetDragStep(e)).next(() => this._updateLaserLineRenderer()), a.next(this._cancelTargetDragStep(e.metadata.target)).next(() => this._updateLaserLineRenderer());\n    });\n  }\n  _createObserverManipulatorDragPipeline(e) {\n    return O(e, (e, t, i) => {\n      t.next(this._screenToIntersection()).next(this._updateObserverDragStep()).next(() => this._updateLaserLineRenderer()), i.next(this._cancelObserverDragStep()).next(() => this._updateLaserLineRenderer());\n    });\n  }\n  _updateObserverDragStep() {\n    return e => (o(e.intersection.mapPoint) ? (l(this.analysis.observer) && (this.analysis.observer = new i()), this._updateFromIntersection(this.analysis.observer, e.intersection)) : this.analysis.observer = null, e);\n  }\n  _cancelObserverDragStep() {\n    const e = o(this.analysis.observer) && o(this.analysis.observer.position) ? this.analysis.observer.clone() : null;\n    return t => (this.analysis.observer = e, t);\n  }\n  _updateTargetDragStep(e) {\n    return t => {\n      this._updateFromIntersection(e.metadata.target, t.intersection);\n      const i = t.intersection.mapPoint;\n      return o(i) && (e.elevationAlignedLocation = i), t;\n    };\n  }\n  _cancelTargetDragStep(e) {\n    const t = c(e.position, e => e.clone());\n    return i => (e.position = t, i);\n  }\n  _manipulatorGrabChanged(e, t) {\n    switch (t.action) {\n      case \"start\":\n        this._grabbedManipulator = e;\n        break;\n      case \"end\":\n        this._grabbedManipulator === e && (this._grabbedManipulator = null);\n    }\n  }\n  _updateManipulatorState(e, t) {\n    const {\n      isValid: i,\n      isTargetVisible: a\n    } = t.computationResult;\n    e.state = i ? a ? S.Custom1 : S.Custom2 : S.Custom3;\n  }\n  _getLineOfSightManipulatorStateDependencies(e) {\n    const {\n      isValid: t,\n      isTargetVisible: i\n    } = e.computationResult;\n    return {\n      isValid: t,\n      isTargetVisible: i\n    };\n  }\n  _laserLineRendererDependencies() {\n    return {\n      laserlineVisualElement: this._laserlineVisualElement,\n      grabbedManipulator: this._grabbedManipulator,\n      shouldRenderTracker: this._shouldRenderTracker,\n      observerPosition: o(this.analysis.observer) ? this.analysis.observer.position : null,\n      visible: this.visible\n    };\n  }\n  _updateLaserLineRenderer() {\n    let e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._laserLineRendererDependencies();\n    const {\n      laserlineVisualElement: t,\n      grabbedManipulator: i,\n      shouldRenderTracker: a,\n      observerPosition: r,\n      visible: n\n    } = e;\n    if (l(t)) return;\n    const s = o(i) ? i : a && o(r) ? this._targetTrackerManipulator : null;\n    this.configuration.laserLine.enabled && o(s) && n ? (t.visible = !0, t.heightManifoldTarget = s.renderLocation, s !== this._observerManipulator ? t.lineVerticalPlaneSegment = v(this._observerManipulator.renderLocation, s.renderLocation, H) : t.lineVerticalPlaneSegment = null) : (t.visible = !1, t.heightManifoldTarget = null, t.lineVerticalPlaneSegment = null);\n  }\n  _createVisualElements() {\n    const e = this.configuration.laserLine;\n    this._removeVisualElements(), this._laserlineVisualElement = new L({\n      view: this.view,\n      attached: !0,\n      visible: this.visible,\n      style: {\n        glowColor: t.toUnitRGB(e.glowColor),\n        glowWidth: e.glowWidth,\n        innerColor: t.toUnitRGB(e.innerColor),\n        innerWidth: e.innerWidth,\n        globalAlpha: e.globalAlpha\n      }\n    });\n  }\n  _removeVisualElements() {\n    o(this._laserlineVisualElement) && (this._laserlineVisualElement.destroy(), this._laserlineVisualElement = null);\n  }\n  _onObserverLocationChange(e) {\n    l(e) ? this._observerManipulator.available = !1 : (this._observerManipulator.metadata.intersection = null, this._observerManipulator.available = !0, this._observerManipulator.elevationAlignedLocation = e);\n  }\n  _onTargetLocationChange(e, t) {\n    o(e) ? (t.elevationAlignedLocation = e, t !== this._targetTrackerManipulator && (t.available = !0)) : t.available = !1;\n  }\n  _addPointFromClickEvent(e) {\n    const t = this._intersector.getScreenPointIntersection(e);\n    if (!l(t) && !l(t.mapPoint)) if (o(this.analysis.observer) && o(this.analysis.observer.position)) {\n      this._clearCursorTracker();\n      const e = new a();\n      this._updateFromIntersection(e, t), this.analysis.targets.add(e);\n    } else {\n      const e = new i();\n      this._updateFromIntersection(e, t), this.analysis.observer = e;\n    }\n  }\n  _clickHandler(e) {\n    this.active && e.button !== E.Right && (this._addPointFromClickEvent(D(e)), e.stopPropagation());\n  }\n  _doubleClickHandler(e) {\n    this.active && e.button !== E.Right && (this.stop(), e.stopPropagation());\n  }\n  _keyDownHandler(e) {\n    this.active && \"Escape\" === e.key && (this.stop(), e.stopPropagation());\n  }\n  _pointerMoveHandler(e) {\n    if (this.hasGrabbedManipulators) return;\n    if (this._latestPointerMovePointerType = e.pointerType, this._updateLaserLineRenderer(), !this._showTracker || l(this.analysis.observer) || l(this.analysis.observer.position)) return;\n    const t = D(e),\n      i = this._intersector.getScreenPointIntersection(t);\n    o(i) && o(i.mapPoint) && (l(this.analysisViewData.cursorTarget) && (this.analysisViewData.cursorTarget = new a()), this._updateFromIntersection(this.analysisViewData.cursorTarget, i), this._updateLaserLineRenderer());\n  }\n  _updateFromIntersection(e, t) {\n    if (l(t.mapPoint)) return e.position = null, e.elevationInfo = null, void (e.feature = null);\n    switch (t.type) {\n      case k.OBJECT:\n        if (o(t.graphic)) {\n          const i = t.graphic,\n            a = b(i);\n          \"on-the-ground\" === a.mode && (a.mode = \"relative-to-ground\", a.offset = 0), e.elevationInfo = new f(a), e.feature = i;\n        } else e.elevationInfo = null, e.feature = null;\n        break;\n      case k.TERRAIN:\n      case k.I3S:\n        e.elevationInfo = new f({\n          mode: \"on-the-ground\"\n        }), e.feature = null;\n        break;\n      default:\n        e.elevationInfo = null, e.feature = null;\n    }\n    const i = t.mapPoint.clone();\n    i.z = y(this.view, i, {\n      mode: \"absolute-height\",\n      offset: 0\n    }, e.elevationInfo), e.position = i;\n  }\n  _manipulatorClick(e, t) {\n    if (\"observer\" === e.metadata.type || e.grabbing || e.dragging || t.button !== E.Right || this.analysis.targets.length <= 1) return;\n    const {\n      target: i\n    } = e.metadata;\n    this.analysis.targets.remove(i), t.stopPropagation();\n  }\n  get testInfo() {\n    return {\n      laserLineVisualElement: this._laserlineVisualElement\n    };\n  }\n};\ne([d({\n  constructOnly: !0\n})], P.prototype, \"view\", void 0), e([d({\n  constructOnly: !0\n})], P.prototype, \"analysis\", void 0), e([d({\n  readOnly: !0\n})], P.prototype, \"state\", null), e([d({\n  readOnly: !0\n})], P.prototype, \"cursor\", null), e([d()], P.prototype, \"removeIncompleteOnCancel\", void 0), e([d({\n  readOnly: !0\n})], P.prototype, \"updating\", null), e([d({\n  type: C\n})], P.prototype, \"configuration\", void 0), e([d({\n  constructOnly: !0\n})], P.prototype, \"analysisViewData\", void 0), e([d({\n  readOnly: !0\n})], P.prototype, \"_showTracker\", null), e([d()], P.prototype, \"_latestPointerMovePointerType\", void 0), e([d()], P.prototype, \"_shouldRenderTracker\", null), e([d()], P.prototype, \"_laserlineVisualElement\", void 0), e([d()], P.prototype, \"_grabbedManipulator\", void 0), P = e([g(\"esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightTool\")], P);\nconst H = m();\nexport { P as LineOfSightTool };","map":{"version":3,"names":["_","e","t","i","a","r","n","destroyMaybe","s","isSome","o","isNone","l","applySome","c","watch","u","syncAndInitial","h","initial","p","property","d","subclass","g","WatchUpdatingTracking","create","m","fromPoints","v","getGraphicEffectiveElevationInfo","b","getConvertedElevation","y","f","LineOfSightRayIntersector","T","LineOfSightToolConfiguration","C","createSphereManipulator","w","createSphereManipulatorRenderObjects","M","LaserlineVisualElement","L","IntersectorType","k","AnalysisToolBase","V","createManipulatorDragEventPipeline","O","ManipulatorStateCustomFlags","S","createScreenPointFromEvent","D","MouseButton","E","I","Ready","Creating","Created","P","constructor","removeIncompleteOnCancel","configuration","analysisViewData","_latestPointerMovePointerType","_laserlineVisualElement","_grabbedManipulator","_analysisHandles","_handles","_updatingHandles","_manipulatorHandles","_targetTrackerManipulator","initialize","_intersector","view","add","state","finishToolCreation","_observerManipulator","_createObserverManipulator","observer","_updateObserverManipulatorStyle","elevationAlignedObserver","_onObserverLocationChange","laserLine","_createVisualElements","_laserLineRendererDependencies","_updateLaserLineRenderer","_connectComputations","addWhen","_shouldRenderTracker","_clearCursorTracker","destroy","_removeVisualElements","_set","active","hasGrabbedManipulators","analysis","position","cursor","_showTracker","updating","continue","activeTool","stop","onEditableChange","editable","internallyEditable","onInputEvent","type","_doubleClickHandler","_keyDownHandler","_pointerMoveHandler","onInputEventAfter","_clickHandler","onShow","onHide","onDeactivate","addOnCollectionChange","computations","_onComputationsCollectionChange","final","_ref","added","removed","_disconnectComputation","_connectComputation","destroyed","getLogger","declaredClass","warn","has","_createTargetManipulator","target","metadata","cursorTarget","available","interactive","_getLineOfSightManipulatorStateDependencies","_updateManipulatorState","elevationAlignedTargetLocation","_onTargetLocationChange","remove","_getTargetManipulator","manipulators","_createManipulator","events","on","_manipulatorGrabChanged","_manipulatorClick","size","customColor1","visibleColor","customColor2","occludedColor","customColor3","undefinedColor","visible","_createTargetManipulatorDragPipeline","elevationAlignedLocation","forEach","manipulator","color","_createObserverManipulatorDragPipeline","intersection","renderObjects","_screenToIntersection","getScreenPointIntersection","screenEnd","next","_updateTargetDragStep","_cancelTargetDragStep","_updateObserverDragStep","_cancelObserverDragStep","mapPoint","_updateFromIntersection","clone","action","isValid","isTargetVisible","computationResult","Custom1","Custom2","Custom3","laserlineVisualElement","grabbedManipulator","shouldRenderTracker","observerPosition","arguments","length","undefined","enabled","heightManifoldTarget","renderLocation","lineVerticalPlaneSegment","H","attached","style","glowColor","toUnitRGB","glowWidth","innerColor","innerWidth","globalAlpha","_addPointFromClickEvent","targets","button","Right","stopPropagation","key","pointerType","elevationInfo","feature","OBJECT","graphic","mode","offset","TERRAIN","I3S","z","grabbing","dragging","testInfo","laserLineVisualElement","constructOnly","prototype","readOnly","LineOfSightTool"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/analysis/LineOfSight/LineOfSightTool.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../Color.js\";import i from\"../../../../analysis/LineOfSightAnalysisObserver.js\";import a from\"../../../../analysis/LineOfSightAnalysisTarget.js\";import r from\"../../../../core/Handles.js\";import n from\"../../../../core/Logger.js\";import{destroyMaybe as s,isSome as o,isNone as l,applySome as c}from\"../../../../core/maybe.js\";import{watch as u,syncAndInitial as h,initial as p}from\"../../../../core/reactiveUtils.js\";import{property as d}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as g}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{WatchUpdatingTracking as _}from\"../../../../core/support/WatchUpdatingTracking.js\";import{create as m,fromPoints as v}from\"../../../../geometry/support/lineSegment.js\";import{getGraphicEffectiveElevationInfo as b,getConvertedElevation as y}from\"../../../../support/elevationInfoUtils.js\";import f from\"../../../../symbols/support/ElevationInfo.js\";import{LineOfSightRayIntersector as T}from\"./LineOfSightRayIntersector.js\";import{LineOfSightToolConfiguration as C}from\"./LineOfSightToolConfiguration.js\";import{createSphereManipulator as w,createSphereManipulatorRenderObjects as M}from\"./lineOfSightToolUtils.js\";import{LaserlineVisualElement as L}from\"../../interactive/visualElements/LaserlineVisualElement.js\";import{IntersectorType as k}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";import\"../../../input/ViewEvents.js\";import{AnalysisToolBase as V}from\"../../../interactive/AnalysisToolBase.js\";import{createManipulatorDragEventPipeline as O}from\"../../../interactive/dragEventPipeline.js\";import{ManipulatorStateCustomFlags as S}from\"../../../interactive/interfaces.js\";import{createScreenPointFromEvent as D}from\"../../../support/screenUtils.js\";import{MouseButton as E}from\"../../../input/IViewEvents.js\";var I;!function(e){e.Ready=\"ready\",e.Creating=\"creating\",e.Created=\"created\"}(I||(I={}));let P=class extends V{constructor(e){super(e),this.removeIncompleteOnCancel=!1,this.configuration=new C,this.analysisViewData=null,this._latestPointerMovePointerType=null,this._laserlineVisualElement=null,this._grabbedManipulator=null,this._analysisHandles=new r,this._handles=new r,this._updatingHandles=new _,this._manipulatorHandles=new r,this._targetTrackerManipulator=null}initialize(){this._intersector=new T({view:this.view}),this._handles.add(u((()=>this.state),(e=>{e===I.Created&&this.finishToolCreation()}),h)),this._observerManipulator=this._createObserverManipulator(),this._handles.add([this._updatingHandles.add((()=>({...this.configuration.observer})),(()=>this._updateObserverManipulatorStyle())),this._updatingHandles.add((()=>this.analysisViewData?.elevationAlignedObserver),(e=>this._onObserverLocationChange(e)),p),this._updatingHandles.add((()=>({...this.configuration.laserLine})),(()=>this._createVisualElements()),p),this._updatingHandles.add((()=>this._laserLineRendererDependencies()),(e=>this._updateLaserLineRenderer(e))),this._connectComputations(),this._updatingHandles.addWhen((()=>!this._shouldRenderTracker),(()=>this._clearCursorTracker()),p)])}destroy(){this._updatingHandles=s(this._updatingHandles),this._handles=s(this._handles),this._manipulatorHandles=s(this._manipulatorHandles),this._analysisHandles=s(this._analysisHandles),this._observerManipulator=null,this._clearCursorTracker(),this._removeVisualElements(),this._intersector=null,this._set(\"analysis\",null)}get state(){return this.active?this.hasGrabbedManipulators?I.Created:I.Creating:o(this.analysis.observer)&&o(this.analysis.observer.position)?I.Created:I.Ready}get cursor(){return this.active&&this._showTracker?\"crosshair\":null}get updating(){return o(this.analysisViewData)&&this.analysisViewData.updating||this._updatingHandles.updating}get _showTracker(){return this.active&&\"mouse\"===this._latestPointerMovePointerType}get _shouldRenderTracker(){return this._showTracker&&o(this.analysis.observer)&&o(this.analysis.observer.position)&&!this.hasGrabbedManipulators}continue(){this.view.activeTool=this}stop(){this.view.activeTool=null}onEditableChange(){this.analysisViewData.editable=this.internallyEditable}onInputEvent(e){switch(e.type){case\"immediate-double-click\":this._doubleClickHandler(e);break;case\"key-down\":this._keyDownHandler(e);break;case\"pointer-move\":this._pointerMoveHandler(e)}}onInputEventAfter(e){if(\"immediate-click\"===e.type)this._clickHandler(e)}onShow(){}onHide(){}onDeactivate(){this._clearCursorTracker()}_connectComputations(){return this._updatingHandles.addOnCollectionChange((()=>this.analysisViewData.computations),(e=>this._onComputationsCollectionChange(e)),{initial:!0,final:!0})}_onComputationsCollectionChange({added:e,removed:t}){for(const i of t)this._disconnectComputation(i);for(const i of e)this._connectComputation(i)}_connectComputation(e){if(this.destroyed)return void n.getLogger(this.declaredClass).warn(\"Attempting to connect an analysis to a destroyed LineOfSight tool. Ignoring.\");const t=this._analysisHandles;if(t.has(e))return;const i=this._createTargetManipulator(e.target);l(this._targetTrackerManipulator)&&i.metadata.target===this.analysisViewData.cursorTarget&&(this._targetTrackerManipulator=i,this._targetTrackerManipulator.available=!1,this._targetTrackerManipulator.interactive=!1,this._updateLaserLineRenderer()),t.add([this._updatingHandles.add((()=>this._getLineOfSightManipulatorStateDependencies(e)),(()=>this._updateManipulatorState(i,e)),p),this._updatingHandles.add((()=>e.elevationAlignedTargetLocation),(e=>this._onTargetLocationChange(e,i)),p)],e)}_disconnectComputation(e){if(this.destroyed)return void n.getLogger(this.declaredClass).warn(\"Attempting to disconnect an analysis from a destroyed LineOfSight tool. Ignoring.\");this._analysisHandles.remove(e);const t=this._getTargetManipulator(e.target);o(t)&&(this.manipulators.remove(t),this._manipulatorHandles.remove(t),o(this._targetTrackerManipulator)&&this._targetTrackerManipulator===t&&(this._targetTrackerManipulator=null))}_clearCursorTracker(){this.analysisViewData.cursorTarget=s(this.analysisViewData.cursorTarget)}_createManipulator(e,t,i){const a=w(this.view,e);return a.metadata=i,this._manipulatorHandles.add([t(a),a.events.on(\"grab-changed\",(e=>this._manipulatorGrabChanged(a,e))),a.events.on(\"immediate-click\",(e=>this._manipulatorClick(a,e)))],a),this.manipulators.add(a),a}_createTargetManipulator(e){const t=this.configuration,i={size:t.target.size,customColor1:t.target.visibleColor,customColor2:t.target.occludedColor,customColor3:t.target.undefinedColor,visible:!0},a={target:e,type:\"target\"},r=this._createManipulator(i,(e=>this._createTargetManipulatorDragPipeline(e)),a);return o(e.position)?r.elevationAlignedLocation=e.position:r.available=!1,r}_getTargetManipulator(e){let t=null;return this.manipulators.forEach((i=>{const a=i.manipulator;l(t)&&\"target\"===a.metadata.type&&a.metadata.target===e&&(t=a)})),t}_createObserverManipulator(){const e=this.configuration,t={size:e.observer.size,color:e.observer.color,visible:!0};return this._createManipulator(t,(e=>this._createObserverManipulatorDragPipeline(e)),{type:\"observer\",intersection:null})}_updateObserverManipulatorStyle(){const e=this._observerManipulator,t=this.configuration.observer,i={size:t.size,color:t.color,visible:e.available};e.renderObjects=M(i)}_screenToIntersection(){return e=>{const t=this._intersector.getScreenPointIntersection(e.screenEnd);return l(t)?null:{...e,intersection:t}}}_createTargetManipulatorDragPipeline(e){return O(e,((t,i,a)=>{i.next(this._screenToIntersection()).next(this._updateTargetDragStep(e)).next((()=>this._updateLaserLineRenderer())),a.next(this._cancelTargetDragStep(e.metadata.target)).next((()=>this._updateLaserLineRenderer()))}))}_createObserverManipulatorDragPipeline(e){return O(e,((e,t,i)=>{t.next(this._screenToIntersection()).next(this._updateObserverDragStep()).next((()=>this._updateLaserLineRenderer())),i.next(this._cancelObserverDragStep()).next((()=>this._updateLaserLineRenderer()))}))}_updateObserverDragStep(){return e=>(o(e.intersection.mapPoint)?(l(this.analysis.observer)&&(this.analysis.observer=new i),this._updateFromIntersection(this.analysis.observer,e.intersection)):this.analysis.observer=null,e)}_cancelObserverDragStep(){const e=o(this.analysis.observer)&&o(this.analysis.observer.position)?this.analysis.observer.clone():null;return t=>(this.analysis.observer=e,t)}_updateTargetDragStep(e){return t=>{this._updateFromIntersection(e.metadata.target,t.intersection);const i=t.intersection.mapPoint;return o(i)&&(e.elevationAlignedLocation=i),t}}_cancelTargetDragStep(e){const t=c(e.position,(e=>e.clone()));return i=>(e.position=t,i)}_manipulatorGrabChanged(e,t){switch(t.action){case\"start\":this._grabbedManipulator=e;break;case\"end\":this._grabbedManipulator===e&&(this._grabbedManipulator=null)}}_updateManipulatorState(e,t){const{isValid:i,isTargetVisible:a}=t.computationResult;e.state=i?a?S.Custom1:S.Custom2:S.Custom3}_getLineOfSightManipulatorStateDependencies(e){const{isValid:t,isTargetVisible:i}=e.computationResult;return{isValid:t,isTargetVisible:i}}_laserLineRendererDependencies(){return{laserlineVisualElement:this._laserlineVisualElement,grabbedManipulator:this._grabbedManipulator,shouldRenderTracker:this._shouldRenderTracker,observerPosition:o(this.analysis.observer)?this.analysis.observer.position:null,visible:this.visible}}_updateLaserLineRenderer(e=this._laserLineRendererDependencies()){const{laserlineVisualElement:t,grabbedManipulator:i,shouldRenderTracker:a,observerPosition:r,visible:n}=e;if(l(t))return;const s=o(i)?i:a&&o(r)?this._targetTrackerManipulator:null;this.configuration.laserLine.enabled&&o(s)&&n?(t.visible=!0,t.heightManifoldTarget=s.renderLocation,s!==this._observerManipulator?t.lineVerticalPlaneSegment=v(this._observerManipulator.renderLocation,s.renderLocation,H):t.lineVerticalPlaneSegment=null):(t.visible=!1,t.heightManifoldTarget=null,t.lineVerticalPlaneSegment=null)}_createVisualElements(){const e=this.configuration.laserLine;this._removeVisualElements(),this._laserlineVisualElement=new L({view:this.view,attached:!0,visible:this.visible,style:{glowColor:t.toUnitRGB(e.glowColor),glowWidth:e.glowWidth,innerColor:t.toUnitRGB(e.innerColor),innerWidth:e.innerWidth,globalAlpha:e.globalAlpha}})}_removeVisualElements(){o(this._laserlineVisualElement)&&(this._laserlineVisualElement.destroy(),this._laserlineVisualElement=null)}_onObserverLocationChange(e){l(e)?this._observerManipulator.available=!1:(this._observerManipulator.metadata.intersection=null,this._observerManipulator.available=!0,this._observerManipulator.elevationAlignedLocation=e)}_onTargetLocationChange(e,t){o(e)?(t.elevationAlignedLocation=e,t!==this._targetTrackerManipulator&&(t.available=!0)):t.available=!1}_addPointFromClickEvent(e){const t=this._intersector.getScreenPointIntersection(e);if(!l(t)&&!l(t.mapPoint))if(o(this.analysis.observer)&&o(this.analysis.observer.position)){this._clearCursorTracker();const e=new a;this._updateFromIntersection(e,t),this.analysis.targets.add(e)}else{const e=new i;this._updateFromIntersection(e,t),this.analysis.observer=e}}_clickHandler(e){this.active&&e.button!==E.Right&&(this._addPointFromClickEvent(D(e)),e.stopPropagation())}_doubleClickHandler(e){this.active&&e.button!==E.Right&&(this.stop(),e.stopPropagation())}_keyDownHandler(e){this.active&&\"Escape\"===e.key&&(this.stop(),e.stopPropagation())}_pointerMoveHandler(e){if(this.hasGrabbedManipulators)return;if(this._latestPointerMovePointerType=e.pointerType,this._updateLaserLineRenderer(),!this._showTracker||l(this.analysis.observer)||l(this.analysis.observer.position))return;const t=D(e),i=this._intersector.getScreenPointIntersection(t);o(i)&&o(i.mapPoint)&&(l(this.analysisViewData.cursorTarget)&&(this.analysisViewData.cursorTarget=new a),this._updateFromIntersection(this.analysisViewData.cursorTarget,i),this._updateLaserLineRenderer())}_updateFromIntersection(e,t){if(l(t.mapPoint))return e.position=null,e.elevationInfo=null,void(e.feature=null);switch(t.type){case k.OBJECT:if(o(t.graphic)){const i=t.graphic,a=b(i);\"on-the-ground\"===a.mode&&(a.mode=\"relative-to-ground\",a.offset=0),e.elevationInfo=new f(a),e.feature=i}else e.elevationInfo=null,e.feature=null;break;case k.TERRAIN:case k.I3S:e.elevationInfo=new f({mode:\"on-the-ground\"}),e.feature=null;break;default:e.elevationInfo=null,e.feature=null}const i=t.mapPoint.clone();i.z=y(this.view,i,{mode:\"absolute-height\",offset:0},e.elevationInfo),e.position=i}_manipulatorClick(e,t){if(\"observer\"===e.metadata.type||e.grabbing||e.dragging||t.button!==E.Right||this.analysis.targets.length<=1)return;const{target:i}=e.metadata;this.analysis.targets.remove(i),t.stopPropagation()}get testInfo(){return{laserLineVisualElement:this._laserlineVisualElement}}};e([d({constructOnly:!0})],P.prototype,\"view\",void 0),e([d({constructOnly:!0})],P.prototype,\"analysis\",void 0),e([d({readOnly:!0})],P.prototype,\"state\",null),e([d({readOnly:!0})],P.prototype,\"cursor\",null),e([d()],P.prototype,\"removeIncompleteOnCancel\",void 0),e([d({readOnly:!0})],P.prototype,\"updating\",null),e([d({type:C})],P.prototype,\"configuration\",void 0),e([d({constructOnly:!0})],P.prototype,\"analysisViewData\",void 0),e([d({readOnly:!0})],P.prototype,\"_showTracker\",null),e([d()],P.prototype,\"_latestPointerMovePointerType\",void 0),e([d()],P.prototype,\"_shouldRenderTracker\",null),e([d()],P.prototype,\"_laserlineVisualElement\",void 0),e([d()],P.prototype,\"_grabbedManipulator\",void 0),P=e([g(\"esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightTool\")],P);const H=m();export{P as LineOfSightTool};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}