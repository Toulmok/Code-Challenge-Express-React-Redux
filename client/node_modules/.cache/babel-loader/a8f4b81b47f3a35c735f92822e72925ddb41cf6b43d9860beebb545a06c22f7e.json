{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Accessor.js\";\nimport s from \"../../../../core/Handles.js\";\nimport i from \"../../../../core/Logger.js\";\nimport { someMap as r } from \"../../../../core/MapUtils.js\";\nimport { isSome as a, destroyMaybe as n, isNone as o, unwrap as u } from \"../../../../core/maybe.js\";\nimport { isAbortError as l, eachAlways as h, throwIfAborted as c } from \"../../../../core/promiseUtils.js\";\nimport { on as d } from \"../../../../core/reactiveUtils.js\";\nimport { schedule as p } from \"../../../../core/scheduling.js\";\nimport { property as f } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as m } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { create as _, equals as g, clone as F, expand as y, toExtent as T } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { getObjectId as x, hasVertices as E } from \"../../../../layers/graphics/dehydratedFeatures.js\";\nimport C from \"../../../../rest/support/QuantizationParameters.js\";\nimport R from \"../../../../rest/support/Query.js\";\nimport { ViewingMode as b } from \"../../../ViewingMode.js\";\nimport { MultiFeatureReference as v, SingleFeatureReference as M } from \"./featureReference.js\";\nimport { FAILED_FEATURE_COUNT as w, FetchStatus as D, FeatureTile as O } from \"./FeatureTile.js\";\nimport { tilesAreRelated as j } from \"../../terrain/tileUtils.js\";\nimport { ImmediateTask as P, TaskPriority as N } from \"../../../support/Scheduler.js\";\nconst U = \"esri.views.3d.layers.support.FeatureTileFetcher3D\",\n  I = i.getLogger(U);\nlet A = class extends t {\n  set maximumNumberOfFeatures(e) {\n    e = e || 1 / 0;\n    const t = this._get(\"maximumNumberOfFeatures\");\n    e === t || e < 1 || (this._set(\"maximumNumberOfFeatures\", e), this._maximumFeaturesUpdated(t, e));\n  }\n  set memoryFactor(e) {\n    this.memoryFactor !== e && (this._set(\"memoryFactor\", e), this._setDirty());\n  }\n  set lodFactor(e) {\n    this.lodFactor !== e && (this._set(\"lodFactor\", e), this._supportsResolution && this.refetch());\n  }\n  get useTileCount() {\n    return this._useTileCount && a(this.context.query.queryFeatureCount);\n  }\n  set useTileCount(e) {\n    this._useTileCount = e, this.notifyChange(\"useTileCount\");\n  }\n  get memoryForUnusedFeatures() {\n    let e = 0;\n    return this._featureTiles.forEach(t => e += t.estimatedUnusedSize), e;\n  }\n  get totalVertices() {\n    let e = 0;\n    return this._featureTiles.forEach(t => e += t.numVertices), e;\n  }\n  get totalFeatures() {\n    let e = 0;\n    return this._featureTiles.forEach(t => e += t.numFeatures), e;\n  }\n  set filterExtent(e) {\n    if (a(e) && this.context.tilingScheme && !e.spatialReference.equals(this.context.tilingScheme.spatialReference)) return void I.error(\"#filterExtent=\", \"extent needs to be in the same spatial reference as the tiling scheme\");\n    const t = this._get(\"filterExtent\");\n    if (t === e || a(t) && e && t.equals(e)) return;\n    const s = a(e) ? e.clone() : null;\n    this._set(\"filterExtent\", s), this._reclip(s, t);\n  }\n  constructor(e) {\n    super(e), this._useTileCount = !1, this.updating = !1, this.running = !1, this.updatingTotal = 0, this.updatingRemaining = 0, this.expectedFeatureDiff = 0, this.maximumNumberOfFeaturesExceeded = !1, this.maximumNumberOfFeaturesExceededThrottle = 1e3, this._fullRatio = 1, this._farRatio = 1, this._changes = {\n      updates: {\n        adds: new Array(),\n        removes: new Array()\n      },\n      adds: new Array(),\n      removes: new Array()\n    }, this._handles = new s(), this._frameTask = P, this._dirty = !1, this._featureTiles = new Map(), this._displayingFeatureReferences = new Map(), this._numDisplayingFeatureReferences = 0, this._suspended = !0, this._pendingEdits = null;\n  }\n  initialize() {\n    this._handles.add(d(() => this.tileDescriptors, \"change\", () => this._setDirty(), {\n      onListenerAdd: () => this._setDirty()\n    })), this._objectIdField = this.context.objectIdField, this.FeatureReferenceClass = this.context.capabilities.supportsMultipleResolutions ? v : M;\n    const e = this.context.scheduler;\n    a(e) && (this._frameTask = e.registerTask(N.FEATURE_TILE_FETCHER, this)), this._setDirty();\n  }\n  destroy() {\n    this._frameTask.remove(), this._handles = n(this._handles), this._featureTiles.forEach(e => {\n      this._cancelFetchTile(e), this._removeTile(e);\n    }), this._featureTiles.clear(), this._displayingFeatureReferences.clear(), this._pendingEdits?.controller.abort(), this._pendingEdits = null;\n  }\n  get _paused() {\n    return this._suspended || !!this._pendingEdits;\n  }\n  restart() {\n    this._featureTiles.forEach(e => {\n      this._cancelFetchTile(e), this._clearTile(e), this._resetFetchTile(e);\n    }), a(this.context.memoryCache) && this.context.memoryCache.clear(), this._setDirty();\n  }\n  refetch() {\n    this._featureTiles.forEach(e => {\n      this._cancelFetchTile(e), this._resetFetchTile(e);\n    }), a(this.context.memoryCache) && this.context.memoryCache.clear(), this._setDirty();\n  }\n  suspend() {\n    this._suspended || (this._suspended = !0, this._pause(), this._setDirty());\n  }\n  resume() {\n    this._suspended && (this._suspended = !1, this._unpause());\n  }\n  _pause() {\n    this._paused && (this._featureTiles.forEach(e => this._cancelFetchTile(e)), this._updated());\n  }\n  _unpause() {\n    this._paused || (this._setDirty(), this._updated());\n  }\n  get availableFields() {\n    let e = null;\n    return this._featureTiles.forEach(t => {\n      o(t.displayingFeatures) || 0 === t.displayingFeatures.length || (o(e) ? e = new Set(t.availableFields) : e.forEach(s => {\n        t.availableFields.has(s) || u(e).delete(s);\n      }));\n    }), a(e) ? e : new Set();\n  }\n  applyEdits(e) {\n    this._pendingEdits || (this._pendingEdits = {\n      edits: Promise.resolve(),\n      count: 0,\n      controller: new AbortController()\n    }, this._pause());\n    const t = this._pendingEdits;\n    t.count++;\n    const s = t.edits.then(() => e.result.catch(e => {\n      if (l(e)) throw e;\n      return null;\n    }).then(e => e ? (this._applyEditsDeleteFeatures(e.deletedFeatures), this._applyEditsAddUpdateFeatures(e.addedFeatures, e.updatedFeatures, t.controller.signal).then(() => e)) : e).then(e => (0 == --t.count && (this._pendingEdits === t && (this._pendingEdits = null), a(this.context.memoryCache) && this.context.memoryCache.clear(), this._unpause(), this._updated()), e)));\n    return t.edits = s, this._updated(), s;\n  }\n  _applyEditsDeleteFeatures(e) {\n    if (0 === e.length) return;\n    const t = this.context.globalIdField,\n      s = t && this.availableFields.has(t),\n      i = new Set(),\n      r = this._objectIdField;\n    e.forEach(_ref => {\n      let {\n        objectId: e,\n        globalId: a\n      } = _ref;\n      if ((!e || e < 0) && t) {\n        s || I.errorOncePerTick(`Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected in the view`);\n        const e = this.features.find(e => e.attributes && e.attributes[t] === a);\n        e && i.add(x(e, r));\n      } else i.add(e);\n    }), this._featureTiles.forEach(e => {\n      if (!e.features) return;\n      const t = e.features.filter(e => !i.has(x(e, this._objectIdField)));\n      t.length !== e.features.length && (e.setFeatures(t, 0, e.availableFields), this._invalidateCounts());\n    });\n  }\n  async _applyEditsAddUpdateFeatures(e, t, s) {\n    const i = [],\n      r = new Set();\n    if (e.forEach(e => i.push(e.objectId)), t.forEach(e => {\n      i.push(e.objectId), r.add(e.objectId);\n    }), 0 === i.length) return;\n    const a = [];\n    this._featureTiles.forEach(e => {\n      const t = this._applyEditsAddUpdateTile(e, i, r, s);\n      t && a.push(t);\n    }), await h(a);\n  }\n  async _applyEditsAddUpdateTile(e, t, s, i) {\n    if (!e.features) return;\n    const r = this._createQuery(e);\n    r.resultType = void 0, r.cacheHint = !1, r.objectIds = t;\n    const a = await this._queryFeatures(r, i);\n    let n = null;\n    if (s.size > 0) {\n      const t = e.features.filter(e => !s.has(x(e, this._objectIdField)));\n      t.length !== e.features.length && (n = t);\n    }\n    if (a.features.length > 0) {\n      n || (n = e.features.slice());\n      for (const e of a.features) n.push(e);\n    }\n    n && (e.hasPreciseFeatureCount && (e.numFeatures = Math.max(e.numFeatures, n.length)), e.setFeatures(n, 0, k(e.availableFields, a.fields)), this._invalidateCounts());\n  }\n  _queryFeatures(e, t) {\n    return this.context.query.queryFeaturesDehydrated(e, {\n      signal: t,\n      timeout: X\n    });\n  }\n  _setDirty() {\n    this._dirty = !0, this._updated();\n  }\n  runTask(e) {\n    if (this._frameTask.processQueue(e), !this._dirty || !this.initialized) return;\n    this._dirty = !1;\n    const t = this._getListOfTiles();\n    if (this._markTilesNotAlive(t), !e.run(() => this._addTiles(t, e)) || !e.run(() => this._filterExtentTiles(t, e)) || !e.run(() => this._removeTiles(t, e)) || e.done) return void this._setDirty();\n    const s = this._sortTiles(t);\n    e.run(() => this._showTiles(s, e)) && e.run(() => this._fetchTiles(s, e)) && e.run(() => this._updateMemoryEstimates(s, e)) || this._setDirty(), this._updated(), this.updating || this._updateMaximumNumberOfFeaturesExceeded();\n  }\n  _markTilesNotAlive(e) {\n    for (const t of e) t.alive = !1;\n  }\n  _addTiles(e, t) {\n    return !this._suspended && (this.tileDescriptors.forEach(s => {\n      const i = this._featureTiles.get(s.id);\n      i ? i.alive = !0 : t.done || (e.push(this._addTile(s)), t.madeProgress());\n    }), t.hasProgressed);\n  }\n  _filterExtentTiles(e, t) {\n    for (const s of e) {\n      if (t.done) break;\n      s.alive && (s.filtered = !s.intersects(this.filterExtent), s.filtered && (this._clearTile(s), t.madeProgress()));\n    }\n    return t.hasProgressed;\n  }\n  _removeTiles(e, t) {\n    for (let s = e.length - 1; s >= 0 && !t.done; s--) {\n      const i = e[s];\n      i.alive || (this._removeTile(i), s !== e.length - 1 && (e[s] = e[e.length - 1]), e.pop(), t.madeProgress());\n    }\n    return t.hasProgressed;\n  }\n  _sortTiles(e) {\n    return e.sort((e, t) => (e.descriptor.loadPriority ?? 0) - (t.descriptor.loadPriority ?? 0)), e;\n  }\n  _showTiles(e, t) {\n    const s = this._updateRatio(e),\n      i = e => {\n        const t = this._fullRatio < 1 ? s(e) * this._farRatio : 1;\n        return e.reduceFeatures(t, this.memoryFactor, this._objectIdField) && this._setDirty(), this._showTile(e);\n      };\n    for (const r of e) if (!t.run(() => i(r))) {\n      this._setDirty();\n      break;\n    }\n    return t.hasProgressed;\n  }\n  _fetchTiles(e, t) {\n    if (this._paused) return !1;\n    let s = !1;\n    for (const i of e) {\n      if (!i.needsFetching) continue;\n      const e = a(this.context.memoryCache) ? this.context.memoryCache.pop(i.id) : null;\n      if (a(e)) i.cache = e, this._setDirty(), this._scheduleUpdated(), t.madeProgress();else {\n        if (this._needsNumFeatures(i)) {\n          const e = new AbortController(),\n            r = this._fetchTileCount(i, e.signal);\n          this._handleRequest(i, r, e, () => i.numFeatures = w), s = !0, t.madeProgress();\n        }\n        if (t.done) return !0;\n      }\n    }\n    if (s) return t.hasProgressed;\n    for (const i of e) if (i.needsFetching) {\n      const e = new AbortController(),\n        s = this._fetchTile(i, e.signal);\n      if (this._handleRequest(i, s, e, e => {\n        i.setFeatures([], 0, null), this._invalidateCounts(), i.featuresMissing = !1, this.context.logFetchError(I, e);\n      }), t.madeProgress()) return !0;\n    }\n    return t.hasProgressed;\n  }\n  _updateMemoryEstimates(e, t) {\n    return e.some(e => !t.run(() => e.updateMemoryEstimates()) && (this._setDirty(), !0)), t.hasProgressed;\n  }\n  _reclip(e, t) {\n    if (!this.initialized) return;\n    const s = new Array();\n    this._featureTiles.forEach(i => {\n      o(i.displayingFeatures) || 0 === i.displayingFeatures.length || (i.intersectionIncludingBorrowed(t, B), i.intersectionIncludingBorrowed(e, G), g(B, G) || s.push(i));\n    }), this._refreshDisplayingFeatures(s), this._updated();\n  }\n  _refreshDisplayingFeatures(e) {\n    const t = new Set(),\n      s = this._changes.updates;\n    for (const i of e) if (!o(i.displayingFeatures)) for (const e of i.displayingFeatures) {\n      const i = x(e, this._objectIdField);\n      if (t.has(i)) continue;\n      t.add(i);\n      const r = this._displayingFeatureReferences.get(i).feature;\n      s.removes.push(r), s.adds.push(r);\n    }\n    this._applyChanges();\n  }\n  _updated() {\n    let e = 0;\n    this._paused || this._featureTiles.forEach(t => t.isFetching ? ++e : 0);\n    const t = this._dirty || !!this._pendingEdits || e > 0;\n    if (this._set(\"running\", this._dirty), this._set(\"updating\", t), t) {\n      let t = 0,\n        s = 0,\n        i = 0,\n        r = 0,\n        n = 0;\n      const o = this._displayingFeatureReferences.size / this._numDisplayingFeatureReferences;\n      this._featureTiles.forEach(e => {\n        if (++s, e.isFetching && e.hasPreciseFeatureCount) {\n          const t = this._maximumFeaturesForTile(e) * (1 - e.emptyFeatureRatio),\n            s = a(e.displayingFeatures) ? e.displayingFeatures.length * o : 0;\n          n += t - s;\n        }\n        e.needsFetching ? ++r : e.numFeatures > 0 && (++i, t += e.numFeatures);\n      }), r += e;\n      let u = 0,\n        l = 0;\n      t ? (l = t, u = Math.min(r * t / i, t)) : (l = s, u = r), n = Math.min(this.maximumNumberOfFeatures - this.features.length, n), this._set(\"updatingTotal\", l), this._set(\"updatingRemaining\", u), this._set(\"expectedFeatureDiff\", n);\n    } else this._set(\"updatingTotal\", 0), this._set(\"updatingRemaining\", 0), this._set(\"expectedFeatureDiff\", 0);\n    this.debugger && this.debugger.update();\n  }\n  _updateMaximumNumberOfFeaturesExceeded() {\n    const e = r(this._featureTiles, e => e.perTileMaximumNumberOfFeaturesExceeded);\n    this._set(\"maximumNumberOfFeaturesExceeded\", e);\n  }\n  _updateRatio(e) {\n    const t = S(e),\n      s = e => 1 / (1 << Math.max(0, t - e.descriptor.lij[0]));\n    let i = 0,\n      r = 0;\n    for (const a of e) {\n      const e = a.numFeatures;\n      i += e, r += e * s(a);\n    }\n    return this._fullRatio = Math.min(1, this.maximumNumberOfFeatures / i), this._farRatio = this.maximumNumberOfFeatures / r, this._scheduleUpdated(), s;\n  }\n  _maximumFeaturesUpdated(e, t) {\n    e !== t && (t > e && this._featureTiles.forEach(e => {\n      if (!e.featuresMissing) return;\n      const t = this._maximumFeaturesForTile(e);\n      e.features && (e.features.length >= t || e.fetchStatus === D.FULL) || (this._cancelFetchTile(e), this._resetFetchTile(e));\n    }), this._setDirty());\n  }\n  _addTile(e) {\n    const t = new O(e);\n    return this._featureTiles.set(t.id, t), this._resetFetchTile(t), this._referenceDisplayingFeaturesFromRelatedTiles(t), t;\n  }\n  _referenceDisplayingFeaturesFromRelatedTiles(e) {\n    const t = e.descriptor.resolution;\n    this._featureTiles.forEach(s => {\n      if (!(o(s.displayingFeatures) || e === s || e.descriptor.lij && s.descriptor.lij && !j(e.descriptor.lij, s.descriptor.lij))) {\n        o(e.displayingFeatures) && (e.displayingFeatures = []), e.descriptor.extent && s.descriptor.extent && (o(e.extentIncludingBorrowedFeatures) && (e.extentIncludingBorrowedFeatures = F(e.descriptor.extent)), y(e.extentIncludingBorrowedFeatures, s.descriptor.extent, e.extentIncludingBorrowedFeatures));\n        for (const i of s.displayingFeatures) {\n          e.displayingFeatures.push(i);\n          const s = this._displayingFeatureReferences.get(x(i, this._objectIdField));\n          s.ref(s.feature, t), this._numDisplayingFeatureReferences++;\n        }\n      }\n    }), e.featureLimit = a(e.displayingFeatures) ? e.displayingFeatures.length : 0;\n  }\n  _removeTile(e) {\n    this._clearTile(e), this._featureTiles.delete(e.id);\n  }\n  _resetFetchTile(e) {\n    e.filtered = !e.intersects(this.filterExtent), e.filtered ? e.needsFetching && (e.fetchStatus = D.DONE) : e.fetchStatus = D.FETCH_NEEDED;\n  }\n  _cancelFetchTile(e) {\n    const t = e.requestController;\n    a(t) && (e.requestController = null, e.resetFetching(), t.abort());\n  }\n  async _fetchTileCount(e, t) {\n    return e.numFeatures = await this._fetchCount(e, t), this._updateRatio(this._getListOfTiles()), e.fetchStatus === D.REFETCHING ? D.REFETCH_NEEDED : D.FETCH_NEEDED;\n  }\n  async _fetchTile(e, t) {\n    const s = this._maximumFeaturesForTile(e);\n    if (s <= 0) return V(e);\n    const i = this._getMaxRecordCount(e),\n      r = Math.ceil(s / i);\n    if (q(e) || !this.context.capabilities.supportsMaxRecordCountFactor || e.numFeatures <= s && r > R.MAX_MAX_RECORD_COUNT_FACTOR) return this._fetchPagedTile(e, t);\n    const a = this._createQuery(e);\n    if (a.maxRecordCountFactor = Math.ceil(s / i), e.isRefetching && e.features && e.features.length > 0) {\n      const t = Math.ceil(e.features.length / (1 - e.emptyFeatureRatio) / i);\n      a.maxRecordCountFactor = Math.max(t + 1, a.maxRecordCountFactor);\n    }\n    const {\n        features: n,\n        exceededTransferLimit: o,\n        fields: u\n      } = await this._queryFeatures(a, t),\n      l = o ? a.maxRecordCountFactor >= R.MAX_MAX_RECORD_COUNT_FACTOR ? D.FULL : D.DONE : D.FULL;\n    return await this._frameTask.schedule(() => {\n      e.featuresMissing = n.length < e.numFeatures || !!o;\n      const t = this._removeEmptyFeatures(n);\n      e.setFeatures(n, t, H(u));\n    }, t), c(t), this._invalidateCounts(), l;\n  }\n  async _fetchCount(e, t) {\n    return this.context.query.queryFeatureCount(this._createFeatureCountQuery(e), {\n      signal: t\n    });\n  }\n  async _fetchPagedTile(e, t) {\n    let s,\n      i = 0,\n      r = 0,\n      a = 0,\n      n = this._maximumFeaturesForTile(e) - a;\n    const o = this._getMaxRecordCount(e);\n    let l = null;\n    for (;;) {\n      const h = this._createQuery(e),\n        d = this._setPagingParameters(h, i, n, o),\n        {\n          features: p,\n          exceededTransferLimit: f,\n          fields: m\n        } = await this._queryFeatures(h, t);\n      if (await this._frameTask.schedule(() => {\n        d && (i += u(h.num)), a += p.length, r += this._removeEmptyFeatures(p), e.featuresMissing = i < e.numFeatures || !!f, s = s ? s.concat(p) : p, l = k(l, m), e.setFeatures(s, r, l);\n      }, t), c(t), this._invalidateCounts(), this._setDirty(), n = this._maximumFeaturesForTile(e) - a, !d || !f || n <= 0) return f ? D.DONE : D.FULL;\n    }\n  }\n  _createFeatureCountQuery(e) {\n    const t = this._createQuery(e);\n    return this.context.capabilities.supportsCacheHint && (t.resultType = void 0, t.cacheHint = !0), t;\n  }\n  _createQuery(e) {\n    const t = this.context.createQuery(),\n      s = e.descriptor.extent;\n    if (s) {\n      const e = this.context.tilingScheme.spatialReference;\n      t.geometry = T(s, e);\n    }\n    return this._setResolutionParams(t, e), this._useTileQuery(e) ? t.resultType = \"tile\" : this.context.capabilities.supportsCacheHint && (t.cacheHint = !0), t;\n  }\n  _setPagingParameters(e, t, s, i) {\n    return !!this.context.capabilities.supportsPagination && (e.start = t, s > 0 && this.context.capabilities.supportsMaxRecordCountFactor ? (e.maxRecordCountFactor = Math.ceil(s / i), e.num = Math.min(e.maxRecordCountFactor * i, s)) : e.num = Math.min(i), !0);\n  }\n  _getEffectiveTileResolution(e) {\n    if (null == e.descriptor.resolution) return null;\n    const t = this.context.viewingMode === b.Global ? this.context.tilingScheme.resolutionAtLevel(3) : 1 / 0;\n    return Math.min(e.descriptor.resolution, t) / this.lodFactor;\n  }\n  get _supportsResolution() {\n    return this.context.capabilities.supportsMultipleResolutions && \"point\" !== this.context.geometryType;\n  }\n  _setResolutionParams(e, t) {\n    if (!this._supportsResolution) return;\n    const s = this._getEffectiveTileResolution(t);\n    null != s && (this.context.capabilities.supportsQuantization ? e.quantizationParameters = new C({\n      mode: \"view\",\n      originPosition: \"upper-left\",\n      tolerance: s,\n      extent: this.context.fullExtent\n    }) : \"polyline\" === this.context.geometryType && (e.maxAllowableOffset = s));\n  }\n  _removeEmptyFeatures(e) {\n    const t = e.length;\n    for (let s = 0; s < e.length;) {\n      const t = e[s];\n      E(t.geometry) ? ++s : (e[s] = e[e.length - 1], --e.length);\n    }\n    return t - e.length;\n  }\n  _needsNumFeatures(e) {\n    return this.useTileCount && e.needsFeatureCount && !q(e);\n  }\n  _getMaxRecordCount(e) {\n    const {\n      tileMaxRecordCount: t,\n      maxRecordCount: s\n    } = this.context;\n    return this._useTileQuery(e) && a(t) && t > 0 && this.context.capabilities.supportsResultType ? t : a(s) && s > 0 ? s : z;\n  }\n  _useTileQuery(e) {\n    return (!q(e) || !this.context.capabilities.supportsCacheHint) && this.context.capabilities.supportsResultType;\n  }\n  _handleRequest(e, t, s, i) {\n    e.fetchStatus = e.needsRefetching ? D.REFETCHING : D.FETCHING, e.requestController = s;\n    let r = !1;\n    t.then(t => {\n      e.requestController = null, e.fetchStatus = t;\n    }).catch(t => {\n      e.requestController === s && (e.requestController = null, e.fetchStatus = D.DONE), l(t) ? r = !0 : i(t);\n    }).then(() => {\n      r || this._setDirty(), this._scheduleUpdated();\n    });\n  }\n  _scheduleUpdated() {\n    this._handles && !this._handles.has(\"scheduleUpdated\") && this._handles.add(p(() => {\n      this._handles.remove(\"scheduleUpdated\"), this._updated();\n    }), \"scheduleUpdated\");\n  }\n  _showTile(e) {\n    if (a(e.displayingFeatures) && !e.needsDisplayUpdate) return !1;\n    const t = e.features;\n    if (0 === e.featureLimit || !t) {\n      const t = a(e.displayingFeatures) && e.displayingFeatures.length > 0;\n      return this._hideTileFeatures(e), e.displayingFeatures = [], t;\n    }\n    const s = e.descriptor.resolution,\n      i = this._changes.updates,\n      r = this._changes.adds,\n      n = Math.min(e.featureLimit, t.length);\n    e.featureLimit = n;\n    for (let a = 0; a < n; ++a) {\n      const e = t[a],\n        n = x(e, this._objectIdField),\n        o = this._displayingFeatureReferences.get(n);\n      if (o) {\n        const t = o.ref(e, s);\n        t.oldVersion !== t.newVersion && (t.oldVersion && i.removes.push(t.oldVersion), t.newVersion && i.adds.push(t.newVersion));\n      } else this._displayingFeatureReferences.set(n, new this.FeatureReferenceClass(e, s)), r.push(e);\n      this._numDisplayingFeatureReferences++;\n    }\n    return this._hideTileFeatures(e), this._applyChanges(), e.displayingFeatures = t.slice(0, n), !0;\n  }\n  _hideTile(e) {\n    this._cancelFetchTile(e), this._hideTileFeatures(e);\n  }\n  _hideTileFeatures(e) {\n    if (o(e.displayingFeatures)) return;\n    const t = this._changes.updates,\n      s = this._changes.removes;\n    for (const i of e.displayingFeatures) {\n      const r = x(i, this._objectIdField),\n        a = this._displayingFeatureReferences.get(r);\n      if (!a) continue;\n      const n = a.unref(e.descriptor.resolution);\n      this._numDisplayingFeatureReferences--, n ? n.oldVersion !== n.newVersion && (null == n.newVersion ? (this._displayingFeatureReferences.delete(r), n.oldVersion && s.push(n.oldVersion)) : (t.adds.push(n.newVersion), n.oldVersion && t.removes.push(n.oldVersion))) : console.error(\"Hiding unreferenced feature\");\n    }\n    this._applyChanges(), e.displayingFeatures = null;\n  }\n  _applyChanges() {\n    const e = this._changes.updates;\n    e.removes.length > 0 && (this.features.removeMany(e.removes), e.removes.length = 0), e.adds.length > 0 && (this.features.addMany(e.adds), e.adds.length = 0);\n    const t = this._changes.adds,\n      s = this._changes.removes,\n      i = Math.min(t.length, s.length);\n    let r = 0;\n    for (; r < i;) {\n      const e = Math.min(r + $, i);\n      this.features.addMany(t.slice(r, e)), this.features.removeMany(s.slice(r, e)), r = e;\n    }\n    t.length > i && this.features.addMany(0 === r ? t : t.slice(r)), s.length > i && this.features.removeMany(0 === r ? s : s.slice(r)), t.length = 0, s.length = 0;\n  }\n  _clearTile(e) {\n    if (this._hideTile(e), e.features && a(this.context.memoryCache)) {\n      const t = 16 + e.estimatedSize;\n      this.context.memoryCache.put(e.id, e.cache, t);\n    }\n    e.setFeatures(null, 0, null), this._invalidateCounts();\n  }\n  _invalidateCounts() {\n    this.notifyChange(\"totalVertices\"), this.notifyChange(\"totalFeatures\"), this.notifyChange(\"memoryForUnusedFeatures\");\n  }\n  _getListOfTiles() {\n    return Array.from(this._featureTiles.values());\n  }\n  get storedFeatures() {\n    return this._getListOfTiles().reduce((e, t) => e + (t.features ? t.features.length : 0), 0);\n  }\n  get missingTiles() {\n    return Array.from(this._featureTiles.values()).reduce((e, t) => e + (t.needsFetching || t.isFetching ? 1 : 0), 0);\n  }\n  _maximumFeaturesForTile(e) {\n    const t = e.hasPreciseFeatureCount ? e.numFeatures : 1 / 0,\n      s = e.hasPreciseFeatureCount ? t : this.maximumNumberOfFeatures,\n      i = this._fullRatio < 1 ? this._farRatio : 1;\n    return Math.min(Math.ceil(s * i / (1 - e.emptyFeatureRatio)), t);\n  }\n  get test() {\n    return {\n      process: e => this.runTask(e),\n      getFeatureTileById: e => this._featureTiles.get(e),\n      forEachFeatureTile: e => this._featureTiles.forEach(e)\n    };\n  }\n};\nfunction q(e) {\n  return \"dummy-tile-full-extent\" === e.id;\n}\nfunction S(e) {\n  let t = 0;\n  for (const s of e) s.features && s.features.length > 0 && s.alive && (t = Math.max(t, s.descriptor.lij[0]));\n  return t;\n}\nfunction L(e) {\n  const t = e.capabilities.query;\n  return {\n    supportsMultipleResolutions: Q(e),\n    supportsPagination: !(!t || !t.supportsPagination),\n    supportsResultType: !(!t || !t.supportsResultType),\n    supportsCacheHint: !(!t || !t.supportsCacheHint),\n    supportsQuantization: !(!t || !t.supportsQuantization),\n    supportsQuantizationEditMode: !(!t || !t.supportsQuantizationEditMode),\n    supportsMaxRecordCountFactor: !(!t || !t.supportsMaxRecordCountFactor),\n    supportsFormatPBF: !(!t || !t.supportsFormatPBF)\n  };\n}\nfunction Q(e) {\n  switch (e.geometryType) {\n    case \"polyline\":\n      return !0;\n    case \"polygon\":\n      return e.capabilities && e.capabilities.query && e.capabilities.query.supportsQuantization;\n    default:\n      return !1;\n  }\n}\nfunction V(e) {\n  return e.setFeatures([], 0, null), e.featuresMissing = !1, D.DONE;\n}\nfunction H(e) {\n  return o(e) ? new Set() : new Set(e.map(e => e.name));\n}\nfunction k(e, t) {\n  if (o(e) || o(t)) return H(t);\n  const s = new Set();\n  for (const {\n    name: i\n  } of t) e.has(i) && s.add(i);\n  return s;\n}\ne([f({\n  constructOnly: !0\n})], A.prototype, \"features\", void 0), e([f()], A.prototype, \"tileDescriptors\", void 0), e([f({\n  value: 1 / 0\n})], A.prototype, \"maximumNumberOfFeatures\", null), e([f({\n  value: 1\n})], A.prototype, \"memoryFactor\", null), e([f({\n  value: 1\n})], A.prototype, \"lodFactor\", null), e([f()], A.prototype, \"useTileCount\", null), e([f({\n  readOnly: !0\n})], A.prototype, \"updating\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"running\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"updatingTotal\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"updatingRemaining\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"expectedFeatureDiff\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"memoryForUnusedFeatures\", null), e([f({\n  readOnly: !0\n})], A.prototype, \"maximumNumberOfFeaturesExceeded\", void 0), e([f({\n  constructOnly: !0\n})], A.prototype, \"maximumNumberOfFeaturesExceededThrottle\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"totalVertices\", null), e([f({\n  readOnly: !0\n})], A.prototype, \"totalFeatures\", null), e([f()], A.prototype, \"filterExtent\", null), e([f({\n  constructOnly: !0\n})], A.prototype, \"context\", void 0), A = e([m(U)], A);\nconst z = 2e3,\n  B = _(),\n  G = _(),\n  X = 6e5,\n  $ = 200;\nexport { A as FeatureTileFetcher3D, L as contextCapabilitiesFromLayer };","map":{"version":3,"names":["_","e","t","s","i","someMap","r","isSome","a","destroyMaybe","n","isNone","o","unwrap","u","isAbortError","l","eachAlways","h","throwIfAborted","c","on","d","schedule","p","property","f","subclass","m","create","equals","g","clone","F","expand","y","toExtent","T","getObjectId","x","hasVertices","E","C","R","ViewingMode","b","MultiFeatureReference","v","SingleFeatureReference","M","FAILED_FEATURE_COUNT","w","FetchStatus","D","FeatureTile","O","tilesAreRelated","j","ImmediateTask","P","TaskPriority","N","U","I","getLogger","A","maximumNumberOfFeatures","_get","_set","_maximumFeaturesUpdated","memoryFactor","_setDirty","lodFactor","_supportsResolution","refetch","useTileCount","_useTileCount","context","query","queryFeatureCount","notifyChange","memoryForUnusedFeatures","_featureTiles","forEach","estimatedUnusedSize","totalVertices","numVertices","totalFeatures","numFeatures","filterExtent","tilingScheme","spatialReference","error","_reclip","constructor","updating","running","updatingTotal","updatingRemaining","expectedFeatureDiff","maximumNumberOfFeaturesExceeded","maximumNumberOfFeaturesExceededThrottle","_fullRatio","_farRatio","_changes","updates","adds","Array","removes","_handles","_frameTask","_dirty","Map","_displayingFeatureReferences","_numDisplayingFeatureReferences","_suspended","_pendingEdits","initialize","add","tileDescriptors","onListenerAdd","_objectIdField","objectIdField","FeatureReferenceClass","capabilities","supportsMultipleResolutions","scheduler","registerTask","FEATURE_TILE_FETCHER","destroy","remove","_cancelFetchTile","_removeTile","clear","controller","abort","_paused","restart","_clearTile","_resetFetchTile","memoryCache","suspend","_pause","resume","_unpause","_updated","availableFields","displayingFeatures","length","Set","has","delete","applyEdits","edits","Promise","resolve","count","AbortController","then","result","catch","_applyEditsDeleteFeatures","deletedFeatures","_applyEditsAddUpdateFeatures","addedFeatures","updatedFeatures","signal","globalIdField","_ref","objectId","globalId","errorOncePerTick","features","find","attributes","filter","setFeatures","_invalidateCounts","push","_applyEditsAddUpdateTile","_createQuery","resultType","cacheHint","objectIds","_queryFeatures","size","slice","hasPreciseFeatureCount","Math","max","k","fields","queryFeaturesDehydrated","timeout","X","runTask","processQueue","initialized","_getListOfTiles","_markTilesNotAlive","run","_addTiles","_filterExtentTiles","_removeTiles","done","_sortTiles","_showTiles","_fetchTiles","_updateMemoryEstimates","_updateMaximumNumberOfFeaturesExceeded","alive","get","id","_addTile","madeProgress","hasProgressed","filtered","intersects","pop","sort","descriptor","loadPriority","_updateRatio","reduceFeatures","_showTile","needsFetching","cache","_scheduleUpdated","_needsNumFeatures","_fetchTileCount","_handleRequest","_fetchTile","featuresMissing","logFetchError","some","updateMemoryEstimates","intersectionIncludingBorrowed","B","G","_refreshDisplayingFeatures","feature","_applyChanges","isFetching","_maximumFeaturesForTile","emptyFeatureRatio","min","debugger","update","perTileMaximumNumberOfFeaturesExceeded","S","lij","fetchStatus","FULL","set","_referenceDisplayingFeaturesFromRelatedTiles","resolution","extent","extentIncludingBorrowedFeatures","ref","featureLimit","DONE","FETCH_NEEDED","requestController","resetFetching","_fetchCount","REFETCHING","REFETCH_NEEDED","V","_getMaxRecordCount","ceil","q","supportsMaxRecordCountFactor","MAX_MAX_RECORD_COUNT_FACTOR","_fetchPagedTile","maxRecordCountFactor","isRefetching","exceededTransferLimit","_removeEmptyFeatures","H","_createFeatureCountQuery","_setPagingParameters","num","concat","supportsCacheHint","createQuery","geometry","_setResolutionParams","_useTileQuery","supportsPagination","start","_getEffectiveTileResolution","viewingMode","Global","resolutionAtLevel","geometryType","supportsQuantization","quantizationParameters","mode","originPosition","tolerance","fullExtent","maxAllowableOffset","needsFeatureCount","tileMaxRecordCount","maxRecordCount","supportsResultType","z","needsRefetching","FETCHING","needsDisplayUpdate","_hideTileFeatures","oldVersion","newVersion","_hideTile","unref","console","removeMany","addMany","$","estimatedSize","put","from","values","storedFeatures","reduce","missingTiles","test","process","getFeatureTileById","forEachFeatureTile","L","Q","supportsQuantizationEditMode","supportsFormatPBF","map","name","constructOnly","prototype","value","readOnly","FeatureTileFetcher3D","contextCapabilitiesFromLayer"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/support/FeatureTileFetcher3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import s from\"../../../../core/Handles.js\";import i from\"../../../../core/Logger.js\";import{someMap as r}from\"../../../../core/MapUtils.js\";import{isSome as a,destroyMaybe as n,isNone as o,unwrap as u}from\"../../../../core/maybe.js\";import{isAbortError as l,eachAlways as h,throwIfAborted as c}from\"../../../../core/promiseUtils.js\";import{on as d}from\"../../../../core/reactiveUtils.js\";import{schedule as p}from\"../../../../core/scheduling.js\";import{property as f}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as m}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{create as _,equals as g,clone as F,expand as y,toExtent as T}from\"../../../../geometry/support/aaBoundingRect.js\";import{getObjectId as x,hasVertices as E}from\"../../../../layers/graphics/dehydratedFeatures.js\";import C from\"../../../../rest/support/QuantizationParameters.js\";import R from\"../../../../rest/support/Query.js\";import{ViewingMode as b}from\"../../../ViewingMode.js\";import{MultiFeatureReference as v,SingleFeatureReference as M}from\"./featureReference.js\";import{FAILED_FEATURE_COUNT as w,FetchStatus as D,FeatureTile as O}from\"./FeatureTile.js\";import{tilesAreRelated as j}from\"../../terrain/tileUtils.js\";import{ImmediateTask as P,TaskPriority as N}from\"../../../support/Scheduler.js\";const U=\"esri.views.3d.layers.support.FeatureTileFetcher3D\",I=i.getLogger(U);let A=class extends t{set maximumNumberOfFeatures(e){e=e||1/0;const t=this._get(\"maximumNumberOfFeatures\");e===t||e<1||(this._set(\"maximumNumberOfFeatures\",e),this._maximumFeaturesUpdated(t,e))}set memoryFactor(e){this.memoryFactor!==e&&(this._set(\"memoryFactor\",e),this._setDirty())}set lodFactor(e){this.lodFactor!==e&&(this._set(\"lodFactor\",e),this._supportsResolution&&this.refetch())}get useTileCount(){return this._useTileCount&&a(this.context.query.queryFeatureCount)}set useTileCount(e){this._useTileCount=e,this.notifyChange(\"useTileCount\")}get memoryForUnusedFeatures(){let e=0;return this._featureTiles.forEach((t=>e+=t.estimatedUnusedSize)),e}get totalVertices(){let e=0;return this._featureTiles.forEach((t=>e+=t.numVertices)),e}get totalFeatures(){let e=0;return this._featureTiles.forEach((t=>e+=t.numFeatures)),e}set filterExtent(e){if(a(e)&&this.context.tilingScheme&&!e.spatialReference.equals(this.context.tilingScheme.spatialReference))return void I.error(\"#filterExtent=\",\"extent needs to be in the same spatial reference as the tiling scheme\");const t=this._get(\"filterExtent\");if(t===e||a(t)&&e&&t.equals(e))return;const s=a(e)?e.clone():null;this._set(\"filterExtent\",s),this._reclip(s,t)}constructor(e){super(e),this._useTileCount=!1,this.updating=!1,this.running=!1,this.updatingTotal=0,this.updatingRemaining=0,this.expectedFeatureDiff=0,this.maximumNumberOfFeaturesExceeded=!1,this.maximumNumberOfFeaturesExceededThrottle=1e3,this._fullRatio=1,this._farRatio=1,this._changes={updates:{adds:new Array,removes:new Array},adds:new Array,removes:new Array},this._handles=new s,this._frameTask=P,this._dirty=!1,this._featureTiles=new Map,this._displayingFeatureReferences=new Map,this._numDisplayingFeatureReferences=0,this._suspended=!0,this._pendingEdits=null}initialize(){this._handles.add(d((()=>this.tileDescriptors),\"change\",(()=>this._setDirty()),{onListenerAdd:()=>this._setDirty()})),this._objectIdField=this.context.objectIdField,this.FeatureReferenceClass=this.context.capabilities.supportsMultipleResolutions?v:M;const e=this.context.scheduler;a(e)&&(this._frameTask=e.registerTask(N.FEATURE_TILE_FETCHER,this)),this._setDirty()}destroy(){this._frameTask.remove(),this._handles=n(this._handles),this._featureTiles.forEach((e=>{this._cancelFetchTile(e),this._removeTile(e)})),this._featureTiles.clear(),this._displayingFeatureReferences.clear(),this._pendingEdits?.controller.abort(),this._pendingEdits=null}get _paused(){return this._suspended||!!this._pendingEdits}restart(){this._featureTiles.forEach((e=>{this._cancelFetchTile(e),this._clearTile(e),this._resetFetchTile(e)})),a(this.context.memoryCache)&&this.context.memoryCache.clear(),this._setDirty()}refetch(){this._featureTiles.forEach((e=>{this._cancelFetchTile(e),this._resetFetchTile(e)})),a(this.context.memoryCache)&&this.context.memoryCache.clear(),this._setDirty()}suspend(){this._suspended||(this._suspended=!0,this._pause(),this._setDirty())}resume(){this._suspended&&(this._suspended=!1,this._unpause())}_pause(){this._paused&&(this._featureTiles.forEach((e=>this._cancelFetchTile(e))),this._updated())}_unpause(){this._paused||(this._setDirty(),this._updated())}get availableFields(){let e=null;return this._featureTiles.forEach((t=>{o(t.displayingFeatures)||0===t.displayingFeatures.length||(o(e)?e=new Set(t.availableFields):e.forEach((s=>{t.availableFields.has(s)||u(e).delete(s)})))})),a(e)?e:new Set}applyEdits(e){this._pendingEdits||(this._pendingEdits={edits:Promise.resolve(),count:0,controller:new AbortController},this._pause());const t=this._pendingEdits;t.count++;const s=t.edits.then((()=>e.result.catch((e=>{if(l(e))throw e;return null})).then((e=>e?(this._applyEditsDeleteFeatures(e.deletedFeatures),this._applyEditsAddUpdateFeatures(e.addedFeatures,e.updatedFeatures,t.controller.signal).then((()=>e))):e)).then((e=>(0==--t.count&&(this._pendingEdits===t&&(this._pendingEdits=null),a(this.context.memoryCache)&&this.context.memoryCache.clear(),this._unpause(),this._updated()),e)))));return t.edits=s,this._updated(),s}_applyEditsDeleteFeatures(e){if(0===e.length)return;const t=this.context.globalIdField,s=t&&this.availableFields.has(t),i=new Set,r=this._objectIdField;e.forEach((({objectId:e,globalId:a})=>{if((!e||e<0)&&t){s||I.errorOncePerTick(`Editing the specified service requires the layer's globalIdField, ${t} to be included the layer's outFields for updates to be reflected in the view`);const e=this.features.find((e=>e.attributes&&e.attributes[t]===a));e&&i.add(x(e,r))}else i.add(e)})),this._featureTiles.forEach((e=>{if(!e.features)return;const t=e.features.filter((e=>!i.has(x(e,this._objectIdField))));t.length!==e.features.length&&(e.setFeatures(t,0,e.availableFields),this._invalidateCounts())}))}async _applyEditsAddUpdateFeatures(e,t,s){const i=[],r=new Set;if(e.forEach((e=>i.push(e.objectId))),t.forEach((e=>{i.push(e.objectId),r.add(e.objectId)})),0===i.length)return;const a=[];this._featureTiles.forEach((e=>{const t=this._applyEditsAddUpdateTile(e,i,r,s);t&&a.push(t)})),await h(a)}async _applyEditsAddUpdateTile(e,t,s,i){if(!e.features)return;const r=this._createQuery(e);r.resultType=void 0,r.cacheHint=!1,r.objectIds=t;const a=await this._queryFeatures(r,i);let n=null;if(s.size>0){const t=e.features.filter((e=>!s.has(x(e,this._objectIdField))));t.length!==e.features.length&&(n=t)}if(a.features.length>0){n||(n=e.features.slice());for(const e of a.features)n.push(e)}n&&(e.hasPreciseFeatureCount&&(e.numFeatures=Math.max(e.numFeatures,n.length)),e.setFeatures(n,0,k(e.availableFields,a.fields)),this._invalidateCounts())}_queryFeatures(e,t){return this.context.query.queryFeaturesDehydrated(e,{signal:t,timeout:X})}_setDirty(){this._dirty=!0,this._updated()}runTask(e){if(this._frameTask.processQueue(e),!this._dirty||!this.initialized)return;this._dirty=!1;const t=this._getListOfTiles();if(this._markTilesNotAlive(t),!e.run((()=>this._addTiles(t,e)))||!e.run((()=>this._filterExtentTiles(t,e)))||!e.run((()=>this._removeTiles(t,e)))||e.done)return void this._setDirty();const s=this._sortTiles(t);e.run((()=>this._showTiles(s,e)))&&e.run((()=>this._fetchTiles(s,e)))&&e.run((()=>this._updateMemoryEstimates(s,e)))||this._setDirty(),this._updated(),this.updating||this._updateMaximumNumberOfFeaturesExceeded()}_markTilesNotAlive(e){for(const t of e)t.alive=!1}_addTiles(e,t){return!this._suspended&&(this.tileDescriptors.forEach((s=>{const i=this._featureTiles.get(s.id);i?i.alive=!0:t.done||(e.push(this._addTile(s)),t.madeProgress())})),t.hasProgressed)}_filterExtentTiles(e,t){for(const s of e){if(t.done)break;s.alive&&(s.filtered=!s.intersects(this.filterExtent),s.filtered&&(this._clearTile(s),t.madeProgress()))}return t.hasProgressed}_removeTiles(e,t){for(let s=e.length-1;s>=0&&!t.done;s--){const i=e[s];i.alive||(this._removeTile(i),s!==e.length-1&&(e[s]=e[e.length-1]),e.pop(),t.madeProgress())}return t.hasProgressed}_sortTiles(e){return e.sort(((e,t)=>(e.descriptor.loadPriority??0)-(t.descriptor.loadPriority??0))),e}_showTiles(e,t){const s=this._updateRatio(e),i=e=>{const t=this._fullRatio<1?s(e)*this._farRatio:1;return e.reduceFeatures(t,this.memoryFactor,this._objectIdField)&&this._setDirty(),this._showTile(e)};for(const r of e)if(!t.run((()=>i(r)))){this._setDirty();break}return t.hasProgressed}_fetchTiles(e,t){if(this._paused)return!1;let s=!1;for(const i of e){if(!i.needsFetching)continue;const e=a(this.context.memoryCache)?this.context.memoryCache.pop(i.id):null;if(a(e))i.cache=e,this._setDirty(),this._scheduleUpdated(),t.madeProgress();else{if(this._needsNumFeatures(i)){const e=new AbortController,r=this._fetchTileCount(i,e.signal);this._handleRequest(i,r,e,(()=>i.numFeatures=w)),s=!0,t.madeProgress()}if(t.done)return!0}}if(s)return t.hasProgressed;for(const i of e)if(i.needsFetching){const e=new AbortController,s=this._fetchTile(i,e.signal);if(this._handleRequest(i,s,e,(e=>{i.setFeatures([],0,null),this._invalidateCounts(),i.featuresMissing=!1,this.context.logFetchError(I,e)})),t.madeProgress())return!0}return t.hasProgressed}_updateMemoryEstimates(e,t){return e.some((e=>!t.run((()=>e.updateMemoryEstimates()))&&(this._setDirty(),!0))),t.hasProgressed}_reclip(e,t){if(!this.initialized)return;const s=new Array;this._featureTiles.forEach((i=>{o(i.displayingFeatures)||0===i.displayingFeatures.length||(i.intersectionIncludingBorrowed(t,B),i.intersectionIncludingBorrowed(e,G),g(B,G)||s.push(i))})),this._refreshDisplayingFeatures(s),this._updated()}_refreshDisplayingFeatures(e){const t=new Set,s=this._changes.updates;for(const i of e)if(!o(i.displayingFeatures))for(const e of i.displayingFeatures){const i=x(e,this._objectIdField);if(t.has(i))continue;t.add(i);const r=this._displayingFeatureReferences.get(i).feature;s.removes.push(r),s.adds.push(r)}this._applyChanges()}_updated(){let e=0;this._paused||this._featureTiles.forEach((t=>t.isFetching?++e:0));const t=this._dirty||!!this._pendingEdits||e>0;if(this._set(\"running\",this._dirty),this._set(\"updating\",t),t){let t=0,s=0,i=0,r=0,n=0;const o=this._displayingFeatureReferences.size/this._numDisplayingFeatureReferences;this._featureTiles.forEach((e=>{if(++s,e.isFetching&&e.hasPreciseFeatureCount){const t=this._maximumFeaturesForTile(e)*(1-e.emptyFeatureRatio),s=a(e.displayingFeatures)?e.displayingFeatures.length*o:0;n+=t-s}e.needsFetching?++r:e.numFeatures>0&&(++i,t+=e.numFeatures)})),r+=e;let u=0,l=0;t?(l=t,u=Math.min(r*t/i,t)):(l=s,u=r),n=Math.min(this.maximumNumberOfFeatures-this.features.length,n),this._set(\"updatingTotal\",l),this._set(\"updatingRemaining\",u),this._set(\"expectedFeatureDiff\",n)}else this._set(\"updatingTotal\",0),this._set(\"updatingRemaining\",0),this._set(\"expectedFeatureDiff\",0);this.debugger&&this.debugger.update()}_updateMaximumNumberOfFeaturesExceeded(){const e=r(this._featureTiles,(e=>e.perTileMaximumNumberOfFeaturesExceeded));this._set(\"maximumNumberOfFeaturesExceeded\",e)}_updateRatio(e){const t=S(e),s=e=>1/(1<<Math.max(0,t-e.descriptor.lij[0]));let i=0,r=0;for(const a of e){const e=a.numFeatures;i+=e,r+=e*s(a)}return this._fullRatio=Math.min(1,this.maximumNumberOfFeatures/i),this._farRatio=this.maximumNumberOfFeatures/r,this._scheduleUpdated(),s}_maximumFeaturesUpdated(e,t){e!==t&&(t>e&&this._featureTiles.forEach((e=>{if(!e.featuresMissing)return;const t=this._maximumFeaturesForTile(e);e.features&&(e.features.length>=t||e.fetchStatus===D.FULL)||(this._cancelFetchTile(e),this._resetFetchTile(e))})),this._setDirty())}_addTile(e){const t=new O(e);return this._featureTiles.set(t.id,t),this._resetFetchTile(t),this._referenceDisplayingFeaturesFromRelatedTiles(t),t}_referenceDisplayingFeaturesFromRelatedTiles(e){const t=e.descriptor.resolution;this._featureTiles.forEach((s=>{if(!(o(s.displayingFeatures)||e===s||e.descriptor.lij&&s.descriptor.lij&&!j(e.descriptor.lij,s.descriptor.lij))){o(e.displayingFeatures)&&(e.displayingFeatures=[]),e.descriptor.extent&&s.descriptor.extent&&(o(e.extentIncludingBorrowedFeatures)&&(e.extentIncludingBorrowedFeatures=F(e.descriptor.extent)),y(e.extentIncludingBorrowedFeatures,s.descriptor.extent,e.extentIncludingBorrowedFeatures));for(const i of s.displayingFeatures){e.displayingFeatures.push(i);const s=this._displayingFeatureReferences.get(x(i,this._objectIdField));s.ref(s.feature,t),this._numDisplayingFeatureReferences++}}})),e.featureLimit=a(e.displayingFeatures)?e.displayingFeatures.length:0}_removeTile(e){this._clearTile(e),this._featureTiles.delete(e.id)}_resetFetchTile(e){e.filtered=!e.intersects(this.filterExtent),e.filtered?e.needsFetching&&(e.fetchStatus=D.DONE):e.fetchStatus=D.FETCH_NEEDED}_cancelFetchTile(e){const t=e.requestController;a(t)&&(e.requestController=null,e.resetFetching(),t.abort())}async _fetchTileCount(e,t){return e.numFeatures=await this._fetchCount(e,t),this._updateRatio(this._getListOfTiles()),e.fetchStatus===D.REFETCHING?D.REFETCH_NEEDED:D.FETCH_NEEDED}async _fetchTile(e,t){const s=this._maximumFeaturesForTile(e);if(s<=0)return V(e);const i=this._getMaxRecordCount(e),r=Math.ceil(s/i);if(q(e)||!this.context.capabilities.supportsMaxRecordCountFactor||e.numFeatures<=s&&r>R.MAX_MAX_RECORD_COUNT_FACTOR)return this._fetchPagedTile(e,t);const a=this._createQuery(e);if(a.maxRecordCountFactor=Math.ceil(s/i),e.isRefetching&&e.features&&e.features.length>0){const t=Math.ceil(e.features.length/(1-e.emptyFeatureRatio)/i);a.maxRecordCountFactor=Math.max(t+1,a.maxRecordCountFactor)}const{features:n,exceededTransferLimit:o,fields:u}=await this._queryFeatures(a,t),l=o?a.maxRecordCountFactor>=R.MAX_MAX_RECORD_COUNT_FACTOR?D.FULL:D.DONE:D.FULL;return await this._frameTask.schedule((()=>{e.featuresMissing=n.length<e.numFeatures||!!o;const t=this._removeEmptyFeatures(n);e.setFeatures(n,t,H(u))}),t),c(t),this._invalidateCounts(),l}async _fetchCount(e,t){return this.context.query.queryFeatureCount(this._createFeatureCountQuery(e),{signal:t})}async _fetchPagedTile(e,t){let s,i=0,r=0,a=0,n=this._maximumFeaturesForTile(e)-a;const o=this._getMaxRecordCount(e);let l=null;for(;;){const h=this._createQuery(e),d=this._setPagingParameters(h,i,n,o),{features:p,exceededTransferLimit:f,fields:m}=await this._queryFeatures(h,t);if(await this._frameTask.schedule((()=>{d&&(i+=u(h.num)),a+=p.length,r+=this._removeEmptyFeatures(p),e.featuresMissing=i<e.numFeatures||!!f,s=s?s.concat(p):p,l=k(l,m),e.setFeatures(s,r,l)}),t),c(t),this._invalidateCounts(),this._setDirty(),n=this._maximumFeaturesForTile(e)-a,!d||!f||n<=0)return f?D.DONE:D.FULL}}_createFeatureCountQuery(e){const t=this._createQuery(e);return this.context.capabilities.supportsCacheHint&&(t.resultType=void 0,t.cacheHint=!0),t}_createQuery(e){const t=this.context.createQuery(),s=e.descriptor.extent;if(s){const e=this.context.tilingScheme.spatialReference;t.geometry=T(s,e)}return this._setResolutionParams(t,e),this._useTileQuery(e)?t.resultType=\"tile\":this.context.capabilities.supportsCacheHint&&(t.cacheHint=!0),t}_setPagingParameters(e,t,s,i){return!!this.context.capabilities.supportsPagination&&(e.start=t,s>0&&this.context.capabilities.supportsMaxRecordCountFactor?(e.maxRecordCountFactor=Math.ceil(s/i),e.num=Math.min(e.maxRecordCountFactor*i,s)):e.num=Math.min(i),!0)}_getEffectiveTileResolution(e){if(null==e.descriptor.resolution)return null;const t=this.context.viewingMode===b.Global?this.context.tilingScheme.resolutionAtLevel(3):1/0;return Math.min(e.descriptor.resolution,t)/this.lodFactor}get _supportsResolution(){return this.context.capabilities.supportsMultipleResolutions&&\"point\"!==this.context.geometryType}_setResolutionParams(e,t){if(!this._supportsResolution)return;const s=this._getEffectiveTileResolution(t);null!=s&&(this.context.capabilities.supportsQuantization?e.quantizationParameters=new C({mode:\"view\",originPosition:\"upper-left\",tolerance:s,extent:this.context.fullExtent}):\"polyline\"===this.context.geometryType&&(e.maxAllowableOffset=s))}_removeEmptyFeatures(e){const t=e.length;for(let s=0;s<e.length;){const t=e[s];E(t.geometry)?++s:(e[s]=e[e.length-1],--e.length)}return t-e.length}_needsNumFeatures(e){return this.useTileCount&&e.needsFeatureCount&&!q(e)}_getMaxRecordCount(e){const{tileMaxRecordCount:t,maxRecordCount:s}=this.context;return this._useTileQuery(e)&&a(t)&&t>0&&this.context.capabilities.supportsResultType?t:a(s)&&s>0?s:z}_useTileQuery(e){return(!q(e)||!this.context.capabilities.supportsCacheHint)&&this.context.capabilities.supportsResultType}_handleRequest(e,t,s,i){e.fetchStatus=e.needsRefetching?D.REFETCHING:D.FETCHING,e.requestController=s;let r=!1;t.then((t=>{e.requestController=null,e.fetchStatus=t})).catch((t=>{e.requestController===s&&(e.requestController=null,e.fetchStatus=D.DONE),l(t)?r=!0:i(t)})).then((()=>{r||this._setDirty(),this._scheduleUpdated()}))}_scheduleUpdated(){this._handles&&!this._handles.has(\"scheduleUpdated\")&&this._handles.add(p((()=>{this._handles.remove(\"scheduleUpdated\"),this._updated()})),\"scheduleUpdated\")}_showTile(e){if(a(e.displayingFeatures)&&!e.needsDisplayUpdate)return!1;const t=e.features;if(0===e.featureLimit||!t){const t=a(e.displayingFeatures)&&e.displayingFeatures.length>0;return this._hideTileFeatures(e),e.displayingFeatures=[],t}const s=e.descriptor.resolution,i=this._changes.updates,r=this._changes.adds,n=Math.min(e.featureLimit,t.length);e.featureLimit=n;for(let a=0;a<n;++a){const e=t[a],n=x(e,this._objectIdField),o=this._displayingFeatureReferences.get(n);if(o){const t=o.ref(e,s);t.oldVersion!==t.newVersion&&(t.oldVersion&&i.removes.push(t.oldVersion),t.newVersion&&i.adds.push(t.newVersion))}else this._displayingFeatureReferences.set(n,new this.FeatureReferenceClass(e,s)),r.push(e);this._numDisplayingFeatureReferences++}return this._hideTileFeatures(e),this._applyChanges(),e.displayingFeatures=t.slice(0,n),!0}_hideTile(e){this._cancelFetchTile(e),this._hideTileFeatures(e)}_hideTileFeatures(e){if(o(e.displayingFeatures))return;const t=this._changes.updates,s=this._changes.removes;for(const i of e.displayingFeatures){const r=x(i,this._objectIdField),a=this._displayingFeatureReferences.get(r);if(!a)continue;const n=a.unref(e.descriptor.resolution);this._numDisplayingFeatureReferences--,n?n.oldVersion!==n.newVersion&&(null==n.newVersion?(this._displayingFeatureReferences.delete(r),n.oldVersion&&s.push(n.oldVersion)):(t.adds.push(n.newVersion),n.oldVersion&&t.removes.push(n.oldVersion))):console.error(\"Hiding unreferenced feature\")}this._applyChanges(),e.displayingFeatures=null}_applyChanges(){const e=this._changes.updates;e.removes.length>0&&(this.features.removeMany(e.removes),e.removes.length=0),e.adds.length>0&&(this.features.addMany(e.adds),e.adds.length=0);const t=this._changes.adds,s=this._changes.removes,i=Math.min(t.length,s.length);let r=0;for(;r<i;){const e=Math.min(r+$,i);this.features.addMany(t.slice(r,e)),this.features.removeMany(s.slice(r,e)),r=e}t.length>i&&this.features.addMany(0===r?t:t.slice(r)),s.length>i&&this.features.removeMany(0===r?s:s.slice(r)),t.length=0,s.length=0}_clearTile(e){if(this._hideTile(e),e.features&&a(this.context.memoryCache)){const t=16+e.estimatedSize;this.context.memoryCache.put(e.id,e.cache,t)}e.setFeatures(null,0,null),this._invalidateCounts()}_invalidateCounts(){this.notifyChange(\"totalVertices\"),this.notifyChange(\"totalFeatures\"),this.notifyChange(\"memoryForUnusedFeatures\")}_getListOfTiles(){return Array.from(this._featureTiles.values())}get storedFeatures(){return this._getListOfTiles().reduce(((e,t)=>e+(t.features?t.features.length:0)),0)}get missingTiles(){return Array.from(this._featureTiles.values()).reduce(((e,t)=>e+(t.needsFetching||t.isFetching?1:0)),0)}_maximumFeaturesForTile(e){const t=e.hasPreciseFeatureCount?e.numFeatures:1/0,s=e.hasPreciseFeatureCount?t:this.maximumNumberOfFeatures,i=this._fullRatio<1?this._farRatio:1;return Math.min(Math.ceil(s*i/(1-e.emptyFeatureRatio)),t)}get test(){return{process:e=>this.runTask(e),getFeatureTileById:e=>this._featureTiles.get(e),forEachFeatureTile:e=>this._featureTiles.forEach(e)}}};function q(e){return\"dummy-tile-full-extent\"===e.id}function S(e){let t=0;for(const s of e)s.features&&s.features.length>0&&s.alive&&(t=Math.max(t,s.descriptor.lij[0]));return t}function L(e){const t=e.capabilities.query;return{supportsMultipleResolutions:Q(e),supportsPagination:!(!t||!t.supportsPagination),supportsResultType:!(!t||!t.supportsResultType),supportsCacheHint:!(!t||!t.supportsCacheHint),supportsQuantization:!(!t||!t.supportsQuantization),supportsQuantizationEditMode:!(!t||!t.supportsQuantizationEditMode),supportsMaxRecordCountFactor:!(!t||!t.supportsMaxRecordCountFactor),supportsFormatPBF:!(!t||!t.supportsFormatPBF)}}function Q(e){switch(e.geometryType){case\"polyline\":return!0;case\"polygon\":return e.capabilities&&e.capabilities.query&&e.capabilities.query.supportsQuantization;default:return!1}}function V(e){return e.setFeatures([],0,null),e.featuresMissing=!1,D.DONE}function H(e){return o(e)?new Set:new Set(e.map((e=>e.name)))}function k(e,t){if(o(e)||o(t))return H(t);const s=new Set;for(const{name:i}of t)e.has(i)&&s.add(i);return s}e([f({constructOnly:!0})],A.prototype,\"features\",void 0),e([f()],A.prototype,\"tileDescriptors\",void 0),e([f({value:1/0})],A.prototype,\"maximumNumberOfFeatures\",null),e([f({value:1})],A.prototype,\"memoryFactor\",null),e([f({value:1})],A.prototype,\"lodFactor\",null),e([f()],A.prototype,\"useTileCount\",null),e([f({readOnly:!0})],A.prototype,\"updating\",void 0),e([f({readOnly:!0})],A.prototype,\"running\",void 0),e([f({readOnly:!0})],A.prototype,\"updatingTotal\",void 0),e([f({readOnly:!0})],A.prototype,\"updatingRemaining\",void 0),e([f({readOnly:!0})],A.prototype,\"expectedFeatureDiff\",void 0),e([f({readOnly:!0})],A.prototype,\"memoryForUnusedFeatures\",null),e([f({readOnly:!0})],A.prototype,\"maximumNumberOfFeaturesExceeded\",void 0),e([f({constructOnly:!0})],A.prototype,\"maximumNumberOfFeaturesExceededThrottle\",void 0),e([f({readOnly:!0})],A.prototype,\"totalVertices\",null),e([f({readOnly:!0})],A.prototype,\"totalFeatures\",null),e([f()],A.prototype,\"filterExtent\",null),e([f({constructOnly:!0})],A.prototype,\"context\",void 0),A=e([m(U)],A);const z=2e3,B=_(),G=_(),X=6e5,$=200;export{A as FeatureTileFetcher3D,L as contextCapabilitiesFromLayer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}