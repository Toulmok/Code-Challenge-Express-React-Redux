{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { s as e } from \"../../../../../../chunks/vec4.js\";\nimport { c as r } from \"../../../../../../chunks/vec4f64.js\";\nimport { ScreenSizePerspective as t, addScreenSizePerspectiveAlignment as l } from \"../util/ScreenSizePerspective.glsl.js\";\nimport { addCameraPosition as o } from \"../util/View.glsl.js\";\nimport { Float4PassUniform as c } from \"../../shaderModules/Float4PassUniform.js\";\nimport { glsl as s } from \"../../shaderModules/interfaces.js\";\nfunction a(e, r) {\n  const c = e.vertex;\n  r.hasVerticalOffset ? (f(c), r.hasScreenSizePerspective && (e.include(t), l(c), o(e.vertex, r)), c.code.add(s`\n      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);\n        ${r.spherical ? s`vec3 worldNormal = normalize(worldPos + localOrigin);` : s`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}\n        ${r.hasScreenSizePerspective ? s`\n            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));\n            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);` : s`\n            float verticalOffsetScreenHeight = verticalOffset.x;`}\n        // Screen sized offset in world space, used for example for line callouts\n        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n        return worldNormal * worldOffset;\n      }\n\n      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n        return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n      }\n    `)) : c.code.add(s`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`);\n}\nconst i = r();\nfunction f(r) {\n  r.uniforms.add(new c(\"verticalOffset\", (r, t) => {\n    const {\n        minWorldLength: l,\n        maxWorldLength: o,\n        screenLength: c\n      } = r.verticalOffset,\n      s = Math.tan(.5 * t.camera.fovY) / (.5 * t.camera.fullViewport[3]),\n      a = t.camera.pixelRatio || 1;\n    return e(i, c * a, s, l, o);\n  }));\n}\nexport { a as VerticalOffset, f as addVerticalOffset };","map":{"version":3,"names":["s","e","c","r","ScreenSizePerspective","t","addScreenSizePerspectiveAlignment","l","addCameraPosition","o","Float4PassUniform","glsl","a","vertex","hasVerticalOffset","f","hasScreenSizePerspective","include","code","add","spherical","i","uniforms","minWorldLength","maxWorldLength","screenLength","verticalOffset","Math","tan","camera","fovY","fullViewport","pixelRatio","VerticalOffset","addVerticalOffset"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/VerticalOffset.glsl.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{s as e}from\"../../../../../../chunks/vec4.js\";import{c as r}from\"../../../../../../chunks/vec4f64.js\";import{ScreenSizePerspective as t,addScreenSizePerspectiveAlignment as l}from\"../util/ScreenSizePerspective.glsl.js\";import{addCameraPosition as o}from\"../util/View.glsl.js\";import{Float4PassUniform as c}from\"../../shaderModules/Float4PassUniform.js\";import{glsl as s}from\"../../shaderModules/interfaces.js\";function a(e,r){const c=e.vertex;r.hasVerticalOffset?(f(c),r.hasScreenSizePerspective&&(e.include(t),l(c),o(e.vertex,r)),c.code.add(s`\n      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);\n        ${r.spherical?s`vec3 worldNormal = normalize(worldPos + localOrigin);`:s`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}\n        ${r.hasScreenSizePerspective?s`\n            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));\n            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:s`\n            float verticalOffsetScreenHeight = verticalOffset.x;`}\n        // Screen sized offset in world space, used for example for line callouts\n        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n        return worldNormal * worldOffset;\n      }\n\n      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n        return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n      }\n    `)):c.code.add(s`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}const i=r();function f(r){r.uniforms.add(new c(\"verticalOffset\",((r,t)=>{const{minWorldLength:l,maxWorldLength:o,screenLength:c}=r.verticalOffset,s=Math.tan(.5*t.camera.fovY)/(.5*t.camera.fullViewport[3]),a=t.camera.pixelRatio||1;return e(i,c*a,s,l,o)})))}export{a as VerticalOffset,f as addVerticalOffset};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAC,QAAK,kCAAkC;AAAC,SAAOC,CAAC,IAAIC,CAAC,QAAK,qCAAqC;AAAC,SAAOC,qBAAqB,IAAIC,CAAC,EAACC,iCAAiC,IAAIC,CAAC,QAAK,uCAAuC;AAAC,SAAOC,iBAAiB,IAAIC,CAAC,QAAK,sBAAsB;AAAC,SAAOC,iBAAiB,IAAIR,CAAC,QAAK,0CAA0C;AAAC,SAAOS,IAAI,IAAIX,CAAC,QAAK,mCAAmC;AAAC,SAASY,CAACA,CAACX,CAAC,EAACE,CAAC,EAAC;EAAC,MAAMD,CAAC,GAACD,CAAC,CAACY,MAAM;EAACV,CAAC,CAACW,iBAAiB,IAAEC,CAAC,CAACb,CAAC,CAAC,EAACC,CAAC,CAACa,wBAAwB,KAAGf,CAAC,CAACgB,OAAO,CAACZ,CAAC,CAAC,EAACE,CAAC,CAACL,CAAC,CAAC,EAACO,CAAC,CAACR,CAAC,CAACY,MAAM,EAACV,CAAC,CAAC,CAAC,EAACD,CAAC,CAACgB,IAAI,CAACC,GAAG,CAACnB,CAAE;AACviB;AACA;AACA,UAAUG,CAAC,CAACiB,SAAS,GAACpB,CAAE,uDAAsD,GAACA,CAAE,yCAAyC;AAC1H,UAAUG,CAAC,CAACa,wBAAwB,GAAChB,CAAE;AACvC;AACA,+JAA+J,GAACA,CAAE;AAClK,iEAAkE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,CAAC,IAAEE,CAAC,CAACgB,IAAI,CAACC,GAAG,CAACnB,CAAE,8EAA6E,CAAC;AAAA;AAAC,MAAMqB,CAAC,GAAClB,CAAC,EAAE;AAAC,SAASY,CAACA,CAACZ,CAAC,EAAC;EAACA,CAAC,CAACmB,QAAQ,CAACH,GAAG,CAAC,IAAIjB,CAAC,CAAC,gBAAgB,EAAE,CAACC,CAAC,EAACE,CAAC,KAAG;IAAC,MAAK;QAACkB,cAAc,EAAChB,CAAC;QAACiB,cAAc,EAACf,CAAC;QAACgB,YAAY,EAACvB;MAAC,CAAC,GAACC,CAAC,CAACuB,cAAc;MAAC1B,CAAC,GAAC2B,IAAI,CAACC,GAAG,CAAC,EAAE,GAACvB,CAAC,CAACwB,MAAM,CAACC,IAAI,CAAC,IAAE,EAAE,GAACzB,CAAC,CAACwB,MAAM,CAACE,YAAY,CAAC,CAAC,CAAC,CAAC;MAACnB,CAAC,GAACP,CAAC,CAACwB,MAAM,CAACG,UAAU,IAAE,CAAC;IAAC,OAAO/B,CAAC,CAACoB,CAAC,EAACnB,CAAC,GAACU,CAAC,EAACZ,CAAC,EAACO,CAAC,EAACE,CAAC,CAAC;EAAA,CAAC,CAAE,CAAC;AAAA;AAAC,SAAOG,CAAC,IAAIqB,cAAc,EAAClB,CAAC,IAAImB,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}