{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport r from \"../../../core/Accessor.js\";\nimport t from \"../../../core/Evented.js\";\nimport s from \"../../../core/Handles.js\";\nimport { someMap as i } from \"../../../core/MapUtils.js\";\nimport { releaseMaybe as o, disposeMaybe as a, destroyMaybe as n, isSome as h, isNone as d, unwrapOr as l } from \"../../../core/maybe.js\";\nimport c from \"../../../core/PooledArray.js\";\nimport { watch as p, syncAndInitial as u, on as _ } from \"../../../core/reactiveUtils.js\";\nimport { someSet as m } from \"../../../core/SetUtils.js\";\nimport { property as g } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as y } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { x as R, f as T } from \"../../../chunks/mat4.js\";\nimport { s as f } from \"../../../chunks/vec3.js\";\nimport { f as w } from \"../../../chunks/vec3f64.js\";\nimport { ViewingMode as b } from \"../../ViewingMode.js\";\nimport { DrapeTargetType as v, DrapeSourceType as x, DrapedRenderGroup as O } from \"../layers/interfaces.js\";\nimport S from \"../support/debugFlags.js\";\nimport { OverlayIndex as D, RenderTargetType as j } from \"./interfaces.js\";\nimport { Overlay as P } from \"./Overlay.js\";\nimport { OverlayFramebufferObject as E } from \"./OverlayFramebufferObject.js\";\nimport { OverlayRenderTarget as A } from \"./OverlayRenderTarget.js\";\nimport { ShaderOutput as C } from \"../webgl-engine/core/shaderLibrary/ShaderOutput.js\";\nimport { T as F } from \"../../../chunks/TextureOnly.glsl.js\";\nimport { ShaderTechniqueRepository as q } from \"../webgl-engine/core/shaderTechnique/ShaderTechniqueRepository.js\";\nimport { Camera as M } from \"../webgl-engine/lib/Camera.js\";\nimport { GLMaterialRepository as U } from \"../webgl-engine/lib/GLMaterialRepository.js\";\nimport { createEmptyDepthTexture as V, createQuadVAO as W } from \"../webgl-engine/lib/glUtil3D.js\";\nimport { GridLocalOriginFactory as L } from \"../webgl-engine/lib/GridLocalOriginFactory.js\";\nimport { RenderOccludedFlag as B } from \"../webgl-engine/lib/Material.js\";\nimport { OverlayRenderContext as H } from \"../webgl-engine/lib/RenderContext.js\";\nimport { RenderSlot as I } from \"../webgl-engine/lib/RenderSlot.js\";\nimport { ShadowMap as N } from \"../webgl-engine/lib/ShadowMap.js\";\nimport { SortedRenderGeometryRenderer as G } from \"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";\nimport { SSAOHelper as k } from \"../webgl-engine/lib/SSAOHelper.js\";\nimport { TextureTechnique as z } from \"../webgl-engine/lib/TextureTechnique.js\";\nimport { TextureTechniqueConfiguration as Y } from \"../webgl-engine/lib/TextureTechniqueConfiguration.js\";\nimport { TransparencyPassType as X } from \"../webgl-engine/lib/TransparencyPassType.js\";\nimport { UpdatePolicy as J } from \"../webgl-engine/lib/UpdatePolicy.js\";\nimport { AmbientLight as K } from \"../webgl-engine/lighting/Lightsources.js\";\nimport { StippleTextureRepository as Q } from \"../webgl-engine/materials/StippleTextureRepository.js\";\nimport { TaskPriority as Z, noBudget as $ } from \"../../support/Scheduler.js\";\nimport { ClearBufferBit as ee, PrimitiveType as re, TextureType as te, PixelFormat as se, PixelType as ie, TextureSamplingMode as oe } from \"../../webgl/enums.js\";\nimport { Texture as ae } from \"../../webgl/Texture.js\";\nimport { vertexCount as ne } from \"../../webgl/Util.js\";\nlet he = class extends r {\n  get _bindParameters() {\n    return this._renderContext.bindParameters;\n  }\n  get rctx() {\n    return this._rctx;\n  }\n  get materialRepository() {\n    return this._materialRepository;\n  }\n  get screenToWorldRatio() {\n    return this._screenToWorldRatio;\n  }\n  get localOriginFactory() {\n    return this._localOriginFactory;\n  }\n  constructor(e) {\n    super(e), this._overlays = null, this._overlayRenderTarget = null, this._hasHighlights = !1, this._rendersOccluded = !1, this._hasWater = !1, this._handles = new s(), this._renderers = new Map(), this._sortedDrapeSourceRenderersDirty = !1, this._sortedRenderers = new c(), this._passParameters = new F(), this._rctx = null, this._materialRepository = null, this._screenToWorldRatio = 1, this._localOriginFactory = null, this._camera = new M(), this.worldToPCSRatio = 1, this.events = new t(), this.longitudeCyclical = null;\n  }\n  initialize() {\n    const e = this.view._stage.renderView;\n    this._rctx = e.renderingContext;\n    const r = e.waterTextureRepository;\n    this._stippleTextureRepository = new Q(e.renderingContext), this._shaderTechniqueRepository = new q({\n      rctx: this._rctx,\n      viewingMode: b.Local,\n      stippleTextureRepository: this._stippleTextureRepository,\n      waterTextureRepository: r\n    }), this._renderContext = new H(this._rctx, new N(this._rctx, this.view.state.viewingMode), new k(this.view, this._shaderTechniqueRepository, this._rctx, () => {})), this._handles.add([p(() => r.updating, () => this.events.emit(\"content-changed\"), u), p(() => this.spatialReference, e => this._localOriginFactory = new L(e), u), _(() => this.view.allLayerViews, \"after-changes\", () => this._sortedDrapeSourceRenderersDirty = !0)]), this._materialRepository = new U(e.textureRepository, this._shaderTechniqueRepository, e => {\n      (e.renderOccluded & pe) > 0 !== this._rendersOccluded && this._updateRendersOccluded(), this.events.emit(\"content-changed\"), this.notifyChange(\"updating\"), this.notifyChange(\"isEmpty\");\n    }, () => this.events.emit(\"content-changed\")), this._bindParameters.slot = I.DRAPED_MATERIAL, this._bindParameters.highlightDepthTexture = V(this._rctx), this._camera.near = 1, this._camera.far = 1e4, this._camera.relativeElevation = null, this._bindParameters.camera = this._camera, this._bindParameters.transparencyPassType = X.NONE, this._bindParameters.newLighting.noonFactor = 0, this._bindParameters.newLighting.globalFactor = 0, this._bindParameters.newLighting.set([new K(w(1, 1, 1))]), this._handles.add(this.view.resourceController.scheduler.registerTask(Z.STAGE, this));\n  }\n  destroy() {\n    this._handles.destroy(), this._renderers.forEach(e => e.destroy()), this._renderers.clear(), this._debugTextureTechnique = o(this._debugTextureTechnique), this._passParameters.texture = a(this._passParameters.texture), this._bindParameters.highlightDepthTexture = a(this._bindParameters.highlightDepthTexture), this._shaderTechniqueRepository = n(this._shaderTechniqueRepository), this._temporaryFBO = a(this._temporaryFBO), this._quadVAO = a(this._quadVAO), this.disposeOverlays();\n  }\n  get updating() {\n    return this._sortedDrapeSourceRenderersDirty || i(this._renderers, e => e.updating);\n  }\n  get hasOverlays() {\n    return h(this._overlays) && h(this._overlayRenderTarget);\n  }\n  get gpuMemoryUsage() {\n    return h(this._overlayRenderTarget) ? this._overlayRenderTarget.gpuMemoryUsage : 0;\n  }\n  createGeometryDrapeSourceRenderer(e) {\n    return this.createDrapeSourceRenderer(e, G);\n  }\n  createDrapeSourceRenderer(e, r, t) {\n    const s = this._renderers.get(e);\n    h(s) && s.destroy();\n    const i = new r({\n      ...t,\n      rendererContext: this,\n      drapeSource: e\n    });\n    return this._renderers.set(e, i), this._sortedDrapeSourceRenderersDirty = !0, \"fullOpacity\" in e && this._handles.add(p(() => e.fullOpacity, () => this.events.emit(\"content-changed\")), e), i;\n  }\n  removeDrapeSourceRenderer(e) {\n    if (d(e)) return;\n    const r = this._renderers.get(e);\n    d(r) || (this._sortedDrapeSourceRenderersDirty = !0, this._renderers.delete(e), this._handles.remove(e), r.destroy());\n  }\n  collectUnusedRenderTargetMemory(e) {\n    let r = !1;\n    if (h(this._overlayRenderTarget)) for (const t of this._overlayRenderTarget.renderTargets) {\n      const [s, i] = this.overlays,\n        o = s.validTargets[t.type] || !i.validTargets[t.type];\n      r = this._overlayRenderTarget.validateUsageForTarget(o, t, e) || r;\n    }\n    return r;\n  }\n  get overlays() {\n    return l(this._overlays, []);\n  }\n  ensureDrapeTargets(e) {\n    h(this._overlays) && this._overlays.forEach(r => r.hasTargetWithoutRasterImage = m(e, e => e.drapeTargetType === v.WithoutRasterImage));\n  }\n  ensureDrapeSources(e) {\n    h(this._overlays) && this._overlays.forEach(r => {\n      r.hasDrapedFeatureSource = m(e, e => e.drapeSourceType === x.Features), r.hasDrapedRasterSource = m(e, e => e.drapeSourceType === x.RasterImage);\n    });\n  }\n  ensureOverlays(e, r) {\n    d(this._overlays) && (this._overlayRenderTarget = new A(this._rctx), this._overlays = [new P(D.INNER, this._overlayRenderTarget), new P(D.OUTER, this._overlayRenderTarget)]), this.ensureDrapeTargets(e), this.ensureDrapeSources(r);\n  }\n  disposeOverlays() {\n    this._overlays = null, this._overlayRenderTarget = a(this._overlayRenderTarget), this.events.emit(\"textures-disposed\");\n  }\n  get running() {\n    return this.updating;\n  }\n  runTask(e) {\n    this._processDrapeSources(e, () => !0);\n  }\n  _processDrapeSources(e, r) {\n    let t = !1;\n    for (const [s, i] of this._renderers) {\n      if (e.done) break;\n      (s.destroyed || r(s)) && i.commitChanges() && (t = !0, e.madeProgress());\n    }\n    this._sortedDrapeSourceRenderersDirty && (this._sortedDrapeSourceRenderersDirty = !1, t = !0, this._updateSortedDrapeSourceRenderers()), t && (h(this._overlays) && 0 === this._renderers.size && this.disposeOverlays(), this.notifyChange(\"updating\"), this.notifyChange(\"isEmpty\"), this.events.emit(\"content-changed\"), this._updateHasHighlights(), this._updateRendersOccluded(), this._updateHasWater());\n  }\n  processSyncDrapeSources() {\n    this._processDrapeSources($, e => e.updatePolicy === J.SYNC);\n  }\n  get isEmpty() {\n    return !S.OVERLAY_DRAW_DEBUG_TEXTURE && !i(this._renderers, e => !e.isEmpty);\n  }\n  get hasHighlights() {\n    return this._hasHighlights;\n  }\n  get hasWater() {\n    return this._hasWater;\n  }\n  get rendersOccluded() {\n    return this._rendersOccluded;\n  }\n  updateAnimation(e) {\n    let r = !1;\n    return this._renderers.forEach(t => r = t.updateAnimation(e) || r), r;\n  }\n  updateDrapeSourceOrder() {\n    this._sortedDrapeSourceRenderersDirty = !0;\n  }\n  drawTarget(e, r, t) {\n    const s = e.canvasGeometries;\n    if (0 === s.numViews) return !1;\n    this._screenToWorldRatio = t * e.mapUnitsPerPixel;\n    const i = r.output;\n    if (this.isEmpty || i === C.Highlight && !this.hasHighlights || i === C.Normal && !this.hasWater || !e.hasSomeSizedView()) return !1;\n    const o = r.fbo;\n    if (!o.isValid()) return !1;\n    const a = 2 * e.resolution,\n      n = e.resolution;\n    o.resize(a, n);\n    const d = this._rctx;\n    if (this._camera.pixelRatio = e.pixelRatio * t, this._renderContext.output = i, this._bindParameters.screenToWorldRatio = this._screenToWorldRatio, this._bindParameters.screenToPCSRatio = this._screenToWorldRatio * this.worldToPCSRatio, this._bindParameters.slot = i === C.Normal ? I.DRAPED_WATER : I.DRAPED_MATERIAL, e.applyViewport(this._rctx), o.bind(d), e.index === D.INNER && (d.setClearColor(0, 0, 0, 0), d.clearSafe(ee.COLOR_BUFFER_BIT)), r.type === j.Occluded && (this._renderContext.renderOccludedMask = pe), S.OVERLAY_DRAW_DEBUG_TEXTURE && r.type !== j.Occluded) for (let h = 0; h < s.numViews; h++) this._setViewParameters(s.extents[h], e), this._drawDebugTexture(e.resolution, le[e.index]);\n    return this._renderers.size > 0 && this._sortedRenderers.forAll(_ref => {\n      let {\n        drapeSource: t,\n        renderer: l\n      } = _ref;\n      if (r.type === j.ColorNoRasterImage && t.drapeSourceType === x.RasterImage) return;\n      const {\n          fullOpacity: c\n        } = t,\n        p = h(c) && c < 1 && i === C.Color;\n      p && (this.bindTemporaryFramebuffer(this._rctx, a, n), d.clearSafe(ee.COLOR_BUFFER_BIT));\n      for (let r = 0; r < s.numViews; r++) this._setViewParameters(s.extents[r], e), l.render(this._renderContext);\n      p && h(this._temporaryFBO) && (o.bind(d), this.view._stage.renderView.compositingHelper.compositeOverlay(this._renderContext.bindParameters, this._temporaryFBO.getTexture(), c, e.index));\n    }), d.bindFramebuffer(null), o.generateMipMap(), this._renderContext.resetRenderOccludedMask(), !0;\n  }\n  bindTemporaryFramebuffer(e, r, t) {\n    d(this._temporaryFBO) && (this._temporaryFBO = new E(e, !1)), this._temporaryFBO.resize(r, t), this._temporaryFBO.bind(e);\n  }\n  async reloadShaders() {\n    await this._shaderTechniqueRepository.reloadAll();\n  }\n  notifyContentChanged() {\n    this.events.emit(\"content-changed\");\n  }\n  intersect(e, r, t, s) {\n    let i = 0;\n    for (const o of this._renderers.values()) i = o.intersect?.(e, r, t, s, i) ?? i;\n  }\n  _updateSortedDrapeSourceRenderers() {\n    if (this._sortedRenderers.clear(), 0 === this._renderers.size) return;\n    const e = this.view.map.allLayers;\n    this._renderers.forEach((r, t) => {\n      const s = e.indexOf(t.layer),\n        i = s >= 0,\n        o = this._renderers.size * (t.renderGroup ?? (i ? O.MapLayer : O.ViewLayer)) + (i ? s : 0);\n      this._sortedRenderers.push(new de(t, r, o));\n    }), this._sortedRenderers.sort((e, r) => e.index - r.index);\n  }\n  _setViewParameters(e, r) {\n    const t = this._camera;\n    t.viewport = [0, 0, r.resolution, r.resolution], R(t.projectionMatrix, 0, e[2] - e[0], 0, e[3] - e[1], t.near, t.far), T(t.viewMatrix, [-e[0], -e[1], 0]);\n  }\n  _updateHasWater() {\n    const e = i(this._renderers, e => e.hasWater);\n    e !== this._hasWater && (this._hasWater = e, this.events.emit(\"has-water\", e));\n  }\n  _updateHasHighlights() {\n    const e = i(this._renderers, e => e.hasHighlights);\n    e !== this._hasHighlights && (this._hasHighlights = e, this.events.emit(\"has-highlights\", e));\n  }\n  _updateRendersOccluded() {\n    const e = i(this._renderers, e => e.rendersOccluded);\n    e !== this._rendersOccluded && (this._rendersOccluded = e, this.events.emit(\"renders-occluded\", e));\n  }\n  _drawDebugTexture(e, r) {\n    this._ensureDebugPatternResources(e, e, r);\n    const t = this._rctx;\n    t.bindTechnique(this._debugTextureTechnique, this._passParameters, null), t.bindVAO(this._quadVAO), t.drawArrays(re.TRIANGLE_STRIP, 0, ne(this._quadVAO, \"geometry\"));\n  }\n  _ensureDebugPatternResources(e, r, t) {\n    if (f(this._passParameters.color, t[0], t[1], t[2]), this._passParameters.texture) return;\n    const s = new Uint8Array(e * r * 4);\n    let i = 0;\n    for (let a = 0; a < r; a++) for (let t = 0; t < e; t++) {\n      const o = Math.floor(t / 10),\n        n = Math.floor(a / 10);\n      o < 2 || n < 2 || 10 * o > e - 20 || 10 * n > r - 20 ? (s[i++] = 255, s[i++] = 255, s[i++] = 255, s[i++] = 255) : (s[i++] = 255, s[i++] = 255, s[i++] = 255, s[i++] = 1 & o && 1 & n ? 1 & t ^ 1 & a ? 0 : 255 : 1 & o ^ 1 & n ? 0 : 128);\n    }\n    this._passParameters.texture = new ae(this._rctx, {\n      target: te.TEXTURE_2D,\n      pixelFormat: se.RGBA,\n      dataType: ie.UNSIGNED_BYTE,\n      samplingMode: oe.NEAREST,\n      width: e,\n      height: r\n    }, s);\n    const o = new Y();\n    o.hasAlpha = !0, this._debugTextureTechnique = this._shaderTechniqueRepository.acquire(z, o), this._quadVAO = W(this._rctx);\n  }\n  get test() {\n    return {\n      drapedRenderers: Array.from(this._renderers.values()),\n      getDrapeSourceRenderer: e => this._renderers.get(e)\n    };\n  }\n};\ne([g()], he.prototype, \"_sortedDrapeSourceRenderersDirty\", void 0), e([g({\n  autoDestroy: !0\n})], he.prototype, \"_shaderTechniqueRepository\", void 0), e([g({\n  autoDestroy: !0\n})], he.prototype, \"_stippleTextureRepository\", void 0), e([g({\n  constructOnly: !0\n})], he.prototype, \"view\", void 0), e([g()], he.prototype, \"worldToPCSRatio\", void 0), e([g()], he.prototype, \"spatialReference\", void 0), e([g({\n  type: Boolean,\n  readOnly: !0\n})], he.prototype, \"updating\", null), e([g()], he.prototype, \"isEmpty\", null), he = e([y(\"esri.views.3d.terrain.OverlayRenderer\")], he);\nclass de {\n  constructor(e, r, t) {\n    this.drapeSource = e, this.renderer = r, this.index = t;\n  }\n}\nconst le = [[1, .5, .5], [.5, .5, 1]],\n  ce = -2,\n  pe = B.OccludeAndTransparent;\nexport { ce as DRAPED_Z, he as OverlayRenderer, pe as overlayRenderOccludedFlag };","map":{"version":3,"names":["_","e","r","t","s","someMap","i","releaseMaybe","o","disposeMaybe","a","destroyMaybe","n","isSome","h","isNone","d","unwrapOr","l","c","watch","p","syncAndInitial","u","on","someSet","m","property","g","subclass","y","x","R","f","T","w","ViewingMode","b","DrapeTargetType","v","DrapeSourceType","DrapedRenderGroup","O","S","OverlayIndex","D","RenderTargetType","j","Overlay","P","OverlayFramebufferObject","E","OverlayRenderTarget","A","ShaderOutput","C","F","ShaderTechniqueRepository","q","Camera","M","GLMaterialRepository","U","createEmptyDepthTexture","V","createQuadVAO","W","GridLocalOriginFactory","L","RenderOccludedFlag","B","OverlayRenderContext","H","RenderSlot","I","ShadowMap","N","SortedRenderGeometryRenderer","G","SSAOHelper","k","TextureTechnique","z","TextureTechniqueConfiguration","Y","TransparencyPassType","X","UpdatePolicy","J","AmbientLight","K","StippleTextureRepository","Q","TaskPriority","Z","noBudget","$","ClearBufferBit","ee","PrimitiveType","re","TextureType","te","PixelFormat","se","PixelType","ie","TextureSamplingMode","oe","Texture","ae","vertexCount","ne","he","_bindParameters","_renderContext","bindParameters","rctx","_rctx","materialRepository","_materialRepository","screenToWorldRatio","_screenToWorldRatio","localOriginFactory","_localOriginFactory","constructor","_overlays","_overlayRenderTarget","_hasHighlights","_rendersOccluded","_hasWater","_handles","_renderers","Map","_sortedDrapeSourceRenderersDirty","_sortedRenderers","_passParameters","_camera","worldToPCSRatio","events","longitudeCyclical","initialize","view","_stage","renderView","renderingContext","waterTextureRepository","_stippleTextureRepository","_shaderTechniqueRepository","viewingMode","Local","stippleTextureRepository","state","add","updating","emit","spatialReference","allLayerViews","textureRepository","renderOccluded","pe","_updateRendersOccluded","notifyChange","slot","DRAPED_MATERIAL","highlightDepthTexture","near","far","relativeElevation","camera","transparencyPassType","NONE","newLighting","noonFactor","globalFactor","set","resourceController","scheduler","registerTask","STAGE","destroy","forEach","clear","_debugTextureTechnique","texture","_temporaryFBO","_quadVAO","disposeOverlays","hasOverlays","gpuMemoryUsage","createGeometryDrapeSourceRenderer","createDrapeSourceRenderer","get","rendererContext","drapeSource","fullOpacity","removeDrapeSourceRenderer","delete","remove","collectUnusedRenderTargetMemory","renderTargets","overlays","validTargets","type","validateUsageForTarget","ensureDrapeTargets","hasTargetWithoutRasterImage","drapeTargetType","WithoutRasterImage","ensureDrapeSources","hasDrapedFeatureSource","drapeSourceType","Features","hasDrapedRasterSource","RasterImage","ensureOverlays","INNER","OUTER","running","runTask","_processDrapeSources","done","destroyed","commitChanges","madeProgress","_updateSortedDrapeSourceRenderers","size","_updateHasHighlights","_updateHasWater","processSyncDrapeSources","updatePolicy","SYNC","isEmpty","OVERLAY_DRAW_DEBUG_TEXTURE","hasHighlights","hasWater","rendersOccluded","updateAnimation","updateDrapeSourceOrder","drawTarget","canvasGeometries","numViews","mapUnitsPerPixel","output","Highlight","Normal","hasSomeSizedView","fbo","isValid","resolution","resize","pixelRatio","screenToPCSRatio","DRAPED_WATER","applyViewport","bind","index","setClearColor","clearSafe","COLOR_BUFFER_BIT","Occluded","renderOccludedMask","_setViewParameters","extents","_drawDebugTexture","le","forAll","_ref","renderer","ColorNoRasterImage","Color","bindTemporaryFramebuffer","render","compositingHelper","compositeOverlay","getTexture","bindFramebuffer","generateMipMap","resetRenderOccludedMask","reloadShaders","reloadAll","notifyContentChanged","intersect","values","map","allLayers","indexOf","layer","renderGroup","MapLayer","ViewLayer","push","de","sort","viewport","projectionMatrix","viewMatrix","_ensureDebugPatternResources","bindTechnique","bindVAO","drawArrays","TRIANGLE_STRIP","color","Uint8Array","Math","floor","target","TEXTURE_2D","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","samplingMode","NEAREST","width","height","hasAlpha","acquire","test","drapedRenderers","Array","from","getDrapeSourceRenderer","prototype","autoDestroy","constructOnly","Boolean","readOnly","ce","OccludeAndTransparent","DRAPED_Z","OverlayRenderer","overlayRenderOccludedFlag"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Accessor.js\";import t from\"../../../core/Evented.js\";import s from\"../../../core/Handles.js\";import{someMap as i}from\"../../../core/MapUtils.js\";import{releaseMaybe as o,disposeMaybe as a,destroyMaybe as n,isSome as h,isNone as d,unwrapOr as l}from\"../../../core/maybe.js\";import c from\"../../../core/PooledArray.js\";import{watch as p,syncAndInitial as u,on as _}from\"../../../core/reactiveUtils.js\";import{someSet as m}from\"../../../core/SetUtils.js\";import{property as g}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import{x as R,f as T}from\"../../../chunks/mat4.js\";import{s as f}from\"../../../chunks/vec3.js\";import{f as w}from\"../../../chunks/vec3f64.js\";import{ViewingMode as b}from\"../../ViewingMode.js\";import{DrapeTargetType as v,DrapeSourceType as x,DrapedRenderGroup as O}from\"../layers/interfaces.js\";import S from\"../support/debugFlags.js\";import{OverlayIndex as D,RenderTargetType as j}from\"./interfaces.js\";import{Overlay as P}from\"./Overlay.js\";import{OverlayFramebufferObject as E}from\"./OverlayFramebufferObject.js\";import{OverlayRenderTarget as A}from\"./OverlayRenderTarget.js\";import{ShaderOutput as C}from\"../webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{T as F}from\"../../../chunks/TextureOnly.glsl.js\";import{ShaderTechniqueRepository as q}from\"../webgl-engine/core/shaderTechnique/ShaderTechniqueRepository.js\";import{Camera as M}from\"../webgl-engine/lib/Camera.js\";import{GLMaterialRepository as U}from\"../webgl-engine/lib/GLMaterialRepository.js\";import{createEmptyDepthTexture as V,createQuadVAO as W}from\"../webgl-engine/lib/glUtil3D.js\";import{GridLocalOriginFactory as L}from\"../webgl-engine/lib/GridLocalOriginFactory.js\";import{RenderOccludedFlag as B}from\"../webgl-engine/lib/Material.js\";import{OverlayRenderContext as H}from\"../webgl-engine/lib/RenderContext.js\";import{RenderSlot as I}from\"../webgl-engine/lib/RenderSlot.js\";import{ShadowMap as N}from\"../webgl-engine/lib/ShadowMap.js\";import{SortedRenderGeometryRenderer as G}from\"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";import{SSAOHelper as k}from\"../webgl-engine/lib/SSAOHelper.js\";import{TextureTechnique as z}from\"../webgl-engine/lib/TextureTechnique.js\";import{TextureTechniqueConfiguration as Y}from\"../webgl-engine/lib/TextureTechniqueConfiguration.js\";import{TransparencyPassType as X}from\"../webgl-engine/lib/TransparencyPassType.js\";import{UpdatePolicy as J}from\"../webgl-engine/lib/UpdatePolicy.js\";import{AmbientLight as K}from\"../webgl-engine/lighting/Lightsources.js\";import{StippleTextureRepository as Q}from\"../webgl-engine/materials/StippleTextureRepository.js\";import{TaskPriority as Z,noBudget as $}from\"../../support/Scheduler.js\";import{ClearBufferBit as ee,PrimitiveType as re,TextureType as te,PixelFormat as se,PixelType as ie,TextureSamplingMode as oe}from\"../../webgl/enums.js\";import{Texture as ae}from\"../../webgl/Texture.js\";import{vertexCount as ne}from\"../../webgl/Util.js\";let he=class extends r{get _bindParameters(){return this._renderContext.bindParameters}get rctx(){return this._rctx}get materialRepository(){return this._materialRepository}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}constructor(e){super(e),this._overlays=null,this._overlayRenderTarget=null,this._hasHighlights=!1,this._rendersOccluded=!1,this._hasWater=!1,this._handles=new s,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new c,this._passParameters=new F,this._rctx=null,this._materialRepository=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this._camera=new M,this.worldToPCSRatio=1,this.events=new t,this.longitudeCyclical=null}initialize(){const e=this.view._stage.renderView;this._rctx=e.renderingContext;const r=e.waterTextureRepository;this._stippleTextureRepository=new Q(e.renderingContext),this._shaderTechniqueRepository=new q({rctx:this._rctx,viewingMode:b.Local,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:r}),this._renderContext=new H(this._rctx,new N(this._rctx,this.view.state.viewingMode),new k(this.view,this._shaderTechniqueRepository,this._rctx,(()=>{}))),this._handles.add([p((()=>r.updating),(()=>this.events.emit(\"content-changed\")),u),p((()=>this.spatialReference),(e=>this._localOriginFactory=new L(e)),u),_((()=>this.view.allLayerViews),\"after-changes\",(()=>this._sortedDrapeSourceRenderersDirty=!0))]),this._materialRepository=new U(e.textureRepository,this._shaderTechniqueRepository,(e=>{(e.renderOccluded&pe)>0!==this._rendersOccluded&&this._updateRendersOccluded(),this.events.emit(\"content-changed\"),this.notifyChange(\"updating\"),this.notifyChange(\"isEmpty\")}),(()=>this.events.emit(\"content-changed\"))),this._bindParameters.slot=I.DRAPED_MATERIAL,this._bindParameters.highlightDepthTexture=V(this._rctx),this._camera.near=1,this._camera.far=1e4,this._camera.relativeElevation=null,this._bindParameters.camera=this._camera,this._bindParameters.transparencyPassType=X.NONE,this._bindParameters.newLighting.noonFactor=0,this._bindParameters.newLighting.globalFactor=0,this._bindParameters.newLighting.set([new K(w(1,1,1))]),this._handles.add(this.view.resourceController.scheduler.registerTask(Z.STAGE,this))}destroy(){this._handles.destroy(),this._renderers.forEach((e=>e.destroy())),this._renderers.clear(),this._debugTextureTechnique=o(this._debugTextureTechnique),this._passParameters.texture=a(this._passParameters.texture),this._bindParameters.highlightDepthTexture=a(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=n(this._shaderTechniqueRepository),this._temporaryFBO=a(this._temporaryFBO),this._quadVAO=a(this._quadVAO),this.disposeOverlays()}get updating(){return this._sortedDrapeSourceRenderersDirty||i(this._renderers,(e=>e.updating))}get hasOverlays(){return h(this._overlays)&&h(this._overlayRenderTarget)}get gpuMemoryUsage(){return h(this._overlayRenderTarget)?this._overlayRenderTarget.gpuMemoryUsage:0}createGeometryDrapeSourceRenderer(e){return this.createDrapeSourceRenderer(e,G)}createDrapeSourceRenderer(e,r,t){const s=this._renderers.get(e);h(s)&&s.destroy();const i=new r({...t,rendererContext:this,drapeSource:e});return this._renderers.set(e,i),this._sortedDrapeSourceRenderersDirty=!0,\"fullOpacity\"in e&&this._handles.add(p((()=>e.fullOpacity),(()=>this.events.emit(\"content-changed\"))),e),i}removeDrapeSourceRenderer(e){if(d(e))return;const r=this._renderers.get(e);d(r)||(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(e),this._handles.remove(e),r.destroy())}collectUnusedRenderTargetMemory(e){let r=!1;if(h(this._overlayRenderTarget))for(const t of this._overlayRenderTarget.renderTargets){const[s,i]=this.overlays,o=s.validTargets[t.type]||!i.validTargets[t.type];r=this._overlayRenderTarget.validateUsageForTarget(o,t,e)||r}return r}get overlays(){return l(this._overlays,[])}ensureDrapeTargets(e){h(this._overlays)&&this._overlays.forEach((r=>r.hasTargetWithoutRasterImage=m(e,(e=>e.drapeTargetType===v.WithoutRasterImage))))}ensureDrapeSources(e){h(this._overlays)&&this._overlays.forEach((r=>{r.hasDrapedFeatureSource=m(e,(e=>e.drapeSourceType===x.Features)),r.hasDrapedRasterSource=m(e,(e=>e.drapeSourceType===x.RasterImage))}))}ensureOverlays(e,r){d(this._overlays)&&(this._overlayRenderTarget=new A(this._rctx),this._overlays=[new P(D.INNER,this._overlayRenderTarget),new P(D.OUTER,this._overlayRenderTarget)]),this.ensureDrapeTargets(e),this.ensureDrapeSources(r)}disposeOverlays(){this._overlays=null,this._overlayRenderTarget=a(this._overlayRenderTarget),this.events.emit(\"textures-disposed\")}get running(){return this.updating}runTask(e){this._processDrapeSources(e,(()=>!0))}_processDrapeSources(e,r){let t=!1;for(const[s,i]of this._renderers){if(e.done)break;(s.destroyed||r(s))&&(i.commitChanges()&&(t=!0,e.madeProgress()))}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,t=!0,this._updateSortedDrapeSourceRenderers()),t&&(h(this._overlays)&&0===this._renderers.size&&this.disposeOverlays(),this.notifyChange(\"updating\"),this.notifyChange(\"isEmpty\"),this.events.emit(\"content-changed\"),this._updateHasHighlights(),this._updateRendersOccluded(),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources($,(e=>e.updatePolicy===J.SYNC))}get isEmpty(){return!S.OVERLAY_DRAW_DEBUG_TEXTURE&&!i(this._renderers,(e=>!e.isEmpty))}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return this._rendersOccluded}updateAnimation(e){let r=!1;return this._renderers.forEach((t=>r=t.updateAnimation(e)||r)),r}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}drawTarget(e,r,t){const s=e.canvasGeometries;if(0===s.numViews)return!1;this._screenToWorldRatio=t*e.mapUnitsPerPixel;const i=r.output;if(this.isEmpty||i===C.Highlight&&!this.hasHighlights||i===C.Normal&&!this.hasWater||!e.hasSomeSizedView())return!1;const o=r.fbo;if(!o.isValid())return!1;const a=2*e.resolution,n=e.resolution;o.resize(a,n);const d=this._rctx;if(this._camera.pixelRatio=e.pixelRatio*t,this._renderContext.output=i,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,this._bindParameters.slot=i===C.Normal?I.DRAPED_WATER:I.DRAPED_MATERIAL,e.applyViewport(this._rctx),o.bind(d),e.index===D.INNER&&(d.setClearColor(0,0,0,0),d.clearSafe(ee.COLOR_BUFFER_BIT)),r.type===j.Occluded&&(this._renderContext.renderOccludedMask=pe),S.OVERLAY_DRAW_DEBUG_TEXTURE&&r.type!==j.Occluded)for(let h=0;h<s.numViews;h++)this._setViewParameters(s.extents[h],e),this._drawDebugTexture(e.resolution,le[e.index]);return this._renderers.size>0&&this._sortedRenderers.forAll((({drapeSource:t,renderer:l})=>{if(r.type===j.ColorNoRasterImage&&t.drapeSourceType===x.RasterImage)return;const{fullOpacity:c}=t,p=h(c)&&c<1&&i===C.Color;p&&(this.bindTemporaryFramebuffer(this._rctx,a,n),d.clearSafe(ee.COLOR_BUFFER_BIT));for(let r=0;r<s.numViews;r++)this._setViewParameters(s.extents[r],e),l.render(this._renderContext);p&&h(this._temporaryFBO)&&(o.bind(d),this.view._stage.renderView.compositingHelper.compositeOverlay(this._renderContext.bindParameters,this._temporaryFBO.getTexture(),c,e.index))})),d.bindFramebuffer(null),o.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}bindTemporaryFramebuffer(e,r,t){d(this._temporaryFBO)&&(this._temporaryFBO=new E(e,!1)),this._temporaryFBO.resize(r,t),this._temporaryFBO.bind(e)}async reloadShaders(){await this._shaderTechniqueRepository.reloadAll()}notifyContentChanged(){this.events.emit(\"content-changed\")}intersect(e,r,t,s){let i=0;for(const o of this._renderers.values())i=o.intersect?.(e,r,t,s,i)??i}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),0===this._renderers.size)return;const e=this.view.map.allLayers;this._renderers.forEach(((r,t)=>{const s=e.indexOf(t.layer),i=s>=0,o=this._renderers.size*(t.renderGroup??(i?O.MapLayer:O.ViewLayer))+(i?s:0);this._sortedRenderers.push(new de(t,r,o))})),this._sortedRenderers.sort(((e,r)=>e.index-r.index))}_setViewParameters(e,r){const t=this._camera;t.viewport=[0,0,r.resolution,r.resolution],R(t.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],t.near,t.far),T(t.viewMatrix,[-e[0],-e[1],0])}_updateHasWater(){const e=i(this._renderers,(e=>e.hasWater));e!==this._hasWater&&(this._hasWater=e,this.events.emit(\"has-water\",e))}_updateHasHighlights(){const e=i(this._renderers,(e=>e.hasHighlights));e!==this._hasHighlights&&(this._hasHighlights=e,this.events.emit(\"has-highlights\",e))}_updateRendersOccluded(){const e=i(this._renderers,(e=>e.rendersOccluded));e!==this._rendersOccluded&&(this._rendersOccluded=e,this.events.emit(\"renders-occluded\",e))}_drawDebugTexture(e,r){this._ensureDebugPatternResources(e,e,r);const t=this._rctx;t.bindTechnique(this._debugTextureTechnique,this._passParameters,null),t.bindVAO(this._quadVAO),t.drawArrays(re.TRIANGLE_STRIP,0,ne(this._quadVAO,\"geometry\"))}_ensureDebugPatternResources(e,r,t){if(f(this._passParameters.color,t[0],t[1],t[2]),this._passParameters.texture)return;const s=new Uint8Array(e*r*4);let i=0;for(let a=0;a<r;a++)for(let t=0;t<e;t++){const o=Math.floor(t/10),n=Math.floor(a/10);o<2||n<2||10*o>e-20||10*n>r-20?(s[i++]=255,s[i++]=255,s[i++]=255,s[i++]=255):(s[i++]=255,s[i++]=255,s[i++]=255,s[i++]=1&o&&1&n?1&t^1&a?0:255:1&o^1&n?0:128)}this._passParameters.texture=new ae(this._rctx,{target:te.TEXTURE_2D,pixelFormat:se.RGBA,dataType:ie.UNSIGNED_BYTE,samplingMode:oe.NEAREST,width:e,height:r},s);const o=new Y;o.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquire(z,o),this._quadVAO=W(this._rctx)}get test(){return{drapedRenderers:Array.from(this._renderers.values()),getDrapeSourceRenderer:e=>this._renderers.get(e)}}};e([g()],he.prototype,\"_sortedDrapeSourceRenderersDirty\",void 0),e([g({autoDestroy:!0})],he.prototype,\"_shaderTechniqueRepository\",void 0),e([g({autoDestroy:!0})],he.prototype,\"_stippleTextureRepository\",void 0),e([g({constructOnly:!0})],he.prototype,\"view\",void 0),e([g()],he.prototype,\"worldToPCSRatio\",void 0),e([g()],he.prototype,\"spatialReference\",void 0),e([g({type:Boolean,readOnly:!0})],he.prototype,\"updating\",null),e([g()],he.prototype,\"isEmpty\",null),he=e([y(\"esri.views.3d.terrain.OverlayRenderer\")],he);class de{constructor(e,r,t){this.drapeSource=e,this.renderer=r,this.index=t}}const le=[[1,.5,.5],[.5,.5,1]],ce=-2,pe=B.OccludeAndTransparent;export{ce as DRAPED_Z,he as OverlayRenderer,pe as overlayRenderOccludedFlag};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAC,QAAK,8BAA8B;AAAC,OAAOC,CAAC,MAAK,2BAA2B;AAAC,OAAOC,CAAC,MAAK,0BAA0B;AAAC,OAAOC,CAAC,MAAK,0BAA0B;AAAC,SAAOC,OAAO,IAAIC,CAAC,QAAK,2BAA2B;AAAC,SAAOC,YAAY,IAAIC,CAAC,EAACC,YAAY,IAAIC,CAAC,EAACC,YAAY,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,EAACC,QAAQ,IAAIC,CAAC,QAAK,wBAAwB;AAAC,OAAOC,CAAC,MAAK,8BAA8B;AAAC,SAAOC,KAAK,IAAIC,CAAC,EAACC,cAAc,IAAIC,CAAC,EAACC,EAAE,IAAIxB,CAAC,QAAK,gCAAgC;AAAC,SAAOyB,OAAO,IAAIC,CAAC,QAAK,2BAA2B;AAAC,SAAOC,QAAQ,IAAIC,CAAC,QAAK,sDAAsD;AAAC,OAAM,6CAA6C;AAAC,OAAM,6BAA6B;AAAC,SAAOC,QAAQ,IAAIC,CAAC,QAAK,sDAAsD;AAAC,SAAOC,CAAC,IAAIC,CAAC,EAACC,CAAC,IAAIC,CAAC,QAAK,yBAAyB;AAAC,SAAO9B,CAAC,IAAI6B,CAAC,QAAK,yBAAyB;AAAC,SAAOA,CAAC,IAAIE,CAAC,QAAK,4BAA4B;AAAC,SAAOC,WAAW,IAAIC,CAAC,QAAK,sBAAsB;AAAC,SAAOC,eAAe,IAAIC,CAAC,EAACC,eAAe,IAAIT,CAAC,EAACU,iBAAiB,IAAIC,CAAC,QAAK,yBAAyB;AAAC,OAAOC,CAAC,MAAK,0BAA0B;AAAC,SAAOC,YAAY,IAAIC,CAAC,EAACC,gBAAgB,IAAIC,CAAC,QAAK,iBAAiB;AAAC,SAAOC,OAAO,IAAIC,CAAC,QAAK,cAAc;AAAC,SAAOC,wBAAwB,IAAIC,CAAC,QAAK,+BAA+B;AAAC,SAAOC,mBAAmB,IAAIC,CAAC,QAAK,0BAA0B;AAAC,SAAOC,YAAY,IAAIC,CAAC,QAAK,oDAAoD;AAAC,SAAOrB,CAAC,IAAIsB,CAAC,QAAK,qCAAqC;AAAC,SAAOC,yBAAyB,IAAIC,CAAC,QAAK,mEAAmE;AAAC,SAAOC,MAAM,IAAIC,CAAC,QAAK,+BAA+B;AAAC,SAAOC,oBAAoB,IAAIC,CAAC,QAAK,6CAA6C;AAAC,SAAOC,uBAAuB,IAAIC,CAAC,EAACC,aAAa,IAAIC,CAAC,QAAK,iCAAiC;AAAC,SAAOC,sBAAsB,IAAIC,CAAC,QAAK,+CAA+C;AAAC,SAAOC,kBAAkB,IAAIC,CAAC,QAAK,iCAAiC;AAAC,SAAOC,oBAAoB,IAAIC,CAAC,QAAK,sCAAsC;AAAC,SAAOC,UAAU,IAAIC,CAAC,QAAK,mCAAmC;AAAC,SAAOC,SAAS,IAAIC,CAAC,QAAK,kCAAkC;AAAC,SAAOC,4BAA4B,IAAIC,CAAC,QAAK,qDAAqD;AAAC,SAAOC,UAAU,IAAIC,CAAC,QAAK,mCAAmC;AAAC,SAAOC,gBAAgB,IAAIC,CAAC,QAAK,yCAAyC;AAAC,SAAOC,6BAA6B,IAAIC,CAAC,QAAK,sDAAsD;AAAC,SAAOC,oBAAoB,IAAIC,CAAC,QAAK,6CAA6C;AAAC,SAAOC,YAAY,IAAIC,CAAC,QAAK,qCAAqC;AAAC,SAAOC,YAAY,IAAIC,CAAC,QAAK,0CAA0C;AAAC,SAAOC,wBAAwB,IAAIC,CAAC,QAAK,uDAAuD;AAAC,SAAOC,YAAY,IAAIC,CAAC,EAACC,QAAQ,IAAIC,CAAC,QAAK,4BAA4B;AAAC,SAAOC,cAAc,IAAIC,EAAE,EAACC,aAAa,IAAIC,EAAE,EAACC,WAAW,IAAIC,EAAE,EAACC,WAAW,IAAIC,EAAE,EAACC,SAAS,IAAIC,EAAE,EAACC,mBAAmB,IAAIC,EAAE,QAAK,sBAAsB;AAAC,SAAOC,OAAO,IAAIC,EAAE,QAAK,wBAAwB;AAAC,SAAOC,WAAW,IAAIC,EAAE,QAAK,qBAAqB;AAAC,IAAIC,EAAE,GAAC,cAAc/G,CAAC;EAAC,IAAIgH,eAAeA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACC,cAAc,CAACC,cAAc;EAAA;EAAC,IAAIC,IAAIA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACC,KAAK;EAAA;EAAC,IAAIC,kBAAkBA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACC,mBAAmB;EAAA;EAAC,IAAIC,kBAAkBA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACC,mBAAmB;EAAA;EAAC,IAAIC,kBAAkBA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACC,mBAAmB;EAAA;EAACC,WAAWA,CAAC5H,CAAC,EAAC;IAAC,KAAK,CAACA,CAAC,CAAC,EAAC,IAAI,CAAC6H,SAAS,GAAC,IAAI,EAAC,IAAI,CAACC,oBAAoB,GAAC,IAAI,EAAC,IAAI,CAACC,cAAc,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,gBAAgB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,SAAS,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,QAAQ,GAAC,IAAI/H,CAAC,IAAC,IAAI,CAACgI,UAAU,GAAC,IAAIC,GAAG,IAAC,IAAI,CAACC,gCAAgC,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,gBAAgB,GAAC,IAAIpH,CAAC,IAAC,IAAI,CAACqH,eAAe,GAAC,IAAIhF,CAAC,IAAC,IAAI,CAAC8D,KAAK,GAAC,IAAI,EAAC,IAAI,CAACE,mBAAmB,GAAC,IAAI,EAAC,IAAI,CAACE,mBAAmB,GAAC,CAAC,EAAC,IAAI,CAACE,mBAAmB,GAAC,IAAI,EAAC,IAAI,CAACa,OAAO,GAAC,IAAI7E,CAAC,IAAC,IAAI,CAAC8E,eAAe,GAAC,CAAC,EAAC,IAAI,CAACC,MAAM,GAAC,IAAIxI,CAAC,IAAC,IAAI,CAACyI,iBAAiB,GAAC,IAAI;EAAA;EAACC,UAAUA,CAAA,EAAE;IAAC,MAAM5I,CAAC,GAAC,IAAI,CAAC6I,IAAI,CAACC,MAAM,CAACC,UAAU;IAAC,IAAI,CAAC1B,KAAK,GAACrH,CAAC,CAACgJ,gBAAgB;IAAC,MAAM/I,CAAC,GAACD,CAAC,CAACiJ,sBAAsB;IAAC,IAAI,CAACC,yBAAyB,GAAC,IAAIvD,CAAC,CAAC3F,CAAC,CAACgJ,gBAAgB,CAAC,EAAC,IAAI,CAACG,0BAA0B,GAAC,IAAI1F,CAAC,CAAC;MAAC2D,IAAI,EAAC,IAAI,CAACC,KAAK;MAAC+B,WAAW,EAAChH,CAAC,CAACiH,KAAK;MAACC,wBAAwB,EAAC,IAAI,CAACJ,yBAAyB;MAACD,sBAAsB,EAAChJ;IAAC,CAAC,CAAC,EAAC,IAAI,CAACiH,cAAc,GAAC,IAAI3C,CAAC,CAAC,IAAI,CAAC8C,KAAK,EAAC,IAAI1C,CAAC,CAAC,IAAI,CAAC0C,KAAK,EAAC,IAAI,CAACwB,IAAI,CAACU,KAAK,CAACH,WAAW,CAAC,EAAC,IAAIrE,CAAC,CAAC,IAAI,CAAC8D,IAAI,EAAC,IAAI,CAACM,0BAA0B,EAAC,IAAI,CAAC9B,KAAK,EAAE,MAAI,CAAC,CAAC,CAAE,CAAC,EAAC,IAAI,CAACa,QAAQ,CAACsB,GAAG,CAAC,CAACpI,CAAC,CAAE,MAAInB,CAAC,CAACwJ,QAAQ,EAAG,MAAI,IAAI,CAACf,MAAM,CAACgB,IAAI,CAAC,iBAAiB,CAAC,EAAEpI,CAAC,CAAC,EAACF,CAAC,CAAE,MAAI,IAAI,CAACuI,gBAAgB,EAAG3J,CAAC,IAAE,IAAI,CAAC2H,mBAAmB,GAAC,IAAIxD,CAAC,CAACnE,CAAC,CAAC,EAAEsB,CAAC,CAAC,EAACvB,CAAC,CAAE,MAAI,IAAI,CAAC8I,IAAI,CAACe,aAAa,EAAE,eAAe,EAAE,MAAI,IAAI,CAACvB,gCAAgC,GAAC,CAAC,CAAC,CAAE,CAAC,CAAC,EAAC,IAAI,CAACd,mBAAmB,GAAC,IAAI1D,CAAC,CAAC7D,CAAC,CAAC6J,iBAAiB,EAAC,IAAI,CAACV,0BAA0B,EAAEnJ,CAAC,IAAE;MAAC,CAACA,CAAC,CAAC8J,cAAc,GAACC,EAAE,IAAE,CAAC,KAAG,IAAI,CAAC/B,gBAAgB,IAAE,IAAI,CAACgC,sBAAsB,EAAE,EAAC,IAAI,CAACtB,MAAM,CAACgB,IAAI,CAAC,iBAAiB,CAAC,EAAC,IAAI,CAACO,YAAY,CAAC,UAAU,CAAC,EAAC,IAAI,CAACA,YAAY,CAAC,SAAS,CAAC;IAAA,CAAC,EAAG,MAAI,IAAI,CAACvB,MAAM,CAACgB,IAAI,CAAC,iBAAiB,CAAC,CAAE,EAAC,IAAI,CAACzC,eAAe,CAACiD,IAAI,GAACzF,CAAC,CAAC0F,eAAe,EAAC,IAAI,CAAClD,eAAe,CAACmD,qBAAqB,GAACrG,CAAC,CAAC,IAAI,CAACsD,KAAK,CAAC,EAAC,IAAI,CAACmB,OAAO,CAAC6B,IAAI,GAAC,CAAC,EAAC,IAAI,CAAC7B,OAAO,CAAC8B,GAAG,GAAC,GAAG,EAAC,IAAI,CAAC9B,OAAO,CAAC+B,iBAAiB,GAAC,IAAI,EAAC,IAAI,CAACtD,eAAe,CAACuD,MAAM,GAAC,IAAI,CAAChC,OAAO,EAAC,IAAI,CAACvB,eAAe,CAACwD,oBAAoB,GAACpF,CAAC,CAACqF,IAAI,EAAC,IAAI,CAACzD,eAAe,CAAC0D,WAAW,CAACC,UAAU,GAAC,CAAC,EAAC,IAAI,CAAC3D,eAAe,CAAC0D,WAAW,CAACE,YAAY,GAAC,CAAC,EAAC,IAAI,CAAC5D,eAAe,CAAC0D,WAAW,CAACG,GAAG,CAAC,CAAC,IAAIrF,CAAC,CAACvD,CAAC,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAC,IAAI,CAACgG,QAAQ,CAACsB,GAAG,CAAC,IAAI,CAACX,IAAI,CAACkC,kBAAkB,CAACC,SAAS,CAACC,YAAY,CAACpF,CAAC,CAACqF,KAAK,EAAC,IAAI,CAAC,CAAC;EAAA;EAACC,OAAOA,CAAA,EAAE;IAAC,IAAI,CAACjD,QAAQ,CAACiD,OAAO,EAAE,EAAC,IAAI,CAAChD,UAAU,CAACiD,OAAO,CAAEpL,CAAC,IAAEA,CAAC,CAACmL,OAAO,EAAE,CAAE,EAAC,IAAI,CAAChD,UAAU,CAACkD,KAAK,EAAE,EAAC,IAAI,CAACC,sBAAsB,GAAC/K,CAAC,CAAC,IAAI,CAAC+K,sBAAsB,CAAC,EAAC,IAAI,CAAC/C,eAAe,CAACgD,OAAO,GAAC9K,CAAC,CAAC,IAAI,CAAC8H,eAAe,CAACgD,OAAO,CAAC,EAAC,IAAI,CAACtE,eAAe,CAACmD,qBAAqB,GAAC3J,CAAC,CAAC,IAAI,CAACwG,eAAe,CAACmD,qBAAqB,CAAC,EAAC,IAAI,CAACjB,0BAA0B,GAACxI,CAAC,CAAC,IAAI,CAACwI,0BAA0B,CAAC,EAAC,IAAI,CAACqC,aAAa,GAAC/K,CAAC,CAAC,IAAI,CAAC+K,aAAa,CAAC,EAAC,IAAI,CAACC,QAAQ,GAAChL,CAAC,CAAC,IAAI,CAACgL,QAAQ,CAAC,EAAC,IAAI,CAACC,eAAe,EAAE;EAAA;EAAC,IAAIjC,QAAQA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACpB,gCAAgC,IAAEhI,CAAC,CAAC,IAAI,CAAC8H,UAAU,EAAEnI,CAAC,IAAEA,CAAC,CAACyJ,QAAQ,CAAE;EAAA;EAAC,IAAIkC,WAAWA,CAAA,EAAE;IAAC,OAAO9K,CAAC,CAAC,IAAI,CAACgH,SAAS,CAAC,IAAEhH,CAAC,CAAC,IAAI,CAACiH,oBAAoB,CAAC;EAAA;EAAC,IAAI8D,cAAcA,CAAA,EAAE;IAAC,OAAO/K,CAAC,CAAC,IAAI,CAACiH,oBAAoB,CAAC,GAAC,IAAI,CAACA,oBAAoB,CAAC8D,cAAc,GAAC,CAAC;EAAA;EAACC,iCAAiCA,CAAC7L,CAAC,EAAC;IAAC,OAAO,IAAI,CAAC8L,yBAAyB,CAAC9L,CAAC,EAAC6E,CAAC,CAAC;EAAA;EAACiH,yBAAyBA,CAAC9L,CAAC,EAACC,CAAC,EAACC,CAAC,EAAC;IAAC,MAAMC,CAAC,GAAC,IAAI,CAACgI,UAAU,CAAC4D,GAAG,CAAC/L,CAAC,CAAC;IAACa,CAAC,CAACV,CAAC,CAAC,IAAEA,CAAC,CAACgL,OAAO,EAAE;IAAC,MAAM9K,CAAC,GAAC,IAAIJ,CAAC,CAAC;MAAC,GAAGC,CAAC;MAAC8L,eAAe,EAAC,IAAI;MAACC,WAAW,EAACjM;IAAC,CAAC,CAAC;IAAC,OAAO,IAAI,CAACmI,UAAU,CAAC2C,GAAG,CAAC9K,CAAC,EAACK,CAAC,CAAC,EAAC,IAAI,CAACgI,gCAAgC,GAAC,CAAC,CAAC,EAAC,aAAa,IAAGrI,CAAC,IAAE,IAAI,CAACkI,QAAQ,CAACsB,GAAG,CAACpI,CAAC,CAAE,MAAIpB,CAAC,CAACkM,WAAW,EAAG,MAAI,IAAI,CAACxD,MAAM,CAACgB,IAAI,CAAC,iBAAiB,CAAC,CAAE,EAAC1J,CAAC,CAAC,EAACK,CAAC;EAAA;EAAC8L,yBAAyBA,CAACnM,CAAC,EAAC;IAAC,IAAGe,CAAC,CAACf,CAAC,CAAC,EAAC;IAAO,MAAMC,CAAC,GAAC,IAAI,CAACkI,UAAU,CAAC4D,GAAG,CAAC/L,CAAC,CAAC;IAACe,CAAC,CAACd,CAAC,CAAC,KAAG,IAAI,CAACoI,gCAAgC,GAAC,CAAC,CAAC,EAAC,IAAI,CAACF,UAAU,CAACiE,MAAM,CAACpM,CAAC,CAAC,EAAC,IAAI,CAACkI,QAAQ,CAACmE,MAAM,CAACrM,CAAC,CAAC,EAACC,CAAC,CAACkL,OAAO,EAAE,CAAC;EAAA;EAACmB,+BAA+BA,CAACtM,CAAC,EAAC;IAAC,IAAIC,CAAC,GAAC,CAAC,CAAC;IAAC,IAAGY,CAAC,CAAC,IAAI,CAACiH,oBAAoB,CAAC,EAAC,KAAI,MAAM5H,CAAC,IAAI,IAAI,CAAC4H,oBAAoB,CAACyE,aAAa,EAAC;MAAC,MAAK,CAACpM,CAAC,EAACE,CAAC,CAAC,GAAC,IAAI,CAACmM,QAAQ;QAACjM,CAAC,GAACJ,CAAC,CAACsM,YAAY,CAACvM,CAAC,CAACwM,IAAI,CAAC,IAAE,CAACrM,CAAC,CAACoM,YAAY,CAACvM,CAAC,CAACwM,IAAI,CAAC;MAACzM,CAAC,GAAC,IAAI,CAAC6H,oBAAoB,CAAC6E,sBAAsB,CAACpM,CAAC,EAACL,CAAC,EAACF,CAAC,CAAC,IAAEC,CAAC;IAAA;IAAC,OAAOA,CAAC;EAAA;EAAC,IAAIuM,QAAQA,CAAA,EAAE;IAAC,OAAOvL,CAAC,CAAC,IAAI,CAAC4G,SAAS,EAAC,EAAE,CAAC;EAAA;EAAC+E,kBAAkBA,CAAC5M,CAAC,EAAC;IAACa,CAAC,CAAC,IAAI,CAACgH,SAAS,CAAC,IAAE,IAAI,CAACA,SAAS,CAACuD,OAAO,CAAEnL,CAAC,IAAEA,CAAC,CAAC4M,2BAA2B,GAACpL,CAAC,CAACzB,CAAC,EAAEA,CAAC,IAAEA,CAAC,CAAC8M,eAAe,KAAGxK,CAAC,CAACyK,kBAAkB,CAAE,CAAE;EAAA;EAACC,kBAAkBA,CAAChN,CAAC,EAAC;IAACa,CAAC,CAAC,IAAI,CAACgH,SAAS,CAAC,IAAE,IAAI,CAACA,SAAS,CAACuD,OAAO,CAAEnL,CAAC,IAAE;MAACA,CAAC,CAACgN,sBAAsB,GAACxL,CAAC,CAACzB,CAAC,EAAEA,CAAC,IAAEA,CAAC,CAACkN,eAAe,KAAGpL,CAAC,CAACqL,QAAQ,CAAE,EAAClN,CAAC,CAACmN,qBAAqB,GAAC3L,CAAC,CAACzB,CAAC,EAAEA,CAAC,IAAEA,CAAC,CAACkN,eAAe,KAAGpL,CAAC,CAACuL,WAAW,CAAE;IAAA,CAAC,CAAE;EAAA;EAACC,cAAcA,CAACtN,CAAC,EAACC,CAAC,EAAC;IAACc,CAAC,CAAC,IAAI,CAAC8G,SAAS,CAAC,KAAG,IAAI,CAACC,oBAAoB,GAAC,IAAI1E,CAAC,CAAC,IAAI,CAACiE,KAAK,CAAC,EAAC,IAAI,CAACQ,SAAS,GAAC,CAAC,IAAI7E,CAAC,CAACJ,CAAC,CAAC2K,KAAK,EAAC,IAAI,CAACzF,oBAAoB,CAAC,EAAC,IAAI9E,CAAC,CAACJ,CAAC,CAAC4K,KAAK,EAAC,IAAI,CAAC1F,oBAAoB,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC8E,kBAAkB,CAAC5M,CAAC,CAAC,EAAC,IAAI,CAACgN,kBAAkB,CAAC/M,CAAC,CAAC;EAAA;EAACyL,eAAeA,CAAA,EAAE;IAAC,IAAI,CAAC7D,SAAS,GAAC,IAAI,EAAC,IAAI,CAACC,oBAAoB,GAACrH,CAAC,CAAC,IAAI,CAACqH,oBAAoB,CAAC,EAAC,IAAI,CAACY,MAAM,CAACgB,IAAI,CAAC,mBAAmB,CAAC;EAAA;EAAC,IAAI+D,OAAOA,CAAA,EAAE;IAAC,OAAO,IAAI,CAAChE,QAAQ;EAAA;EAACiE,OAAOA,CAAC1N,CAAC,EAAC;IAAC,IAAI,CAAC2N,oBAAoB,CAAC3N,CAAC,EAAE,MAAI,CAAC,CAAC,CAAE;EAAA;EAAC2N,oBAAoBA,CAAC3N,CAAC,EAACC,CAAC,EAAC;IAAC,IAAIC,CAAC,GAAC,CAAC,CAAC;IAAC,KAAI,MAAK,CAACC,CAAC,EAACE,CAAC,CAAC,IAAG,IAAI,CAAC8H,UAAU,EAAC;MAAC,IAAGnI,CAAC,CAAC4N,IAAI,EAAC;MAAM,CAACzN,CAAC,CAAC0N,SAAS,IAAE5N,CAAC,CAACE,CAAC,CAAC,KAAIE,CAAC,CAACyN,aAAa,EAAE,KAAG5N,CAAC,GAAC,CAAC,CAAC,EAACF,CAAC,CAAC+N,YAAY,EAAE,CAAE;IAAA;IAAC,IAAI,CAAC1F,gCAAgC,KAAG,IAAI,CAACA,gCAAgC,GAAC,CAAC,CAAC,EAACnI,CAAC,GAAC,CAAC,CAAC,EAAC,IAAI,CAAC8N,iCAAiC,EAAE,CAAC,EAAC9N,CAAC,KAAGW,CAAC,CAAC,IAAI,CAACgH,SAAS,CAAC,IAAE,CAAC,KAAG,IAAI,CAACM,UAAU,CAAC8F,IAAI,IAAE,IAAI,CAACvC,eAAe,EAAE,EAAC,IAAI,CAACzB,YAAY,CAAC,UAAU,CAAC,EAAC,IAAI,CAACA,YAAY,CAAC,SAAS,CAAC,EAAC,IAAI,CAACvB,MAAM,CAACgB,IAAI,CAAC,iBAAiB,CAAC,EAAC,IAAI,CAACwE,oBAAoB,EAAE,EAAC,IAAI,CAAClE,sBAAsB,EAAE,EAAC,IAAI,CAACmE,eAAe,EAAE,CAAC;EAAA;EAACC,uBAAuBA,CAAA,EAAE;IAAC,IAAI,CAACT,oBAAoB,CAAC5H,CAAC,EAAE/F,CAAC,IAAEA,CAAC,CAACqO,YAAY,KAAG9I,CAAC,CAAC+I,IAAI,CAAE;EAAA;EAAC,IAAIC,OAAOA,CAAA,EAAE;IAAC,OAAM,CAAC7L,CAAC,CAAC8L,0BAA0B,IAAE,CAACnO,CAAC,CAAC,IAAI,CAAC8H,UAAU,EAAEnI,CAAC,IAAE,CAACA,CAAC,CAACuO,OAAO,CAAE;EAAA;EAAC,IAAIE,aAAaA,CAAA,EAAE;IAAC,OAAO,IAAI,CAAC1G,cAAc;EAAA;EAAC,IAAI2G,QAAQA,CAAA,EAAE;IAAC,OAAO,IAAI,CAACzG,SAAS;EAAA;EAAC,IAAI0G,eAAeA,CAAA,EAAE;IAAC,OAAO,IAAI,CAAC3G,gBAAgB;EAAA;EAAC4G,eAAeA,CAAC5O,CAAC,EAAC;IAAC,IAAIC,CAAC,GAAC,CAAC,CAAC;IAAC,OAAO,IAAI,CAACkI,UAAU,CAACiD,OAAO,CAAElL,CAAC,IAAED,CAAC,GAACC,CAAC,CAAC0O,eAAe,CAAC5O,CAAC,CAAC,IAAEC,CAAC,CAAE,EAACA,CAAC;EAAA;EAAC4O,sBAAsBA,CAAA,EAAE;IAAC,IAAI,CAACxG,gCAAgC,GAAC,CAAC,CAAC;EAAA;EAACyG,UAAUA,CAAC9O,CAAC,EAACC,CAAC,EAACC,CAAC,EAAC;IAAC,MAAMC,CAAC,GAACH,CAAC,CAAC+O,gBAAgB;IAAC,IAAG,CAAC,KAAG5O,CAAC,CAAC6O,QAAQ,EAAC,OAAM,CAAC,CAAC;IAAC,IAAI,CAACvH,mBAAmB,GAACvH,CAAC,GAACF,CAAC,CAACiP,gBAAgB;IAAC,MAAM5O,CAAC,GAACJ,CAAC,CAACiP,MAAM;IAAC,IAAG,IAAI,CAACX,OAAO,IAAElO,CAAC,KAAGiD,CAAC,CAAC6L,SAAS,IAAE,CAAC,IAAI,CAACV,aAAa,IAAEpO,CAAC,KAAGiD,CAAC,CAAC8L,MAAM,IAAE,CAAC,IAAI,CAACV,QAAQ,IAAE,CAAC1O,CAAC,CAACqP,gBAAgB,EAAE,EAAC,OAAM,CAAC,CAAC;IAAC,MAAM9O,CAAC,GAACN,CAAC,CAACqP,GAAG;IAAC,IAAG,CAAC/O,CAAC,CAACgP,OAAO,EAAE,EAAC,OAAM,CAAC,CAAC;IAAC,MAAM9O,CAAC,GAAC,CAAC,GAACT,CAAC,CAACwP,UAAU;MAAC7O,CAAC,GAACX,CAAC,CAACwP,UAAU;IAACjP,CAAC,CAACkP,MAAM,CAAChP,CAAC,EAACE,CAAC,CAAC;IAAC,MAAMI,CAAC,GAAC,IAAI,CAACsG,KAAK;IAAC,IAAG,IAAI,CAACmB,OAAO,CAACkH,UAAU,GAAC1P,CAAC,CAAC0P,UAAU,GAACxP,CAAC,EAAC,IAAI,CAACgH,cAAc,CAACgI,MAAM,GAAC7O,CAAC,EAAC,IAAI,CAAC4G,eAAe,CAACO,kBAAkB,GAAC,IAAI,CAACC,mBAAmB,EAAC,IAAI,CAACR,eAAe,CAAC0I,gBAAgB,GAAC,IAAI,CAAClI,mBAAmB,GAAC,IAAI,CAACgB,eAAe,EAAC,IAAI,CAACxB,eAAe,CAACiD,IAAI,GAAC7J,CAAC,KAAGiD,CAAC,CAAC8L,MAAM,GAAC3K,CAAC,CAACmL,YAAY,GAACnL,CAAC,CAAC0F,eAAe,EAACnK,CAAC,CAAC6P,aAAa,CAAC,IAAI,CAACxI,KAAK,CAAC,EAAC9G,CAAC,CAACuP,IAAI,CAAC/O,CAAC,CAAC,EAACf,CAAC,CAAC+P,KAAK,KAAGnN,CAAC,CAAC2K,KAAK,KAAGxM,CAAC,CAACiP,aAAa,CAAC,CAAC,EAAC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC,EAACjP,CAAC,CAACkP,SAAS,CAAChK,EAAE,CAACiK,gBAAgB,CAAC,CAAC,EAACjQ,CAAC,CAACyM,IAAI,KAAG5J,CAAC,CAACqN,QAAQ,KAAG,IAAI,CAACjJ,cAAc,CAACkJ,kBAAkB,GAACrG,EAAE,CAAC,EAACrH,CAAC,CAAC8L,0BAA0B,IAAEvO,CAAC,CAACyM,IAAI,KAAG5J,CAAC,CAACqN,QAAQ,EAAC,KAAI,IAAItP,CAAC,GAAC,CAAC,EAACA,CAAC,GAACV,CAAC,CAAC6O,QAAQ,EAACnO,CAAC,EAAE,EAAC,IAAI,CAACwP,kBAAkB,CAAClQ,CAAC,CAACmQ,OAAO,CAACzP,CAAC,CAAC,EAACb,CAAC,CAAC,EAAC,IAAI,CAACuQ,iBAAiB,CAACvQ,CAAC,CAACwP,UAAU,EAACgB,EAAE,CAACxQ,CAAC,CAAC+P,KAAK,CAAC,CAAC;IAAC,OAAO,IAAI,CAAC5H,UAAU,CAAC8F,IAAI,GAAC,CAAC,IAAE,IAAI,CAAC3F,gBAAgB,CAACmI,MAAM,CAAEC,IAAA,IAA8B;MAAA,IAA7B;QAACzE,WAAW,EAAC/L,CAAC;QAACyQ,QAAQ,EAAC1P;MAAC,CAAC,GAAAyP,IAAA;MAAI,IAAGzQ,CAAC,CAACyM,IAAI,KAAG5J,CAAC,CAAC8N,kBAAkB,IAAE1Q,CAAC,CAACgN,eAAe,KAAGpL,CAAC,CAACuL,WAAW,EAAC;MAAO,MAAK;UAACnB,WAAW,EAAChL;QAAC,CAAC,GAAChB,CAAC;QAACkB,CAAC,GAACP,CAAC,CAACK,CAAC,CAAC,IAAEA,CAAC,GAAC,CAAC,IAAEb,CAAC,KAAGiD,CAAC,CAACuN,KAAK;MAACzP,CAAC,KAAG,IAAI,CAAC0P,wBAAwB,CAAC,IAAI,CAACzJ,KAAK,EAAC5G,CAAC,EAACE,CAAC,CAAC,EAACI,CAAC,CAACkP,SAAS,CAAChK,EAAE,CAACiK,gBAAgB,CAAC,CAAC;MAAC,KAAI,IAAIjQ,CAAC,GAAC,CAAC,EAACA,CAAC,GAACE,CAAC,CAAC6O,QAAQ,EAAC/O,CAAC,EAAE,EAAC,IAAI,CAACoQ,kBAAkB,CAAClQ,CAAC,CAACmQ,OAAO,CAACrQ,CAAC,CAAC,EAACD,CAAC,CAAC,EAACiB,CAAC,CAAC8P,MAAM,CAAC,IAAI,CAAC7J,cAAc,CAAC;MAAC9F,CAAC,IAAEP,CAAC,CAAC,IAAI,CAAC2K,aAAa,CAAC,KAAGjL,CAAC,CAACuP,IAAI,CAAC/O,CAAC,CAAC,EAAC,IAAI,CAAC8H,IAAI,CAACC,MAAM,CAACC,UAAU,CAACiI,iBAAiB,CAACC,gBAAgB,CAAC,IAAI,CAAC/J,cAAc,CAACC,cAAc,EAAC,IAAI,CAACqE,aAAa,CAAC0F,UAAU,EAAE,EAAChQ,CAAC,EAAClB,CAAC,CAAC+P,KAAK,CAAC,CAAC;IAAA,CAAC,CAAE,EAAChP,CAAC,CAACoQ,eAAe,CAAC,IAAI,CAAC,EAAC5Q,CAAC,CAAC6Q,cAAc,EAAE,EAAC,IAAI,CAAClK,cAAc,CAACmK,uBAAuB,EAAE,EAAC,CAAC,CAAC;EAAA;EAACP,wBAAwBA,CAAC9Q,CAAC,EAACC,CAAC,EAACC,CAAC,EAAC;IAACa,CAAC,CAAC,IAAI,CAACyK,aAAa,CAAC,KAAG,IAAI,CAACA,aAAa,GAAC,IAAItI,CAAC,CAAClD,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC,EAAC,IAAI,CAACwL,aAAa,CAACiE,MAAM,CAACxP,CAAC,EAACC,CAAC,CAAC,EAAC,IAAI,CAACsL,aAAa,CAACsE,IAAI,CAAC9P,CAAC,CAAC;EAAA;EAAC,MAAMsR,aAAaA,CAAA,EAAE;IAAC,MAAM,IAAI,CAACnI,0BAA0B,CAACoI,SAAS,EAAE;EAAA;EAACC,oBAAoBA,CAAA,EAAE;IAAC,IAAI,CAAC9I,MAAM,CAACgB,IAAI,CAAC,iBAAiB,CAAC;EAAA;EAAC+H,SAASA,CAACzR,CAAC,EAACC,CAAC,EAACC,CAAC,EAACC,CAAC,EAAC;IAAC,IAAIE,CAAC,GAAC,CAAC;IAAC,KAAI,MAAME,CAAC,IAAI,IAAI,CAAC4H,UAAU,CAACuJ,MAAM,EAAE,EAACrR,CAAC,GAACE,CAAC,CAACkR,SAAS,GAAGzR,CAAC,EAACC,CAAC,EAACC,CAAC,EAACC,CAAC,EAACE,CAAC,CAAC,IAAEA,CAAC;EAAA;EAAC2N,iCAAiCA,CAAA,EAAE;IAAC,IAAG,IAAI,CAAC1F,gBAAgB,CAAC+C,KAAK,EAAE,EAAC,CAAC,KAAG,IAAI,CAAClD,UAAU,CAAC8F,IAAI,EAAC;IAAO,MAAMjO,CAAC,GAAC,IAAI,CAAC6I,IAAI,CAAC8I,GAAG,CAACC,SAAS;IAAC,IAAI,CAACzJ,UAAU,CAACiD,OAAO,CAAE,CAACnL,CAAC,EAACC,CAAC,KAAG;MAAC,MAAMC,CAAC,GAACH,CAAC,CAAC6R,OAAO,CAAC3R,CAAC,CAAC4R,KAAK,CAAC;QAACzR,CAAC,GAACF,CAAC,IAAE,CAAC;QAACI,CAAC,GAAC,IAAI,CAAC4H,UAAU,CAAC8F,IAAI,IAAE/N,CAAC,CAAC6R,WAAW,KAAG1R,CAAC,GAACoC,CAAC,CAACuP,QAAQ,GAACvP,CAAC,CAACwP,SAAS,CAAC,CAAC,IAAE5R,CAAC,GAACF,CAAC,GAAC,CAAC,CAAC;MAAC,IAAI,CAACmI,gBAAgB,CAAC4J,IAAI,CAAC,IAAIC,EAAE,CAACjS,CAAC,EAACD,CAAC,EAACM,CAAC,CAAC,CAAC;IAAA,CAAC,CAAE,EAAC,IAAI,CAAC+H,gBAAgB,CAAC8J,IAAI,CAAE,CAACpS,CAAC,EAACC,CAAC,KAAGD,CAAC,CAAC+P,KAAK,GAAC9P,CAAC,CAAC8P,KAAK,CAAE;EAAA;EAACM,kBAAkBA,CAACrQ,CAAC,EAACC,CAAC,EAAC;IAAC,MAAMC,CAAC,GAAC,IAAI,CAACsI,OAAO;IAACtI,CAAC,CAACmS,QAAQ,GAAC,CAAC,CAAC,EAAC,CAAC,EAACpS,CAAC,CAACuP,UAAU,EAACvP,CAAC,CAACuP,UAAU,CAAC,EAACzN,CAAC,CAAC7B,CAAC,CAACoS,gBAAgB,EAAC,CAAC,EAACtS,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,EAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,EAACE,CAAC,CAACmK,IAAI,EAACnK,CAAC,CAACoK,GAAG,CAAC,EAACrI,CAAC,CAAC/B,CAAC,CAACqS,UAAU,EAAC,CAAC,CAACvS,CAAC,CAAC,CAAC,CAAC,EAAC,CAACA,CAAC,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;EAAA;EAACmO,eAAeA,CAAA,EAAE;IAAC,MAAMnO,CAAC,GAACK,CAAC,CAAC,IAAI,CAAC8H,UAAU,EAAEnI,CAAC,IAAEA,CAAC,CAAC0O,QAAQ,CAAE;IAAC1O,CAAC,KAAG,IAAI,CAACiI,SAAS,KAAG,IAAI,CAACA,SAAS,GAACjI,CAAC,EAAC,IAAI,CAAC0I,MAAM,CAACgB,IAAI,CAAC,WAAW,EAAC1J,CAAC,CAAC,CAAC;EAAA;EAACkO,oBAAoBA,CAAA,EAAE;IAAC,MAAMlO,CAAC,GAACK,CAAC,CAAC,IAAI,CAAC8H,UAAU,EAAEnI,CAAC,IAAEA,CAAC,CAACyO,aAAa,CAAE;IAACzO,CAAC,KAAG,IAAI,CAAC+H,cAAc,KAAG,IAAI,CAACA,cAAc,GAAC/H,CAAC,EAAC,IAAI,CAAC0I,MAAM,CAACgB,IAAI,CAAC,gBAAgB,EAAC1J,CAAC,CAAC,CAAC;EAAA;EAACgK,sBAAsBA,CAAA,EAAE;IAAC,MAAMhK,CAAC,GAACK,CAAC,CAAC,IAAI,CAAC8H,UAAU,EAAEnI,CAAC,IAAEA,CAAC,CAAC2O,eAAe,CAAE;IAAC3O,CAAC,KAAG,IAAI,CAACgI,gBAAgB,KAAG,IAAI,CAACA,gBAAgB,GAAChI,CAAC,EAAC,IAAI,CAAC0I,MAAM,CAACgB,IAAI,CAAC,kBAAkB,EAAC1J,CAAC,CAAC,CAAC;EAAA;EAACuQ,iBAAiBA,CAACvQ,CAAC,EAACC,CAAC,EAAC;IAAC,IAAI,CAACuS,4BAA4B,CAACxS,CAAC,EAACA,CAAC,EAACC,CAAC,CAAC;IAAC,MAAMC,CAAC,GAAC,IAAI,CAACmH,KAAK;IAACnH,CAAC,CAACuS,aAAa,CAAC,IAAI,CAACnH,sBAAsB,EAAC,IAAI,CAAC/C,eAAe,EAAC,IAAI,CAAC,EAACrI,CAAC,CAACwS,OAAO,CAAC,IAAI,CAACjH,QAAQ,CAAC,EAACvL,CAAC,CAACyS,UAAU,CAACxM,EAAE,CAACyM,cAAc,EAAC,CAAC,EAAC7L,EAAE,CAAC,IAAI,CAAC0E,QAAQ,EAAC,UAAU,CAAC,CAAC;EAAA;EAAC+G,4BAA4BA,CAACxS,CAAC,EAACC,CAAC,EAACC,CAAC,EAAC;IAAC,IAAG8B,CAAC,CAAC,IAAI,CAACuG,eAAe,CAACsK,KAAK,EAAC3S,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAC,IAAI,CAACqI,eAAe,CAACgD,OAAO,EAAC;IAAO,MAAMpL,CAAC,GAAC,IAAI2S,UAAU,CAAC9S,CAAC,GAACC,CAAC,GAAC,CAAC,CAAC;IAAC,IAAII,CAAC,GAAC,CAAC;IAAC,KAAI,IAAII,CAAC,GAAC,CAAC,EAACA,CAAC,GAACR,CAAC,EAACQ,CAAC,EAAE,EAAC,KAAI,IAAIP,CAAC,GAAC,CAAC,EAACA,CAAC,GAACF,CAAC,EAACE,CAAC,EAAE,EAAC;MAAC,MAAMK,CAAC,GAACwS,IAAI,CAACC,KAAK,CAAC9S,CAAC,GAAC,EAAE,CAAC;QAACS,CAAC,GAACoS,IAAI,CAACC,KAAK,CAACvS,CAAC,GAAC,EAAE,CAAC;MAACF,CAAC,GAAC,CAAC,IAAEI,CAAC,GAAC,CAAC,IAAE,EAAE,GAACJ,CAAC,GAACP,CAAC,GAAC,EAAE,IAAE,EAAE,GAACW,CAAC,GAACV,CAAC,GAAC,EAAE,IAAEE,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,EAACF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,EAACF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,EAACF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,KAAGF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,EAACF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,EAACF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,GAAG,EAACF,CAAC,CAACE,CAAC,EAAE,CAAC,GAAC,CAAC,GAACE,CAAC,IAAE,CAAC,GAACI,CAAC,GAAC,CAAC,GAACT,CAAC,GAAC,CAAC,GAACO,CAAC,GAAC,CAAC,GAAC,GAAG,GAAC,CAAC,GAACF,CAAC,GAAC,CAAC,GAACI,CAAC,GAAC,CAAC,GAAC,GAAG,CAAC;IAAA;IAAC,IAAI,CAAC4H,eAAe,CAACgD,OAAO,GAAC,IAAI1E,EAAE,CAAC,IAAI,CAACQ,KAAK,EAAC;MAAC4L,MAAM,EAAC5M,EAAE,CAAC6M,UAAU;MAACC,WAAW,EAAC5M,EAAE,CAAC6M,IAAI;MAACC,QAAQ,EAAC5M,EAAE,CAAC6M,aAAa;MAACC,YAAY,EAAC5M,EAAE,CAAC6M,OAAO;MAACC,KAAK,EAACzT,CAAC;MAAC0T,MAAM,EAACzT;IAAC,CAAC,EAACE,CAAC,CAAC;IAAC,MAAMI,CAAC,GAAC,IAAI4E,CAAC;IAAC5E,CAAC,CAACoT,QAAQ,GAAC,CAAC,CAAC,EAAC,IAAI,CAACrI,sBAAsB,GAAC,IAAI,CAACnC,0BAA0B,CAACyK,OAAO,CAAC3O,CAAC,EAAC1E,CAAC,CAAC,EAAC,IAAI,CAACkL,QAAQ,GAACxH,CAAC,CAAC,IAAI,CAACoD,KAAK,CAAC;EAAA;EAAC,IAAIwM,IAAIA,CAAA,EAAE;IAAC,OAAM;MAACC,eAAe,EAACC,KAAK,CAACC,IAAI,CAAC,IAAI,CAAC7L,UAAU,CAACuJ,MAAM,EAAE,CAAC;MAACuC,sBAAsB,EAACjU,CAAC,IAAE,IAAI,CAACmI,UAAU,CAAC4D,GAAG,CAAC/L,CAAC;IAAC,CAAC;EAAA;AAAC,CAAC;AAACA,CAAC,CAAC,CAAC2B,CAAC,EAAE,CAAC,EAACqF,EAAE,CAACkN,SAAS,EAAC,kCAAkC,EAAC,KAAK,CAAC,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,CAAC;EAACwS,WAAW,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAACnN,EAAE,CAACkN,SAAS,EAAC,4BAA4B,EAAC,KAAK,CAAC,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,CAAC;EAACwS,WAAW,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAACnN,EAAE,CAACkN,SAAS,EAAC,2BAA2B,EAAC,KAAK,CAAC,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,CAAC;EAACyS,aAAa,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAACpN,EAAE,CAACkN,SAAS,EAAC,MAAM,EAAC,KAAK,CAAC,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,EAAE,CAAC,EAACqF,EAAE,CAACkN,SAAS,EAAC,iBAAiB,EAAC,KAAK,CAAC,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,EAAE,CAAC,EAACqF,EAAE,CAACkN,SAAS,EAAC,kBAAkB,EAAC,KAAK,CAAC,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,CAAC;EAAC+K,IAAI,EAAC2H,OAAO;EAACC,QAAQ,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAACtN,EAAE,CAACkN,SAAS,EAAC,UAAU,EAAC,IAAI,CAAC,EAAClU,CAAC,CAAC,CAAC2B,CAAC,EAAE,CAAC,EAACqF,EAAE,CAACkN,SAAS,EAAC,SAAS,EAAC,IAAI,CAAC,EAAClN,EAAE,GAAChH,CAAC,CAAC,CAAC6B,CAAC,CAAC,uCAAuC,CAAC,CAAC,EAACmF,EAAE,CAAC;AAAC,MAAMmL,EAAE;EAACvK,WAAWA,CAAC5H,CAAC,EAACC,CAAC,EAACC,CAAC,EAAC;IAAC,IAAI,CAAC+L,WAAW,GAACjM,CAAC,EAAC,IAAI,CAAC2Q,QAAQ,GAAC1Q,CAAC,EAAC,IAAI,CAAC8P,KAAK,GAAC7P,CAAC;EAAA;AAAC;AAAC,MAAMsQ,EAAE,GAAC,CAAC,CAAC,CAAC,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,CAAC,EAAE,EAAC,EAAE,EAAC,CAAC,CAAC,CAAC;EAAC+D,EAAE,GAAC,CAAC,CAAC;EAACxK,EAAE,GAAC1F,CAAC,CAACmQ,qBAAqB;AAAC,SAAOD,EAAE,IAAIE,QAAQ,EAACzN,EAAE,IAAI0N,eAAe,EAAC3K,EAAE,IAAI4K,yBAAyB"},"metadata":{},"sourceType":"module","externalDependencies":[]}