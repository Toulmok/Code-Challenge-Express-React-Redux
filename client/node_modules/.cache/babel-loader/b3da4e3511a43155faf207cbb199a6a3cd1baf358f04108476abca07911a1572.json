{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as t } from \"../../../../core/maybe.js\";\nimport { isAbortError as e } from \"../../../../core/promiseUtils.js\";\nimport { PlacementEngine as s } from \"./Placement.js\";\nimport r from \"./TileParser.js\";\nimport { TileStatus as i } from \"../../tiling/enums.js\";\nclass a {\n  constructor(t, e, r, a) {\n    this.status = i.INITIALIZED, this.placementEngine = new s(), this.tileKey = t, this.refKeys = e, this._workerTileHandler = r, this._styleRepository = a;\n  }\n  release() {\n    this.tileKey = \"\", this.refKeys = null, this.status = i.INITIALIZED, this._workerTileHandler = null;\n  }\n  async parse(s, r) {\n    const a = r && r.signal;\n    if (t(a)) {\n      const t = () => {\n        a.removeEventListener(\"abort\", t), this.status = i.INVALID;\n      };\n      a.addEventListener(\"abort\", t);\n    }\n    let n;\n    const l = {\n      bucketsWithData: [],\n      emptyBuckets: null\n    };\n    try {\n      n = await this._parse(s, r);\n    } catch (y) {\n      if (e(y)) throw y;\n      return {\n        result: l,\n        transferList: []\n      };\n    }\n    this.status = i.READY;\n    const o = l.bucketsWithData,\n      u = [];\n    for (const t of n) if (t.hasFeatures()) {\n      const e = t.serialize();\n      o.push(e);\n    } else u.push(t.layer.uid);\n    const h = [...o];\n    let c = null;\n    return u.length > 0 && (c = Uint32Array.from(u), h.push(c.buffer)), l.emptyBuckets = c, {\n      result: l,\n      transferList: h\n    };\n  }\n  setObsolete() {\n    this.status = i.INVALID;\n  }\n  getLayers() {\n    return this._workerTileHandler.getLayers();\n  }\n  getWorkerTileHandler() {\n    return this._workerTileHandler;\n  }\n  async _parse(t, e) {\n    const s = t.sourceName2DataAndRefKey;\n    if (0 === Object.keys(s).length) return [];\n    this.status = i.MODIFIED;\n    return new r(s, this, e.client, this._styleRepository, t.styleLayerUIDs).parse(e);\n  }\n}\nexport { a as default };","map":{"version":3,"names":["isSome","t","isAbortError","e","PlacementEngine","s","r","TileStatus","i","a","constructor","status","INITIALIZED","placementEngine","tileKey","refKeys","_workerTileHandler","_styleRepository","release","parse","signal","removeEventListener","INVALID","addEventListener","n","l","bucketsWithData","emptyBuckets","_parse","y","result","transferList","READY","o","u","hasFeatures","serialize","push","layer","uid","h","c","length","Uint32Array","from","buffer","setObsolete","getLayers","getWorkerTileHandler","sourceName2DataAndRefKey","Object","keys","MODIFIED","client","styleLayerUIDs","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/2d/engine/vectorTiles/WorkerTile.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../../core/maybe.js\";import{isAbortError as e}from\"../../../../core/promiseUtils.js\";import{PlacementEngine as s}from\"./Placement.js\";import r from\"./TileParser.js\";import{TileStatus as i}from\"../../tiling/enums.js\";class a{constructor(t,e,r,a){this.status=i.INITIALIZED,this.placementEngine=new s,this.tileKey=t,this.refKeys=e,this._workerTileHandler=r,this._styleRepository=a}release(){this.tileKey=\"\",this.refKeys=null,this.status=i.INITIALIZED,this._workerTileHandler=null}async parse(s,r){const a=r&&r.signal;if(t(a)){const t=()=>{a.removeEventListener(\"abort\",t),this.status=i.INVALID};a.addEventListener(\"abort\",t)}let n;const l={bucketsWithData:[],emptyBuckets:null};try{n=await this._parse(s,r)}catch(y){if(e(y))throw y;return{result:l,transferList:[]}}this.status=i.READY;const o=l.bucketsWithData,u=[];for(const t of n)if(t.hasFeatures()){const e=t.serialize();o.push(e)}else u.push(t.layer.uid);const h=[...o];let c=null;return u.length>0&&(c=Uint32Array.from(u),h.push(c.buffer)),l.emptyBuckets=c,{result:l,transferList:h}}setObsolete(){this.status=i.INVALID}getLayers(){return this._workerTileHandler.getLayers()}getWorkerTileHandler(){return this._workerTileHandler}async _parse(t,e){const s=t.sourceName2DataAndRefKey;if(0===Object.keys(s).length)return[];this.status=i.MODIFIED;return new r(s,this,e.client,this._styleRepository,t.styleLayerUIDs).parse(e)}}export{a as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}