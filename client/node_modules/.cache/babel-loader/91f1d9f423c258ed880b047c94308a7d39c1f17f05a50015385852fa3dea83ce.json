{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Accessor.js\";\nimport { Cyclical as r, cyclicalPI as s } from \"../../../core/Cyclical.js\";\nimport i from \"../../../core/Handles.js\";\nimport has from \"../../../core/has.js\";\nimport { nextHighestPowerOfTwo as a, clamp as n, deg2rad as o } from \"../../../core/mathUtils.js\";\nimport { isSome as l, destroyMaybe as h, isNone as c, unwrap as d } from \"../../../core/maybe.js\";\nimport { watch as u, sync as p } from \"../../../core/reactiveUtils.js\";\nimport { Milliseconds as _ } from \"../../../core/time.js\";\nimport { property as m } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as y } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { a as g } from \"../../../chunks/vec2.js\";\nimport { a as f, b as v, E as R, c as T, i as w } from \"../../../chunks/vec3.js\";\nimport { c as O } from \"../../../chunks/vec3f64.js\";\nimport { t as D, b as x, a as S } from \"../../../chunks/vec4.js\";\nimport { c as E, f as P } from \"../../../chunks/vec4f64.js\";\nimport { getReferenceEllipsoid as M } from \"../../../geometry/ellipsoidUtils.js\";\nimport { projectVectorToVector as U } from \"../../../geometry/projection.js\";\nimport { create as C, width as I, copy as N, center as j, height as b, intersection as A, contains as G, intersects as L, offset as H } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { create as k, wrap as q } from \"../../../geometry/support/ray.js\";\nimport { b as B, e as F, t as V } from \"../../../chunks/sphere.js\";\nimport { angleAroundAxis as W } from \"../../../geometry/support/vector.js\";\nimport { y2lat as Y } from \"../../../geometry/support/webMercatorUtils.js\";\nimport { viewAngle as z } from \"../state/utils/viewUtils.js\";\nimport X from \"../support/debugFlags.js\";\nimport { PointGraphics as K } from \"../support/debugUtils.js\";\nimport { OverlayIndex as Z } from \"./interfaces.js\";\nimport { OverlayRenderer as J } from \"./OverlayRenderer.js\";\nimport { RenderRequestType as Q, ValidationState as $ } from \"../webgl-engine/lib/basicInterfaces.js\";\nimport { newIntersector as ee } from \"../webgl-engine/lib/Intersector.js\";\nimport { fromValues as te } from \"../webgl-engine/lib/LocalOriginFactory.js\";\nimport { UpdateParameters as re } from \"../webgl-engine/lib/Material.js\";\nimport { SortedRenderGeometryRenderer as se } from \"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";\nimport { removeLoadedShaderModules as ie } from \"../webgl-engine/parts/requireUtils.js\";\nimport { TaskPriority as ae, noBudget as ne, Task as oe } from \"../../support/Scheduler.js\";\nconst le = [[-.1, -2, 3.9, 2], [-.1, -3.9, 3.9, .1], [-2, -3.9, 2, .1], [-3.9, -3.9, .1, .1], [-3.9, -2, .1, 2], [-3.9, -.1, .1, 3.9], [-2, -.1, 2, 3.9], [-.1, -.1, 3.9, 3.9]];\nlet he,\n  ce = class extends t {\n    get running() {\n      return this._placementDirty && (this._drapeSources.size > 0 || this._view.graphics.length > 0 || X.OVERLAY_DRAW_DEBUG_TEXTURE) && !!this._spatialReference && !this.suspended && this.surface.ready;\n    }\n    get _isSpherical() {\n      return this._view.state.isGlobal;\n    }\n    get _worldToPCSRatio() {\n      return l(this._spatialReference) && this._spatialReference.isGeographic && !this._view.state.isLocal ? M(this._spatialReference).metersPerDegree : 1;\n    }\n    get _view() {\n      return this.surface.view;\n    }\n    get suspended() {\n      return this.surface.suspended;\n    }\n    get updating() {\n      return this.running || this.renderer.updating || this._contentUpdated;\n    }\n    get hasHighlights() {\n      return this.renderer.hasHighlights;\n    }\n    get rendersOccluded() {\n      return this.renderer.rendersOccluded;\n    }\n    constructor(e) {\n      super(e), this._handles = new i(), this._spatialReference = null, this._renderSR = null, this._overlaySREqualsRenderSR = !0, this._drapeSources = new Set(), this._drapeTargets = new Set(), this._placementDirty = !1, this._contentUpdated = !1, this._drawTexturesDirty = !1, this._drawTexturesAnimateDirty = !1, this._hasUnusedRenderTargets = !1, this._longitudeCyclical = null, this._latestOriginId = 0, this._maxResolution = has(\"esri-mobile\") ? 2048 : 4096, this._animationTimeLast = 0;\n    }\n    initialize() {\n      const e = this._view;\n      this.renderer = new J({\n        view: e,\n        worldToPCSRatio: this._worldToPCSRatio,\n        spatialReference: this._spatialReference\n      }), this._groundIntersector = ee(this._view.state.viewingMode), this._groundIntersector.options.backfacesTerrain = !0, this._groundIntersector.options.invisibleTerrain = !0, this._groundIntersector.options.hud = !1, this._handles.add([this.renderer.events.on(\"has-highlights\", () => {\n        this.setDrawTexturesDirty(), this.notifyChange(\"hasHighlights\");\n      }), this.renderer.events.on(\"has-water\", t => e._stage?.renderer.setParameters({\n        hasOverlayWater: t\n      })), this.renderer.events.on(\"renders-occluded\", () => {\n        this.setDrawTexturesDirty(), this.notifyChange(\"rendersOccluded\");\n      }), this.renderer.events.on(\"content-changed\", () => this.setDrawTexturesDirty()), this.renderer.events.on(\"textures-disposed\", () => this.updateOverlayResult()), u(() => [e.pointsOfInterest?.renderPointOfView, e.pointsOfInterest?.centerOnSurfaceFrequent?.location], () => this.setPlacementDirty()), u(() => [e.state?.pixelRatio, e.state?.contentPixelRatio], () => this.setPlacementDirty(), p), this.surface.on(\"elevation-change\", () => this.setPlacementDirty()), e.on(\"resize\", () => this.setPlacementDirty()), e.resourceController.scheduler.registerTask(ae.OVERLAY, this), e._stage.renderView.events.on(\"force-camera-for-screenshot\", e => {\n        this._updateOverlays(ne, e, Q.BACKGROUND), this.renderer.hasOverlays && this._drawOverlayTextures(this.renderer.overlays, Q.BACKGROUND, e.pixelRatio);\n      })]), e._stage?.renderer.setParameters({\n        renderOverlay: e => {\n          this._contentUpdated = !1, this.renderer.processSyncDrapeSources(), this.renderer.hasOverlays && (this._dispatchAnimationUpdate(e), this._drawOverlayTextures(this.renderer.overlays, Q.UPDATE)), this._hasUnusedRenderTargets && this._collectUnusedRenderTargetMemory();\n        }\n      });\n    }\n    destroy() {\n      this._handles = h(this._handles), l(he) && (he.hide(), he = null);\n    }\n    get hasOverlays() {\n      return this.renderer.hasOverlays;\n    }\n    setSpatialReference(e) {\n      this._spatialReference = e, this.renderer.spatialReference = e, this._longitudeCyclical = null;\n      const t = this._view.renderSpatialReference;\n      l(e) && l(t) ? (this._renderSR = t, this._overlaySREqualsRenderSR = e.equals(this._renderSR), this._isSpherical && (this._longitudeCyclical = e.isWebMercator ? new r(-20037508.342787, 20037508.342787) : new r(-180, 180), this.renderer.longitudeCyclical = this._longitudeCyclical), this.renderer && (this.renderer.worldToPCSRatio = this._worldToPCSRatio)) : this.renderer.disposeOverlays();\n    }\n    get gpuMemoryUsage() {\n      return this.renderer.gpuMemoryUsage;\n    }\n    registerDrapeSource(e, t, r) {\n      this._drapeSources.add(e), this.renderer.ensureOverlays(this._drapeTargets, this._drapeSources);\n      const s = this.renderer.createDrapeSourceRenderer(e, t, r);\n      return this._updateDrapeSourceExtent(e), this._setContentDirty(), this.notifyChange(\"running\"), s;\n    }\n    registerGeometryDrapeSource(e) {\n      return this.registerDrapeSource(e, se);\n    }\n    _updateDrapeSourceExtent(e) {\n      2 === this.renderer.overlays.length && l(e.setDrapingExtent) && l(this._spatialReference) && e.setDrapingExtent(this.renderer.overlays, this._spatialReference);\n    }\n    unregisterDrapeSource(e) {\n      this._drapeSources.has(e) && (this._drapeSources.delete(e), this.renderer.removeDrapeSourceRenderer(e), this.renderer.ensureDrapeSources(this._drapeSources), this._setContentDirty(), this.notifyChange(\"running\"));\n    }\n    registerDrapeTarget(e) {\n      this._drapeTargets.add(e), this.renderer.ensureOverlays(this._drapeTargets, this._drapeSources);\n    }\n    updateOverlayResult() {\n      this._view._stage?.renderer.setParameters({\n        overlays: this.renderer.overlays\n      });\n    }\n    unregisterDrapeTarget(e) {\n      this._drapeTargets.delete(e), this.renderer.ensureDrapeTargets(this._drapeTargets);\n    }\n    _setContentDirty() {\n      this.setPlacementDirty(), this.setDrawTexturesDirty();\n    }\n    setPlacementDirty() {\n      this._placementDirty = !0;\n    }\n    runTask(e) {\n      return this._updateOverlays(e, this._view.state.contentCamera, Q.UPDATE);\n    }\n    _updateOverlays(e, t, r) {\n      if (!this._spatialReference) return oe.YIELD;\n      const s = this._computeOverlayResolution(t);\n      this._computeOverlayExtents(t, s, _e);\n      const i = I(_e.inner) / I(_e.outer);\n      this.renderer.ensureOverlays(this._drapeTargets, this._drapeSources);\n      const a = this._updateOverlay(Z.INNER, _e.inner, s, 1 * _e.pixelRatioAdjustment, _e.mapUnitsPerPixel),\n        n = this._updateOverlay(Z.OUTER, _e.outer, s, i * _e.pixelRatioAdjustment, _e.mapUnitsPerPixel);\n      a !== fe.EXTENT && n !== fe.EXTENT || (this._drapeSources.forEach(e => this._updateDrapeSourceExtent(e)), this.surface.updateTileOverlayParams(r)), a === fe.NONE && n === fe.NONE || this.setDrawTexturesDirty(), this._placementDirty = !1, e.madeProgress();\n    }\n    _computeOverlayResolution(e) {\n      const t = this._view.state.contentPixelRatio,\n        r = e.fullWidth / e.pixelRatio * t,\n        s = e.fullHeight / e.pixelRatio * t;\n      return Math.min(a(Math.max(r, s) + 256), this._maxResolution);\n    }\n    _updateOverlay(e, t, r, s, i) {\n      if (0 === this.renderer.overlays.length) return fe.NONE;\n      const a = this.renderer.overlays[e],\n        n = a.mapUnitsPerPixel;\n      if (a.mapUnitsPerPixel = i, a.pixelRatio = s, de(t, a.extent) && r === a.resolution) return n === i ? fe.NONE : fe.RERENDER_ONLY;\n      N(a.extent, t), a.resolution = r;\n      const o = j(a.extent);\n      return a.renderLocalOrigin = te(o[0], o[1], 0, \"OV_\" + this._latestOriginId++), fe.EXTENT;\n    }\n    setTileParameters(e) {\n      const t = e.renderData.overlay;\n      if (this.renderer.overlays.length > 0) {\n        const r = this.renderer.overlays[Z.INNER],\n          s = this.renderer.overlays[Z.OUTER],\n          i = e.extent;\n        this._rectInsideRect(r.extent, i) || this._rectanglesOverlap(i, r.extent) || this._rectanglesOverlap(i, s.extent) ? (this._setTileOverlayData(i, Z.INNER, t), this._setTileOverlayData(i, Z.OUTER, t)) : (this._clearTileOverlayData(Z.INNER, t), this._clearTileOverlayData(Z.OUTER, t));\n      } else this._clearTileOverlayData(Z.INNER, t), this._clearTileOverlayData(Z.OUTER, t);\n    }\n    overlayPixelSizeInMapUnits(e) {\n      if (0 === this.renderer.overlays.length) return 0;\n      const t = this.renderer.overlays[Z.INNER],\n        r = this.renderer.overlays[Z.OUTER],\n        s = this._pointIsInExtent(e, t.extent) ? t : r;\n      return (s.extent[2] - s.extent[0]) / s.resolution;\n    }\n    _setTileOverlayData(e, t, r) {\n      if (0 === this.renderer.overlays.length) return;\n      const s = this.renderer.overlays[t].extent,\n        i = I(s),\n        a = b(s);\n      let n = e[0];\n      if (this._longitudeCyclical) {\n        n = this._longitudeCyclical.minimalMonotonic(s[0], n);\n        const t = this._longitudeCyclical.minimalMonotonic(s[0], e[2]);\n        n > t && (n = t - (e[2] - e[0]));\n      }\n      r.setScale(t, I(e) / i, b(e) / a), r.setOffset(t, (n - s[0]) / i, (e[1] - s[1]) / a);\n    }\n    _clearTileOverlayData(e, t) {\n      t.setScale(e, -1, -1), t.setOffset(e, -1, -1);\n    }\n    async reloadShaders() {\n      ie(), await this.renderer.reloadShaders(), this.setDrawTexturesDirty(), this.runTask(ne);\n    }\n    _dispatchAnimationUpdate(e) {\n      const t = _(e - this._animationTimeLast);\n      if (t >= this.surface.view._stage.renderer.animationTimestep || l(this._view.state.forcedAnimationTime) || this._drawTexturesDirty || this._drawTexturesAnimateDirty) {\n        const r = _(t / this.surface.view._stage.renderer.animationTimeDilation),\n          s = new re(this._view.state.camera, r, this._view.state.forcedAnimationTime);\n        this.renderer.updateAnimation(s) && (this._drawTexturesAnimateDirty = !0), this._animationTimeLast = e;\n      }\n    }\n    setDrawTexturesDirty() {\n      this.renderer.hasOverlays ? (this._contentUpdated = !0, this._drawTexturesDirty = !0, this._view._stage.renderView.requestRender()) : this.setPlacementDirty();\n    }\n    _intersectGroundFromView(e, t, r, s) {\n      const i = this._view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(e, ge, t, r);\n      if (c(i)) return !1;\n      const a = i.origin,\n        n = f(pe, i.origin, i.direction);\n      return this._groundIntersector.reset(a, n, e), this._groundIntersector.intersect([]), this._view.basemapTerrain.intersect(this._groundIntersector, null, a, n), this._groundIntersector.results.min.getIntersectionPoint(s);\n    }\n    _findHorizonBasedPointOfInterest(e, t) {\n      let r = .5;\n      const i = .55,\n        a = this._view.renderCoordsHelper.getAltitude(e.eye),\n        o = this._view.pointsOfInterest.centerOnSurfaceFrequent,\n        l = 1e-5,\n        h = n(o.estimatedSurfaceAltitude, e.aboveGround ? -1 / 0 : a + l, e.aboveGround ? a - l : 1 / 0),\n        c = e.aboveGround;\n      if (\"global\" === this._view.viewingMode) {\n        const t = pe;\n        B(F(V, M(this._view.spatialReference).radius + h), q(e.eye, e.viewForward), t), v(t, t, e.eye);\n        const a = s.normalize(W(e.viewForward, t, e.viewRight)) / e.fovY + .5,\n          n = a <= 0 || a >= 1 ? .5 : i;\n        r = c ? n * a : a + n * (1 - a);\n      } else {\n        const t = .5 * Math.PI - Math.acos(-e.viewForward[2]),\n          s = Math.tan(t),\n          a = P(0, s, 1, 0),\n          o = D(a, a, e.projectionMatrix)[1],\n          l = n(.5 + .5 * o, 0, 1);\n        r = 1 === l || 0 === l ? .5 : c ? l * i : 1 - (1 - l) * i;\n      }\n      return !!this._intersectGroundFromView(e, .5, r, t) && R(t, e.eye) < o.distance * o.distance;\n    }\n    _computeOverlayExtents(e, t, r) {\n      const s = this._view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,\n        i = O();\n      this._findHorizonBasedPointOfInterest(e, i) || T(i, s);\n      const a = Math.max(.1, w(e.eye, i)),\n        n = z(this._view.renderCoordsHelper, s, e.eye),\n        h = Math.PI / 2 - Math.abs(n - Math.PI / 2);\n      X.OVERLAY_SHOW_CENTER ? (c(he) && (he = new K(this._view.graphics, \"red\")), he.show(i, this._renderSR)) : l(he) && he.hide(), this._overlaySREqualsRenderSR || U(i, this._renderSR, i, this._spatialReference);\n      const u = this.surface.extent,\n        p = !this._isSpherical && l(this._spatialReference) && this._spatialReference.isGeographic,\n        _ = p && l(this._spatialReference) ? 1 / M(this._spatialReference).metersPerDegree : 1,\n        m = this._view.state.contentPixelRatio,\n        y = e.perScreenPixelRatio / m * a * _;\n      r.mapUnitsPerPixel = y / this._worldToPCSRatio;\n      let f = t * y / 2,\n        v = !1,\n        R = p ? 90 : 1 / 0;\n      this._isSpherical && l(u) && l(this._spatialReference) && (this._spatialReference.isWebMercator ? (f /= Math.cos(Y(i[1])), R = u[3]) : (v = !0, f /= M(this._spatialReference).metersPerDegree, R = 90), f >= R && (f = R, i[1] = 0, this._spatialReference.isWebMercator && (i[0] = 0)));\n      let D = 1;\n      v && (D = 1 / Math.max(.2, Math.cos(Math.abs(o(i[1])))), f * D > 180 && (D = 180 / f), r.mapUnitsPerPixel *= D);\n      const E = Math.log(2) / 12;\n      f = Math.exp(Math.round(Math.log(f) / E) * E);\n      const P = f * D,\n        C = 32,\n        j = .5 * t / (C * P),\n        b = .5 * t / (C * f);\n      i[0] = Math.round(i[0] * j) / j, i[1] = Math.round(i[1] * b) / b;\n      const L = r.inner;\n      L[0] = i[0] - P, L[1] = i[1] - f, L[2] = i[0] + P, L[3] = i[1] + f, this._isSpherical && this._shiftExtentToFitBounds(L, 1 / 0, R);\n      const H = r.outer;\n      if (6 * P > I(u)) N(H, d(u));else if (h <= .25 * Math.PI) H[0] = L[0] - P, H[1] = L[1] - f, H[2] = L[2] + P, H[3] = L[3] + f;else {\n        U(e.eye, this._renderSR, pe, this._spatialReference), g(ue, i, pe);\n        let t = -Math.atan2(ue[1], ue[0]) + .125 * Math.PI;\n        t < 0 && (t += 2 * Math.PI);\n        const r = Math.floor(t / (.25 * Math.PI));\n        x(ue, le[r], 2 * f), ue[0] *= D, ue[2] *= D, S(H, L, ue);\n      }\n      if (this._isSpherical) H[0] = this._longitudeCyclical.clamp(H[0]), H[2] = this._longitudeCyclical.clamp(H[2]), H[1] = Math.max(H[1], -R), H[3] = Math.min(H[3], R);else {\n        const e = A(L, u, me),\n          t = A(H, u, ye);\n        G(e, t) && (H[2] = H[0], H[3] = H[1]);\n      }\n      const k = Math.abs(L[2] - L[0]) / t;\n      r.mapUnitsPerPixel = Math.max(r.mapUnitsPerPixel, k), r.pixelRatioAdjustment = r.mapUnitsPerPixel / k;\n    }\n    _drawOverlayTextures(e, t) {\n      let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this._view.state.contentPixelRatio;\n      if (0 === e.length || !this._drawTexturesDirty && !this._drawTexturesAnimateDirty) return;\n      const s = this._drawTexturesDirty;\n      this._drawTexturesDirty = !1, this._drawTexturesAnimateDirty = !1;\n      const i = this._drawOverlay(e[Z.INNER], r),\n        a = this._drawOverlay(e[Z.OUTER], r);\n      i !== $.CHANGED && a !== $.CHANGED || this.surface.updateTileOverlayParams(Q.UPDATE), this._collectUnusedRenderTargetMemory(), this.updateOverlayResult(), s ? (this.surface.requestRender(t), t === Q.UPDATE && this.surface.requestUpdate()) : this.surface.requestRender(Q.BACKGROUND);\n    }\n    _drawOverlay(e, t) {\n      return this._longitudeCyclical ? e.setupGeometryViewsCyclical(this._longitudeCyclical) : e.setupGeometryViewsDirect(), e.draw(this.renderer, t);\n    }\n    _collectUnusedRenderTargetMemory() {\n      if (this._hasUnusedRenderTargets = !1, this.renderer.hasOverlays) {\n        const e = performance.now();\n        this._hasUnusedRenderTargets = this.renderer.collectUnusedRenderTargetMemory(e);\n      }\n    }\n    _rectanglesOverlap(e, t) {\n      return !c(e) && (this._longitudeCyclical ? (this._longitudeCyclical.contains(t[0], t[2], e[0]) || this._longitudeCyclical.contains(t[0], t[2], e[2]) || this._longitudeCyclical.contains(e[0], e[2], t[0])) && !(e[1] > t[3] || e[3] < t[1]) : L(e, t));\n    }\n    _rectInsideRect(e, t) {\n      return !c(t) && (this._longitudeCyclical ? this._longitudeCyclical.contains(e[0], e[2], t[0]) && this._longitudeCyclical.contains(e[0], e[2], t[2]) && t[1] > e[1] && t[3] < e[3] : G(e, t));\n    }\n    _pointIsInExtent(e, t) {\n      if (this._longitudeCyclical) return this._longitudeCyclical.contains(t[0], t[2], e.x) && e.y >= t[1] && e.y <= t[3];\n      const r = e.x,\n        s = e.y;\n      return r > t[0] && r < t[2] && s > t[1] && s < t[3];\n    }\n    _shiftExtentToFitBounds(e, t, r) {\n      let s = 0,\n        i = 0;\n      e[0] < -t ? s = e[0] + t : e[2] > t && (s = t - e[2]), e[1] < -r ? i = e[1] + r : e[3] > r && (i = r - e[3]), H(e, s, i);\n    }\n    get test() {\n      return {\n        renderer: this.renderer,\n        update: () => this.runTask(ne)\n      };\n    }\n  };\nfunction de(e, t) {\n  const r = 1e-5,\n    s = X.TESTS_DISABLE_OPTIMIZATIONS ? 0 : r * Math.max(e[2] - e[0], e[3] - e[1], t[2] - t[0], t[3] - t[1]);\n  return Math.abs(t[0] - e[0]) <= s && Math.abs(t[1] - e[1]) <= s && Math.abs(t[2] - e[2]) <= s && Math.abs(t[3] - e[3]) <= s;\n}\ne([m()], ce.prototype, \"_spatialReference\", void 0), e([m({\n  readOnly: !0\n})], ce.prototype, \"running\", null), e([m()], ce.prototype, \"_placementDirty\", void 0), e([m()], ce.prototype, \"_contentUpdated\", void 0), e([m()], ce.prototype, \"_isSpherical\", null), e([m()], ce.prototype, \"_worldToPCSRatio\", null), e([m({\n  autoDestroy: !0\n})], ce.prototype, \"renderer\", void 0), e([m({\n  constructOnly: !0\n})], ce.prototype, \"surface\", void 0), e([m()], ce.prototype, \"suspended\", null), e([m()], ce.prototype, \"updating\", null), e([m({\n  type: Boolean\n})], ce.prototype, \"hasHighlights\", null), e([m({\n  type: Boolean\n})], ce.prototype, \"rendersOccluded\", null), ce = e([y(\"esri.views.3d.terrain.OverlayManager\")], ce);\nconst ue = E(),\n  pe = O(),\n  _e = {\n    inner: C(),\n    outer: C(),\n    mapUnitsPerPixel: 0,\n    pixelRatioAdjustment: 1\n  },\n  me = C(),\n  ye = C(),\n  ge = k();\nvar fe;\n!function (e) {\n  e[e.NONE = 0] = \"NONE\", e[e.EXTENT = 1] = \"EXTENT\", e[e.RERENDER_ONLY = 2] = \"RERENDER_ONLY\";\n}(fe || (fe = {}));\nexport { ce as OverlayManager };","map":{"version":3,"names":["_","e","t","Cyclical","r","cyclicalPI","s","i","has","nextHighestPowerOfTwo","a","clamp","n","deg2rad","o","isSome","l","destroyMaybe","h","isNone","c","unwrap","d","watch","u","sync","p","Milliseconds","property","m","subclass","y","g","f","b","v","E","R","T","w","O","D","x","S","P","getReferenceEllipsoid","M","projectVectorToVector","U","create","C","width","I","copy","N","center","j","height","intersection","A","contains","G","intersects","L","offset","H","k","wrap","q","B","F","V","angleAroundAxis","W","y2lat","Y","viewAngle","z","X","PointGraphics","K","OverlayIndex","Z","OverlayRenderer","J","RenderRequestType","Q","ValidationState","$","newIntersector","ee","fromValues","te","UpdateParameters","re","SortedRenderGeometryRenderer","se","removeLoadedShaderModules","ie","TaskPriority","ae","noBudget","ne","Task","oe","le","he","ce","running","_placementDirty","_drapeSources","size","_view","graphics","length","OVERLAY_DRAW_DEBUG_TEXTURE","_spatialReference","suspended","surface","ready","_isSpherical","state","isGlobal","_worldToPCSRatio","isGeographic","isLocal","metersPerDegree","view","updating","renderer","_contentUpdated","hasHighlights","rendersOccluded","constructor","_handles","_renderSR","_overlaySREqualsRenderSR","Set","_drapeTargets","_drawTexturesDirty","_drawTexturesAnimateDirty","_hasUnusedRenderTargets","_longitudeCyclical","_latestOriginId","_maxResolution","_animationTimeLast","initialize","worldToPCSRatio","spatialReference","_groundIntersector","viewingMode","options","backfacesTerrain","invisibleTerrain","hud","add","events","on","setDrawTexturesDirty","notifyChange","_stage","setParameters","hasOverlayWater","updateOverlayResult","pointsOfInterest","renderPointOfView","centerOnSurfaceFrequent","location","setPlacementDirty","pixelRatio","contentPixelRatio","resourceController","scheduler","registerTask","OVERLAY","renderView","_updateOverlays","BACKGROUND","hasOverlays","_drawOverlayTextures","overlays","renderOverlay","processSyncDrapeSources","_dispatchAnimationUpdate","UPDATE","_collectUnusedRenderTargetMemory","destroy","hide","setSpatialReference","renderSpatialReference","equals","isWebMercator","longitudeCyclical","disposeOverlays","gpuMemoryUsage","registerDrapeSource","ensureOverlays","createDrapeSourceRenderer","_updateDrapeSourceExtent","_setContentDirty","registerGeometryDrapeSource","setDrapingExtent","unregisterDrapeSource","delete","removeDrapeSourceRenderer","ensureDrapeSources","registerDrapeTarget","unregisterDrapeTarget","ensureDrapeTargets","runTask","contentCamera","YIELD","_computeOverlayResolution","_computeOverlayExtents","_e","inner","outer","_updateOverlay","INNER","pixelRatioAdjustment","mapUnitsPerPixel","OUTER","fe","EXTENT","forEach","updateTileOverlayParams","NONE","madeProgress","fullWidth","fullHeight","Math","min","max","de","extent","resolution","RERENDER_ONLY","renderLocalOrigin","setTileParameters","renderData","overlay","_rectInsideRect","_rectanglesOverlap","_setTileOverlayData","_clearTileOverlayData","overlayPixelSizeInMapUnits","_pointIsInExtent","minimalMonotonic","setScale","setOffset","reloadShaders","animationTimestep","forcedAnimationTime","animationTimeDilation","camera","updateAnimation","requestRender","_intersectGroundFromView","sceneIntersectionHelper","getCenterRayWithSubpixelOffset","ge","origin","pe","direction","reset","intersect","basemapTerrain","results","getIntersectionPoint","_findHorizonBasedPointOfInterest","renderCoordsHelper","getAltitude","eye","estimatedSurfaceAltitude","aboveGround","radius","viewForward","normalize","viewRight","fovY","PI","acos","tan","projectionMatrix","distance","renderLocation","abs","OVERLAY_SHOW_CENTER","show","perScreenPixelRatio","cos","log","exp","round","_shiftExtentToFitBounds","ue","atan2","floor","me","ye","arguments","undefined","_drawOverlay","CHANGED","requestUpdate","setupGeometryViewsCyclical","setupGeometryViewsDirect","draw","performance","now","collectUnusedRenderTargetMemory","test","update","TESTS_DISABLE_OPTIMIZATIONS","prototype","readOnly","autoDestroy","constructOnly","type","Boolean","OverlayManager"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/terrain/OverlayManager.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Accessor.js\";import{Cyclical as r,cyclicalPI as s}from\"../../../core/Cyclical.js\";import i from\"../../../core/Handles.js\";import has from\"../../../core/has.js\";import{nextHighestPowerOfTwo as a,clamp as n,deg2rad as o}from\"../../../core/mathUtils.js\";import{isSome as l,destroyMaybe as h,isNone as c,unwrap as d}from\"../../../core/maybe.js\";import{watch as u,sync as p}from\"../../../core/reactiveUtils.js\";import{Milliseconds as _}from\"../../../core/time.js\";import{property as m}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import{a as g}from\"../../../chunks/vec2.js\";import{a as f,b as v,E as R,c as T,i as w}from\"../../../chunks/vec3.js\";import{c as O}from\"../../../chunks/vec3f64.js\";import{t as D,b as x,a as S}from\"../../../chunks/vec4.js\";import{c as E,f as P}from\"../../../chunks/vec4f64.js\";import{getReferenceEllipsoid as M}from\"../../../geometry/ellipsoidUtils.js\";import{projectVectorToVector as U}from\"../../../geometry/projection.js\";import{create as C,width as I,copy as N,center as j,height as b,intersection as A,contains as G,intersects as L,offset as H}from\"../../../geometry/support/aaBoundingRect.js\";import{create as k,wrap as q}from\"../../../geometry/support/ray.js\";import{b as B,e as F,t as V}from\"../../../chunks/sphere.js\";import{angleAroundAxis as W}from\"../../../geometry/support/vector.js\";import{y2lat as Y}from\"../../../geometry/support/webMercatorUtils.js\";import{viewAngle as z}from\"../state/utils/viewUtils.js\";import X from\"../support/debugFlags.js\";import{PointGraphics as K}from\"../support/debugUtils.js\";import{OverlayIndex as Z}from\"./interfaces.js\";import{OverlayRenderer as J}from\"./OverlayRenderer.js\";import{RenderRequestType as Q,ValidationState as $}from\"../webgl-engine/lib/basicInterfaces.js\";import{newIntersector as ee}from\"../webgl-engine/lib/Intersector.js\";import{fromValues as te}from\"../webgl-engine/lib/LocalOriginFactory.js\";import{UpdateParameters as re}from\"../webgl-engine/lib/Material.js\";import{SortedRenderGeometryRenderer as se}from\"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";import{removeLoadedShaderModules as ie}from\"../webgl-engine/parts/requireUtils.js\";import{TaskPriority as ae,noBudget as ne,Task as oe}from\"../../support/Scheduler.js\";const le=[[-.1,-2,3.9,2],[-.1,-3.9,3.9,.1],[-2,-3.9,2,.1],[-3.9,-3.9,.1,.1],[-3.9,-2,.1,2],[-3.9,-.1,.1,3.9],[-2,-.1,2,3.9],[-.1,-.1,3.9,3.9]];let he,ce=class extends t{get running(){return this._placementDirty&&(this._drapeSources.size>0||this._view.graphics.length>0||X.OVERLAY_DRAW_DEBUG_TEXTURE)&&!!this._spatialReference&&!this.suspended&&this.surface.ready}get _isSpherical(){return this._view.state.isGlobal}get _worldToPCSRatio(){return l(this._spatialReference)&&this._spatialReference.isGeographic&&!this._view.state.isLocal?M(this._spatialReference).metersPerDegree:1}get _view(){return this.surface.view}get suspended(){return this.surface.suspended}get updating(){return this.running||this.renderer.updating||this._contentUpdated}get hasHighlights(){return this.renderer.hasHighlights}get rendersOccluded(){return this.renderer.rendersOccluded}constructor(e){super(e),this._handles=new i,this._spatialReference=null,this._renderSR=null,this._overlaySREqualsRenderSR=!0,this._drapeSources=new Set,this._drapeTargets=new Set,this._placementDirty=!1,this._contentUpdated=!1,this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1,this._hasUnusedRenderTargets=!1,this._longitudeCyclical=null,this._latestOriginId=0,this._maxResolution=has(\"esri-mobile\")?2048:4096,this._animationTimeLast=0}initialize(){const e=this._view;this.renderer=new J({view:e,worldToPCSRatio:this._worldToPCSRatio,spatialReference:this._spatialReference}),this._groundIntersector=ee(this._view.state.viewingMode),this._groundIntersector.options.backfacesTerrain=!0,this._groundIntersector.options.invisibleTerrain=!0,this._groundIntersector.options.hud=!1,this._handles.add([this.renderer.events.on(\"has-highlights\",(()=>{this.setDrawTexturesDirty(),this.notifyChange(\"hasHighlights\")})),this.renderer.events.on(\"has-water\",(t=>e._stage?.renderer.setParameters({hasOverlayWater:t}))),this.renderer.events.on(\"renders-occluded\",(()=>{this.setDrawTexturesDirty(),this.notifyChange(\"rendersOccluded\")})),this.renderer.events.on(\"content-changed\",(()=>this.setDrawTexturesDirty())),this.renderer.events.on(\"textures-disposed\",(()=>this.updateOverlayResult())),u((()=>[e.pointsOfInterest?.renderPointOfView,e.pointsOfInterest?.centerOnSurfaceFrequent?.location]),(()=>this.setPlacementDirty())),u((()=>[e.state?.pixelRatio,e.state?.contentPixelRatio]),(()=>this.setPlacementDirty()),p),this.surface.on(\"elevation-change\",(()=>this.setPlacementDirty())),e.on(\"resize\",(()=>this.setPlacementDirty())),e.resourceController.scheduler.registerTask(ae.OVERLAY,this),e._stage.renderView.events.on(\"force-camera-for-screenshot\",(e=>{this._updateOverlays(ne,e,Q.BACKGROUND),this.renderer.hasOverlays&&this._drawOverlayTextures(this.renderer.overlays,Q.BACKGROUND,e.pixelRatio)}))]),e._stage?.renderer.setParameters({renderOverlay:e=>{this._contentUpdated=!1,this.renderer.processSyncDrapeSources(),this.renderer.hasOverlays&&(this._dispatchAnimationUpdate(e),this._drawOverlayTextures(this.renderer.overlays,Q.UPDATE)),this._hasUnusedRenderTargets&&this._collectUnusedRenderTargetMemory()}})}destroy(){this._handles=h(this._handles),l(he)&&(he.hide(),he=null)}get hasOverlays(){return this.renderer.hasOverlays}setSpatialReference(e){this._spatialReference=e,this.renderer.spatialReference=e,this._longitudeCyclical=null;const t=this._view.renderSpatialReference;l(e)&&l(t)?(this._renderSR=t,this._overlaySREqualsRenderSR=e.equals(this._renderSR),this._isSpherical&&(this._longitudeCyclical=e.isWebMercator?new r(-20037508.342787,20037508.342787):new r(-180,180),this.renderer.longitudeCyclical=this._longitudeCyclical),this.renderer&&(this.renderer.worldToPCSRatio=this._worldToPCSRatio)):this.renderer.disposeOverlays()}get gpuMemoryUsage(){return this.renderer.gpuMemoryUsage}registerDrapeSource(e,t,r){this._drapeSources.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const s=this.renderer.createDrapeSourceRenderer(e,t,r);return this._updateDrapeSourceExtent(e),this._setContentDirty(),this.notifyChange(\"running\"),s}registerGeometryDrapeSource(e){return this.registerDrapeSource(e,se)}_updateDrapeSourceExtent(e){2===this.renderer.overlays.length&&l(e.setDrapingExtent)&&l(this._spatialReference)&&e.setDrapingExtent(this.renderer.overlays,this._spatialReference)}unregisterDrapeSource(e){this._drapeSources.has(e)&&(this._drapeSources.delete(e),this.renderer.removeDrapeSourceRenderer(e),this.renderer.ensureDrapeSources(this._drapeSources),this._setContentDirty(),this.notifyChange(\"running\"))}registerDrapeTarget(e){this._drapeTargets.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources)}updateOverlayResult(){this._view._stage?.renderer.setParameters({overlays:this.renderer.overlays})}unregisterDrapeTarget(e){this._drapeTargets.delete(e),this.renderer.ensureDrapeTargets(this._drapeTargets)}_setContentDirty(){this.setPlacementDirty(),this.setDrawTexturesDirty()}setPlacementDirty(){this._placementDirty=!0}runTask(e){return this._updateOverlays(e,this._view.state.contentCamera,Q.UPDATE)}_updateOverlays(e,t,r){if(!this._spatialReference)return oe.YIELD;const s=this._computeOverlayResolution(t);this._computeOverlayExtents(t,s,_e);const i=I(_e.inner)/I(_e.outer);this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const a=this._updateOverlay(Z.INNER,_e.inner,s,1*_e.pixelRatioAdjustment,_e.mapUnitsPerPixel),n=this._updateOverlay(Z.OUTER,_e.outer,s,i*_e.pixelRatioAdjustment,_e.mapUnitsPerPixel);a!==fe.EXTENT&&n!==fe.EXTENT||(this._drapeSources.forEach((e=>this._updateDrapeSourceExtent(e))),this.surface.updateTileOverlayParams(r)),a===fe.NONE&&n===fe.NONE||this.setDrawTexturesDirty(),this._placementDirty=!1,e.madeProgress()}_computeOverlayResolution(e){const t=this._view.state.contentPixelRatio,r=e.fullWidth/e.pixelRatio*t,s=e.fullHeight/e.pixelRatio*t;return Math.min(a(Math.max(r,s)+256),this._maxResolution)}_updateOverlay(e,t,r,s,i){if(0===this.renderer.overlays.length)return fe.NONE;const a=this.renderer.overlays[e],n=a.mapUnitsPerPixel;if(a.mapUnitsPerPixel=i,a.pixelRatio=s,de(t,a.extent)&&r===a.resolution)return n===i?fe.NONE:fe.RERENDER_ONLY;N(a.extent,t),a.resolution=r;const o=j(a.extent);return a.renderLocalOrigin=te(o[0],o[1],0,\"OV_\"+this._latestOriginId++),fe.EXTENT}setTileParameters(e){const t=e.renderData.overlay;if(this.renderer.overlays.length>0){const r=this.renderer.overlays[Z.INNER],s=this.renderer.overlays[Z.OUTER],i=e.extent;this._rectInsideRect(r.extent,i)||this._rectanglesOverlap(i,r.extent)||this._rectanglesOverlap(i,s.extent)?(this._setTileOverlayData(i,Z.INNER,t),this._setTileOverlayData(i,Z.OUTER,t)):(this._clearTileOverlayData(Z.INNER,t),this._clearTileOverlayData(Z.OUTER,t))}else this._clearTileOverlayData(Z.INNER,t),this._clearTileOverlayData(Z.OUTER,t)}overlayPixelSizeInMapUnits(e){if(0===this.renderer.overlays.length)return 0;const t=this.renderer.overlays[Z.INNER],r=this.renderer.overlays[Z.OUTER],s=this._pointIsInExtent(e,t.extent)?t:r;return(s.extent[2]-s.extent[0])/s.resolution}_setTileOverlayData(e,t,r){if(0===this.renderer.overlays.length)return;const s=this.renderer.overlays[t].extent,i=I(s),a=b(s);let n=e[0];if(this._longitudeCyclical){n=this._longitudeCyclical.minimalMonotonic(s[0],n);const t=this._longitudeCyclical.minimalMonotonic(s[0],e[2]);n>t&&(n=t-(e[2]-e[0]))}r.setScale(t,I(e)/i,b(e)/a),r.setOffset(t,(n-s[0])/i,(e[1]-s[1])/a)}_clearTileOverlayData(e,t){t.setScale(e,-1,-1),t.setOffset(e,-1,-1)}async reloadShaders(){ie(),await this.renderer.reloadShaders(),this.setDrawTexturesDirty(),this.runTask(ne)}_dispatchAnimationUpdate(e){const t=_(e-this._animationTimeLast);if(t>=this.surface.view._stage.renderer.animationTimestep||l(this._view.state.forcedAnimationTime)||this._drawTexturesDirty||this._drawTexturesAnimateDirty){const r=_(t/this.surface.view._stage.renderer.animationTimeDilation),s=new re(this._view.state.camera,r,this._view.state.forcedAnimationTime);this.renderer.updateAnimation(s)&&(this._drawTexturesAnimateDirty=!0),this._animationTimeLast=e}}setDrawTexturesDirty(){this.renderer.hasOverlays?(this._contentUpdated=!0,this._drawTexturesDirty=!0,this._view._stage.renderView.requestRender()):this.setPlacementDirty()}_intersectGroundFromView(e,t,r,s){const i=this._view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(e,ge,t,r);if(c(i))return!1;const a=i.origin,n=f(pe,i.origin,i.direction);return this._groundIntersector.reset(a,n,e),this._groundIntersector.intersect([]),this._view.basemapTerrain.intersect(this._groundIntersector,null,a,n),this._groundIntersector.results.min.getIntersectionPoint(s)}_findHorizonBasedPointOfInterest(e,t){let r=.5;const i=.55,a=this._view.renderCoordsHelper.getAltitude(e.eye),o=this._view.pointsOfInterest.centerOnSurfaceFrequent,l=1e-5,h=n(o.estimatedSurfaceAltitude,e.aboveGround?-1/0:a+l,e.aboveGround?a-l:1/0),c=e.aboveGround;if(\"global\"===this._view.viewingMode){const t=pe;B(F(V,M(this._view.spatialReference).radius+h),q(e.eye,e.viewForward),t),v(t,t,e.eye);const a=s.normalize(W(e.viewForward,t,e.viewRight))/e.fovY+.5,n=a<=0||a>=1?.5:i;r=c?n*a:a+n*(1-a)}else{const t=.5*Math.PI-Math.acos(-e.viewForward[2]),s=Math.tan(t),a=P(0,s,1,0),o=D(a,a,e.projectionMatrix)[1],l=n(.5+.5*o,0,1);r=1===l||0===l?.5:c?l*i:1-(1-l)*i}return!!this._intersectGroundFromView(e,.5,r,t)&&R(t,e.eye)<o.distance*o.distance}_computeOverlayExtents(e,t,r){const s=this._view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,i=O();this._findHorizonBasedPointOfInterest(e,i)||T(i,s);const a=Math.max(.1,w(e.eye,i)),n=z(this._view.renderCoordsHelper,s,e.eye),h=Math.PI/2-Math.abs(n-Math.PI/2);X.OVERLAY_SHOW_CENTER?(c(he)&&(he=new K(this._view.graphics,\"red\")),he.show(i,this._renderSR)):l(he)&&he.hide(),this._overlaySREqualsRenderSR||U(i,this._renderSR,i,this._spatialReference);const u=this.surface.extent,p=!this._isSpherical&&l(this._spatialReference)&&this._spatialReference.isGeographic,_=p&&l(this._spatialReference)?1/M(this._spatialReference).metersPerDegree:1,m=this._view.state.contentPixelRatio,y=e.perScreenPixelRatio/m*a*_;r.mapUnitsPerPixel=y/this._worldToPCSRatio;let f=t*y/2,v=!1,R=p?90:1/0;this._isSpherical&&l(u)&&l(this._spatialReference)&&(this._spatialReference.isWebMercator?(f/=Math.cos(Y(i[1])),R=u[3]):(v=!0,f/=M(this._spatialReference).metersPerDegree,R=90),f>=R&&(f=R,i[1]=0,this._spatialReference.isWebMercator&&(i[0]=0)));let D=1;v&&(D=1/Math.max(.2,Math.cos(Math.abs(o(i[1])))),f*D>180&&(D=180/f),r.mapUnitsPerPixel*=D);const E=Math.log(2)/12;f=Math.exp(Math.round(Math.log(f)/E)*E);const P=f*D,C=32,j=.5*t/(C*P),b=.5*t/(C*f);i[0]=Math.round(i[0]*j)/j,i[1]=Math.round(i[1]*b)/b;const L=r.inner;L[0]=i[0]-P,L[1]=i[1]-f,L[2]=i[0]+P,L[3]=i[1]+f,this._isSpherical&&this._shiftExtentToFitBounds(L,1/0,R);const H=r.outer;if(6*P>I(u))N(H,d(u));else if(h<=.25*Math.PI)H[0]=L[0]-P,H[1]=L[1]-f,H[2]=L[2]+P,H[3]=L[3]+f;else{U(e.eye,this._renderSR,pe,this._spatialReference),g(ue,i,pe);let t=-Math.atan2(ue[1],ue[0])+.125*Math.PI;t<0&&(t+=2*Math.PI);const r=Math.floor(t/(.25*Math.PI));x(ue,le[r],2*f),ue[0]*=D,ue[2]*=D,S(H,L,ue)}if(this._isSpherical)H[0]=this._longitudeCyclical.clamp(H[0]),H[2]=this._longitudeCyclical.clamp(H[2]),H[1]=Math.max(H[1],-R),H[3]=Math.min(H[3],R);else{const e=A(L,u,me),t=A(H,u,ye);G(e,t)&&(H[2]=H[0],H[3]=H[1])}const k=Math.abs(L[2]-L[0])/t;r.mapUnitsPerPixel=Math.max(r.mapUnitsPerPixel,k),r.pixelRatioAdjustment=r.mapUnitsPerPixel/k}_drawOverlayTextures(e,t,r=this._view.state.contentPixelRatio){if(0===e.length||!this._drawTexturesDirty&&!this._drawTexturesAnimateDirty)return;const s=this._drawTexturesDirty;this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1;const i=this._drawOverlay(e[Z.INNER],r),a=this._drawOverlay(e[Z.OUTER],r);i!==$.CHANGED&&a!==$.CHANGED||this.surface.updateTileOverlayParams(Q.UPDATE),this._collectUnusedRenderTargetMemory(),this.updateOverlayResult(),s?(this.surface.requestRender(t),t===Q.UPDATE&&this.surface.requestUpdate()):this.surface.requestRender(Q.BACKGROUND)}_drawOverlay(e,t){return this._longitudeCyclical?e.setupGeometryViewsCyclical(this._longitudeCyclical):e.setupGeometryViewsDirect(),e.draw(this.renderer,t)}_collectUnusedRenderTargetMemory(){if(this._hasUnusedRenderTargets=!1,this.renderer.hasOverlays){const e=performance.now();this._hasUnusedRenderTargets=this.renderer.collectUnusedRenderTargetMemory(e)}}_rectanglesOverlap(e,t){return!c(e)&&(this._longitudeCyclical?(this._longitudeCyclical.contains(t[0],t[2],e[0])||this._longitudeCyclical.contains(t[0],t[2],e[2])||this._longitudeCyclical.contains(e[0],e[2],t[0]))&&!(e[1]>t[3]||e[3]<t[1]):L(e,t))}_rectInsideRect(e,t){return!c(t)&&(this._longitudeCyclical?this._longitudeCyclical.contains(e[0],e[2],t[0])&&this._longitudeCyclical.contains(e[0],e[2],t[2])&&t[1]>e[1]&&t[3]<e[3]:G(e,t))}_pointIsInExtent(e,t){if(this._longitudeCyclical)return this._longitudeCyclical.contains(t[0],t[2],e.x)&&e.y>=t[1]&&e.y<=t[3];const r=e.x,s=e.y;return r>t[0]&&r<t[2]&&s>t[1]&&s<t[3]}_shiftExtentToFitBounds(e,t,r){let s=0,i=0;e[0]<-t?s=e[0]+t:e[2]>t&&(s=t-e[2]),e[1]<-r?i=e[1]+r:e[3]>r&&(i=r-e[3]),H(e,s,i)}get test(){return{renderer:this.renderer,update:()=>this.runTask(ne)}}};function de(e,t){const r=1e-5,s=X.TESTS_DISABLE_OPTIMIZATIONS?0:r*Math.max(e[2]-e[0],e[3]-e[1],t[2]-t[0],t[3]-t[1]);return Math.abs(t[0]-e[0])<=s&&Math.abs(t[1]-e[1])<=s&&Math.abs(t[2]-e[2])<=s&&Math.abs(t[3]-e[3])<=s}e([m()],ce.prototype,\"_spatialReference\",void 0),e([m({readOnly:!0})],ce.prototype,\"running\",null),e([m()],ce.prototype,\"_placementDirty\",void 0),e([m()],ce.prototype,\"_contentUpdated\",void 0),e([m()],ce.prototype,\"_isSpherical\",null),e([m()],ce.prototype,\"_worldToPCSRatio\",null),e([m({autoDestroy:!0})],ce.prototype,\"renderer\",void 0),e([m({constructOnly:!0})],ce.prototype,\"surface\",void 0),e([m()],ce.prototype,\"suspended\",null),e([m()],ce.prototype,\"updating\",null),e([m({type:Boolean})],ce.prototype,\"hasHighlights\",null),e([m({type:Boolean})],ce.prototype,\"rendersOccluded\",null),ce=e([y(\"esri.views.3d.terrain.OverlayManager\")],ce);const ue=E(),pe=O(),_e={inner:C(),outer:C(),mapUnitsPerPixel:0,pixelRatioAdjustment:1},me=C(),ye=C(),ge=k();var fe;!function(e){e[e.NONE=0]=\"NONE\",e[e.EXTENT=1]=\"EXTENT\",e[e.RERENDER_ONLY=2]=\"RERENDER_ONLY\"}(fe||(fe={}));export{ce as OverlayManager};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAC,QAAK,8BAA8B;AAAC,OAAOC,CAAC,MAAK,2BAA2B;AAAC,SAAOC,QAAQ,IAAIC,CAAC,EAACC,UAAU,IAAIC,CAAC,QAAK,2BAA2B;AAAC,OAAOC,CAAC,MAAK,0BAA0B;AAAC,OAAOC,GAAG,MAAK,sBAAsB;AAAC,SAAOC,qBAAqB,IAAIC,CAAC,EAACC,KAAK,IAAIC,CAAC,EAACC,OAAO,IAAIC,CAAC,QAAK,4BAA4B;AAAC,SAAOC,MAAM,IAAIC,CAAC,EAACC,YAAY,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,QAAK,wBAAwB;AAAC,SAAOC,KAAK,IAAIC,CAAC,EAACC,IAAI,IAAIC,CAAC,QAAK,gCAAgC;AAAC,SAAOC,YAAY,IAAI3B,CAAC,QAAK,uBAAuB;AAAC,SAAO4B,QAAQ,IAAIC,CAAC,QAAK,sDAAsD;AAAC,OAAM,6CAA6C;AAAC,OAAM,6BAA6B;AAAC,SAAOC,QAAQ,IAAIC,CAAC,QAAK,sDAAsD;AAAC,SAAOrB,CAAC,IAAIsB,CAAC,QAAK,yBAAyB;AAAC,SAAOtB,CAAC,IAAIuB,CAAC,EAACC,CAAC,IAAIC,CAAC,EAACC,CAAC,IAAIC,CAAC,EAACjB,CAAC,IAAIkB,CAAC,EAAC/B,CAAC,IAAIgC,CAAC,QAAK,yBAAyB;AAAC,SAAOnB,CAAC,IAAIoB,CAAC,QAAK,4BAA4B;AAAC,SAAOtC,CAAC,IAAIuC,CAAC,EAACP,CAAC,IAAIQ,CAAC,EAAChC,CAAC,IAAIiC,CAAC,QAAK,yBAAyB;AAAC,SAAOvB,CAAC,IAAIgB,CAAC,EAACH,CAAC,IAAIW,CAAC,QAAK,4BAA4B;AAAC,SAAOC,qBAAqB,IAAIC,CAAC,QAAK,qCAAqC;AAAC,SAAOC,qBAAqB,IAAIC,CAAC,QAAK,iCAAiC;AAAC,SAAOC,MAAM,IAAIC,CAAC,EAACC,KAAK,IAAIC,CAAC,EAACC,IAAI,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,EAACC,MAAM,IAAIvB,CAAC,EAACwB,YAAY,IAAIC,CAAC,EAACC,QAAQ,IAAIC,CAAC,EAACC,UAAU,IAAIC,CAAC,EAACC,MAAM,IAAIC,CAAC,QAAK,6CAA6C;AAAC,SAAOhB,MAAM,IAAIiB,CAAC,EAACC,IAAI,IAAIC,CAAC,QAAK,kCAAkC;AAAC,SAAOlC,CAAC,IAAImC,CAAC,EAACpE,CAAC,IAAIqE,CAAC,EAACpE,CAAC,IAAIqE,CAAC,QAAK,2BAA2B;AAAC,SAAOC,eAAe,IAAIC,CAAC,QAAK,qCAAqC;AAAC,SAAOC,KAAK,IAAIC,CAAC,QAAK,+CAA+C;AAAC,SAAOC,SAAS,IAAIC,CAAC,QAAK,6BAA6B;AAAC,OAAOC,CAAC,MAAK,0BAA0B;AAAC,SAAOC,aAAa,IAAIC,CAAC,QAAK,0BAA0B;AAAC,SAAOC,YAAY,IAAIC,CAAC,QAAK,iBAAiB;AAAC,SAAOC,eAAe,IAAIC,CAAC,QAAK,sBAAsB;AAAC,SAAOC,iBAAiB,IAAIC,CAAC,EAACC,eAAe,IAAIC,CAAC,QAAK,wCAAwC;AAAC,SAAOC,cAAc,IAAIC,EAAE,QAAK,oCAAoC;AAAC,SAAOC,UAAU,IAAIC,EAAE,QAAK,2CAA2C;AAAC,SAAOC,gBAAgB,IAAIC,EAAE,QAAK,iCAAiC;AAAC,SAAOC,4BAA4B,IAAIC,EAAE,QAAK,qDAAqD;AAAC,SAAOC,yBAAyB,IAAIC,EAAE,QAAK,uCAAuC;AAAC,SAAOC,YAAY,IAAIC,EAAE,EAACC,QAAQ,IAAIC,EAAE,EAACC,IAAI,IAAIC,EAAE,QAAK,4BAA4B;AAAC,MAAMC,EAAE,GAAC,CAAC,CAAC,CAAC,EAAE,EAAC,CAAC,CAAC,EAAC,GAAG,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC,EAAE,EAAC,CAAC,GAAG,EAAC,GAAG,EAAC,EAAE,CAAC,EAAC,CAAC,CAAC,CAAC,EAAC,CAAC,GAAG,EAAC,CAAC,EAAC,EAAE,CAAC,EAAC,CAAC,CAAC,GAAG,EAAC,CAAC,GAAG,EAAC,EAAE,EAAC,EAAE,CAAC,EAAC,CAAC,CAAC,GAAG,EAAC,CAAC,CAAC,EAAC,EAAE,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC,GAAG,EAAC,CAAC,EAAE,EAAC,EAAE,EAAC,GAAG,CAAC,EAAC,CAAC,CAAC,CAAC,EAAC,CAAC,EAAE,EAAC,CAAC,EAAC,GAAG,CAAC,EAAC,CAAC,CAAC,EAAE,EAAC,CAAC,EAAE,EAAC,GAAG,EAAC,GAAG,CAAC,CAAC;AAAC,IAAIC,EAAE;EAACC,EAAE,GAAC,cAAczG,CAAC;IAAC,IAAI0G,OAAOA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACC,eAAe,KAAG,IAAI,CAACC,aAAa,CAACC,IAAI,GAAC,CAAC,IAAE,IAAI,CAACC,KAAK,CAACC,QAAQ,CAACC,MAAM,GAAC,CAAC,IAAEpC,CAAC,CAACqC,0BAA0B,CAAC,IAAE,CAAC,CAAC,IAAI,CAACC,iBAAiB,IAAE,CAAC,IAAI,CAACC,SAAS,IAAE,IAAI,CAACC,OAAO,CAACC,KAAK;IAAA;IAAC,IAAIC,YAAYA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACR,KAAK,CAACS,KAAK,CAACC,QAAQ;IAAA;IAAC,IAAIC,gBAAgBA,CAAA,EAAE;MAAC,OAAO3G,CAAC,CAAC,IAAI,CAACoG,iBAAiB,CAAC,IAAE,IAAI,CAACA,iBAAiB,CAACQ,YAAY,IAAE,CAAC,IAAI,CAACZ,KAAK,CAACS,KAAK,CAACI,OAAO,GAAC/E,CAAC,CAAC,IAAI,CAACsE,iBAAiB,CAAC,CAACU,eAAe,GAAC,CAAC;IAAA;IAAC,IAAId,KAAKA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACM,OAAO,CAACS,IAAI;IAAA;IAAC,IAAIV,SAASA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACC,OAAO,CAACD,SAAS;IAAA;IAAC,IAAIW,QAAQA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACpB,OAAO,IAAE,IAAI,CAACqB,QAAQ,CAACD,QAAQ,IAAE,IAAI,CAACE,eAAe;IAAA;IAAC,IAAIC,aAAaA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACF,QAAQ,CAACE,aAAa;IAAA;IAAC,IAAIC,eAAeA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACH,QAAQ,CAACG,eAAe;IAAA;IAACC,WAAWA,CAACpI,CAAC,EAAC;MAAC,KAAK,CAACA,CAAC,CAAC,EAAC,IAAI,CAACqI,QAAQ,GAAC,IAAI/H,CAAC,IAAC,IAAI,CAAC6G,iBAAiB,GAAC,IAAI,EAAC,IAAI,CAACmB,SAAS,GAAC,IAAI,EAAC,IAAI,CAACC,wBAAwB,GAAC,CAAC,CAAC,EAAC,IAAI,CAAC1B,aAAa,GAAC,IAAI2B,GAAG,IAAC,IAAI,CAACC,aAAa,GAAC,IAAID,GAAG,IAAC,IAAI,CAAC5B,eAAe,GAAC,CAAC,CAAC,EAAC,IAAI,CAACqB,eAAe,GAAC,CAAC,CAAC,EAAC,IAAI,CAACS,kBAAkB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,yBAAyB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,uBAAuB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,kBAAkB,GAAC,IAAI,EAAC,IAAI,CAACC,eAAe,GAAC,CAAC,EAAC,IAAI,CAACC,cAAc,GAACxI,GAAG,CAAC,aAAa,CAAC,GAAC,IAAI,GAAC,IAAI,EAAC,IAAI,CAACyI,kBAAkB,GAAC,CAAC;IAAA;IAACC,UAAUA,CAAA,EAAE;MAAC,MAAMjJ,CAAC,GAAC,IAAI,CAAC+G,KAAK;MAAC,IAAI,CAACiB,QAAQ,GAAC,IAAI7C,CAAC,CAAC;QAAC2C,IAAI,EAAC9H,CAAC;QAACkJ,eAAe,EAAC,IAAI,CAACxB,gBAAgB;QAACyB,gBAAgB,EAAC,IAAI,CAAChC;MAAiB,CAAC,CAAC,EAAC,IAAI,CAACiC,kBAAkB,GAAC3D,EAAE,CAAC,IAAI,CAACsB,KAAK,CAACS,KAAK,CAAC6B,WAAW,CAAC,EAAC,IAAI,CAACD,kBAAkB,CAACE,OAAO,CAACC,gBAAgB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACH,kBAAkB,CAACE,OAAO,CAACE,gBAAgB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACJ,kBAAkB,CAACE,OAAO,CAACG,GAAG,GAAC,CAAC,CAAC,EAAC,IAAI,CAACpB,QAAQ,CAACqB,GAAG,CAAC,CAAC,IAAI,CAAC1B,QAAQ,CAAC2B,MAAM,CAACC,EAAE,CAAC,gBAAgB,EAAE,MAAI;QAAC,IAAI,CAACC,oBAAoB,EAAE,EAAC,IAAI,CAACC,YAAY,CAAC,eAAe,CAAC;MAAA,CAAC,CAAE,EAAC,IAAI,CAAC9B,QAAQ,CAAC2B,MAAM,CAACC,EAAE,CAAC,WAAW,EAAE3J,CAAC,IAAED,CAAC,CAAC+J,MAAM,EAAE/B,QAAQ,CAACgC,aAAa,CAAC;QAACC,eAAe,EAAChK;MAAC,CAAC,CAAC,CAAE,EAAC,IAAI,CAAC+H,QAAQ,CAAC2B,MAAM,CAACC,EAAE,CAAC,kBAAkB,EAAE,MAAI;QAAC,IAAI,CAACC,oBAAoB,EAAE,EAAC,IAAI,CAACC,YAAY,CAAC,iBAAiB,CAAC;MAAA,CAAC,CAAE,EAAC,IAAI,CAAC9B,QAAQ,CAAC2B,MAAM,CAACC,EAAE,CAAC,iBAAiB,EAAE,MAAI,IAAI,CAACC,oBAAoB,EAAE,CAAE,EAAC,IAAI,CAAC7B,QAAQ,CAAC2B,MAAM,CAACC,EAAE,CAAC,mBAAmB,EAAE,MAAI,IAAI,CAACM,mBAAmB,EAAE,CAAE,EAAC3I,CAAC,CAAE,MAAI,CAACvB,CAAC,CAACmK,gBAAgB,EAAEC,iBAAiB,EAACpK,CAAC,CAACmK,gBAAgB,EAAEE,uBAAuB,EAAEC,QAAQ,CAAC,EAAG,MAAI,IAAI,CAACC,iBAAiB,EAAE,CAAE,EAAChJ,CAAC,CAAE,MAAI,CAACvB,CAAC,CAACwH,KAAK,EAAEgD,UAAU,EAACxK,CAAC,CAACwH,KAAK,EAAEiD,iBAAiB,CAAC,EAAG,MAAI,IAAI,CAACF,iBAAiB,EAAE,EAAE9I,CAAC,CAAC,EAAC,IAAI,CAAC4F,OAAO,CAACuC,EAAE,CAAC,kBAAkB,EAAE,MAAI,IAAI,CAACW,iBAAiB,EAAE,CAAE,EAACvK,CAAC,CAAC4J,EAAE,CAAC,QAAQ,EAAE,MAAI,IAAI,CAACW,iBAAiB,EAAE,CAAE,EAACvK,CAAC,CAAC0K,kBAAkB,CAACC,SAAS,CAACC,YAAY,CAACzE,EAAE,CAAC0E,OAAO,EAAC,IAAI,CAAC,EAAC7K,CAAC,CAAC+J,MAAM,CAACe,UAAU,CAACnB,MAAM,CAACC,EAAE,CAAC,6BAA6B,EAAE5J,CAAC,IAAE;QAAC,IAAI,CAAC+K,eAAe,CAAC1E,EAAE,EAACrG,CAAC,EAACqF,CAAC,CAAC2F,UAAU,CAAC,EAAC,IAAI,CAAChD,QAAQ,CAACiD,WAAW,IAAE,IAAI,CAACC,oBAAoB,CAAC,IAAI,CAAClD,QAAQ,CAACmD,QAAQ,EAAC9F,CAAC,CAAC2F,UAAU,EAAChL,CAAC,CAACwK,UAAU,CAAC;MAAA,CAAC,CAAE,CAAC,CAAC,EAACxK,CAAC,CAAC+J,MAAM,EAAE/B,QAAQ,CAACgC,aAAa,CAAC;QAACoB,aAAa,EAACpL,CAAC,IAAE;UAAC,IAAI,CAACiI,eAAe,GAAC,CAAC,CAAC,EAAC,IAAI,CAACD,QAAQ,CAACqD,uBAAuB,EAAE,EAAC,IAAI,CAACrD,QAAQ,CAACiD,WAAW,KAAG,IAAI,CAACK,wBAAwB,CAACtL,CAAC,CAAC,EAAC,IAAI,CAACkL,oBAAoB,CAAC,IAAI,CAAClD,QAAQ,CAACmD,QAAQ,EAAC9F,CAAC,CAACkG,MAAM,CAAC,CAAC,EAAC,IAAI,CAAC3C,uBAAuB,IAAE,IAAI,CAAC4C,gCAAgC,EAAE;QAAA;MAAC,CAAC,CAAC;IAAA;IAACC,OAAOA,CAAA,EAAE;MAAC,IAAI,CAACpD,QAAQ,GAACpH,CAAC,CAAC,IAAI,CAACoH,QAAQ,CAAC,EAACtH,CAAC,CAAC0F,EAAE,CAAC,KAAGA,EAAE,CAACiF,IAAI,EAAE,EAACjF,EAAE,GAAC,IAAI,CAAC;IAAA;IAAC,IAAIwE,WAAWA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACjD,QAAQ,CAACiD,WAAW;IAAA;IAACU,mBAAmBA,CAAC3L,CAAC,EAAC;MAAC,IAAI,CAACmH,iBAAiB,GAACnH,CAAC,EAAC,IAAI,CAACgI,QAAQ,CAACmB,gBAAgB,GAACnJ,CAAC,EAAC,IAAI,CAAC6I,kBAAkB,GAAC,IAAI;MAAC,MAAM5I,CAAC,GAAC,IAAI,CAAC8G,KAAK,CAAC6E,sBAAsB;MAAC7K,CAAC,CAACf,CAAC,CAAC,IAAEe,CAAC,CAACd,CAAC,CAAC,IAAE,IAAI,CAACqI,SAAS,GAACrI,CAAC,EAAC,IAAI,CAACsI,wBAAwB,GAACvI,CAAC,CAAC6L,MAAM,CAAC,IAAI,CAACvD,SAAS,CAAC,EAAC,IAAI,CAACf,YAAY,KAAG,IAAI,CAACsB,kBAAkB,GAAC7I,CAAC,CAAC8L,aAAa,GAAC,IAAI3L,CAAC,CAAC,CAAC,eAAe,EAAC,eAAe,CAAC,GAAC,IAAIA,CAAC,CAAC,CAAC,GAAG,EAAC,GAAG,CAAC,EAAC,IAAI,CAAC6H,QAAQ,CAAC+D,iBAAiB,GAAC,IAAI,CAAClD,kBAAkB,CAAC,EAAC,IAAI,CAACb,QAAQ,KAAG,IAAI,CAACA,QAAQ,CAACkB,eAAe,GAAC,IAAI,CAACxB,gBAAgB,CAAC,IAAE,IAAI,CAACM,QAAQ,CAACgE,eAAe,EAAE;IAAA;IAAC,IAAIC,cAAcA,CAAA,EAAE;MAAC,OAAO,IAAI,CAACjE,QAAQ,CAACiE,cAAc;IAAA;IAACC,mBAAmBA,CAAClM,CAAC,EAACC,CAAC,EAACE,CAAC,EAAC;MAAC,IAAI,CAAC0G,aAAa,CAAC6C,GAAG,CAAC1J,CAAC,CAAC,EAAC,IAAI,CAACgI,QAAQ,CAACmE,cAAc,CAAC,IAAI,CAAC1D,aAAa,EAAC,IAAI,CAAC5B,aAAa,CAAC;MAAC,MAAMxG,CAAC,GAAC,IAAI,CAAC2H,QAAQ,CAACoE,yBAAyB,CAACpM,CAAC,EAACC,CAAC,EAACE,CAAC,CAAC;MAAC,OAAO,IAAI,CAACkM,wBAAwB,CAACrM,CAAC,CAAC,EAAC,IAAI,CAACsM,gBAAgB,EAAE,EAAC,IAAI,CAACxC,YAAY,CAAC,SAAS,CAAC,EAACzJ,CAAC;IAAA;IAACkM,2BAA2BA,CAACvM,CAAC,EAAC;MAAC,OAAO,IAAI,CAACkM,mBAAmB,CAAClM,CAAC,EAAC+F,EAAE,CAAC;IAAA;IAACsG,wBAAwBA,CAACrM,CAAC,EAAC;MAAC,CAAC,KAAG,IAAI,CAACgI,QAAQ,CAACmD,QAAQ,CAAClE,MAAM,IAAElG,CAAC,CAACf,CAAC,CAACwM,gBAAgB,CAAC,IAAEzL,CAAC,CAAC,IAAI,CAACoG,iBAAiB,CAAC,IAAEnH,CAAC,CAACwM,gBAAgB,CAAC,IAAI,CAACxE,QAAQ,CAACmD,QAAQ,EAAC,IAAI,CAAChE,iBAAiB,CAAC;IAAA;IAACsF,qBAAqBA,CAACzM,CAAC,EAAC;MAAC,IAAI,CAAC6G,aAAa,CAACtG,GAAG,CAACP,CAAC,CAAC,KAAG,IAAI,CAAC6G,aAAa,CAAC6F,MAAM,CAAC1M,CAAC,CAAC,EAAC,IAAI,CAACgI,QAAQ,CAAC2E,yBAAyB,CAAC3M,CAAC,CAAC,EAAC,IAAI,CAACgI,QAAQ,CAAC4E,kBAAkB,CAAC,IAAI,CAAC/F,aAAa,CAAC,EAAC,IAAI,CAACyF,gBAAgB,EAAE,EAAC,IAAI,CAACxC,YAAY,CAAC,SAAS,CAAC,CAAC;IAAA;IAAC+C,mBAAmBA,CAAC7M,CAAC,EAAC;MAAC,IAAI,CAACyI,aAAa,CAACiB,GAAG,CAAC1J,CAAC,CAAC,EAAC,IAAI,CAACgI,QAAQ,CAACmE,cAAc,CAAC,IAAI,CAAC1D,aAAa,EAAC,IAAI,CAAC5B,aAAa,CAAC;IAAA;IAACqD,mBAAmBA,CAAA,EAAE;MAAC,IAAI,CAACnD,KAAK,CAACgD,MAAM,EAAE/B,QAAQ,CAACgC,aAAa,CAAC;QAACmB,QAAQ,EAAC,IAAI,CAACnD,QAAQ,CAACmD;MAAQ,CAAC,CAAC;IAAA;IAAC2B,qBAAqBA,CAAC9M,CAAC,EAAC;MAAC,IAAI,CAACyI,aAAa,CAACiE,MAAM,CAAC1M,CAAC,CAAC,EAAC,IAAI,CAACgI,QAAQ,CAAC+E,kBAAkB,CAAC,IAAI,CAACtE,aAAa,CAAC;IAAA;IAAC6D,gBAAgBA,CAAA,EAAE;MAAC,IAAI,CAAC/B,iBAAiB,EAAE,EAAC,IAAI,CAACV,oBAAoB,EAAE;IAAA;IAACU,iBAAiBA,CAAA,EAAE;MAAC,IAAI,CAAC3D,eAAe,GAAC,CAAC,CAAC;IAAA;IAACoG,OAAOA,CAAChN,CAAC,EAAC;MAAC,OAAO,IAAI,CAAC+K,eAAe,CAAC/K,CAAC,EAAC,IAAI,CAAC+G,KAAK,CAACS,KAAK,CAACyF,aAAa,EAAC5H,CAAC,CAACkG,MAAM,CAAC;IAAA;IAACR,eAAeA,CAAC/K,CAAC,EAACC,CAAC,EAACE,CAAC,EAAC;MAAC,IAAG,CAAC,IAAI,CAACgH,iBAAiB,EAAC,OAAOZ,EAAE,CAAC2G,KAAK;MAAC,MAAM7M,CAAC,GAAC,IAAI,CAAC8M,yBAAyB,CAAClN,CAAC,CAAC;MAAC,IAAI,CAACmN,sBAAsB,CAACnN,CAAC,EAACI,CAAC,EAACgN,EAAE,CAAC;MAAC,MAAM/M,CAAC,GAAC6C,CAAC,CAACkK,EAAE,CAACC,KAAK,CAAC,GAACnK,CAAC,CAACkK,EAAE,CAACE,KAAK,CAAC;MAAC,IAAI,CAACvF,QAAQ,CAACmE,cAAc,CAAC,IAAI,CAAC1D,aAAa,EAAC,IAAI,CAAC5B,aAAa,CAAC;MAAC,MAAMpG,CAAC,GAAC,IAAI,CAAC+M,cAAc,CAACvI,CAAC,CAACwI,KAAK,EAACJ,EAAE,CAACC,KAAK,EAACjN,CAAC,EAAC,CAAC,GAACgN,EAAE,CAACK,oBAAoB,EAACL,EAAE,CAACM,gBAAgB,CAAC;QAAChN,CAAC,GAAC,IAAI,CAAC6M,cAAc,CAACvI,CAAC,CAAC2I,KAAK,EAACP,EAAE,CAACE,KAAK,EAAClN,CAAC,EAACC,CAAC,GAAC+M,EAAE,CAACK,oBAAoB,EAACL,EAAE,CAACM,gBAAgB,CAAC;MAAClN,CAAC,KAAGoN,EAAE,CAACC,MAAM,IAAEnN,CAAC,KAAGkN,EAAE,CAACC,MAAM,KAAG,IAAI,CAACjH,aAAa,CAACkH,OAAO,CAAE/N,CAAC,IAAE,IAAI,CAACqM,wBAAwB,CAACrM,CAAC,CAAC,CAAE,EAAC,IAAI,CAACqH,OAAO,CAAC2G,uBAAuB,CAAC7N,CAAC,CAAC,CAAC,EAACM,CAAC,KAAGoN,EAAE,CAACI,IAAI,IAAEtN,CAAC,KAAGkN,EAAE,CAACI,IAAI,IAAE,IAAI,CAACpE,oBAAoB,EAAE,EAAC,IAAI,CAACjD,eAAe,GAAC,CAAC,CAAC,EAAC5G,CAAC,CAACkO,YAAY,EAAE;IAAA;IAACf,yBAAyBA,CAACnN,CAAC,EAAC;MAAC,MAAMC,CAAC,GAAC,IAAI,CAAC8G,KAAK,CAACS,KAAK,CAACiD,iBAAiB;QAACtK,CAAC,GAACH,CAAC,CAACmO,SAAS,GAACnO,CAAC,CAACwK,UAAU,GAACvK,CAAC;QAACI,CAAC,GAACL,CAAC,CAACoO,UAAU,GAACpO,CAAC,CAACwK,UAAU,GAACvK,CAAC;MAAC,OAAOoO,IAAI,CAACC,GAAG,CAAC7N,CAAC,CAAC4N,IAAI,CAACE,GAAG,CAACpO,CAAC,EAACE,CAAC,CAAC,GAAC,GAAG,CAAC,EAAC,IAAI,CAAC0I,cAAc,CAAC;IAAA;IAACyE,cAAcA,CAACxN,CAAC,EAACC,CAAC,EAACE,CAAC,EAACE,CAAC,EAACC,CAAC,EAAC;MAAC,IAAG,CAAC,KAAG,IAAI,CAAC0H,QAAQ,CAACmD,QAAQ,CAAClE,MAAM,EAAC,OAAO4G,EAAE,CAACI,IAAI;MAAC,MAAMxN,CAAC,GAAC,IAAI,CAACuH,QAAQ,CAACmD,QAAQ,CAACnL,CAAC,CAAC;QAACW,CAAC,GAACF,CAAC,CAACkN,gBAAgB;MAAC,IAAGlN,CAAC,CAACkN,gBAAgB,GAACrN,CAAC,EAACG,CAAC,CAAC+J,UAAU,GAACnK,CAAC,EAACmO,EAAE,CAACvO,CAAC,EAACQ,CAAC,CAACgO,MAAM,CAAC,IAAEtO,CAAC,KAAGM,CAAC,CAACiO,UAAU,EAAC,OAAO/N,CAAC,KAAGL,CAAC,GAACuN,EAAE,CAACI,IAAI,GAACJ,EAAE,CAACc,aAAa;MAACtL,CAAC,CAAC5C,CAAC,CAACgO,MAAM,EAACxO,CAAC,CAAC,EAACQ,CAAC,CAACiO,UAAU,GAACvO,CAAC;MAAC,MAAMU,CAAC,GAAC0C,CAAC,CAAC9C,CAAC,CAACgO,MAAM,CAAC;MAAC,OAAOhO,CAAC,CAACmO,iBAAiB,GAACjJ,EAAE,CAAC9E,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAAC,CAAC,EAAC,KAAK,GAAC,IAAI,CAACiI,eAAe,EAAE,CAAC,EAAC+E,EAAE,CAACC,MAAM;IAAA;IAACe,iBAAiBA,CAAC7O,CAAC,EAAC;MAAC,MAAMC,CAAC,GAACD,CAAC,CAAC8O,UAAU,CAACC,OAAO;MAAC,IAAG,IAAI,CAAC/G,QAAQ,CAACmD,QAAQ,CAAClE,MAAM,GAAC,CAAC,EAAC;QAAC,MAAM9G,CAAC,GAAC,IAAI,CAAC6H,QAAQ,CAACmD,QAAQ,CAAClG,CAAC,CAACwI,KAAK,CAAC;UAACpN,CAAC,GAAC,IAAI,CAAC2H,QAAQ,CAACmD,QAAQ,CAAClG,CAAC,CAAC2I,KAAK,CAAC;UAACtN,CAAC,GAACN,CAAC,CAACyO,MAAM;QAAC,IAAI,CAACO,eAAe,CAAC7O,CAAC,CAACsO,MAAM,EAACnO,CAAC,CAAC,IAAE,IAAI,CAAC2O,kBAAkB,CAAC3O,CAAC,EAACH,CAAC,CAACsO,MAAM,CAAC,IAAE,IAAI,CAACQ,kBAAkB,CAAC3O,CAAC,EAACD,CAAC,CAACoO,MAAM,CAAC,IAAE,IAAI,CAACS,mBAAmB,CAAC5O,CAAC,EAAC2E,CAAC,CAACwI,KAAK,EAACxN,CAAC,CAAC,EAAC,IAAI,CAACiP,mBAAmB,CAAC5O,CAAC,EAAC2E,CAAC,CAAC2I,KAAK,EAAC3N,CAAC,CAAC,KAAG,IAAI,CAACkP,qBAAqB,CAAClK,CAAC,CAACwI,KAAK,EAACxN,CAAC,CAAC,EAAC,IAAI,CAACkP,qBAAqB,CAAClK,CAAC,CAAC2I,KAAK,EAAC3N,CAAC,CAAC,CAAC;MAAA,CAAC,MAAK,IAAI,CAACkP,qBAAqB,CAAClK,CAAC,CAACwI,KAAK,EAACxN,CAAC,CAAC,EAAC,IAAI,CAACkP,qBAAqB,CAAClK,CAAC,CAAC2I,KAAK,EAAC3N,CAAC,CAAC;IAAA;IAACmP,0BAA0BA,CAACpP,CAAC,EAAC;MAAC,IAAG,CAAC,KAAG,IAAI,CAACgI,QAAQ,CAACmD,QAAQ,CAAClE,MAAM,EAAC,OAAO,CAAC;MAAC,MAAMhH,CAAC,GAAC,IAAI,CAAC+H,QAAQ,CAACmD,QAAQ,CAAClG,CAAC,CAACwI,KAAK,CAAC;QAACtN,CAAC,GAAC,IAAI,CAAC6H,QAAQ,CAACmD,QAAQ,CAAClG,CAAC,CAAC2I,KAAK,CAAC;QAACvN,CAAC,GAAC,IAAI,CAACgP,gBAAgB,CAACrP,CAAC,EAACC,CAAC,CAACwO,MAAM,CAAC,GAACxO,CAAC,GAACE,CAAC;MAAC,OAAM,CAACE,CAAC,CAACoO,MAAM,CAAC,CAAC,CAAC,GAACpO,CAAC,CAACoO,MAAM,CAAC,CAAC,CAAC,IAAEpO,CAAC,CAACqO,UAAU;IAAA;IAACQ,mBAAmBA,CAAClP,CAAC,EAACC,CAAC,EAACE,CAAC,EAAC;MAAC,IAAG,CAAC,KAAG,IAAI,CAAC6H,QAAQ,CAACmD,QAAQ,CAAClE,MAAM,EAAC;MAAO,MAAM5G,CAAC,GAAC,IAAI,CAAC2H,QAAQ,CAACmD,QAAQ,CAAClL,CAAC,CAAC,CAACwO,MAAM;QAACnO,CAAC,GAAC6C,CAAC,CAAC9C,CAAC,CAAC;QAACI,CAAC,GAACwB,CAAC,CAAC5B,CAAC,CAAC;MAAC,IAAIM,CAAC,GAACX,CAAC,CAAC,CAAC,CAAC;MAAC,IAAG,IAAI,CAAC6I,kBAAkB,EAAC;QAAClI,CAAC,GAAC,IAAI,CAACkI,kBAAkB,CAACyG,gBAAgB,CAACjP,CAAC,CAAC,CAAC,CAAC,EAACM,CAAC,CAAC;QAAC,MAAMV,CAAC,GAAC,IAAI,CAAC4I,kBAAkB,CAACyG,gBAAgB,CAACjP,CAAC,CAAC,CAAC,CAAC,EAACL,CAAC,CAAC,CAAC,CAAC,CAAC;QAACW,CAAC,GAACV,CAAC,KAAGU,CAAC,GAACV,CAAC,IAAED,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAAA;MAACG,CAAC,CAACoP,QAAQ,CAACtP,CAAC,EAACkD,CAAC,CAACnD,CAAC,CAAC,GAACM,CAAC,EAAC2B,CAAC,CAACjC,CAAC,CAAC,GAACS,CAAC,CAAC,EAACN,CAAC,CAACqP,SAAS,CAACvP,CAAC,EAAC,CAACU,CAAC,GAACN,CAAC,CAAC,CAAC,CAAC,IAAEC,CAAC,EAAC,CAACN,CAAC,CAAC,CAAC,CAAC,GAACK,CAAC,CAAC,CAAC,CAAC,IAAEI,CAAC,CAAC;IAAA;IAAC0O,qBAAqBA,CAACnP,CAAC,EAACC,CAAC,EAAC;MAACA,CAAC,CAACsP,QAAQ,CAACvP,CAAC,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAACuP,SAAS,CAACxP,CAAC,EAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;IAAA;IAAC,MAAMyP,aAAaA,CAAA,EAAE;MAACxJ,EAAE,EAAE,EAAC,MAAM,IAAI,CAAC+B,QAAQ,CAACyH,aAAa,EAAE,EAAC,IAAI,CAAC5F,oBAAoB,EAAE,EAAC,IAAI,CAACmD,OAAO,CAAC3G,EAAE,CAAC;IAAA;IAACiF,wBAAwBA,CAACtL,CAAC,EAAC;MAAC,MAAMC,CAAC,GAACF,CAAC,CAACC,CAAC,GAAC,IAAI,CAACgJ,kBAAkB,CAAC;MAAC,IAAG/I,CAAC,IAAE,IAAI,CAACoH,OAAO,CAACS,IAAI,CAACiC,MAAM,CAAC/B,QAAQ,CAAC0H,iBAAiB,IAAE3O,CAAC,CAAC,IAAI,CAACgG,KAAK,CAACS,KAAK,CAACmI,mBAAmB,CAAC,IAAE,IAAI,CAACjH,kBAAkB,IAAE,IAAI,CAACC,yBAAyB,EAAC;QAAC,MAAMxI,CAAC,GAACJ,CAAC,CAACE,CAAC,GAAC,IAAI,CAACoH,OAAO,CAACS,IAAI,CAACiC,MAAM,CAAC/B,QAAQ,CAAC4H,qBAAqB,CAAC;UAACvP,CAAC,GAAC,IAAIwF,EAAE,CAAC,IAAI,CAACkB,KAAK,CAACS,KAAK,CAACqI,MAAM,EAAC1P,CAAC,EAAC,IAAI,CAAC4G,KAAK,CAACS,KAAK,CAACmI,mBAAmB,CAAC;QAAC,IAAI,CAAC3H,QAAQ,CAAC8H,eAAe,CAACzP,CAAC,CAAC,KAAG,IAAI,CAACsI,yBAAyB,GAAC,CAAC,CAAC,CAAC,EAAC,IAAI,CAACK,kBAAkB,GAAChJ,CAAC;MAAA;IAAC;IAAC6J,oBAAoBA,CAAA,EAAE;MAAC,IAAI,CAAC7B,QAAQ,CAACiD,WAAW,IAAE,IAAI,CAAChD,eAAe,GAAC,CAAC,CAAC,EAAC,IAAI,CAACS,kBAAkB,GAAC,CAAC,CAAC,EAAC,IAAI,CAAC3B,KAAK,CAACgD,MAAM,CAACe,UAAU,CAACiF,aAAa,EAAE,IAAE,IAAI,CAACxF,iBAAiB,EAAE;IAAA;IAACyF,wBAAwBA,CAAChQ,CAAC,EAACC,CAAC,EAACE,CAAC,EAACE,CAAC,EAAC;MAAC,MAAMC,CAAC,GAAC,IAAI,CAACyG,KAAK,CAACkJ,uBAAuB,CAACC,8BAA8B,CAAClQ,CAAC,EAACmQ,EAAE,EAAClQ,CAAC,EAACE,CAAC,CAAC;MAAC,IAAGgB,CAAC,CAACb,CAAC,CAAC,EAAC,OAAM,CAAC,CAAC;MAAC,MAAMG,CAAC,GAACH,CAAC,CAAC8P,MAAM;QAACzP,CAAC,GAACqB,CAAC,CAACqO,EAAE,EAAC/P,CAAC,CAAC8P,MAAM,EAAC9P,CAAC,CAACgQ,SAAS,CAAC;MAAC,OAAO,IAAI,CAAClH,kBAAkB,CAACmH,KAAK,CAAC9P,CAAC,EAACE,CAAC,EAACX,CAAC,CAAC,EAAC,IAAI,CAACoJ,kBAAkB,CAACoH,SAAS,CAAC,EAAE,CAAC,EAAC,IAAI,CAACzJ,KAAK,CAAC0J,cAAc,CAACD,SAAS,CAAC,IAAI,CAACpH,kBAAkB,EAAC,IAAI,EAAC3I,CAAC,EAACE,CAAC,CAAC,EAAC,IAAI,CAACyI,kBAAkB,CAACsH,OAAO,CAACpC,GAAG,CAACqC,oBAAoB,CAACtQ,CAAC,CAAC;IAAA;IAACuQ,gCAAgCA,CAAC5Q,CAAC,EAACC,CAAC,EAAC;MAAC,IAAIE,CAAC,GAAC,EAAE;MAAC,MAAMG,CAAC,GAAC,GAAG;QAACG,CAAC,GAAC,IAAI,CAACsG,KAAK,CAAC8J,kBAAkB,CAACC,WAAW,CAAC9Q,CAAC,CAAC+Q,GAAG,CAAC;QAAClQ,CAAC,GAAC,IAAI,CAACkG,KAAK,CAACoD,gBAAgB,CAACE,uBAAuB;QAACtJ,CAAC,GAAC,IAAI;QAACE,CAAC,GAACN,CAAC,CAACE,CAAC,CAACmQ,wBAAwB,EAAChR,CAAC,CAACiR,WAAW,GAAC,CAAC,CAAC,GAAC,CAAC,GAACxQ,CAAC,GAACM,CAAC,EAACf,CAAC,CAACiR,WAAW,GAACxQ,CAAC,GAACM,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC;QAACI,CAAC,GAACnB,CAAC,CAACiR,WAAW;MAAC,IAAG,QAAQ,KAAG,IAAI,CAAClK,KAAK,CAACsC,WAAW,EAAC;QAAC,MAAMpJ,CAAC,GAACoQ,EAAE;QAACjM,CAAC,CAACC,CAAC,CAACC,CAAC,EAACzB,CAAC,CAAC,IAAI,CAACkE,KAAK,CAACoC,gBAAgB,CAAC,CAAC+H,MAAM,GAACjQ,CAAC,CAAC,EAACkD,CAAC,CAACnE,CAAC,CAAC+Q,GAAG,EAAC/Q,CAAC,CAACmR,WAAW,CAAC,EAAClR,CAAC,CAAC,EAACiC,CAAC,CAACjC,CAAC,EAACA,CAAC,EAACD,CAAC,CAAC+Q,GAAG,CAAC;QAAC,MAAMtQ,CAAC,GAACJ,CAAC,CAAC+Q,SAAS,CAAC5M,CAAC,CAACxE,CAAC,CAACmR,WAAW,EAAClR,CAAC,EAACD,CAAC,CAACqR,SAAS,CAAC,CAAC,GAACrR,CAAC,CAACsR,IAAI,GAAC,EAAE;UAAC3Q,CAAC,GAACF,CAAC,IAAE,CAAC,IAAEA,CAAC,IAAE,CAAC,GAAC,EAAE,GAACH,CAAC;QAACH,CAAC,GAACgB,CAAC,GAACR,CAAC,GAACF,CAAC,GAACA,CAAC,GAACE,CAAC,IAAE,CAAC,GAACF,CAAC,CAAC;MAAA,CAAC,MAAI;QAAC,MAAMR,CAAC,GAAC,EAAE,GAACoO,IAAI,CAACkD,EAAE,GAAClD,IAAI,CAACmD,IAAI,CAAC,CAACxR,CAAC,CAACmR,WAAW,CAAC,CAAC,CAAC,CAAC;UAAC9Q,CAAC,GAACgO,IAAI,CAACoD,GAAG,CAACxR,CAAC,CAAC;UAACQ,CAAC,GAACkC,CAAC,CAAC,CAAC,EAACtC,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;UAACQ,CAAC,GAAC2B,CAAC,CAAC/B,CAAC,EAACA,CAAC,EAACT,CAAC,CAAC0R,gBAAgB,CAAC,CAAC,CAAC,CAAC;UAAC3Q,CAAC,GAACJ,CAAC,CAAC,EAAE,GAAC,EAAE,GAACE,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;QAACV,CAAC,GAAC,CAAC,KAAGY,CAAC,IAAE,CAAC,KAAGA,CAAC,GAAC,EAAE,GAACI,CAAC,GAACJ,CAAC,GAACT,CAAC,GAAC,CAAC,GAAC,CAAC,CAAC,GAACS,CAAC,IAAET,CAAC;MAAA;MAAC,OAAM,CAAC,CAAC,IAAI,CAAC0P,wBAAwB,CAAChQ,CAAC,EAAC,EAAE,EAACG,CAAC,EAACF,CAAC,CAAC,IAAEmC,CAAC,CAACnC,CAAC,EAACD,CAAC,CAAC+Q,GAAG,CAAC,GAAClQ,CAAC,CAAC8Q,QAAQ,GAAC9Q,CAAC,CAAC8Q,QAAQ;IAAA;IAACvE,sBAAsBA,CAACpN,CAAC,EAACC,CAAC,EAACE,CAAC,EAAC;MAAC,MAAME,CAAC,GAAC,IAAI,CAAC0G,KAAK,CAACoD,gBAAgB,CAACE,uBAAuB,CAACuH,cAAc;QAACtR,CAAC,GAACiC,CAAC,EAAE;MAAC,IAAI,CAACqO,gCAAgC,CAAC5Q,CAAC,EAACM,CAAC,CAAC,IAAE+B,CAAC,CAAC/B,CAAC,EAACD,CAAC,CAAC;MAAC,MAAMI,CAAC,GAAC4N,IAAI,CAACE,GAAG,CAAC,EAAE,EAACjM,CAAC,CAACtC,CAAC,CAAC+Q,GAAG,EAACzQ,CAAC,CAAC,CAAC;QAACK,CAAC,GAACiE,CAAC,CAAC,IAAI,CAACmC,KAAK,CAAC8J,kBAAkB,EAACxQ,CAAC,EAACL,CAAC,CAAC+Q,GAAG,CAAC;QAAC9P,CAAC,GAACoN,IAAI,CAACkD,EAAE,GAAC,CAAC,GAAClD,IAAI,CAACwD,GAAG,CAAClR,CAAC,GAAC0N,IAAI,CAACkD,EAAE,GAAC,CAAC,CAAC;MAAC1M,CAAC,CAACiN,mBAAmB,IAAE3Q,CAAC,CAACsF,EAAE,CAAC,KAAGA,EAAE,GAAC,IAAI1B,CAAC,CAAC,IAAI,CAACgC,KAAK,CAACC,QAAQ,EAAC,KAAK,CAAC,CAAC,EAACP,EAAE,CAACsL,IAAI,CAACzR,CAAC,EAAC,IAAI,CAACgI,SAAS,CAAC,IAAEvH,CAAC,CAAC0F,EAAE,CAAC,IAAEA,EAAE,CAACiF,IAAI,EAAE,EAAC,IAAI,CAACnD,wBAAwB,IAAExF,CAAC,CAACzC,CAAC,EAAC,IAAI,CAACgI,SAAS,EAAChI,CAAC,EAAC,IAAI,CAAC6G,iBAAiB,CAAC;MAAC,MAAM5F,CAAC,GAAC,IAAI,CAAC8F,OAAO,CAACoH,MAAM;QAAChN,CAAC,GAAC,CAAC,IAAI,CAAC8F,YAAY,IAAExG,CAAC,CAAC,IAAI,CAACoG,iBAAiB,CAAC,IAAE,IAAI,CAACA,iBAAiB,CAACQ,YAAY;QAAC5H,CAAC,GAAC0B,CAAC,IAAEV,CAAC,CAAC,IAAI,CAACoG,iBAAiB,CAAC,GAAC,CAAC,GAACtE,CAAC,CAAC,IAAI,CAACsE,iBAAiB,CAAC,CAACU,eAAe,GAAC,CAAC;QAACjG,CAAC,GAAC,IAAI,CAACmF,KAAK,CAACS,KAAK,CAACiD,iBAAiB;QAAC3I,CAAC,GAAC9B,CAAC,CAACgS,mBAAmB,GAACpQ,CAAC,GAACnB,CAAC,GAACV,CAAC;MAACI,CAAC,CAACwN,gBAAgB,GAAC7L,CAAC,GAAC,IAAI,CAAC4F,gBAAgB;MAAC,IAAI1F,CAAC,GAAC/B,CAAC,GAAC6B,CAAC,GAAC,CAAC;QAACI,CAAC,GAAC,CAAC,CAAC;QAACE,CAAC,GAACX,CAAC,GAAC,EAAE,GAAC,CAAC,GAAC,CAAC;MAAC,IAAI,CAAC8F,YAAY,IAAExG,CAAC,CAACQ,CAAC,CAAC,IAAER,CAAC,CAAC,IAAI,CAACoG,iBAAiB,CAAC,KAAG,IAAI,CAACA,iBAAiB,CAAC2E,aAAa,IAAE9J,CAAC,IAAEqM,IAAI,CAAC4D,GAAG,CAACvN,CAAC,CAACpE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAC8B,CAAC,GAACb,CAAC,CAAC,CAAC,CAAC,KAAGW,CAAC,GAAC,CAAC,CAAC,EAACF,CAAC,IAAEa,CAAC,CAAC,IAAI,CAACsE,iBAAiB,CAAC,CAACU,eAAe,EAACzF,CAAC,GAAC,EAAE,CAAC,EAACJ,CAAC,IAAEI,CAAC,KAAGJ,CAAC,GAACI,CAAC,EAAC9B,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,EAAC,IAAI,CAAC6G,iBAAiB,CAAC2E,aAAa,KAAGxL,CAAC,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC,CAAC;MAAC,IAAIkC,CAAC,GAAC,CAAC;MAACN,CAAC,KAAGM,CAAC,GAAC,CAAC,GAAC6L,IAAI,CAACE,GAAG,CAAC,EAAE,EAACF,IAAI,CAAC4D,GAAG,CAAC5D,IAAI,CAACwD,GAAG,CAAChR,CAAC,CAACP,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAC0B,CAAC,GAACQ,CAAC,GAAC,GAAG,KAAGA,CAAC,GAAC,GAAG,GAACR,CAAC,CAAC,EAAC7B,CAAC,CAACwN,gBAAgB,IAAEnL,CAAC,CAAC;MAAC,MAAML,CAAC,GAACkM,IAAI,CAAC6D,GAAG,CAAC,CAAC,CAAC,GAAC,EAAE;MAAClQ,CAAC,GAACqM,IAAI,CAAC8D,GAAG,CAAC9D,IAAI,CAAC+D,KAAK,CAAC/D,IAAI,CAAC6D,GAAG,CAAClQ,CAAC,CAAC,GAACG,CAAC,CAAC,GAACA,CAAC,CAAC;MAAC,MAAMQ,CAAC,GAACX,CAAC,GAACQ,CAAC;QAACS,CAAC,GAAC,EAAE;QAACM,CAAC,GAAC,EAAE,GAACtD,CAAC,IAAEgD,CAAC,GAACN,CAAC,CAAC;QAACV,CAAC,GAAC,EAAE,GAAChC,CAAC,IAAEgD,CAAC,GAACjB,CAAC,CAAC;MAAC1B,CAAC,CAAC,CAAC,CAAC,GAAC+N,IAAI,CAAC+D,KAAK,CAAC9R,CAAC,CAAC,CAAC,CAAC,GAACiD,CAAC,CAAC,GAACA,CAAC,EAACjD,CAAC,CAAC,CAAC,CAAC,GAAC+N,IAAI,CAAC+D,KAAK,CAAC9R,CAAC,CAAC,CAAC,CAAC,GAAC2B,CAAC,CAAC,GAACA,CAAC;MAAC,MAAM6B,CAAC,GAAC3D,CAAC,CAACmN,KAAK;MAACxJ,CAAC,CAAC,CAAC,CAAC,GAACxD,CAAC,CAAC,CAAC,CAAC,GAACqC,CAAC,EAACmB,CAAC,CAAC,CAAC,CAAC,GAACxD,CAAC,CAAC,CAAC,CAAC,GAAC0B,CAAC,EAAC8B,CAAC,CAAC,CAAC,CAAC,GAACxD,CAAC,CAAC,CAAC,CAAC,GAACqC,CAAC,EAACmB,CAAC,CAAC,CAAC,CAAC,GAACxD,CAAC,CAAC,CAAC,CAAC,GAAC0B,CAAC,EAAC,IAAI,CAACuF,YAAY,IAAE,IAAI,CAAC8K,uBAAuB,CAACvO,CAAC,EAAC,CAAC,GAAC,CAAC,EAAC1B,CAAC,CAAC;MAAC,MAAM4B,CAAC,GAAC7D,CAAC,CAACoN,KAAK;MAAC,IAAG,CAAC,GAAC5K,CAAC,GAACQ,CAAC,CAAC5B,CAAC,CAAC,EAAC8B,CAAC,CAACW,CAAC,EAAC3C,CAAC,CAACE,CAAC,CAAC,CAAC,CAAC,KAAK,IAAGN,CAAC,IAAE,GAAG,GAACoN,IAAI,CAACkD,EAAE,EAACvN,CAAC,CAAC,CAAC,CAAC,GAACF,CAAC,CAAC,CAAC,CAAC,GAACnB,CAAC,EAACqB,CAAC,CAAC,CAAC,CAAC,GAACF,CAAC,CAAC,CAAC,CAAC,GAAC9B,CAAC,EAACgC,CAAC,CAAC,CAAC,CAAC,GAACF,CAAC,CAAC,CAAC,CAAC,GAACnB,CAAC,EAACqB,CAAC,CAAC,CAAC,CAAC,GAACF,CAAC,CAAC,CAAC,CAAC,GAAC9B,CAAC,CAAC,KAAI;QAACe,CAAC,CAAC/C,CAAC,CAAC+Q,GAAG,EAAC,IAAI,CAACzI,SAAS,EAAC+H,EAAE,EAAC,IAAI,CAAClJ,iBAAiB,CAAC,EAACpF,CAAC,CAACuQ,EAAE,EAAChS,CAAC,EAAC+P,EAAE,CAAC;QAAC,IAAIpQ,CAAC,GAAC,CAACoO,IAAI,CAACkE,KAAK,CAACD,EAAE,CAAC,CAAC,CAAC,EAACA,EAAE,CAAC,CAAC,CAAC,CAAC,GAAC,IAAI,GAACjE,IAAI,CAACkD,EAAE;QAACtR,CAAC,GAAC,CAAC,KAAGA,CAAC,IAAE,CAAC,GAACoO,IAAI,CAACkD,EAAE,CAAC;QAAC,MAAMpR,CAAC,GAACkO,IAAI,CAACmE,KAAK,CAACvS,CAAC,IAAE,GAAG,GAACoO,IAAI,CAACkD,EAAE,CAAC,CAAC;QAAC9O,CAAC,CAAC6P,EAAE,EAAC9L,EAAE,CAACrG,CAAC,CAAC,EAAC,CAAC,GAAC6B,CAAC,CAAC,EAACsQ,EAAE,CAAC,CAAC,CAAC,IAAE9P,CAAC,EAAC8P,EAAE,CAAC,CAAC,CAAC,IAAE9P,CAAC,EAACE,CAAC,CAACsB,CAAC,EAACF,CAAC,EAACwO,EAAE,CAAC;MAAA;MAAC,IAAG,IAAI,CAAC/K,YAAY,EAACvD,CAAC,CAAC,CAAC,CAAC,GAAC,IAAI,CAAC6E,kBAAkB,CAACnI,KAAK,CAACsD,CAAC,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAAC,IAAI,CAAC6E,kBAAkB,CAACnI,KAAK,CAACsD,CAAC,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAACqK,IAAI,CAACE,GAAG,CAACvK,CAAC,CAAC,CAAC,CAAC,EAAC,CAAC5B,CAAC,CAAC,EAAC4B,CAAC,CAAC,CAAC,CAAC,GAACqK,IAAI,CAACC,GAAG,CAACtK,CAAC,CAAC,CAAC,CAAC,EAAC5B,CAAC,CAAC,CAAC,KAAI;QAAC,MAAMpC,CAAC,GAAC0D,CAAC,CAACI,CAAC,EAACvC,CAAC,EAACkR,EAAE,CAAC;UAACxS,CAAC,GAACyD,CAAC,CAACM,CAAC,EAACzC,CAAC,EAACmR,EAAE,CAAC;QAAC9O,CAAC,CAAC5D,CAAC,EAACC,CAAC,CAAC,KAAG+D,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,CAAC;MAAA;MAAC,MAAMC,CAAC,GAACoK,IAAI,CAACwD,GAAG,CAAC/N,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC7D,CAAC;MAACE,CAAC,CAACwN,gBAAgB,GAACU,IAAI,CAACE,GAAG,CAACpO,CAAC,CAACwN,gBAAgB,EAAC1J,CAAC,CAAC,EAAC9D,CAAC,CAACuN,oBAAoB,GAACvN,CAAC,CAACwN,gBAAgB,GAAC1J,CAAC;IAAA;IAACiH,oBAAoBA,CAAClL,CAAC,EAACC,CAAC,EAAsC;MAAA,IAArCE,CAAC,GAAAwS,SAAA,CAAA1L,MAAA,QAAA0L,SAAA,QAAAC,SAAA,GAAAD,SAAA,MAAC,IAAI,CAAC5L,KAAK,CAACS,KAAK,CAACiD,iBAAiB;MAAE,IAAG,CAAC,KAAGzK,CAAC,CAACiH,MAAM,IAAE,CAAC,IAAI,CAACyB,kBAAkB,IAAE,CAAC,IAAI,CAACC,yBAAyB,EAAC;MAAO,MAAMtI,CAAC,GAAC,IAAI,CAACqI,kBAAkB;MAAC,IAAI,CAACA,kBAAkB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACC,yBAAyB,GAAC,CAAC,CAAC;MAAC,MAAMrI,CAAC,GAAC,IAAI,CAACuS,YAAY,CAAC7S,CAAC,CAACiF,CAAC,CAACwI,KAAK,CAAC,EAACtN,CAAC,CAAC;QAACM,CAAC,GAAC,IAAI,CAACoS,YAAY,CAAC7S,CAAC,CAACiF,CAAC,CAAC2I,KAAK,CAAC,EAACzN,CAAC,CAAC;MAACG,CAAC,KAAGiF,CAAC,CAACuN,OAAO,IAAErS,CAAC,KAAG8E,CAAC,CAACuN,OAAO,IAAE,IAAI,CAACzL,OAAO,CAAC2G,uBAAuB,CAAC3I,CAAC,CAACkG,MAAM,CAAC,EAAC,IAAI,CAACC,gCAAgC,EAAE,EAAC,IAAI,CAACtB,mBAAmB,EAAE,EAAC7J,CAAC,IAAE,IAAI,CAACgH,OAAO,CAAC0I,aAAa,CAAC9P,CAAC,CAAC,EAACA,CAAC,KAAGoF,CAAC,CAACkG,MAAM,IAAE,IAAI,CAAClE,OAAO,CAAC0L,aAAa,EAAE,IAAE,IAAI,CAAC1L,OAAO,CAAC0I,aAAa,CAAC1K,CAAC,CAAC2F,UAAU,CAAC;IAAA;IAAC6H,YAAYA,CAAC7S,CAAC,EAACC,CAAC,EAAC;MAAC,OAAO,IAAI,CAAC4I,kBAAkB,GAAC7I,CAAC,CAACgT,0BAA0B,CAAC,IAAI,CAACnK,kBAAkB,CAAC,GAAC7I,CAAC,CAACiT,wBAAwB,EAAE,EAACjT,CAAC,CAACkT,IAAI,CAAC,IAAI,CAAClL,QAAQ,EAAC/H,CAAC,CAAC;IAAA;IAACuL,gCAAgCA,CAAA,EAAE;MAAC,IAAG,IAAI,CAAC5C,uBAAuB,GAAC,CAAC,CAAC,EAAC,IAAI,CAACZ,QAAQ,CAACiD,WAAW,EAAC;QAAC,MAAMjL,CAAC,GAACmT,WAAW,CAACC,GAAG,EAAE;QAAC,IAAI,CAACxK,uBAAuB,GAAC,IAAI,CAACZ,QAAQ,CAACqL,+BAA+B,CAACrT,CAAC,CAAC;MAAA;IAAC;IAACiP,kBAAkBA,CAACjP,CAAC,EAACC,CAAC,EAAC;MAAC,OAAM,CAACkB,CAAC,CAACnB,CAAC,CAAC,KAAG,IAAI,CAAC6I,kBAAkB,GAAC,CAAC,IAAI,CAACA,kBAAkB,CAAClF,QAAQ,CAAC1D,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACD,CAAC,CAAC,CAAC,CAAC,CAAC,IAAE,IAAI,CAAC6I,kBAAkB,CAAClF,QAAQ,CAAC1D,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACD,CAAC,CAAC,CAAC,CAAC,CAAC,IAAE,IAAI,CAAC6I,kBAAkB,CAAClF,QAAQ,CAAC3D,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAG,EAAED,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC,IAAED,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAC6D,CAAC,CAAC9D,CAAC,EAACC,CAAC,CAAC,CAAC;IAAA;IAAC+O,eAAeA,CAAChP,CAAC,EAACC,CAAC,EAAC;MAAC,OAAM,CAACkB,CAAC,CAAClB,CAAC,CAAC,KAAG,IAAI,CAAC4I,kBAAkB,GAAC,IAAI,CAACA,kBAAkB,CAAClF,QAAQ,CAAC3D,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAE,IAAI,CAAC4I,kBAAkB,CAAClF,QAAQ,CAAC3D,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAEA,CAAC,CAAC,CAAC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,IAAEC,CAAC,CAAC,CAAC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,GAAC4D,CAAC,CAAC5D,CAAC,EAACC,CAAC,CAAC,CAAC;IAAA;IAACoP,gBAAgBA,CAACrP,CAAC,EAACC,CAAC,EAAC;MAAC,IAAG,IAAI,CAAC4I,kBAAkB,EAAC,OAAO,IAAI,CAACA,kBAAkB,CAAClF,QAAQ,CAAC1D,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,EAACD,CAAC,CAACyC,CAAC,CAAC,IAAEzC,CAAC,CAAC8B,CAAC,IAAE7B,CAAC,CAAC,CAAC,CAAC,IAAED,CAAC,CAAC8B,CAAC,IAAE7B,CAAC,CAAC,CAAC,CAAC;MAAC,MAAME,CAAC,GAACH,CAAC,CAACyC,CAAC;QAACpC,CAAC,GAACL,CAAC,CAAC8B,CAAC;MAAC,OAAO3B,CAAC,GAACF,CAAC,CAAC,CAAC,CAAC,IAAEE,CAAC,GAACF,CAAC,CAAC,CAAC,CAAC,IAAEI,CAAC,GAACJ,CAAC,CAAC,CAAC,CAAC,IAAEI,CAAC,GAACJ,CAAC,CAAC,CAAC,CAAC;IAAA;IAACoS,uBAAuBA,CAACrS,CAAC,EAACC,CAAC,EAACE,CAAC,EAAC;MAAC,IAAIE,CAAC,GAAC,CAAC;QAACC,CAAC,GAAC,CAAC;MAACN,CAAC,CAAC,CAAC,CAAC,GAAC,CAACC,CAAC,GAACI,CAAC,GAACL,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,GAACC,CAAC,KAAGI,CAAC,GAACJ,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAAC,CAACG,CAAC,GAACG,CAAC,GAACN,CAAC,CAAC,CAAC,CAAC,GAACG,CAAC,GAACH,CAAC,CAAC,CAAC,CAAC,GAACG,CAAC,KAAGG,CAAC,GAACH,CAAC,GAACH,CAAC,CAAC,CAAC,CAAC,CAAC,EAACgE,CAAC,CAAChE,CAAC,EAACK,CAAC,EAACC,CAAC,CAAC;IAAA;IAAC,IAAIgT,IAAIA,CAAA,EAAE;MAAC,OAAM;QAACtL,QAAQ,EAAC,IAAI,CAACA,QAAQ;QAACuL,MAAM,EAACA,CAAA,KAAI,IAAI,CAACvG,OAAO,CAAC3G,EAAE;MAAC,CAAC;IAAA;EAAC,CAAC;AAAC,SAASmI,EAAEA,CAACxO,CAAC,EAACC,CAAC,EAAC;EAAC,MAAME,CAAC,GAAC,IAAI;IAACE,CAAC,GAACwE,CAAC,CAAC2O,2BAA2B,GAAC,CAAC,GAACrT,CAAC,GAACkO,IAAI,CAACE,GAAG,CAACvO,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,EAACC,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,EAACA,CAAC,CAAC,CAAC,CAAC,GAACA,CAAC,CAAC,CAAC,CAAC,CAAC;EAAC,OAAOoO,IAAI,CAACwD,GAAG,CAAC5R,CAAC,CAAC,CAAC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,CAAC,IAAEK,CAAC,IAAEgO,IAAI,CAACwD,GAAG,CAAC5R,CAAC,CAAC,CAAC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,CAAC,IAAEK,CAAC,IAAEgO,IAAI,CAACwD,GAAG,CAAC5R,CAAC,CAAC,CAAC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,CAAC,IAAEK,CAAC,IAAEgO,IAAI,CAACwD,GAAG,CAAC5R,CAAC,CAAC,CAAC,CAAC,GAACD,CAAC,CAAC,CAAC,CAAC,CAAC,IAAEK,CAAC;AAAA;AAACL,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,mBAAmB,EAAC,KAAK,CAAC,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,CAAC;EAAC8R,QAAQ,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAAChN,EAAE,CAAC+M,SAAS,EAAC,SAAS,EAAC,IAAI,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,iBAAiB,EAAC,KAAK,CAAC,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,iBAAiB,EAAC,KAAK,CAAC,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,cAAc,EAAC,IAAI,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,kBAAkB,EAAC,IAAI,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,CAAC;EAAC+R,WAAW,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAACjN,EAAE,CAAC+M,SAAS,EAAC,UAAU,EAAC,KAAK,CAAC,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,CAAC;EAACgS,aAAa,EAAC,CAAC;AAAC,CAAC,CAAC,CAAC,EAAClN,EAAE,CAAC+M,SAAS,EAAC,SAAS,EAAC,KAAK,CAAC,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,WAAW,EAAC,IAAI,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,EAAE,CAAC,EAAC8E,EAAE,CAAC+M,SAAS,EAAC,UAAU,EAAC,IAAI,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,CAAC;EAACiS,IAAI,EAACC;AAAO,CAAC,CAAC,CAAC,EAACpN,EAAE,CAAC+M,SAAS,EAAC,eAAe,EAAC,IAAI,CAAC,EAACzT,CAAC,CAAC,CAAC4B,CAAC,CAAC;EAACiS,IAAI,EAACC;AAAO,CAAC,CAAC,CAAC,EAACpN,EAAE,CAAC+M,SAAS,EAAC,iBAAiB,EAAC,IAAI,CAAC,EAAC/M,EAAE,GAAC1G,CAAC,CAAC,CAAC8B,CAAC,CAAC,sCAAsC,CAAC,CAAC,EAAC4E,EAAE,CAAC;AAAC,MAAM4L,EAAE,GAACnQ,CAAC,EAAE;EAACkO,EAAE,GAAC9N,CAAC,EAAE;EAAC8K,EAAE,GAAC;IAACC,KAAK,EAACrK,CAAC,EAAE;IAACsK,KAAK,EAACtK,CAAC,EAAE;IAAC0K,gBAAgB,EAAC,CAAC;IAACD,oBAAoB,EAAC;EAAC,CAAC;EAAC+E,EAAE,GAACxP,CAAC,EAAE;EAACyP,EAAE,GAACzP,CAAC,EAAE;EAACkN,EAAE,GAAClM,CAAC,EAAE;AAAC,IAAI4J,EAAE;AAAC,CAAC,UAAS7N,CAAC,EAAC;EAACA,CAAC,CAACA,CAAC,CAACiO,IAAI,GAAC,CAAC,CAAC,GAAC,MAAM,EAACjO,CAAC,CAACA,CAAC,CAAC8N,MAAM,GAAC,CAAC,CAAC,GAAC,QAAQ,EAAC9N,CAAC,CAACA,CAAC,CAAC2O,aAAa,GAAC,CAAC,CAAC,GAAC,eAAe;AAAA,CAAC,CAACd,EAAE,KAAGA,EAAE,GAAC,CAAC,CAAC,CAAC,CAAC;AAAC,SAAOnH,EAAE,IAAIqN,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}