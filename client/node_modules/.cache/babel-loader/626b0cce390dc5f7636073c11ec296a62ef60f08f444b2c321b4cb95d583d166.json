{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport t from \"../../../request.js\";\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport { urlToObject as r, join as o } from \"../../../core/urlUtils.js\";\nimport { getJsonType as n } from \"../../../geometry/support/jsonUtils.js\";\nimport { normalizeCentralMeridian as i } from \"../../../geometry/support/normalizeUtils.js\";\nimport { mapParameters as s } from \"../../operations/urlUtils.js\";\nimport { applyFeatureSetZUnitScaling as u } from \"./queryZScale.js\";\nconst l = \"Layer does not support extent calculation.\";\nfunction y(t, r) {\n  const o = t.geometry,\n    i = t.toJSON(),\n    s = i;\n  if (e(o) && (s.geometry = JSON.stringify(o), s.geometryType = n(o), s.inSR = o.spatialReference.wkid || JSON.stringify(o.spatialReference)), i.topFilter?.groupByFields && (s.topFilter.groupByFields = i.topFilter.groupByFields.join(\",\")), i.topFilter?.orderByFields && (s.topFilter.orderByFields = i.topFilter.orderByFields.join(\",\")), i.topFilter && (s.topFilter = JSON.stringify(s.topFilter)), i.objectIds && (s.objectIds = i.objectIds.join(\",\")), i.orderByFields && (s.orderByFields = i.orderByFields.join(\",\")), i.outFields && !(r?.returnCountOnly || r?.returnExtentOnly || r?.returnIdsOnly) ? i.outFields.includes(\"*\") ? s.outFields = \"*\" : s.outFields = i.outFields.join(\",\") : delete s.outFields, i.outSR ? s.outSR = i.outSR.wkid || JSON.stringify(i.outSR) : o && i.returnGeometry && (s.outSR = s.inSR), i.returnGeometry && delete i.returnGeometry, i.timeExtent) {\n    const t = i.timeExtent,\n      {\n        start: e,\n        end: r\n      } = t;\n    null == e && null == r || (s.time = e === r ? e : `${e ?? \"null\"},${r ?? \"null\"}`), delete i.timeExtent;\n  }\n  return s;\n}\nasync function d(t, e, r, o) {\n  const n = await c(t, e, \"json\", o);\n  return u(e, r, n.data), n;\n}\nasync function m(t, r, o) {\n  return e(r.timeExtent) && r.timeExtent.isEmpty ? {\n    data: {\n      objectIds: []\n    }\n  } : c(t, r, \"json\", o, {\n    returnIdsOnly: !0\n  });\n}\nasync function p(t, r, o) {\n  return e(r.timeExtent) && r.timeExtent.isEmpty ? {\n    data: {\n      count: 0,\n      extent: null\n    }\n  } : c(t, r, \"json\", o, {\n    returnExtentOnly: !0,\n    returnCountOnly: !0\n  }).then(t => {\n    const e = t.data;\n    if (e.hasOwnProperty(\"extent\")) return t;\n    if (e.features) throw new Error(l);\n    if (e.hasOwnProperty(\"count\")) throw new Error(l);\n    return t;\n  });\n}\nfunction a(t, r, o) {\n  return e(r.timeExtent) && r.timeExtent.isEmpty ? Promise.resolve({\n    data: {\n      count: 0\n    }\n  }) : c(t, r, \"json\", o, {\n    returnIdsOnly: !0,\n    returnCountOnly: !0\n  });\n}\nfunction c(n, u, l) {\n  let d = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  let m = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n  const p = \"string\" == typeof n ? r(n) : n,\n    a = u.geometry ? [u.geometry] : [];\n  return d.responseType = \"pbf\" === l ? \"array-buffer\" : \"json\", i(a, null, d).then(r => {\n    const n = r && r[0];\n    e(n) && ((u = u.clone()).geometry = n);\n    const i = s({\n      ...p.query,\n      f: l,\n      ...m,\n      ...y(u, m)\n    });\n    return t(o(p.path, \"queryTopFeatures\"), {\n      ...d,\n      query: {\n        ...i,\n        ...d.query\n      }\n    });\n  });\n}\nexport { a as executeQueryForTopCount, p as executeQueryForTopExtents, m as executeQueryForTopIds, d as executeTopFeaturesQuery, y as queryToQueryStringParameters };","map":{"version":3,"names":["t","isSome","e","urlToObject","r","join","o","getJsonType","n","normalizeCentralMeridian","i","mapParameters","s","applyFeatureSetZUnitScaling","u","l","y","geometry","toJSON","JSON","stringify","geometryType","inSR","spatialReference","wkid","topFilter","groupByFields","orderByFields","objectIds","outFields","returnCountOnly","returnExtentOnly","returnIdsOnly","includes","outSR","returnGeometry","timeExtent","start","end","time","d","c","data","m","isEmpty","p","count","extent","then","hasOwnProperty","features","Error","a","Promise","resolve","arguments","length","undefined","responseType","clone","query","f","path","executeQueryForTopCount","executeQueryForTopExtents","executeQueryForTopIds","executeTopFeaturesQuery","queryToQueryStringParameters"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/rest/query/operations/queryTopFeatures.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport t from\"../../../request.js\";import{isSome as e}from\"../../../core/maybe.js\";import{urlToObject as r,join as o}from\"../../../core/urlUtils.js\";import{getJsonType as n}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as i}from\"../../../geometry/support/normalizeUtils.js\";import{mapParameters as s}from\"../../operations/urlUtils.js\";import{applyFeatureSetZUnitScaling as u}from\"./queryZScale.js\";const l=\"Layer does not support extent calculation.\";function y(t,r){const o=t.geometry,i=t.toJSON(),s=i;if(e(o)&&(s.geometry=JSON.stringify(o),s.geometryType=n(o),s.inSR=o.spatialReference.wkid||JSON.stringify(o.spatialReference)),i.topFilter?.groupByFields&&(s.topFilter.groupByFields=i.topFilter.groupByFields.join(\",\")),i.topFilter?.orderByFields&&(s.topFilter.orderByFields=i.topFilter.orderByFields.join(\",\")),i.topFilter&&(s.topFilter=JSON.stringify(s.topFilter)),i.objectIds&&(s.objectIds=i.objectIds.join(\",\")),i.orderByFields&&(s.orderByFields=i.orderByFields.join(\",\")),i.outFields&&!(r?.returnCountOnly||r?.returnExtentOnly||r?.returnIdsOnly)?i.outFields.includes(\"*\")?s.outFields=\"*\":s.outFields=i.outFields.join(\",\"):delete s.outFields,i.outSR?s.outSR=i.outSR.wkid||JSON.stringify(i.outSR):o&&i.returnGeometry&&(s.outSR=s.inSR),i.returnGeometry&&delete i.returnGeometry,i.timeExtent){const t=i.timeExtent,{start:e,end:r}=t;null==e&&null==r||(s.time=e===r?e:`${e??\"null\"},${r??\"null\"}`),delete i.timeExtent}return s}async function d(t,e,r,o){const n=await c(t,e,\"json\",o);return u(e,r,n.data),n}async function m(t,r,o){return e(r.timeExtent)&&r.timeExtent.isEmpty?{data:{objectIds:[]}}:c(t,r,\"json\",o,{returnIdsOnly:!0})}async function p(t,r,o){return e(r.timeExtent)&&r.timeExtent.isEmpty?{data:{count:0,extent:null}}:c(t,r,\"json\",o,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty(\"extent\"))return t;if(e.features)throw new Error(l);if(e.hasOwnProperty(\"count\"))throw new Error(l);return t}))}function a(t,r,o){return e(r.timeExtent)&&r.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):c(t,r,\"json\",o,{returnIdsOnly:!0,returnCountOnly:!0})}function c(n,u,l,d={},m={}){const p=\"string\"==typeof n?r(n):n,a=u.geometry?[u.geometry]:[];return d.responseType=\"pbf\"===l?\"array-buffer\":\"json\",i(a,null,d).then((r=>{const n=r&&r[0];e(n)&&((u=u.clone()).geometry=n);const i=s({...p.query,f:l,...m,...y(u,m)});return t(o(p.path,\"queryTopFeatures\"),{...d,query:{...i,...d.query}})}))}export{a as executeQueryForTopCount,p as executeQueryForTopExtents,m as executeQueryForTopIds,d as executeTopFeaturesQuery,y as queryToQueryStringParameters};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}