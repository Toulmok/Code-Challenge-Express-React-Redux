{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isAbortError as e } from \"../../../../core/promiseUtils.js\";\nimport { StyleUpdateType as t } from \"./enums.js\";\nimport s from \"./WorkerTile.js\";\nimport r from \"./style/StyleRepository.js\";\nclass o {\n  constructor() {\n    this._spriteInfo = {}, this._glyphInfo = {};\n  }\n  reset() {\n    return this._spriteInfo = {}, this._glyphInfo = {}, Promise.resolve();\n  }\n  getLayers() {\n    return this._styleRepository?.layers ?? [];\n  }\n  async createTileAndParse(t, r) {\n    const {\n        key: o\n      } = t,\n      i = {};\n    for (const e of Object.keys(t.sourceName2DataAndRefKey)) {\n      const s = t.sourceName2DataAndRefKey[e];\n      i[e] = s.refKey;\n    }\n    const n = new s(o, i, this, this._styleRepository);\n    try {\n      return await n.parse(t, r);\n    } catch (l) {\n      if (n.setObsolete(), n.release(), !e(l)) throw l;\n      return null;\n    }\n  }\n  updateStyle(e) {\n    if (!e || 0 === e.length || !this._styleRepository) return;\n    const s = this._styleRepository;\n    for (const r of e) {\n      const e = r.type,\n        o = r.data;\n      switch (e) {\n        case t.PAINTER_CHANGED:\n          s.setPaintProperties(o.layer, o.paint);\n          break;\n        case t.LAYOUT_CHANGED:\n          s.setLayoutProperties(o.layer, o.layout);\n          break;\n        case t.LAYER_REMOVED:\n          s.deleteStyleLayer(o.layer);\n          break;\n        case t.LAYER_CHANGED:\n          s.setStyleLayer(o.layer, o.index);\n          break;\n        case t.SPRITES_CHANGED:\n          this._spriteInfo = {};\n      }\n    }\n  }\n  setStyle(e) {\n    this._styleRepository = new r(e), this._spriteInfo = {}, this._glyphInfo = {};\n  }\n  fetchSprites(e, t, s) {\n    const r = [],\n      o = this._spriteInfo;\n    for (const i of e) {\n      void 0 === o[i.name] && r.push(i);\n    }\n    return 0 === r.length ? Promise.resolve() : t.invoke(\"getSprites\", r, {\n      signal: s && s.signal\n    }).then(e => {\n      for (const t in e) {\n        const s = e[t];\n        o[t] = s;\n      }\n    });\n  }\n  getSpriteItems() {\n    return this._spriteInfo;\n  }\n  fetchGlyphs(e, t, s, r, o) {\n    const i = [];\n    let n = this._glyphInfo[t];\n    return n ? s.forEach(e => {\n      n[e] || i.push(e);\n    }) : (n = this._glyphInfo[t] = [], s.forEach(e => i.push(e))), 0 === i.length ? Promise.resolve() : r.invoke(\"getGlyphs\", {\n      tileID: e,\n      font: t,\n      codePoints: i\n    }, o).then(e => {\n      for (let t = 0; t < e.length; t++) e[t] && (n[t] = e[t]);\n    });\n  }\n  getGlyphItems(e) {\n    return this._glyphInfo[e];\n  }\n}\nexport { o as default };","map":{"version":3,"names":["isAbortError","e","StyleUpdateType","t","s","r","o","constructor","_spriteInfo","_glyphInfo","reset","Promise","resolve","getLayers","_styleRepository","layers","createTileAndParse","key","i","Object","keys","sourceName2DataAndRefKey","refKey","n","parse","l","setObsolete","release","updateStyle","length","type","data","PAINTER_CHANGED","setPaintProperties","layer","paint","LAYOUT_CHANGED","setLayoutProperties","layout","LAYER_REMOVED","deleteStyleLayer","LAYER_CHANGED","setStyleLayer","index","SPRITES_CHANGED","setStyle","fetchSprites","name","push","invoke","signal","then","getSpriteItems","fetchGlyphs","forEach","tileID","font","codePoints","getGlyphItems","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/2d/engine/vectorTiles/WorkerTileHandler.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isAbortError as e}from\"../../../../core/promiseUtils.js\";import{StyleUpdateType as t}from\"./enums.js\";import s from\"./WorkerTile.js\";import r from\"./style/StyleRepository.js\";class o{constructor(){this._spriteInfo={},this._glyphInfo={}}reset(){return this._spriteInfo={},this._glyphInfo={},Promise.resolve()}getLayers(){return this._styleRepository?.layers??[]}async createTileAndParse(t,r){const{key:o}=t,i={};for(const e of Object.keys(t.sourceName2DataAndRefKey)){const s=t.sourceName2DataAndRefKey[e];i[e]=s.refKey}const n=new s(o,i,this,this._styleRepository);try{return await n.parse(t,r)}catch(l){if(n.setObsolete(),n.release(),!e(l))throw l;return null}}updateStyle(e){if(!e||0===e.length||!this._styleRepository)return;const s=this._styleRepository;for(const r of e){const e=r.type,o=r.data;switch(e){case t.PAINTER_CHANGED:s.setPaintProperties(o.layer,o.paint);break;case t.LAYOUT_CHANGED:s.setLayoutProperties(o.layer,o.layout);break;case t.LAYER_REMOVED:s.deleteStyleLayer(o.layer);break;case t.LAYER_CHANGED:s.setStyleLayer(o.layer,o.index);break;case t.SPRITES_CHANGED:this._spriteInfo={}}}}setStyle(e){this._styleRepository=new r(e),this._spriteInfo={},this._glyphInfo={}}fetchSprites(e,t,s){const r=[],o=this._spriteInfo;for(const i of e){void 0===o[i.name]&&r.push(i)}return 0===r.length?Promise.resolve():t.invoke(\"getSprites\",r,{signal:s&&s.signal}).then((e=>{for(const t in e){const s=e[t];o[t]=s}}))}getSpriteItems(){return this._spriteInfo}fetchGlyphs(e,t,s,r,o){const i=[];let n=this._glyphInfo[t];return n?s.forEach((e=>{n[e]||i.push(e)})):(n=this._glyphInfo[t]=[],s.forEach((e=>i.push(e)))),0===i.length?Promise.resolve():r.invoke(\"getGlyphs\",{tileID:e,font:t,codePoints:i},o).then((e=>{for(let t=0;t<e.length;t++)e[t]&&(n[t]=e[t])}))}getGlyphItems(e){return this._glyphInfo[e]}}export{o as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}