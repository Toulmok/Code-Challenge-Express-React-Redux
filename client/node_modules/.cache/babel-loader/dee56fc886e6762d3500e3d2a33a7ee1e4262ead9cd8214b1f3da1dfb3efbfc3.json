{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { removeMaybe as e, isSome as s, isNone as o } from \"../../../../core/maybe.js\";\nimport { addFrameTask as d } from \"../../../../core/scheduling.js\";\nimport { FadeDirection as i } from \"../support/I3SLayerView.js\";\nclass t {\n  constructor() {\n    this.lodCrossfadeSignedDuration = 0;\n  }\n}\nclass a {\n  constructor(e) {\n    this._view = e, this._preRenderFrameTaskHandle = null, this._currentFrameStartTime = null, this._numFadingNodes = 0;\n  }\n  get updating() {\n    return this._numFadingNodes > 0;\n  }\n  stopNodeFading(s) {\n    null != s.lodCrossfadeProgress && (this._numFadingNodes--, s.lodCrossfadeProgress = null, 0 === this._numFadingNodes && (null != this._preRenderFrameTaskHandle && (this._preRenderFrameTaskHandle = e(this._preRenderFrameTaskHandle)), this._view.notifyLODUpdate(), this._view.notifyUpdate()));\n  }\n  _startNodeFading(e, s, o) {\n    0 === this._numFadingNodes && (this._preRenderFrameTaskHandle = d({\n      preRender: e => this._updateAllNodeFading(e)\n    }), this._view.notifyLODUpdate()), null == e.lodCrossfadeProgress && (this._numFadingNodes++, this._view.notifyUpdate()), e.lodCrossfadeSignedDuration = o, e.lodCrossfadeProgress = s;\n  }\n  _updateAllNodeFading(e) {\n    const o = this._view.nodeCrossfadingEnabled;\n    this._view.foreachCrossfadeNode((d, i) => {\n      if (s(i) && s(i.lodCrossfadeProgress)) {\n        const s = i.lodCrossfadeSignedDuration,\n          t = s > 0 ? this._view.fullOpacity : 0,\n          a = e.deltaTime / s,\n          r = i.lodCrossfadeProgress + Math.abs(a),\n          n = !o || r >= 1 || 0 === s,\n          l = t - (n ? 0 : s > 0 ? 1 : -1) * (1 - r);\n        n ? (this.stopNodeFading(i), s < 0 && this._view.markNodeToRemove(d)) : i.lodCrossfadeProgress = r, this._view.setNodeOpacityByIndex(d, l);\n      }\n    }), this._view.removeMarkedNodes();\n  }\n  stopAllNodeFading() {\n    this._view.foreachCrossfadeNode((e, o) => {\n      if (s(o) && s(o.lodCrossfadeProgress)) {\n        this.stopNodeFading(o);\n        const s = o.lodCrossfadeSignedDuration;\n        s < 0 && this._view.markNodeToRemove(e);\n        const d = s > 0 ? this._view.fullOpacity : 0;\n        this._view.setNodeOpacityByIndex(e, d);\n      }\n    }), this._view.removeMarkedNodes();\n  }\n  fadeNode(e, s, o, d) {\n    null == this._currentFrameStartTime && (this._currentFrameStartTime = Date.now());\n    const t = this._view,\n      a = t.nodeCrossfadingEnabled,\n      n = o === i.FadeIn ? t.fullOpacity : 0,\n      l = a ? d ? o === i.FadeIn ? t.lodCrossfadeinDuration : t.lodCrossfadeoutDuration : t.lodCrossfadeUncoveredDuration : 0,\n      h = this._view.getNodeOpacityByIndex(e);\n    if (a && h !== n && l > 0) {\n      const e = 1 - Math.abs(n - h);\n      this._startNodeFading(s, e, r(o) * l);\n    } else this.stopNodeFading(s), this._view.setNodeOpacityByIndex(e, n), o === i.FadeOut && this._view.removeNode(e);\n  }\n  isNodeFullyFadedIn(e) {\n    const s = this._view.getNodeCrossfadeMetaData(e);\n    return o(s) || null == s.lodCrossfadeProgress && this._view.getNodeOpacityByIndex(e) === this._view.fullOpacity;\n  }\n}\nfunction r(e) {\n  return e === i.FadeIn ? 1 : -1;\n}\nexport { a as I3SCrossfadeHelper, t as NodeCrossfadeMetaData };","map":{"version":3,"names":["removeMaybe","e","isSome","s","isNone","o","addFrameTask","d","FadeDirection","i","t","constructor","lodCrossfadeSignedDuration","a","_view","_preRenderFrameTaskHandle","_currentFrameStartTime","_numFadingNodes","updating","stopNodeFading","lodCrossfadeProgress","notifyLODUpdate","notifyUpdate","_startNodeFading","preRender","_updateAllNodeFading","nodeCrossfadingEnabled","foreachCrossfadeNode","fullOpacity","deltaTime","r","Math","abs","n","l","markNodeToRemove","setNodeOpacityByIndex","removeMarkedNodes","stopAllNodeFading","fadeNode","Date","now","FadeIn","lodCrossfadeinDuration","lodCrossfadeoutDuration","lodCrossfadeUncoveredDuration","h","getNodeOpacityByIndex","FadeOut","removeNode","isNodeFullyFadedIn","getNodeCrossfadeMetaData","I3SCrossfadeHelper","NodeCrossfadeMetaData"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/i3s/I3SCrossfadeHelper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{removeMaybe as e,isSome as s,isNone as o}from\"../../../../core/maybe.js\";import{addFrameTask as d}from\"../../../../core/scheduling.js\";import{FadeDirection as i}from\"../support/I3SLayerView.js\";class t{constructor(){this.lodCrossfadeSignedDuration=0}}class a{constructor(e){this._view=e,this._preRenderFrameTaskHandle=null,this._currentFrameStartTime=null,this._numFadingNodes=0}get updating(){return this._numFadingNodes>0}stopNodeFading(s){null!=s.lodCrossfadeProgress&&(this._numFadingNodes--,s.lodCrossfadeProgress=null,0===this._numFadingNodes&&(null!=this._preRenderFrameTaskHandle&&(this._preRenderFrameTaskHandle=e(this._preRenderFrameTaskHandle)),this._view.notifyLODUpdate(),this._view.notifyUpdate()))}_startNodeFading(e,s,o){0===this._numFadingNodes&&(this._preRenderFrameTaskHandle=d({preRender:e=>this._updateAllNodeFading(e)}),this._view.notifyLODUpdate()),null==e.lodCrossfadeProgress&&(this._numFadingNodes++,this._view.notifyUpdate()),e.lodCrossfadeSignedDuration=o,e.lodCrossfadeProgress=s}_updateAllNodeFading(e){const o=this._view.nodeCrossfadingEnabled;this._view.foreachCrossfadeNode(((d,i)=>{if(s(i)&&s(i.lodCrossfadeProgress)){const s=i.lodCrossfadeSignedDuration,t=s>0?this._view.fullOpacity:0,a=e.deltaTime/s,r=i.lodCrossfadeProgress+Math.abs(a),n=!o||r>=1||0===s,l=t-(n?0:s>0?1:-1)*(1-r);n?(this.stopNodeFading(i),s<0&&this._view.markNodeToRemove(d)):i.lodCrossfadeProgress=r,this._view.setNodeOpacityByIndex(d,l)}})),this._view.removeMarkedNodes()}stopAllNodeFading(){this._view.foreachCrossfadeNode(((e,o)=>{if(s(o)&&s(o.lodCrossfadeProgress)){this.stopNodeFading(o);const s=o.lodCrossfadeSignedDuration;s<0&&this._view.markNodeToRemove(e);const d=s>0?this._view.fullOpacity:0;this._view.setNodeOpacityByIndex(e,d)}})),this._view.removeMarkedNodes()}fadeNode(e,s,o,d){null==this._currentFrameStartTime&&(this._currentFrameStartTime=Date.now());const t=this._view,a=t.nodeCrossfadingEnabled,n=o===i.FadeIn?t.fullOpacity:0,l=a?d?o===i.FadeIn?t.lodCrossfadeinDuration:t.lodCrossfadeoutDuration:t.lodCrossfadeUncoveredDuration:0,h=this._view.getNodeOpacityByIndex(e);if(a&&h!==n&&l>0){const e=1-Math.abs(n-h);this._startNodeFading(s,e,r(o)*l)}else this.stopNodeFading(s),this._view.setNodeOpacityByIndex(e,n),o===i.FadeOut&&this._view.removeNode(e)}isNodeFullyFadedIn(e){const s=this._view.getNodeCrossfadeMetaData(e);return o(s)||null==s.lodCrossfadeProgress&&this._view.getNodeOpacityByIndex(e)===this._view.fullOpacity}}function r(e){return e===i.FadeIn?1:-1}export{a as I3SCrossfadeHelper,t as NodeCrossfadeMetaData};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}