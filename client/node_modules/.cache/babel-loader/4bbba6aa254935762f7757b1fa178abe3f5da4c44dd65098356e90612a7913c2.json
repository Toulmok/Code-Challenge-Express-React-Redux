{"ast":null,"code":"import _regeneratorRuntime from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _createForOfIteratorHelper from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _asyncToGenerator from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/code-challenge-react/client/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from \"../../../../../core/has.js\";\nimport { throwIfAborted as e, isAbortError as t } from \"../../../../../core/promiseUtils.js\";\nimport { BaseFeatureSource as r } from \"./BaseFeatureSource.js\";\nvar s = has(\"esri-mobile\"),\n  i = {\n    maxDrillLevel: s ? 1 : 4,\n    maxRecordCountFactor: s ? 1 : 3\n  };\nvar a = /*#__PURE__*/function (_r) {\n  _inherits(a, _r);\n  var _super = _createSuper(a);\n  function a(e) {\n    _classCallCheck(this, a);\n    return _super.call(this, e);\n  }\n  _createClass(a, [{\n    key: \"_fetchDataTile\",\n    value: function () {\n      var _fetchDataTile2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(r) {\n        var _this = this;\n        var s, _a, o, n, c, d;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              s = this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor, _a = this._subscriptions.get(r.key.id), o = _a.signal, n = r.getQuantizationParameters();\n              c = 0;\n              d = /*#__PURE__*/function () {\n                var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(u, l) {\n                  var p, m, _t, _iterator, _step, _e, _s;\n                  return _regeneratorRuntime().wrap(function _callee$(_context) {\n                    while (1) switch (_context.prev = _context.next) {\n                      case 0:\n                        p = _this._queryInfo, m = _this.createTileQuery(u, {\n                          maxRecordCountFactor: s ? i.maxRecordCountFactor : void 0,\n                          returnExceededLimitFeatures: !1,\n                          quantizationParameters: n\n                        });\n                        c++;\n                        _context.prev = 2;\n                        _context.next = 5;\n                        return _this._queue.push({\n                          tile: r,\n                          query: m,\n                          signal: o,\n                          depth: l\n                        });\n                      case 5:\n                        _t = _context.sent;\n                        if (!(c--, e(o), !_t)) {\n                          _context.next = 8;\n                          break;\n                        }\n                        return _context.abrupt(\"return\");\n                      case 8:\n                        if (!(p !== _this._queryInfo)) {\n                          _context.next = 10;\n                          break;\n                        }\n                        return _context.abrupt(\"return\", void d(u, l));\n                      case 10:\n                        if (!(_t.exceededTransferLimit && l < i.maxDrillLevel)) {\n                          _context.next = 14;\n                          break;\n                        }\n                        _iterator = _createForOfIteratorHelper(u.createChildTiles());\n                        try {\n                          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                            _e = _step.value;\n                            d(_e, l + 1);\n                          }\n                        } catch (err) {\n                          _iterator.e(err);\n                        } finally {\n                          _iterator.f();\n                        }\n                        return _context.abrupt(\"return\");\n                      case 14:\n                        _s = {\n                          id: r.id,\n                          addOrUpdate: _t,\n                          end: 0 === c,\n                          type: \"append\"\n                        };\n                        _a.add({\n                          query: m,\n                          message: _s\n                        }), _this._onMessage(_s);\n                        _context.next = 21;\n                        break;\n                      case 18:\n                        _context.prev = 18;\n                        _context.t0 = _context[\"catch\"](2);\n                        t(_context.t0) || _this._onMessage({\n                          id: r.id,\n                          addOrUpdate: null,\n                          end: !0,\n                          type: \"append\"\n                        });\n                      case 21:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }, _callee, null, [[2, 18]]);\n                }));\n                return function d(_x2, _x3) {\n                  return _ref.apply(this, arguments);\n                };\n              }();\n              d(r, 0);\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function _fetchDataTile(_x) {\n        return _fetchDataTile2.apply(this, arguments);\n      }\n      return _fetchDataTile;\n    }()\n  }]);\n  return a;\n}(r);\nexport { a as DrillDownFeatureSource };","map":{"version":3,"names":["has","throwIfAborted","e","isAbortError","t","BaseFeatureSource","r","s","i","maxDrillLevel","maxRecordCountFactor","a","_r","_inherits","_super","_createSuper","_classCallCheck","call","_createClass","key","value","_fetchDataTile2","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","_this","_a","o","n","c","d","wrap","_callee2$","_context2","prev","next","_serviceInfo","capabilities","query","supportsMaxRecordCountFactor","_subscriptions","get","id","signal","getQuantizationParameters","_ref","_callee","u","l","p","m","_t","_iterator","_step","_e","_s","_callee$","_context","_queryInfo","createTileQuery","returnExceededLimitFeatures","quantizationParameters","_queue","push","tile","depth","sent","abrupt","exceededTransferLimit","_createForOfIteratorHelper","createChildTiles","done","err","f","addOrUpdate","end","type","add","message","_onMessage","t0","stop","_x2","_x3","apply","arguments","_fetchDataTile","_x","DrillDownFeatureSource"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/2d/layers/features/sources/DrillDownFeatureSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{throwIfAborted as e,isAbortError as t}from\"../../../../../core/promiseUtils.js\";import{BaseFeatureSource as r}from\"./BaseFeatureSource.js\";const s=has(\"esri-mobile\"),i={maxDrillLevel:s?1:4,maxRecordCountFactor:s?1:3};class a extends r{constructor(e){super(e)}async _fetchDataTile(r){const s=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,a=this._subscriptions.get(r.key.id),o=a.signal,n=r.getQuantizationParameters();let c=0;const d=async(u,l)=>{const p=this._queryInfo,m=this.createTileQuery(u,{maxRecordCountFactor:s?i.maxRecordCountFactor:void 0,returnExceededLimitFeatures:!1,quantizationParameters:n});c++;try{const t=await this._queue.push({tile:r,query:m,signal:o,depth:l});if(c--,e(o),!t)return;if(p!==this._queryInfo)return void d(u,l);if(t.exceededTransferLimit&&l<i.maxDrillLevel){for(const e of u.createChildTiles())d(e,l+1);return}const s={id:r.id,addOrUpdate:t,end:0===c,type:\"append\"};a.add({query:m,message:s}),this._onMessage(s)}catch(h){t(h)||this._onMessage({id:r.id,addOrUpdate:null,end:!0,type:\"append\"})}};d(r,0)}}export{a as DrillDownFeatureSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}