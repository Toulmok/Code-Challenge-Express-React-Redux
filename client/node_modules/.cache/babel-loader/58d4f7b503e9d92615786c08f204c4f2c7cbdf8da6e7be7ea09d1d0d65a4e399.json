{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport r from \"../../../../core/Accessor.js\";\nimport { update as t } from \"../../../../core/arrayUtils.js\";\nimport s from \"../../../../core/Handles.js\";\nimport has from \"../../../../core/has.js\";\nimport { unwrapOr as i, removeMaybe as a, disposeMaybe as n, isSome as h, isNone as o, applySome as d, unwrap as l } from \"../../../../core/maybe.js\";\nimport _ from \"../../../../core/PooledArray.js\";\nimport { watch as c, syncAndInitial as p, initial as m, sync as u } from \"../../../../core/reactiveUtils.js\";\nimport { property as f } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as g } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { h as T, a as b, m as R } from \"../../../../chunks/mat4.js\";\nimport { I as E, c as A } from \"../../../../chunks/mat4f64.js\";\nimport { a as P } from \"../../../../chunks/boundedPlane.js\";\nimport S from \"../../support/debugFlags.js\";\nimport { TransparencyMode as y } from \"../../terrain/TerrainRenderer.js\";\nimport { RenderPassManager as w } from \"../core/renderPasses/RenderPassManager.js\";\nimport { ShaderOutput as O } from \"../core/shaderLibrary/ShaderOutput.js\";\nimport { HUDTransparentRenderStyle as C } from \"../core/shaderLibrary/hud/HUDUniforms.js\";\nimport { AnimationTimeStep as D } from \"./AnimationTimeStep.js\";\nimport { Decorations as x, RenderRequestType as I, StencilBits as H } from \"./basicInterfaces.js\";\nimport { BoundingInfo as v } from \"./BoundingInfo.js\";\nimport { ZERO as M, union as L } from \"./depthRange.js\";\nimport { depthRangeFromScene as N } from \"./depthRangeUtils.js\";\nimport { createEmptyDepthTexture as U } from \"./glUtil3D.js\";\nimport { Highlight as F } from \"./Highlight.js\";\nimport { RenderOccludedFlag as j } from \"./Material.js\";\nimport { OffscreenRendering as G } from \"./OffscreenRendering.js\";\nimport { RenderContext as q } from \"./RenderContext.js\";\nimport { splitRenderGeometryChangeSetByMaterial as V } from \"./rendererUtils.js\";\nimport { RenderFeature as B, setupFeatureDefaults as W } from \"./RenderFeature.js\";\nimport { RenderPluginManager as k } from \"./RenderPluginManager.js\";\nimport { RenderSlot as Q } from \"./RenderSlot.js\";\nimport { ShadowAccumulator as Y } from \"./ShadowAccumulator.js\";\nimport { ShadowHighlight as X } from \"./ShadowHighlight.js\";\nimport { ShadowMap as z, SnapshotSlot as J } from \"./ShadowMap.js\";\nimport K from \"./SliceHelper.js\";\nimport { SmaaRenderPass as Z } from \"./SmaaRenderPass.js\";\nimport { SSAOHelper as $ } from \"./SSAOHelper.js\";\nimport { TransparencyPassType as ee } from \"./TransparencyPassType.js\";\nimport { EdgeView as re } from \"./edgeRendering/EdgeView.js\";\nimport { Transparency as te } from \"./edgeRendering/interfaces.js\";\nimport { MergedRenderer as se } from \"../materials/renderers/MergedRenderer.js\";\nimport { AlphaMode as ie } from \"../shaders/CompositingTechniqueConfiguration.js\";\nimport { RendererPerformanceInfo as ae, PerformanceCategory as ne } from \"../statistics/RendererPerformanceInfo.js\";\nimport { RenderState as he } from \"../../../support/RenderState.js\";\nimport { ClearBufferBit as oe, PixelFormat as de, PixelType as le } from \"../../../webgl/enums.js\";\nlet _e = class extends r {\n  get _bindParameters() {\n    return this._renderContext.bindParameters;\n  }\n  isFeatureEnabled(e) {\n    let r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._state;\n    return i(this._renderStateFeatures.get(r, e), !1);\n  }\n  setFeatureEnabled(e, r, t) {\n    this._renderStateFeatures.set(r, e, t), this.notifyChange(\"_renderStateFeatures\"), this._requestRender();\n  }\n  get _antialiasing() {\n    return this._antialiasingEnabled || this.isFeatureEnabled(B.Antialiasing);\n  }\n  get _highQualityTransparency() {\n    return this._highQualityTransparencyEnabled || this.isFeatureEnabled(B.HighQualityTransparency);\n  }\n  get hasWaterReflection() {\n    return this.hasWater && (this._waterReflectionEnabled || this.isFeatureEnabled(B.WaterReflection));\n  }\n  get hasWater() {\n    return this._hasWater || this._hasOverlayWater;\n  }\n  constructor(e, r, t, i, a, n, h, o) {\n    super({}), this._stage = e, this._materialRepository = r, this._shaderTechniqueRepository = i, this._rctx = a, this._compositingHelper = n, this._magnifierHelper = h, this._requestRender = o, this._materialRenderers = new _(), this._needsTransparentPass = !1, this._hasHUDElements = !1, this._hasHighlights = !1, this._hasWater = !1, this._hasOverlayWater = !1, this._renderOverlay = e => {}, this._isRendering = !1, this._fallbackDepthStencilTexture = null, this._sliceHelper = new K(), this._state = he.IDLE, this._renderStateFeatures = W(), this._antialiasingEnabled = !0, this._highQualityTransparencyEnabled = !0, this._terrainRenderingEnabled = !0, this._terrainTransparency = y.Opaque, this._waterReflectionEnabled = !1, this._ssaoEnabled = !1, this._hasAnimations = !1, this._animationTimestep = new D(), this._handles = new s(), this._renderHiddenTransparentEdges = () => {}, this._oitUsed = !1, this._smaaPass = new Z(this._rctx, i), o(), this._offscreen = new G(this._rctx, this._compositingHelper), this.performanceInfo = new ae(this._rctx), this._shadowMap = new z(this._rctx, e.viewingMode), this._ssaoHelper = new $(e.view, i, this._rctx, o), this._highlight = new F(i, this._rctx), this._shadowHighlight = new X(this._rctx, e.viewingMode), this._shadowAccumulator = new Y(this._rctx, i, e, e => {\n      const r = this.shadowsEnabled;\n      this._shadowMap.enabled = !0, this._prepare(e.camera, e.contentCamera), this._renderPlugins.prepareRender(), this._shadowMap.enabled = r;\n    }, (e, r, t) => {\n      e.shadowMap.start(e.camera, r, t), this._renderShadowCascades(O.Shadow, e.shadowMap), e.camera.setGLViewport(this._rctx), this._prepare(e.camera, e.contentCamera);\n    }, o), this._renderContext = new q(this._rctx, this._offscreen, this._shadowMap, this._ssaoHelper, this._sliceHelper), this._renderPlugins = new k({\n      renderContext: this._renderContext,\n      techniqueRepository: i,\n      textureRepository: t,\n      materialRepository: this._materialRepository,\n      requestRender: o,\n      controller: e\n    }), this.renderPassManager = new w(this._rctx, this._shaderTechniqueRepository), this._renderPlugins.add(this.renderPassManager.slots(), this.renderPassManager), this._handles.add([c(() => this._stage.view.state.camera, () => o(), p), c(() => S.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES, e => {\n      this._renderHiddenTransparentEdges = e ? () => this._renderEdges(te.TRANSPARENT) : () => {}, o();\n    }, m), c(() => this._ssaoEnabled || this.isFeatureEnabled(B.SSAO), e => this._ssaoHelper.enabled = e, p)]);\n  }\n  normalizeCtorArgs() {\n    return {};\n  }\n  destroy() {\n    this._handles.destroy(), this._smaaPass.dispose(), this._gpuTimerHandle = a(this._gpuTimerHandle), this._materialRenderers.forAll(e => e.dispose()), this._materialRenderers.clear(), this._offscreen.dispose(), this._fallbackDepthStencilTexture = n(this._fallbackDepthStencilTexture), this._shadowMap.dispose(), this._ssaoHelper.dispose(), this._highlight.dispose(), this._shadowHighlight.dispose(), this._shadowAccumulator.dispose(), v.prune();\n  }\n  disposeOffscreenBuffers() {\n    this._offscreen.dispose(), this._shadowMap.disposeOffscreenBuffers(), this._smaaPass.disable(), this._ssaoHelper.disposeOffscreenBuffers();\n  }\n  get updating() {\n    return this._antialiasing && this._smaaPass.updating || h(this._edgeView) && this._edgeView.updating || this._shadowAccumulator.running || !this.isCameraFinal;\n  }\n  ensureEdgeView() {\n    return o(this._edgeView) && (this._edgeView = new re({\n      rctx: this._rctx,\n      renderSR: this._stage.view.renderSpatialReference,\n      viewingMode: this._stage.viewingMode,\n      techniqueRepository: this._shaderTechniqueRepository,\n      setNeedsRender: () => this._requestRender(),\n      schedule: e => this._stage.view.resourceController.immediate.schedule(e)\n    }), this._handles.add(c(() => d(this._edgeView, e => e.updating), () => this._requestRender(), u)), this._requestRender()), this._edgeView;\n  }\n  get edgeView() {\n    return this._edgeView;\n  }\n  get isCameraFinal() {\n    return T(this._bindParameters.ssr.reprojectionMatrix, E);\n  }\n  set _reprojectionMatrix(e) {\n    t(this._bindParameters.ssr.reprojectionMatrix, e) && this.notifyChange(\"isCameraFinal\");\n  }\n  get shadowsEnabled() {\n    return !!this._shadowMap?.enabled;\n  }\n  setParameters(e) {\n    const {\n      _shadowMap: r,\n      _bindParameters: t\n    } = this;\n    if (void 0 !== e.screenSpaceReflectionsEnabled && t.ssr.enabled !== e.screenSpaceReflectionsEnabled && (t.ssr.enabled = e.screenSpaceReflectionsEnabled, this._requestRender()), void 0 !== e.shadowMap && this._shadowMap.enabled !== e.shadowMap && (this._shadowMap.enabled = e.shadowMap, this._requestRender()), void 0 !== e.shadowMapMaxCascades && r.maxCascades !== e.shadowMapMaxCascades && (r.maxCascades = e.shadowMapMaxCascades, this._requestRender()), h(e.environment)) {\n      h(e.environment.weather) && (this._bindParameters.weather = e.environment.weather, this._bindParameters.weatherVisible = !!e.weatherVisible), void 0 !== e.environment.lighting.ambientOcclusionEnabled && this._ssaoEnabled !== e.environment.lighting.ambientOcclusionEnabled && (this._ssaoEnabled = e.environment.lighting.ambientOcclusionEnabled, this._requestRender()), void 0 !== e.environment.lighting.waterReflectionEnabled && this._waterReflectionEnabled !== e.environment.lighting.waterReflectionEnabled && (this._waterReflectionEnabled = e.environment.lighting.waterReflectionEnabled, this._requestRender());\n      const r = \"virtual\" !== e.environment.lighting.type;\n      t.enableFillLights !== r && (t.enableFillLights = r, this._requestRender());\n    }\n    e.background && this._offscreen.background !== e.background && (this._offscreen.background = e.background, this._requestRender()), void 0 !== e.antialiasingEnabled && this._antialiasingEnabled !== e.antialiasingEnabled && (this._antialiasingEnabled = e.antialiasingEnabled, this._requestRender()), void 0 !== e.highQualityTransparency && this._highQualityTransparencyEnabled !== e.highQualityTransparency && (this._highQualityTransparencyEnabled = e.highQualityTransparency, this._requestRender()), void 0 !== e.defaultHighlightOptions && (this._highlight.setDefaultOptions(e.defaultHighlightOptions), this._shadowHighlight.setDefaultOptions(e.defaultHighlightOptions), this._requestRender()), void 0 !== e.overlays && this._bindParameters.overlays !== e.overlays && (this._bindParameters.overlays = e.overlays, this._requestRender()), void 0 !== e.hasOverlayWater && this._hasOverlayWater !== e.hasOverlayWater && (this._hasOverlayWater = e.hasOverlayWater, this._requestRender()), void 0 !== e.renderOverlay && this._renderOverlay !== e.renderOverlay && (this._renderOverlay = e.renderOverlay, this._requestRender()), void 0 !== e.slicePlane && this._sliceHelper.plane !== e.slicePlane && (this._sliceHelper.plane = l(e.slicePlane), this._requestRender()), void 0 !== e.terrainRenderingEnabled && this._terrainRenderingEnabled !== e.terrainRenderingEnabled && (this._terrainRenderingEnabled = e.terrainRenderingEnabled, this._requestRender()), void 0 !== e.terrainTransparency && this._terrainTransparency !== e.terrainTransparency && (this._terrainTransparency = e.terrainTransparency, this._requestRender()), void 0 !== e.shadowCastOptions && this._shadowAccumulator.setOptions(e.shadowCastOptions);\n  }\n  get hasSlicePlane() {\n    return !!this._sliceHelper.plane;\n  }\n  get renderPlugins() {\n    return this._renderPlugins;\n  }\n  get _hasOITSupport() {\n    return this._rctx.driverTest.floatBufferBlend.result;\n  }\n  get _oitEnabled() {\n    return this._highQualityTransparency && this._hasOITSupport;\n  }\n  modify(e, r) {\n    this._isRendering && console.warn(\"Renderer.modify called while rendering\");\n    const {\n      adds: t,\n      removes: s,\n      updates: i\n    } = e;\n    if (0 === t.length && 0 === s.length && 0 === i.length) return;\n    const a = V(e);\n    let n = !1;\n    a.forEach((t, s) => {\n      if (r.done) return;\n      let i = this._materialRenderers.find(e => e.material === s);\n      o(i) && t.adds.length > 0 && (i = new se(this._rctx, this._materialRepository, s), this._materialRenderers.push(i)), i && (i.modify(t), i.isEmpty && (n = !0)), t.removes.forEach(r => e.removes.removeUnordered(r)), t.adds.forEach(r => e.adds.removeUnordered(r)), t.updates.forEach(r => e.updates.removeUnordered(r)), r.madeProgress();\n    }), n && this._materialRenderers.filterInPlace(e => !e.isEmpty || (e.dispose(), !1)), this._hasHighlights = this._materialRenderers.some(e => e.hasHighlights), this._bindParameters.hasOccludees = this._materialRenderers.some(e => e.hasOccludees), this._hasWater = this._materialRenderers.some(e => e.hasWater), this._hasHUDElements = this._materialRenderers.some(e => e.requiresSlot(Q.LINE_CALLOUTS_HUD_DEPTH, O.Color) || e.requiresSlot(Q.HUD_MATERIAL, O.Color) || e.requiresSlot(Q.LABEL_MATERIAL, O.Color)), this._requestRender();\n  }\n  updateAnimation(e) {\n    const r = this._hasAnimations;\n    return this._hasAnimations = !1, this._materialRenderers.forAll(r => this._hasAnimations = r.updateAnimation(e) || this._hasAnimations), this._hasAnimations = this._renderPlugins.updateAnimation(e) || this._hasAnimations, this._hasAnimations !== r && (this._gpuTimerHandle = r ? a(this._gpuTimerHandle) : this.performanceInfo.enableGPUPerformanceInfo()), this._hasAnimations;\n  }\n  get animationTimestep() {\n    return this._animationTimestep.value;\n  }\n  get animationTimeDilation() {\n    return this._animationTimestep.timeDilation;\n  }\n  resetAnimation() {\n    this._animationTimestep.clear();\n  }\n  render(e, r, t, s, i) {\n    this._isRendering = !0, this.performanceInfo.startFrame();\n    const {\n      camera: a,\n      contentCamera: n,\n      mode: d\n    } = t;\n    this._state = d, this._renderOverlay(i), this.performanceInfo.advance(ne.OVERLAY), this._renderContext.time = i, this._bindParameters.transparencyPassType = ee.NONE;\n    const l = this._offscreen;\n    l.setupRenderTarget(this.hasWaterReflection);\n    const _ = P(this._sliceHelper.plane);\n    s === x.OFF && (this._sliceHelper.plane = null), this._rctx.bindFramebuffer(e), a.setGLViewport(this._rctx), this._prepare(a, n), this._renderPlugins.prepareRender(), this.performanceInfo.advance(ne.PREPARE);\n    const c = this._computeDepthRange(a);\n    this._renderShadowMap(e, a, this._bindParameters.lighting.mainLight.direction, c), this.performanceInfo.advance(ne.SHADOW_MAP), l.initializeFrame(a), this._ensureBindParameters(a, n), this._renderLinearDepth(), this.performanceInfo.advance(ne.LINEAR_DEPTH), this._accumulateShadows(c, a, n), this.performanceInfo.advance(ne.ACCUMULATED_SHADOWS), this._renderNormal(), this.performanceInfo.advance(ne.NORMALS), this._ensureBindParametersSSR(i), this._renderSSAO(i), this.performanceInfo.advance(ne.SSAO), this._renderContext.output = O.Color, l.bindFramebuffer(), this._renderOpaqueGeometry(), this.performanceInfo.advance(ne.OPAQUE);\n    const p = this._terrainRenderingEnabled && (this._terrainTransparency === y.Semitransparent || this._terrainTransparency === y.TransparentWithDraped),\n      m = this._highQualityTransparency && p;\n    this._renderTerrainLinearDepth(m), this._setMultipassEnabled(m), this._setTerrainCulling(m), this._renderEdges(te.OPAQUE), this.performanceInfo.advance(ne.OPAQUE_EDGES), this._offscreen.bindTarget(this._offscreen.currentColorTarget, this._offscreen.mainDepth), this._renderSlot(Q.VOXEL), this.performanceInfo.advance(ne.VOXEL), this._renderHiddenTransparentEdges();\n    const u = this._needsTransparentPass || this._renderPlugins.needsTransparentPass;\n    u && (this._oitEnabled ? this._renderOrderIndependentTransparency(() => this._renderTransparentGeometry(), !1) : this._renderTransparentGeometry()), this.performanceInfo.advance(ne.TRANSPARENT), this._renderGeometryLinearDepth(m);\n    const f = this._renderHUDVisibility(m);\n    m || this._renderInternalSlot(Q.LINE_CALLOUTS), this.performanceInfo.advance(ne.HUD_VISIBILITY), this._renderObjectAndLayerIdColor(r), this.performanceInfo.advance(ne.OBJECT_AND_LAYER_ID_COLOR), this._renderEdges(te.TRANSPARENT, m), this.performanceInfo.advance(ne.TRANSPARENT_EDGES), this._renderTransparentTerrain(), p && f && (m ? this._renderLineCallouts(C.Occluded) : l.compositeTransparentTerrainOntoHUDVisibility(this._bindParameters), this._renderHUD(C.Occluded, l.framebuffer), this.performanceInfo.advance(ne.HUD_OCCLUDED)), this.performanceInfo.advance(ne.TRANSPARENT_TERRAIN), this._setTerrainCulling(!1), p && (l.compositeTransparentTerrainOntoMain(this._bindParameters), m && (this._renderEdges(te.OPAQUE), this.performanceInfo.advance(ne.OPAQUE_EDGES), u && (this._oitEnabled ? this._renderOrderIndependentTransparency(() => this._renderTransparentGeometry(), !1) : this._renderTransparentGeometry()), this.performanceInfo.advance(ne.TRANSPARENT), this._renderEdges(te.TRANSPARENT), this.performanceInfo.advance(ne.TRANSPARENT_EDGES))), m && this._renderLineCallouts(C.NotOccluded), this._setMultipassEnabled(!1), this._shadowAccumulator.render(this._bindParameters), l.renderToTargets(() => {\n      this._renderInternalSlot(Q.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL), this._renderSlot(Q.POSTPROCESSING_ENVIRONMENT_TRANSPARENT), this._renderSlot(Q.LASERLINES);\n    }, l.currentColorTarget, l.mainDepth), this.performanceInfo.advance(ne.ENVIRONMENT), this._renderPlugins.needsLaserlineWithContrastControl && l.renderTmpAndCompositeToMain(() => this._renderSlot(Q.LASERLINES_CONTRAST_CONTROL), this._bindParameters, ie.PremultipliedAlpha), this.performanceInfo.advance(ne.LASER_LINE), this._renderOccluded(), this.performanceInfo.advance(ne.OCCLUDED);\n    const g = s === x.ON && this._magnifierHelper.enabled,\n      T = g && o(e) ? this._offscreen.getFramebuffer(this._offscreen.tmpColor, this._offscreen.tmpDepth) : e;\n    this._rctx.bindFramebuffer(T);\n    const b = this._offscreen.colorTexture;\n    !this._renderAntiAliasing(b) && h(b) && this._compositingHelper.composite(this._bindParameters, b, ie.None), this.performanceInfo.advance(ne.ANTIALIASING), this._renderHUD(C.NotOccluded, T), this.performanceInfo.advance(ne.HUD), this._renderHighlights(T, this._bindParameters), this.performanceInfo.advance(ne.HIGHLIGHTS), g && this._magnifierHelper.render(this._rctx, this._bindParameters), T !== e && (this._rctx.bindFramebuffer(e), this._compositingHelper.composite(this._bindParameters, this._offscreen.tmpColorTexture, ie.None)), this._disposeOITBuffers(), this._renderContext.lastFrameCamera.copyFrom(this._bindParameters.camera), this._sliceHelper.plane = _, this._isRendering = !1, this.onPostRender && this.onPostRender(), this.performanceInfo.finishFrame();\n  }\n  _renderObjectAndLayerIdColor(e) {\n    if (h(e) && has(\"enable-feature:objectAndLayerId-rendering\")) {\n      const r = this._renderContext.output;\n      this._rctx.bindFramebuffer(e), this._offscreen.renderToFBO(() => this._renderGeometryAndTransparentTerrainPass(O.ObjectAndLayerIdColor), [0, 0, 0, 0], !0, !0), this._rctx.bindFramebuffer(e), this._offscreen.renderToFBO(() => {\n        this._bindParameters.renderTransparentlyOccludedHUD = C.NotOccluded, this._renderInternalSlot(Q.HUD_MATERIAL);\n      }, void 0, !0, !0), this._renderContext.output = r;\n    }\n  }\n  finish(e) {\n    this._hasAnimations || this._animationTimestep.clear();\n    const r = this.performanceInfo.gpuSamplingEnabled,\n      t = e === I.BACKGROUND;\n    if (t || r) {\n      const e = t ? this.performanceInfo.elapsedTime : 0,\n        s = r ? this.performanceInfo.totalGPUTimeSampler.last : this._rctx.gl.getError(),\n        i = Math.max(e, s);\n      this._animationTimestep.frame(i, t);\n    }\n  }\n  readDepthPixels(e, r, t) {\n    const s = this._offscreen.bindTarget(this._offscreen.linearDepth, this._offscreen.tmpDepth);\n    if (!this._needsLinearDepth) {\n      this._ensureBindParameters(e, e), this._bindParameters.camera.setGLViewport(this._rctx), this._rctx.setClearColor(0, 0, 0, 0);\n      const r = oe.COLOR_BUFFER_BIT | oe.DEPTH_BUFFER_BIT | oe.STENCIL_BUFFER_BIT;\n      this._rctx.clearSafe(r), this._renderGeometryAndTransparentTerrainPass(O.Depth);\n    }\n    s.readPixels(r[0], r[1], r[2], r[3], de.RGBA, le.UNSIGNED_BYTE, t);\n  }\n  readHUDVisibility(e, r, t, s, i) {\n    this._offscreen.bindTarget(this._offscreen.hudVisibility).readPixels(e, r, t, s, de.RGBA, le.UNSIGNED_BYTE, i);\n  }\n  readAccumulatedShadow(e) {\n    return this._shadowAccumulator.readAccumulatedShadow(e[0], e[1]);\n  }\n  _setMultipassEnabled(e) {\n    this._bindParameters.multipassTerrain.enabled = this._bindParameters.multipassGeometry.enabled = e;\n  }\n  _setTerrainCulling(e) {\n    this._bindParameters.multipassTerrain.cullAboveGround = e;\n  }\n  _renderSlot(e) {\n    this._bindParameters.slot = e, this._renderPlugins.render();\n  }\n  _renderEdges(e) {\n    let r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n    const t = this._edgeView;\n    h(t) && t.shouldRender() && this._offscreen.renderTmpAndCompositeToMain(() => t.render(this._bindParameters, e), this._bindParameters, ie.Alpha, r);\n  }\n  _renderShadowMap(e, r, t, s) {\n    const i = this._shadowMap;\n    i.enabled && this.isFeatureEnabled(B.ShadowMapUpdate) && (i.start(r, t, s), this._shadowHighlight.updateParameters(r, t), this._needsShadowHighlight ? (this._renderShadowCascades(O.ShadowHighlight, this._shadowMap, e => i.takeCascadeSnapshotTo(e, J.Highlight)), i.clear(), this._renderShadowCascades(O.ShadowExcludeHighlight, this._shadowMap, e => {\n      i.takeCascadeSnapshotTo(e, J.Default), this._renderGeometryAndTransparentTerrainPass(O.ShadowHighlight);\n    })) : this._renderShadowCascades(O.Shadow), i.finish(e), r.setGLViewport(this._rctx));\n  }\n  _renderShadowCascades(e) {\n    let r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._shadowMap;\n    let t = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : e => {};\n    for (const s of r.cascades) s.camera.setGLViewport(this._rctx), this._prepare(s.camera, s.camera), this._renderGeometryAndTransparentTerrainPass(e), t(s);\n  }\n  get _needsLinearDepth() {\n    return this._ssaoHelper.active || this._renderPlugins.needsLinearDepth || this.hasWaterReflection || this._needsShadowHighlight || this._needsShadowCast;\n  }\n  _renderLinearDepth() {\n    this._needsLinearDepth ? this._offscreen.renderToTargets(() => this._renderGeometryAndTransparentTerrainPass(O.Depth), this._offscreen.linearDepth, this._offscreen.tmpDepth, [0, 0, 0, 0], !0, !0) : this._offscreen.disposeTarget(this._offscreen.linearDepth), this._bindParameters.linearDepthTexture = this._offscreen.linearDepthTexture;\n  }\n  _renderTerrainLinearDepth(e) {\n    if (e) {\n      const e = this._renderContext.output;\n      this._renderContext.output = O.Depth, this._offscreen.renderToTargets(() => this._renderTransparentTerrain(), this._offscreen.terrainLinearDepth, this._offscreen.tmpDepth, [-1e10, -1e10, -1e10, 1], !0, !0), this._renderContext.output = e;\n    } else this._offscreen.disposeTarget(this._offscreen.terrainLinearDepth);\n    this._bindParameters.multipassTerrain.linearDepthTexture = this._offscreen.terrainLinearDepthTexture;\n  }\n  _renderGeometryLinearDepth(e) {\n    if (e) {\n      const e = this._renderContext.output;\n      this._offscreen.renderToTargets(() => this._renderGeometryPass(O.Depth), this._offscreen.geometryLinearDepth, this._offscreen.tmpDepth, [1, 1, 1, 1], !0, !0), this._renderContext.output = e;\n    } else this._offscreen.disposeTarget(this._offscreen.geometryLinearDepth);\n    this._bindParameters.multipassGeometry.linearDepthTexture = this._offscreen.geometryLinearDepthTexture;\n  }\n  get _needsNormal() {\n    return this._ssaoHelper.active;\n  }\n  _renderNormal() {\n    this._needsNormal ? this._offscreen.renderToTargets(() => {\n      this._renderGeometryAndTransparentTerrainPass(O.Normal);\n    }, this._offscreen.normal, this._offscreen.tmpDepth, [0, 0, 0, 0], !0, !0) : this._offscreen.disposeTarget(this._offscreen.normal);\n  }\n  get _needsDepthRange() {\n    return this._shadowMap.enabled || this._needsShadowCast;\n  }\n  _computeDepthRange(e) {\n    if (!this._needsDepthRange) return M;\n    const r = N(e, this._materialRenderers, this._stage.layers);\n    return L(r, this.renderPlugins.queryDepthRange(e)), r.near = Math.max(e.near, r.near), r.far = Math.min(e.far, r.far), r;\n  }\n  _renderGeometryAndTransparentTerrainPass(e) {\n    this._renderContext.output = e, this._renderGeometryPass(e), this._renderTransparentTerrain();\n  }\n  _renderGeometryPass(e) {\n    this._renderContext.output = e, this._renderOpaqueGeometry(), this._renderTransparentGeometry();\n  }\n  _renderSSAO(e) {\n    this._ssaoHelper.render(this._bindParameters, e, this._offscreen.linearDepthTexture, this._offscreen.normalTexture);\n  }\n  _renderOpaqueGeometry() {\n    this._renderSlot(Q.INTEGRATED_MESH), this._renderSlot(Q.OPAQUE_TERRAIN), this._renderInternalSlot(Q.OPAQUE_MATERIAL), this._renderSlot(Q.OPAQUE_MATERIAL), this._renderSlot(Q.POSTPROCESSING_ENVIRONMENT_OPAQUE);\n  }\n  _renderTransparentGeometry() {\n    this._renderInternalSlot(Q.TRANSPARENT_MATERIAL), this._renderSlot(Q.TRANSPARENT_MATERIAL);\n  }\n  _renderTransparentTerrain() {\n    this._renderSlot(Q.TRANSPARENT_TERRAIN);\n  }\n  _renderHUDVisibility(e) {\n    let r = !1;\n    return this._renderContext.offscreenRenderingHelper && this._renderContext.offscreenRenderingHelper.renderHUDVisibility(() => {\n      this._bindParameters.hudVisibilityTexture = this._renderContext.offscreenRenderingHelper.hudVisibilityTexture, r = this._renderInternalSlot(Q.OCCLUSION_PIXELS);\n    }, e), r;\n  }\n  _renderLineCallouts(e) {\n    this._bindParameters.renderTransparentlyOccludedHUD = e, e === C.Occluded ? this._offscreen.renderToTargets(() => this._renderInternalSlot(Q.LINE_CALLOUTS), this._offscreen.currentColorTarget, this._offscreen.tmpDepth, void 0, !0, !0) : this._renderInternalSlot(Q.LINE_CALLOUTS);\n  }\n  _renderHUD(e, r) {\n    this._hasHUDElements && (this._oitEnabled ? (this._renderOrderIndependentTransparency(() => this._renderHUDElements(e), !0), this._rctx.bindFramebuffer(r), this._compositingHelper.composite(this._bindParameters, this._offscreen.hudColorTexture, ie.PremultipliedAlpha)) : e === C.Occluded ? this._offscreen.renderToTargets(() => this._renderHUDElements(C.Occluded), this._offscreen.currentColorTarget, this._offscreen.tmpDepth, void 0, !0, !0) : this._renderHUDElements(e));\n  }\n  _renderHUDElements(e) {\n    this._bindParameters.renderTransparentlyOccludedHUD = e, this._renderInternalSlot(Q.LINE_CALLOUTS_HUD_DEPTH), this._renderInternalSlot(Q.HUD_MATERIAL), this._renderInternalSlot(Q.LABEL_MATERIAL);\n  }\n  get _needsHighlight() {\n    return this._hasHighlights || this._renderPlugins.needsHighlight;\n  }\n  get _needsShadowHighlight() {\n    return this._shadowMap.enabled && this._shadowHighlight.isVisible && this._needsHighlight;\n  }\n  _renderHighlights(e, r) {\n    if (!this._needsHighlight) return void this._offscreen.disposeTarget(this._offscreen.highlight);\n    const t = this._highlight,\n      s = this._offscreen.renderToTargets(() => {\n        this._renderGeometryAndTransparentTerrainPass(O.Highlight), this._rctx.clearSafe(oe.DEPTH_BUFFER_BIT), this._renderHUDElements(C.Both);\n      }, this._offscreen.highlight, this._offscreen.tmpDepth, [0, 0, 0, 0], !0, !0);\n    this._bindParameters.highlightColorTexture = s.colorTexture, this._needsShadowHighlight && this._shadowHighlight.render(r, e), t.render(this._bindParameters, s, e);\n  }\n  get _needsShadowCast() {\n    return this._shadowAccumulator.isAccumulating;\n  }\n  _accumulateShadows(e, r, t) {\n    this._needsShadowCast && h(this._offscreen.linearDepthTexture) && this._shadowAccumulator.renderAccumulation(this._offscreen.linearDepthTexture, e, r, t);\n  }\n  _renderOrderIndependentTransparency(e, r) {\n    const t = t => {\n        this._bindParameters.transparencyPassType = t, this._offscreen.renderOITPass(() => e(), t, r);\n      },\n      s = this._renderContext.output;\n    this._renderContext.output = O.Alpha, t(ee.Alpha), this._renderContext.output = O.Color, t(ee.Color), t(ee.FrontFace), this._offscreen.compositeTransparentOntoOpaque(this._bindParameters, r), this._bindParameters.transparencyPassType = ee.NONE, this._renderContext.output = s, this._oitUsed = !0;\n  }\n  _disposeOITBuffers() {\n    this._oitUsed || (this._offscreen.disposeTarget(this._offscreen.alphaFloatTarget), this._offscreen.disposeTarget(this._offscreen.colorFloatTarget), this._offscreen.disposeTarget(this._offscreen.frontFaceTarget)), this._oitUsed = !1;\n  }\n  _renderOccluded() {\n    let e = 0;\n    pe.clear(), this._materialRenderers.forAll(r => {\n      r.material && r.material.isVisible() && r.material.renderOccluded === j.OccludeAndTransparentStencil && (e |= r.material.renderOccluded, pe.push(r));\n    });\n    const r = this._offscreen,\n      t = (t, s, i, a, n) => {\n        0 != (e & s) && (r.renderToTargets(i, r.tmpColor, r.mainDepth, [0, 0, 0, 0], a, n), r.compositeOccludedOntoMain(this._bindParameters, t));\n      };\n    0 !== pe.length && (this._renderInternalSlot(Q.OCCLUDER_MATERIAL, pe), t(.5, j.OccludeAndTransparentStencil, () => this._renderInternalSlot(Q.TRANSPARENT_OCCLUDER_MATERIAL, pe), !1, !1)), pe.clear(), this._materialRenderers.forAll(r => {\n      r.material && r.material.isVisible() && (r.material.renderOccluded === j.OccludeAndTransparent || r.material.renderOccluded === j.Transparent || r.material.renderOccluded === j.Opaque) && (e |= r.material.renderOccluded, pe.push(r));\n    });\n    const s = this._renderPlugins.renderOccludedFlags;\n    if (e |= s, !e) return;\n    const i = e => {\n      this._renderContext.renderOccludedMask = e, s > j.Occlude && this._renderSlot(Q.OCCLUDED_TERRAIN), this._renderInternalSlot(Q.OPAQUE_MATERIAL, pe), this._renderInternalSlot(Q.TRANSPARENT_MATERIAL, pe), this._renderInternalSlot(Q.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL, pe), this._renderContext.resetRenderOccludedMask();\n    };\n    this._renderContext.output = O.Color, t(.5, j.OccludeAndTransparent, () => i(j.OccludeAndTransparent), !0, H.OutlineVisualElementMask), t(.5, j.Transparent, () => i(j.Transparent), !0, H.OutlineVisualElementMask), t(1, j.Opaque, () => i(j.Opaque), !0, H.OutlineVisualElementMask), pe.clear();\n  }\n  _renderAntiAliasing(e) {\n    if (this._antialiasing) {\n      if (this._smaaPass.enable(() => this._requestRender()) && h(e)) return this._smaaPass.render(e), !0;\n    } else this._smaaPass.disable();\n    return !1;\n  }\n  _prepare(e, r) {\n    this._needsTransparentPass = this._materialRenderers.some(e => e.requiresSlot(Q.TRANSPARENT_MATERIAL, O.Color)), this._bindParameters.camera = e, this._bindParameters.contentCamera = r;\n  }\n  _ensureBindParameters(e, r) {\n    this._bindParameters.camera = e, this._bindParameters.contentCamera = r;\n    const t = this._renderContext.offscreenRenderingHelper;\n    this._bindParameters.hudVisibilityTexture = t.hudVisibilityTexture, this._bindParameters.mainColorTexture = t.mainColorTexture, this._bindParameters.highlightDepthTexture = t.depthTexture ?? this._getFallbackDepthTexture();\n  }\n  _ensureBindParametersSSR(e) {\n    if (this._bindParameters.ssr.enabled = this.hasWaterReflection, this._bindParameters.ssr.enabled) {\n      o(this._waterReflectionEnableTime) && (this._waterReflectionEnableTime = e), this._renderContext.lastFrameCamera.equals(this._bindParameters.camera) ? this._reprojectionMatrix = E : (b(ue, this._bindParameters.camera.viewMatrix), b(me, this._bindParameters.camera.projectionMatrix), R(fe, ue, me), R(fe, this._renderContext.lastFrameCamera.viewMatrix, fe), R(fe, this._renderContext.lastFrameCamera.projectionMatrix, fe), this._reprojectionMatrix = fe), this._bindParameters.ssr.lastFrameColorTexture = this._offscreen.lastFrameColorTexture;\n      const r = this._stage.view.qualitySettings.fadeDuration;\n      this._bindParameters.ssr.fadeFactor = r > 0 ? Math.min(r, e - this._waterReflectionEnableTime) / r : 1, this._bindParameters.ssr.fadeFactor < 1 && this._requestRender();\n    } else this._bindParameters.ssr.lastFrameColorTexture = null, this._waterReflectionEnableTime = null;\n  }\n  _renderInternalSlot(e) {\n    let r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._materialRenderers;\n    let t = !1;\n    return this._bindParameters.slot = e, r.forAll(e => {\n      e.material.shouldRender(this._renderContext) && e.render(this._renderContext.output, this._bindParameters) && (t = !0);\n    }), t;\n  }\n  _getFallbackDepthTexture() {\n    return this._fallbackDepthStencilTexture || (this._fallbackDepthStencilTexture = U(this._rctx)), this._fallbackDepthStencilTexture;\n  }\n  get gpuMemoryUsage() {\n    return {\n      offscreen: this._offscreen?.gpuMemoryUsage ?? 0,\n      highlights: (this._highlight?.gpuMemoryUsage ?? 0) + (this._shadowHighlight?.gpuMemoryUsage ?? 0),\n      shadows: this._shadowMap?.gpuMemoryUsage ?? 0,\n      ssao: this._ssaoHelper?.gpuMemoryUsage ?? 0\n    };\n  }\n  get test() {\n    const e = this;\n    return {\n      offscreen: this._offscreen,\n      shadowMap: this._shadowMap,\n      ssao: this._ssaoHelper,\n      highlight: this._highlight,\n      lighting: this._bindParameters.lighting,\n      materialRenderers: this._materialRenderers,\n      shadowAccumulator: this._shadowAccumulator,\n      weatherIsFading: this._bindParameters.cloudsFade.isFading,\n      resetRenderStateFeatures: () => {\n        e._renderStateFeatures = W();\n      },\n      getFramebufferTexture: r => {\n        switch (r) {\n          case ce.Color:\n            return e._offscreen.colorTexture;\n          case ce.LinearDepth:\n            return e._offscreen.linearDepthTexture;\n          case ce.Normals:\n            return e._offscreen.normalTexture;\n          case ce.ShadowMap:\n            return e._shadowMap.depthTexture;\n          case ce.HudVisibility:\n            return e._offscreen.hudVisibilityTexture;\n          case ce.Highlight:\n            return e._offscreen.highlightTexture;\n        }\n      }\n    };\n  }\n};\nvar ce;\ne([f()], _e.prototype, \"_shadowAccumulator\", void 0), e([f()], _e.prototype, \"_state\", void 0), e([f()], _e.prototype, \"_renderStateFeatures\", void 0), e([f()], _e.prototype, \"_antialiasingEnabled\", void 0), e([f({\n  readOnly: !0\n})], _e.prototype, \"_antialiasing\", null), e([f()], _e.prototype, \"_ssaoEnabled\", void 0), e([f()], _e.prototype, \"_smaaPass\", void 0), e([f({\n  autoDestroy: !0\n})], _e.prototype, \"_edgeView\", void 0), e([f()], _e.prototype, \"updating\", null), e([f()], _e.prototype, \"isCameraFinal\", null), _e = e([g(\"esri.views.3d.webgl-engine.lib.Renderer\")], _e), function (e) {\n  e[e.Color = 0] = \"Color\", e[e.LinearDepth = 1] = \"LinearDepth\", e[e.Normals = 2] = \"Normals\", e[e.ShadowMap = 3] = \"ShadowMap\", e[e.HudVisibility = 4] = \"HudVisibility\", e[e.Highlight = 5] = \"Highlight\";\n}(ce || (ce = {}));\nconst pe = new _(),\n  me = A(),\n  ue = A(),\n  fe = A();\nexport { ce as FramebufferId, _e as Renderer };","map":{"version":3,"names":["_","e","r","update","t","s","has","unwrapOr","i","removeMaybe","a","disposeMaybe","n","isSome","h","isNone","o","applySome","d","unwrap","l","watch","c","syncAndInitial","p","initial","m","sync","u","property","f","subclass","g","T","b","R","I","E","A","P","S","TransparencyMode","y","RenderPassManager","w","ShaderOutput","O","HUDTransparentRenderStyle","C","AnimationTimeStep","D","Decorations","x","RenderRequestType","StencilBits","H","BoundingInfo","v","ZERO","M","union","L","depthRangeFromScene","N","createEmptyDepthTexture","U","Highlight","F","RenderOccludedFlag","j","OffscreenRendering","G","RenderContext","q","splitRenderGeometryChangeSetByMaterial","V","RenderFeature","B","setupFeatureDefaults","W","RenderPluginManager","k","RenderSlot","Q","ShadowAccumulator","Y","ShadowHighlight","X","ShadowMap","z","SnapshotSlot","J","K","SmaaRenderPass","Z","SSAOHelper","$","TransparencyPassType","ee","EdgeView","re","Transparency","te","MergedRenderer","se","AlphaMode","ie","RendererPerformanceInfo","ae","PerformanceCategory","ne","RenderState","he","ClearBufferBit","oe","PixelFormat","de","PixelType","le","_e","_bindParameters","_renderContext","bindParameters","isFeatureEnabled","arguments","length","undefined","_state","_renderStateFeatures","get","setFeatureEnabled","set","notifyChange","_requestRender","_antialiasing","_antialiasingEnabled","Antialiasing","_highQualityTransparency","_highQualityTransparencyEnabled","HighQualityTransparency","hasWaterReflection","hasWater","_waterReflectionEnabled","WaterReflection","_hasWater","_hasOverlayWater","constructor","_stage","_materialRepository","_shaderTechniqueRepository","_rctx","_compositingHelper","_magnifierHelper","_materialRenderers","_needsTransparentPass","_hasHUDElements","_hasHighlights","_renderOverlay","_isRendering","_fallbackDepthStencilTexture","_sliceHelper","IDLE","_terrainRenderingEnabled","_terrainTransparency","Opaque","_ssaoEnabled","_hasAnimations","_animationTimestep","_handles","_renderHiddenTransparentEdges","_oitUsed","_smaaPass","_offscreen","performanceInfo","_shadowMap","viewingMode","_ssaoHelper","view","_highlight","_shadowHighlight","_shadowAccumulator","shadowsEnabled","enabled","_prepare","camera","contentCamera","_renderPlugins","prepareRender","shadowMap","start","_renderShadowCascades","Shadow","setGLViewport","renderContext","techniqueRepository","textureRepository","materialRepository","requestRender","controller","renderPassManager","add","slots","state","EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES","_renderEdges","TRANSPARENT","SSAO","normalizeCtorArgs","destroy","dispose","_gpuTimerHandle","forAll","clear","prune","disposeOffscreenBuffers","disable","updating","_edgeView","running","isCameraFinal","ensureEdgeView","rctx","renderSR","renderSpatialReference","setNeedsRender","schedule","resourceController","immediate","edgeView","ssr","reprojectionMatrix","_reprojectionMatrix","setParameters","screenSpaceReflectionsEnabled","shadowMapMaxCascades","maxCascades","environment","weather","weatherVisible","lighting","ambientOcclusionEnabled","waterReflectionEnabled","type","enableFillLights","background","antialiasingEnabled","highQualityTransparency","defaultHighlightOptions","setDefaultOptions","overlays","hasOverlayWater","renderOverlay","slicePlane","plane","terrainRenderingEnabled","terrainTransparency","shadowCastOptions","setOptions","hasSlicePlane","renderPlugins","_hasOITSupport","driverTest","floatBufferBlend","result","_oitEnabled","modify","console","warn","adds","removes","updates","forEach","done","find","material","push","isEmpty","removeUnordered","madeProgress","filterInPlace","some","hasHighlights","hasOccludees","requiresSlot","LINE_CALLOUTS_HUD_DEPTH","Color","HUD_MATERIAL","LABEL_MATERIAL","updateAnimation","enableGPUPerformanceInfo","animationTimestep","value","animationTimeDilation","timeDilation","resetAnimation","render","startFrame","mode","advance","OVERLAY","time","transparencyPassType","NONE","setupRenderTarget","OFF","bindFramebuffer","PREPARE","_computeDepthRange","_renderShadowMap","mainLight","direction","SHADOW_MAP","initializeFrame","_ensureBindParameters","_renderLinearDepth","LINEAR_DEPTH","_accumulateShadows","ACCUMULATED_SHADOWS","_renderNormal","NORMALS","_ensureBindParametersSSR","_renderSSAO","output","_renderOpaqueGeometry","OPAQUE","Semitransparent","TransparentWithDraped","_renderTerrainLinearDepth","_setMultipassEnabled","_setTerrainCulling","OPAQUE_EDGES","bindTarget","currentColorTarget","mainDepth","_renderSlot","VOXEL","needsTransparentPass","_renderOrderIndependentTransparency","_renderTransparentGeometry","_renderGeometryLinearDepth","_renderHUDVisibility","_renderInternalSlot","LINE_CALLOUTS","HUD_VISIBILITY","_renderObjectAndLayerIdColor","OBJECT_AND_LAYER_ID_COLOR","TRANSPARENT_EDGES","_renderTransparentTerrain","_renderLineCallouts","Occluded","compositeTransparentTerrainOntoHUDVisibility","_renderHUD","framebuffer","HUD_OCCLUDED","TRANSPARENT_TERRAIN","compositeTransparentTerrainOntoMain","NotOccluded","renderToTargets","TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL","POSTPROCESSING_ENVIRONMENT_TRANSPARENT","LASERLINES","ENVIRONMENT","needsLaserlineWithContrastControl","renderTmpAndCompositeToMain","LASERLINES_CONTRAST_CONTROL","PremultipliedAlpha","LASER_LINE","_renderOccluded","OCCLUDED","ON","getFramebuffer","tmpColor","tmpDepth","colorTexture","_renderAntiAliasing","composite","None","ANTIALIASING","HUD","_renderHighlights","HIGHLIGHTS","tmpColorTexture","_disposeOITBuffers","lastFrameCamera","copyFrom","onPostRender","finishFrame","renderToFBO","_renderGeometryAndTransparentTerrainPass","ObjectAndLayerIdColor","renderTransparentlyOccludedHUD","finish","gpuSamplingEnabled","BACKGROUND","elapsedTime","totalGPUTimeSampler","last","gl","getError","Math","max","frame","readDepthPixels","linearDepth","_needsLinearDepth","setClearColor","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","clearSafe","Depth","readPixels","RGBA","UNSIGNED_BYTE","readHUDVisibility","hudVisibility","readAccumulatedShadow","multipassTerrain","multipassGeometry","cullAboveGround","slot","shouldRender","Alpha","ShadowMapUpdate","updateParameters","_needsShadowHighlight","takeCascadeSnapshotTo","ShadowExcludeHighlight","Default","cascades","active","needsLinearDepth","_needsShadowCast","disposeTarget","linearDepthTexture","terrainLinearDepth","terrainLinearDepthTexture","_renderGeometryPass","geometryLinearDepth","geometryLinearDepthTexture","_needsNormal","Normal","normal","_needsDepthRange","layers","queryDepthRange","near","far","min","normalTexture","INTEGRATED_MESH","OPAQUE_TERRAIN","OPAQUE_MATERIAL","POSTPROCESSING_ENVIRONMENT_OPAQUE","TRANSPARENT_MATERIAL","offscreenRenderingHelper","renderHUDVisibility","hudVisibilityTexture","OCCLUSION_PIXELS","_renderHUDElements","hudColorTexture","_needsHighlight","needsHighlight","isVisible","highlight","Both","highlightColorTexture","isAccumulating","renderAccumulation","renderOITPass","FrontFace","compositeTransparentOntoOpaque","alphaFloatTarget","colorFloatTarget","frontFaceTarget","pe","renderOccluded","OccludeAndTransparentStencil","compositeOccludedOntoMain","OCCLUDER_MATERIAL","TRANSPARENT_OCCLUDER_MATERIAL","OccludeAndTransparent","Transparent","renderOccludedFlags","renderOccludedMask","Occlude","OCCLUDED_TERRAIN","resetRenderOccludedMask","OutlineVisualElementMask","enable","mainColorTexture","highlightDepthTexture","depthTexture","_getFallbackDepthTexture","_waterReflectionEnableTime","equals","ue","viewMatrix","me","projectionMatrix","fe","lastFrameColorTexture","qualitySettings","fadeDuration","fadeFactor","gpuMemoryUsage","offscreen","highlights","shadows","ssao","test","materialRenderers","shadowAccumulator","weatherIsFading","cloudsFade","isFading","resetRenderStateFeatures","getFramebufferTexture","ce","LinearDepth","Normals","HudVisibility","highlightTexture","prototype","readOnly","autoDestroy","FramebufferId","Renderer"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/webgl-engine/lib/Renderer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import{update as t}from\"../../../../core/arrayUtils.js\";import s from\"../../../../core/Handles.js\";import has from\"../../../../core/has.js\";import{unwrapOr as i,removeMaybe as a,disposeMaybe as n,isSome as h,isNone as o,applySome as d,unwrap as l}from\"../../../../core/maybe.js\";import _ from\"../../../../core/PooledArray.js\";import{watch as c,syncAndInitial as p,initial as m,sync as u}from\"../../../../core/reactiveUtils.js\";import{property as f}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as g}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{h as T,a as b,m as R}from\"../../../../chunks/mat4.js\";import{I as E,c as A}from\"../../../../chunks/mat4f64.js\";import{a as P}from\"../../../../chunks/boundedPlane.js\";import S from\"../../support/debugFlags.js\";import{TransparencyMode as y}from\"../../terrain/TerrainRenderer.js\";import{RenderPassManager as w}from\"../core/renderPasses/RenderPassManager.js\";import{ShaderOutput as O}from\"../core/shaderLibrary/ShaderOutput.js\";import{HUDTransparentRenderStyle as C}from\"../core/shaderLibrary/hud/HUDUniforms.js\";import{AnimationTimeStep as D}from\"./AnimationTimeStep.js\";import{Decorations as x,RenderRequestType as I,StencilBits as H}from\"./basicInterfaces.js\";import{BoundingInfo as v}from\"./BoundingInfo.js\";import{ZERO as M,union as L}from\"./depthRange.js\";import{depthRangeFromScene as N}from\"./depthRangeUtils.js\";import{createEmptyDepthTexture as U}from\"./glUtil3D.js\";import{Highlight as F}from\"./Highlight.js\";import{RenderOccludedFlag as j}from\"./Material.js\";import{OffscreenRendering as G}from\"./OffscreenRendering.js\";import{RenderContext as q}from\"./RenderContext.js\";import{splitRenderGeometryChangeSetByMaterial as V}from\"./rendererUtils.js\";import{RenderFeature as B,setupFeatureDefaults as W}from\"./RenderFeature.js\";import{RenderPluginManager as k}from\"./RenderPluginManager.js\";import{RenderSlot as Q}from\"./RenderSlot.js\";import{ShadowAccumulator as Y}from\"./ShadowAccumulator.js\";import{ShadowHighlight as X}from\"./ShadowHighlight.js\";import{ShadowMap as z,SnapshotSlot as J}from\"./ShadowMap.js\";import K from\"./SliceHelper.js\";import{SmaaRenderPass as Z}from\"./SmaaRenderPass.js\";import{SSAOHelper as $}from\"./SSAOHelper.js\";import{TransparencyPassType as ee}from\"./TransparencyPassType.js\";import{EdgeView as re}from\"./edgeRendering/EdgeView.js\";import{Transparency as te}from\"./edgeRendering/interfaces.js\";import{MergedRenderer as se}from\"../materials/renderers/MergedRenderer.js\";import{AlphaMode as ie}from\"../shaders/CompositingTechniqueConfiguration.js\";import{RendererPerformanceInfo as ae,PerformanceCategory as ne}from\"../statistics/RendererPerformanceInfo.js\";import{RenderState as he}from\"../../../support/RenderState.js\";import{ClearBufferBit as oe,PixelFormat as de,PixelType as le}from\"../../../webgl/enums.js\";let _e=class extends r{get _bindParameters(){return this._renderContext.bindParameters}isFeatureEnabled(e,r=this._state){return i(this._renderStateFeatures.get(r,e),!1)}setFeatureEnabled(e,r,t){this._renderStateFeatures.set(r,e,t),this.notifyChange(\"_renderStateFeatures\"),this._requestRender()}get _antialiasing(){return this._antialiasingEnabled||this.isFeatureEnabled(B.Antialiasing)}get _highQualityTransparency(){return this._highQualityTransparencyEnabled||this.isFeatureEnabled(B.HighQualityTransparency)}get hasWaterReflection(){return this.hasWater&&(this._waterReflectionEnabled||this.isFeatureEnabled(B.WaterReflection))}get hasWater(){return this._hasWater||this._hasOverlayWater}constructor(e,r,t,i,a,n,h,o){super({}),this._stage=e,this._materialRepository=r,this._shaderTechniqueRepository=i,this._rctx=a,this._compositingHelper=n,this._magnifierHelper=h,this._requestRender=o,this._materialRenderers=new _,this._needsTransparentPass=!1,this._hasHUDElements=!1,this._hasHighlights=!1,this._hasWater=!1,this._hasOverlayWater=!1,this._renderOverlay=e=>{},this._isRendering=!1,this._fallbackDepthStencilTexture=null,this._sliceHelper=new K,this._state=he.IDLE,this._renderStateFeatures=W(),this._antialiasingEnabled=!0,this._highQualityTransparencyEnabled=!0,this._terrainRenderingEnabled=!0,this._terrainTransparency=y.Opaque,this._waterReflectionEnabled=!1,this._ssaoEnabled=!1,this._hasAnimations=!1,this._animationTimestep=new D,this._handles=new s,this._renderHiddenTransparentEdges=()=>{},this._oitUsed=!1,this._smaaPass=new Z(this._rctx,i),o(),this._offscreen=new G(this._rctx,this._compositingHelper),this.performanceInfo=new ae(this._rctx),this._shadowMap=new z(this._rctx,e.viewingMode),this._ssaoHelper=new $(e.view,i,this._rctx,o),this._highlight=new F(i,this._rctx),this._shadowHighlight=new X(this._rctx,e.viewingMode),this._shadowAccumulator=new Y(this._rctx,i,e,(e=>{const r=this.shadowsEnabled;this._shadowMap.enabled=!0,this._prepare(e.camera,e.contentCamera),this._renderPlugins.prepareRender(),this._shadowMap.enabled=r}),((e,r,t)=>{e.shadowMap.start(e.camera,r,t),this._renderShadowCascades(O.Shadow,e.shadowMap),e.camera.setGLViewport(this._rctx),this._prepare(e.camera,e.contentCamera)}),o),this._renderContext=new q(this._rctx,this._offscreen,this._shadowMap,this._ssaoHelper,this._sliceHelper),this._renderPlugins=new k({renderContext:this._renderContext,techniqueRepository:i,textureRepository:t,materialRepository:this._materialRepository,requestRender:o,controller:e}),this.renderPassManager=new w(this._rctx,this._shaderTechniqueRepository),this._renderPlugins.add(this.renderPassManager.slots(),this.renderPassManager),this._handles.add([c((()=>this._stage.view.state.camera),(()=>o()),p),c((()=>S.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES),(e=>{this._renderHiddenTransparentEdges=e?()=>this._renderEdges(te.TRANSPARENT):()=>{},o()}),m),c((()=>this._ssaoEnabled||this.isFeatureEnabled(B.SSAO)),(e=>this._ssaoHelper.enabled=e),p)])}normalizeCtorArgs(){return{}}destroy(){this._handles.destroy(),this._smaaPass.dispose(),this._gpuTimerHandle=a(this._gpuTimerHandle),this._materialRenderers.forAll((e=>e.dispose())),this._materialRenderers.clear(),this._offscreen.dispose(),this._fallbackDepthStencilTexture=n(this._fallbackDepthStencilTexture),this._shadowMap.dispose(),this._ssaoHelper.dispose(),this._highlight.dispose(),this._shadowHighlight.dispose(),this._shadowAccumulator.dispose(),v.prune()}disposeOffscreenBuffers(){this._offscreen.dispose(),this._shadowMap.disposeOffscreenBuffers(),this._smaaPass.disable(),this._ssaoHelper.disposeOffscreenBuffers()}get updating(){return this._antialiasing&&this._smaaPass.updating||h(this._edgeView)&&this._edgeView.updating||this._shadowAccumulator.running||!this.isCameraFinal}ensureEdgeView(){return o(this._edgeView)&&(this._edgeView=new re({rctx:this._rctx,renderSR:this._stage.view.renderSpatialReference,viewingMode:this._stage.viewingMode,techniqueRepository:this._shaderTechniqueRepository,setNeedsRender:()=>this._requestRender(),schedule:e=>this._stage.view.resourceController.immediate.schedule(e)}),this._handles.add(c((()=>d(this._edgeView,(e=>e.updating))),(()=>this._requestRender()),u)),this._requestRender()),this._edgeView}get edgeView(){return this._edgeView}get isCameraFinal(){return T(this._bindParameters.ssr.reprojectionMatrix,E)}set _reprojectionMatrix(e){t(this._bindParameters.ssr.reprojectionMatrix,e)&&this.notifyChange(\"isCameraFinal\")}get shadowsEnabled(){return!!this._shadowMap?.enabled}setParameters(e){const{_shadowMap:r,_bindParameters:t}=this;if(void 0!==e.screenSpaceReflectionsEnabled&&t.ssr.enabled!==e.screenSpaceReflectionsEnabled&&(t.ssr.enabled=e.screenSpaceReflectionsEnabled,this._requestRender()),void 0!==e.shadowMap&&this._shadowMap.enabled!==e.shadowMap&&(this._shadowMap.enabled=e.shadowMap,this._requestRender()),void 0!==e.shadowMapMaxCascades&&r.maxCascades!==e.shadowMapMaxCascades&&(r.maxCascades=e.shadowMapMaxCascades,this._requestRender()),h(e.environment)){h(e.environment.weather)&&(this._bindParameters.weather=e.environment.weather,this._bindParameters.weatherVisible=!!e.weatherVisible),void 0!==e.environment.lighting.ambientOcclusionEnabled&&this._ssaoEnabled!==e.environment.lighting.ambientOcclusionEnabled&&(this._ssaoEnabled=e.environment.lighting.ambientOcclusionEnabled,this._requestRender()),void 0!==e.environment.lighting.waterReflectionEnabled&&this._waterReflectionEnabled!==e.environment.lighting.waterReflectionEnabled&&(this._waterReflectionEnabled=e.environment.lighting.waterReflectionEnabled,this._requestRender());const r=\"virtual\"!==e.environment.lighting.type;t.enableFillLights!==r&&(t.enableFillLights=r,this._requestRender())}e.background&&this._offscreen.background!==e.background&&(this._offscreen.background=e.background,this._requestRender()),void 0!==e.antialiasingEnabled&&this._antialiasingEnabled!==e.antialiasingEnabled&&(this._antialiasingEnabled=e.antialiasingEnabled,this._requestRender()),void 0!==e.highQualityTransparency&&this._highQualityTransparencyEnabled!==e.highQualityTransparency&&(this._highQualityTransparencyEnabled=e.highQualityTransparency,this._requestRender()),void 0!==e.defaultHighlightOptions&&(this._highlight.setDefaultOptions(e.defaultHighlightOptions),this._shadowHighlight.setDefaultOptions(e.defaultHighlightOptions),this._requestRender()),void 0!==e.overlays&&this._bindParameters.overlays!==e.overlays&&(this._bindParameters.overlays=e.overlays,this._requestRender()),void 0!==e.hasOverlayWater&&this._hasOverlayWater!==e.hasOverlayWater&&(this._hasOverlayWater=e.hasOverlayWater,this._requestRender()),void 0!==e.renderOverlay&&this._renderOverlay!==e.renderOverlay&&(this._renderOverlay=e.renderOverlay,this._requestRender()),void 0!==e.slicePlane&&this._sliceHelper.plane!==e.slicePlane&&(this._sliceHelper.plane=l(e.slicePlane),this._requestRender()),void 0!==e.terrainRenderingEnabled&&this._terrainRenderingEnabled!==e.terrainRenderingEnabled&&(this._terrainRenderingEnabled=e.terrainRenderingEnabled,this._requestRender()),void 0!==e.terrainTransparency&&this._terrainTransparency!==e.terrainTransparency&&(this._terrainTransparency=e.terrainTransparency,this._requestRender()),void 0!==e.shadowCastOptions&&this._shadowAccumulator.setOptions(e.shadowCastOptions)}get hasSlicePlane(){return!!this._sliceHelper.plane}get renderPlugins(){return this._renderPlugins}get _hasOITSupport(){return this._rctx.driverTest.floatBufferBlend.result}get _oitEnabled(){return this._highQualityTransparency&&this._hasOITSupport}modify(e,r){this._isRendering&&console.warn(\"Renderer.modify called while rendering\");const{adds:t,removes:s,updates:i}=e;if(0===t.length&&0===s.length&&0===i.length)return;const a=V(e);let n=!1;a.forEach(((t,s)=>{if(r.done)return;let i=this._materialRenderers.find((e=>e.material===s));o(i)&&t.adds.length>0&&(i=new se(this._rctx,this._materialRepository,s),this._materialRenderers.push(i)),i&&(i.modify(t),i.isEmpty&&(n=!0)),t.removes.forEach((r=>e.removes.removeUnordered(r))),t.adds.forEach((r=>e.adds.removeUnordered(r))),t.updates.forEach((r=>e.updates.removeUnordered(r))),r.madeProgress()})),n&&this._materialRenderers.filterInPlace((e=>!e.isEmpty||(e.dispose(),!1))),this._hasHighlights=this._materialRenderers.some((e=>e.hasHighlights)),this._bindParameters.hasOccludees=this._materialRenderers.some((e=>e.hasOccludees)),this._hasWater=this._materialRenderers.some((e=>e.hasWater)),this._hasHUDElements=this._materialRenderers.some((e=>e.requiresSlot(Q.LINE_CALLOUTS_HUD_DEPTH,O.Color)||e.requiresSlot(Q.HUD_MATERIAL,O.Color)||e.requiresSlot(Q.LABEL_MATERIAL,O.Color))),this._requestRender()}updateAnimation(e){const r=this._hasAnimations;return this._hasAnimations=!1,this._materialRenderers.forAll((r=>this._hasAnimations=r.updateAnimation(e)||this._hasAnimations)),this._hasAnimations=this._renderPlugins.updateAnimation(e)||this._hasAnimations,this._hasAnimations!==r&&(this._gpuTimerHandle=r?a(this._gpuTimerHandle):this.performanceInfo.enableGPUPerformanceInfo()),this._hasAnimations}get animationTimestep(){return this._animationTimestep.value}get animationTimeDilation(){return this._animationTimestep.timeDilation}resetAnimation(){this._animationTimestep.clear()}render(e,r,t,s,i){this._isRendering=!0,this.performanceInfo.startFrame();const{camera:a,contentCamera:n,mode:d}=t;this._state=d,this._renderOverlay(i),this.performanceInfo.advance(ne.OVERLAY),this._renderContext.time=i,this._bindParameters.transparencyPassType=ee.NONE;const l=this._offscreen;l.setupRenderTarget(this.hasWaterReflection);const _=P(this._sliceHelper.plane);s===x.OFF&&(this._sliceHelper.plane=null),this._rctx.bindFramebuffer(e),a.setGLViewport(this._rctx),this._prepare(a,n),this._renderPlugins.prepareRender(),this.performanceInfo.advance(ne.PREPARE);const c=this._computeDepthRange(a);this._renderShadowMap(e,a,this._bindParameters.lighting.mainLight.direction,c),this.performanceInfo.advance(ne.SHADOW_MAP),l.initializeFrame(a),this._ensureBindParameters(a,n),this._renderLinearDepth(),this.performanceInfo.advance(ne.LINEAR_DEPTH),this._accumulateShadows(c,a,n),this.performanceInfo.advance(ne.ACCUMULATED_SHADOWS),this._renderNormal(),this.performanceInfo.advance(ne.NORMALS),this._ensureBindParametersSSR(i),this._renderSSAO(i),this.performanceInfo.advance(ne.SSAO),this._renderContext.output=O.Color,l.bindFramebuffer(),this._renderOpaqueGeometry(),this.performanceInfo.advance(ne.OPAQUE);const p=this._terrainRenderingEnabled&&(this._terrainTransparency===y.Semitransparent||this._terrainTransparency===y.TransparentWithDraped),m=this._highQualityTransparency&&p;this._renderTerrainLinearDepth(m),this._setMultipassEnabled(m),this._setTerrainCulling(m),this._renderEdges(te.OPAQUE),this.performanceInfo.advance(ne.OPAQUE_EDGES),this._offscreen.bindTarget(this._offscreen.currentColorTarget,this._offscreen.mainDepth),this._renderSlot(Q.VOXEL),this.performanceInfo.advance(ne.VOXEL),this._renderHiddenTransparentEdges();const u=this._needsTransparentPass||this._renderPlugins.needsTransparentPass;u&&(this._oitEnabled?this._renderOrderIndependentTransparency((()=>this._renderTransparentGeometry()),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(ne.TRANSPARENT),this._renderGeometryLinearDepth(m);const f=this._renderHUDVisibility(m);m||this._renderInternalSlot(Q.LINE_CALLOUTS),this.performanceInfo.advance(ne.HUD_VISIBILITY),this._renderObjectAndLayerIdColor(r),this.performanceInfo.advance(ne.OBJECT_AND_LAYER_ID_COLOR),this._renderEdges(te.TRANSPARENT,m),this.performanceInfo.advance(ne.TRANSPARENT_EDGES),this._renderTransparentTerrain(),p&&f&&(m?this._renderLineCallouts(C.Occluded):l.compositeTransparentTerrainOntoHUDVisibility(this._bindParameters),this._renderHUD(C.Occluded,l.framebuffer),this.performanceInfo.advance(ne.HUD_OCCLUDED)),this.performanceInfo.advance(ne.TRANSPARENT_TERRAIN),this._setTerrainCulling(!1),p&&(l.compositeTransparentTerrainOntoMain(this._bindParameters),m&&(this._renderEdges(te.OPAQUE),this.performanceInfo.advance(ne.OPAQUE_EDGES),u&&(this._oitEnabled?this._renderOrderIndependentTransparency((()=>this._renderTransparentGeometry()),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(ne.TRANSPARENT),this._renderEdges(te.TRANSPARENT),this.performanceInfo.advance(ne.TRANSPARENT_EDGES))),m&&this._renderLineCallouts(C.NotOccluded),this._setMultipassEnabled(!1),this._shadowAccumulator.render(this._bindParameters),l.renderToTargets((()=>{this._renderInternalSlot(Q.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),this._renderSlot(Q.POSTPROCESSING_ENVIRONMENT_TRANSPARENT),this._renderSlot(Q.LASERLINES)}),l.currentColorTarget,l.mainDepth),this.performanceInfo.advance(ne.ENVIRONMENT),this._renderPlugins.needsLaserlineWithContrastControl&&l.renderTmpAndCompositeToMain((()=>this._renderSlot(Q.LASERLINES_CONTRAST_CONTROL)),this._bindParameters,ie.PremultipliedAlpha),this.performanceInfo.advance(ne.LASER_LINE),this._renderOccluded(),this.performanceInfo.advance(ne.OCCLUDED);const g=s===x.ON&&this._magnifierHelper.enabled,T=g&&o(e)?this._offscreen.getFramebuffer(this._offscreen.tmpColor,this._offscreen.tmpDepth):e;this._rctx.bindFramebuffer(T);const b=this._offscreen.colorTexture;!this._renderAntiAliasing(b)&&h(b)&&this._compositingHelper.composite(this._bindParameters,b,ie.None),this.performanceInfo.advance(ne.ANTIALIASING),this._renderHUD(C.NotOccluded,T),this.performanceInfo.advance(ne.HUD),this._renderHighlights(T,this._bindParameters),this.performanceInfo.advance(ne.HIGHLIGHTS),g&&this._magnifierHelper.render(this._rctx,this._bindParameters),T!==e&&(this._rctx.bindFramebuffer(e),this._compositingHelper.composite(this._bindParameters,this._offscreen.tmpColorTexture,ie.None)),this._disposeOITBuffers(),this._renderContext.lastFrameCamera.copyFrom(this._bindParameters.camera),this._sliceHelper.plane=_,this._isRendering=!1,this.onPostRender&&this.onPostRender(),this.performanceInfo.finishFrame()}_renderObjectAndLayerIdColor(e){if(h(e)&&has(\"enable-feature:objectAndLayerId-rendering\")){const r=this._renderContext.output;this._rctx.bindFramebuffer(e),this._offscreen.renderToFBO((()=>this._renderGeometryAndTransparentTerrainPass(O.ObjectAndLayerIdColor)),[0,0,0,0],!0,!0),this._rctx.bindFramebuffer(e),this._offscreen.renderToFBO((()=>{this._bindParameters.renderTransparentlyOccludedHUD=C.NotOccluded,this._renderInternalSlot(Q.HUD_MATERIAL)}),void 0,!0,!0),this._renderContext.output=r}}finish(e){this._hasAnimations||this._animationTimestep.clear();const r=this.performanceInfo.gpuSamplingEnabled,t=e===I.BACKGROUND;if(t||r){const e=t?this.performanceInfo.elapsedTime:0,s=r?this.performanceInfo.totalGPUTimeSampler.last:this._rctx.gl.getError(),i=Math.max(e,s);this._animationTimestep.frame(i,t)}}readDepthPixels(e,r,t){const s=this._offscreen.bindTarget(this._offscreen.linearDepth,this._offscreen.tmpDepth);if(!this._needsLinearDepth){this._ensureBindParameters(e,e),this._bindParameters.camera.setGLViewport(this._rctx),this._rctx.setClearColor(0,0,0,0);const r=oe.COLOR_BUFFER_BIT|oe.DEPTH_BUFFER_BIT|oe.STENCIL_BUFFER_BIT;this._rctx.clearSafe(r),this._renderGeometryAndTransparentTerrainPass(O.Depth)}s.readPixels(r[0],r[1],r[2],r[3],de.RGBA,le.UNSIGNED_BYTE,t)}readHUDVisibility(e,r,t,s,i){this._offscreen.bindTarget(this._offscreen.hudVisibility).readPixels(e,r,t,s,de.RGBA,le.UNSIGNED_BYTE,i)}readAccumulatedShadow(e){return this._shadowAccumulator.readAccumulatedShadow(e[0],e[1])}_setMultipassEnabled(e){this._bindParameters.multipassTerrain.enabled=this._bindParameters.multipassGeometry.enabled=e}_setTerrainCulling(e){this._bindParameters.multipassTerrain.cullAboveGround=e}_renderSlot(e){this._bindParameters.slot=e,this._renderPlugins.render()}_renderEdges(e,r=!1){const t=this._edgeView;h(t)&&t.shouldRender()&&this._offscreen.renderTmpAndCompositeToMain((()=>t.render(this._bindParameters,e)),this._bindParameters,ie.Alpha,r)}_renderShadowMap(e,r,t,s){const i=this._shadowMap;i.enabled&&this.isFeatureEnabled(B.ShadowMapUpdate)&&(i.start(r,t,s),this._shadowHighlight.updateParameters(r,t),this._needsShadowHighlight?(this._renderShadowCascades(O.ShadowHighlight,this._shadowMap,(e=>i.takeCascadeSnapshotTo(e,J.Highlight))),i.clear(),this._renderShadowCascades(O.ShadowExcludeHighlight,this._shadowMap,(e=>{i.takeCascadeSnapshotTo(e,J.Default),this._renderGeometryAndTransparentTerrainPass(O.ShadowHighlight)}))):this._renderShadowCascades(O.Shadow),i.finish(e),r.setGLViewport(this._rctx))}_renderShadowCascades(e,r=this._shadowMap,t=(e=>{})){for(const s of r.cascades)s.camera.setGLViewport(this._rctx),this._prepare(s.camera,s.camera),this._renderGeometryAndTransparentTerrainPass(e),t(s)}get _needsLinearDepth(){return this._ssaoHelper.active||this._renderPlugins.needsLinearDepth||this.hasWaterReflection||this._needsShadowHighlight||this._needsShadowCast}_renderLinearDepth(){this._needsLinearDepth?this._offscreen.renderToTargets((()=>this._renderGeometryAndTransparentTerrainPass(O.Depth)),this._offscreen.linearDepth,this._offscreen.tmpDepth,[0,0,0,0],!0,!0):this._offscreen.disposeTarget(this._offscreen.linearDepth),this._bindParameters.linearDepthTexture=this._offscreen.linearDepthTexture}_renderTerrainLinearDepth(e){if(e){const e=this._renderContext.output;this._renderContext.output=O.Depth,this._offscreen.renderToTargets((()=>this._renderTransparentTerrain()),this._offscreen.terrainLinearDepth,this._offscreen.tmpDepth,[-1e10,-1e10,-1e10,1],!0,!0),this._renderContext.output=e}else this._offscreen.disposeTarget(this._offscreen.terrainLinearDepth);this._bindParameters.multipassTerrain.linearDepthTexture=this._offscreen.terrainLinearDepthTexture}_renderGeometryLinearDepth(e){if(e){const e=this._renderContext.output;this._offscreen.renderToTargets((()=>this._renderGeometryPass(O.Depth)),this._offscreen.geometryLinearDepth,this._offscreen.tmpDepth,[1,1,1,1],!0,!0),this._renderContext.output=e}else this._offscreen.disposeTarget(this._offscreen.geometryLinearDepth);this._bindParameters.multipassGeometry.linearDepthTexture=this._offscreen.geometryLinearDepthTexture}get _needsNormal(){return this._ssaoHelper.active}_renderNormal(){this._needsNormal?this._offscreen.renderToTargets((()=>{this._renderGeometryAndTransparentTerrainPass(O.Normal)}),this._offscreen.normal,this._offscreen.tmpDepth,[0,0,0,0],!0,!0):this._offscreen.disposeTarget(this._offscreen.normal)}get _needsDepthRange(){return this._shadowMap.enabled||this._needsShadowCast}_computeDepthRange(e){if(!this._needsDepthRange)return M;const r=N(e,this._materialRenderers,this._stage.layers);return L(r,this.renderPlugins.queryDepthRange(e)),r.near=Math.max(e.near,r.near),r.far=Math.min(e.far,r.far),r}_renderGeometryAndTransparentTerrainPass(e){this._renderContext.output=e,this._renderGeometryPass(e),this._renderTransparentTerrain()}_renderGeometryPass(e){this._renderContext.output=e,this._renderOpaqueGeometry(),this._renderTransparentGeometry()}_renderSSAO(e){this._ssaoHelper.render(this._bindParameters,e,this._offscreen.linearDepthTexture,this._offscreen.normalTexture)}_renderOpaqueGeometry(){this._renderSlot(Q.INTEGRATED_MESH),this._renderSlot(Q.OPAQUE_TERRAIN),this._renderInternalSlot(Q.OPAQUE_MATERIAL),this._renderSlot(Q.OPAQUE_MATERIAL),this._renderSlot(Q.POSTPROCESSING_ENVIRONMENT_OPAQUE)}_renderTransparentGeometry(){this._renderInternalSlot(Q.TRANSPARENT_MATERIAL),this._renderSlot(Q.TRANSPARENT_MATERIAL)}_renderTransparentTerrain(){this._renderSlot(Q.TRANSPARENT_TERRAIN)}_renderHUDVisibility(e){let r=!1;return this._renderContext.offscreenRenderingHelper&&this._renderContext.offscreenRenderingHelper.renderHUDVisibility((()=>{this._bindParameters.hudVisibilityTexture=this._renderContext.offscreenRenderingHelper.hudVisibilityTexture,r=this._renderInternalSlot(Q.OCCLUSION_PIXELS)}),e),r}_renderLineCallouts(e){this._bindParameters.renderTransparentlyOccludedHUD=e,e===C.Occluded?this._offscreen.renderToTargets((()=>this._renderInternalSlot(Q.LINE_CALLOUTS)),this._offscreen.currentColorTarget,this._offscreen.tmpDepth,void 0,!0,!0):this._renderInternalSlot(Q.LINE_CALLOUTS)}_renderHUD(e,r){this._hasHUDElements&&(this._oitEnabled?(this._renderOrderIndependentTransparency((()=>this._renderHUDElements(e)),!0),this._rctx.bindFramebuffer(r),this._compositingHelper.composite(this._bindParameters,this._offscreen.hudColorTexture,ie.PremultipliedAlpha)):e===C.Occluded?this._offscreen.renderToTargets((()=>this._renderHUDElements(C.Occluded)),this._offscreen.currentColorTarget,this._offscreen.tmpDepth,void 0,!0,!0):this._renderHUDElements(e))}_renderHUDElements(e){this._bindParameters.renderTransparentlyOccludedHUD=e,this._renderInternalSlot(Q.LINE_CALLOUTS_HUD_DEPTH),this._renderInternalSlot(Q.HUD_MATERIAL),this._renderInternalSlot(Q.LABEL_MATERIAL)}get _needsHighlight(){return this._hasHighlights||this._renderPlugins.needsHighlight}get _needsShadowHighlight(){return this._shadowMap.enabled&&this._shadowHighlight.isVisible&&this._needsHighlight}_renderHighlights(e,r){if(!this._needsHighlight)return void this._offscreen.disposeTarget(this._offscreen.highlight);const t=this._highlight,s=this._offscreen.renderToTargets((()=>{this._renderGeometryAndTransparentTerrainPass(O.Highlight),this._rctx.clearSafe(oe.DEPTH_BUFFER_BIT),this._renderHUDElements(C.Both)}),this._offscreen.highlight,this._offscreen.tmpDepth,[0,0,0,0],!0,!0);this._bindParameters.highlightColorTexture=s.colorTexture,this._needsShadowHighlight&&this._shadowHighlight.render(r,e),t.render(this._bindParameters,s,e)}get _needsShadowCast(){return this._shadowAccumulator.isAccumulating}_accumulateShadows(e,r,t){this._needsShadowCast&&h(this._offscreen.linearDepthTexture)&&this._shadowAccumulator.renderAccumulation(this._offscreen.linearDepthTexture,e,r,t)}_renderOrderIndependentTransparency(e,r){const t=t=>{this._bindParameters.transparencyPassType=t,this._offscreen.renderOITPass((()=>e()),t,r)},s=this._renderContext.output;this._renderContext.output=O.Alpha,t(ee.Alpha),this._renderContext.output=O.Color,t(ee.Color),t(ee.FrontFace),this._offscreen.compositeTransparentOntoOpaque(this._bindParameters,r),this._bindParameters.transparencyPassType=ee.NONE,this._renderContext.output=s,this._oitUsed=!0}_disposeOITBuffers(){this._oitUsed||(this._offscreen.disposeTarget(this._offscreen.alphaFloatTarget),this._offscreen.disposeTarget(this._offscreen.colorFloatTarget),this._offscreen.disposeTarget(this._offscreen.frontFaceTarget)),this._oitUsed=!1}_renderOccluded(){let e=0;pe.clear(),this._materialRenderers.forAll((r=>{r.material&&r.material.isVisible()&&r.material.renderOccluded===j.OccludeAndTransparentStencil&&(e|=r.material.renderOccluded,pe.push(r))}));const r=this._offscreen,t=(t,s,i,a,n)=>{0!=(e&s)&&(r.renderToTargets(i,r.tmpColor,r.mainDepth,[0,0,0,0],a,n),r.compositeOccludedOntoMain(this._bindParameters,t))};0!==pe.length&&(this._renderInternalSlot(Q.OCCLUDER_MATERIAL,pe),t(.5,j.OccludeAndTransparentStencil,(()=>this._renderInternalSlot(Q.TRANSPARENT_OCCLUDER_MATERIAL,pe)),!1,!1)),pe.clear(),this._materialRenderers.forAll((r=>{r.material&&r.material.isVisible()&&(r.material.renderOccluded===j.OccludeAndTransparent||r.material.renderOccluded===j.Transparent||r.material.renderOccluded===j.Opaque)&&(e|=r.material.renderOccluded,pe.push(r))}));const s=this._renderPlugins.renderOccludedFlags;if(e|=s,!e)return;const i=e=>{this._renderContext.renderOccludedMask=e,s>j.Occlude&&this._renderSlot(Q.OCCLUDED_TERRAIN),this._renderInternalSlot(Q.OPAQUE_MATERIAL,pe),this._renderInternalSlot(Q.TRANSPARENT_MATERIAL,pe),this._renderInternalSlot(Q.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,pe),this._renderContext.resetRenderOccludedMask()};this._renderContext.output=O.Color,t(.5,j.OccludeAndTransparent,(()=>i(j.OccludeAndTransparent)),!0,H.OutlineVisualElementMask),t(.5,j.Transparent,(()=>i(j.Transparent)),!0,H.OutlineVisualElementMask),t(1,j.Opaque,(()=>i(j.Opaque)),!0,H.OutlineVisualElementMask),pe.clear()}_renderAntiAliasing(e){if(this._antialiasing){if(this._smaaPass.enable((()=>this._requestRender()))&&h(e))return this._smaaPass.render(e),!0}else this._smaaPass.disable();return!1}_prepare(e,r){this._needsTransparentPass=this._materialRenderers.some((e=>e.requiresSlot(Q.TRANSPARENT_MATERIAL,O.Color))),this._bindParameters.camera=e,this._bindParameters.contentCamera=r}_ensureBindParameters(e,r){this._bindParameters.camera=e,this._bindParameters.contentCamera=r;const t=this._renderContext.offscreenRenderingHelper;this._bindParameters.hudVisibilityTexture=t.hudVisibilityTexture,this._bindParameters.mainColorTexture=t.mainColorTexture,this._bindParameters.highlightDepthTexture=t.depthTexture??this._getFallbackDepthTexture()}_ensureBindParametersSSR(e){if(this._bindParameters.ssr.enabled=this.hasWaterReflection,this._bindParameters.ssr.enabled){o(this._waterReflectionEnableTime)&&(this._waterReflectionEnableTime=e),this._renderContext.lastFrameCamera.equals(this._bindParameters.camera)?this._reprojectionMatrix=E:(b(ue,this._bindParameters.camera.viewMatrix),b(me,this._bindParameters.camera.projectionMatrix),R(fe,ue,me),R(fe,this._renderContext.lastFrameCamera.viewMatrix,fe),R(fe,this._renderContext.lastFrameCamera.projectionMatrix,fe),this._reprojectionMatrix=fe),this._bindParameters.ssr.lastFrameColorTexture=this._offscreen.lastFrameColorTexture;const r=this._stage.view.qualitySettings.fadeDuration;this._bindParameters.ssr.fadeFactor=r>0?Math.min(r,e-this._waterReflectionEnableTime)/r:1,this._bindParameters.ssr.fadeFactor<1&&this._requestRender()}else this._bindParameters.ssr.lastFrameColorTexture=null,this._waterReflectionEnableTime=null}_renderInternalSlot(e,r=this._materialRenderers){let t=!1;return this._bindParameters.slot=e,r.forAll((e=>{e.material.shouldRender(this._renderContext)&&e.render(this._renderContext.output,this._bindParameters)&&(t=!0)})),t}_getFallbackDepthTexture(){return this._fallbackDepthStencilTexture||(this._fallbackDepthStencilTexture=U(this._rctx)),this._fallbackDepthStencilTexture}get gpuMemoryUsage(){return{offscreen:this._offscreen?.gpuMemoryUsage??0,highlights:(this._highlight?.gpuMemoryUsage??0)+(this._shadowHighlight?.gpuMemoryUsage??0),shadows:this._shadowMap?.gpuMemoryUsage??0,ssao:this._ssaoHelper?.gpuMemoryUsage??0}}get test(){const e=this;return{offscreen:this._offscreen,shadowMap:this._shadowMap,ssao:this._ssaoHelper,highlight:this._highlight,lighting:this._bindParameters.lighting,materialRenderers:this._materialRenderers,shadowAccumulator:this._shadowAccumulator,weatherIsFading:this._bindParameters.cloudsFade.isFading,resetRenderStateFeatures:()=>{e._renderStateFeatures=W()},getFramebufferTexture:r=>{switch(r){case ce.Color:return e._offscreen.colorTexture;case ce.LinearDepth:return e._offscreen.linearDepthTexture;case ce.Normals:return e._offscreen.normalTexture;case ce.ShadowMap:return e._shadowMap.depthTexture;case ce.HudVisibility:return e._offscreen.hudVisibilityTexture;case ce.Highlight:return e._offscreen.highlightTexture}}}}};var ce;e([f()],_e.prototype,\"_shadowAccumulator\",void 0),e([f()],_e.prototype,\"_state\",void 0),e([f()],_e.prototype,\"_renderStateFeatures\",void 0),e([f()],_e.prototype,\"_antialiasingEnabled\",void 0),e([f({readOnly:!0})],_e.prototype,\"_antialiasing\",null),e([f()],_e.prototype,\"_ssaoEnabled\",void 0),e([f()],_e.prototype,\"_smaaPass\",void 0),e([f({autoDestroy:!0})],_e.prototype,\"_edgeView\",void 0),e([f()],_e.prototype,\"updating\",null),e([f()],_e.prototype,\"isCameraFinal\",null),_e=e([g(\"esri.views.3d.webgl-engine.lib.Renderer\")],_e),function(e){e[e.Color=0]=\"Color\",e[e.LinearDepth=1]=\"LinearDepth\",e[e.Normals=2]=\"Normals\",e[e.ShadowMap=3]=\"ShadowMap\",e[e.HudVisibility=4]=\"HudVisibility\",e[e.Highlight=5]=\"Highlight\"}(ce||(ce={}));const pe=new _,me=A(),ue=A(),fe=A();export{ce as FramebufferId,_e as Renderer};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}