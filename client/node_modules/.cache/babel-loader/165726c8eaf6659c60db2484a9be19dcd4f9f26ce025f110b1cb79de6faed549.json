{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { isNone as a } from \"../../../core/maybe.js\";\nimport { debounce as t } from \"../../../core/promiseUtils.js\";\nimport { when as i } from \"../../../core/reactiveUtils.js\";\nimport \"../../../core/Logger.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport \"../../../core/Error.js\";\nimport \"../../../core/has.js\";\nimport { subclass as r } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport s from \"./DynamicLayerView3D.js\";\nimport o from \"../../layers/ImageryLayerView.js\";\nlet n = class extends o(s) {\n  constructor() {\n    super(...arguments), this.type = \"imagery-3d\", this.redrawDebounced = t(async e => {\n      this.redraw((e, a) => this._redrawImage(e, a), e);\n    }, 2e3);\n  }\n  initialize() {\n    this.handles.add([i(() => this.view.basemapTerrain.ready, () => this._initializeMaximumDataResolution(), {\n      once: !0,\n      initial: !0\n    }), this.layer.on(\"redraw\", () => this.updatingHandles.addPromise(this.redrawDebounced()))]), this.updatingHandles.add(() => this.layer?.exportImageServiceParameters?.version, () => {\n      this.updatingHandles.addPromise(this.refreshDebounced());\n    }), this.updatingHandles.add(() => this.layer?.renderer, () => {\n      this.updatingHandles.addPromise(this.refreshDebounced());\n    }), this.updatingHandles.add(() => this.timeExtent, () => this.updatingHandles.addPromise(this.refreshDebounced()));\n  }\n  _initializeMaximumDataResolution() {\n    this.maximumDataResolution = this.layer.loaded ? this.layer.serviceRasterInfo.pixelSize : null;\n  }\n  getFetchOptions() {\n    return {\n      timeExtent: this.timeExtent\n    };\n  }\n  async processResult(e, a, t) {\n    a.imageOrCanvasElement ? e.image = a.imageOrCanvasElement : (e.image = document.createElement(\"canvas\"), e.pixelData = a.pixelData, await this._redrawImage(e, t));\n  }\n  async _redrawImage(e, t) {\n    if (!(e.image instanceof HTMLCanvasElement) || a(e.pixelData)) throw new Error();\n    const i = e.image,\n      r = i.getContext(\"2d\"),\n      s = await this.layer.applyRenderer(e.pixelData, {\n        signal: t\n      }),\n      o = this.layer.applyFilter(s).pixelBlock;\n    if (a(o)) throw new Error();\n    i.width = o.width, i.height = o.height;\n    const n = r.createImageData(o.width, o.height);\n    n.data.set(o.getAsRGBA()), r.putImageData(n, 0, 0);\n  }\n};\nn = e([r(\"esri.views.3d.layers.ImageryLayerView3D\")], n);\nconst d = n;\nexport { d as default };","map":{"version":3,"names":["_","e","isNone","a","debounce","t","when","i","subclass","r","s","o","n","constructor","arguments","type","redrawDebounced","redraw","_redrawImage","initialize","handles","add","view","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","layer","on","updatingHandles","addPromise","exportImageServiceParameters","version","refreshDebounced","renderer","timeExtent","maximumDataResolution","loaded","serviceRasterInfo","pixelSize","getFetchOptions","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","signal","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData","d","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{isNone as a}from\"../../../core/maybe.js\";import{debounce as t}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/Error.js\";import\"../../../core/has.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"./DynamicLayerView3D.js\";import o from\"../../layers/ImageryLayerView.js\";let n=class extends(o(s)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=t((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.handles.add([i((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this.updatingHandles.addPromise(this.redrawDebounced())))]),this.updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this.updatingHandles.addPromise(this.refreshDebounced())})),this.updatingHandles.add((()=>this.layer?.renderer),(()=>{this.updatingHandles.addPromise(this.refreshDebounced())})),this.updatingHandles.add((()=>this.timeExtent),(()=>this.updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,a,t){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,t))}async _redrawImage(e,t){if(!(e.image instanceof HTMLCanvasElement)||a(e.pixelData))throw new Error;const i=e.image,r=i.getContext(\"2d\"),s=await this.layer.applyRenderer(e.pixelData,{signal:t}),o=this.layer.applyFilter(s).pixelBlock;if(a(o))throw new Error;i.width=o.width,i.height=o.height;const n=r.createImageData(o.width,o.height);n.data.set(o.getAsRGBA()),r.putImageData(n,0,0)}};n=e([r(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const d=n;export{d as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}