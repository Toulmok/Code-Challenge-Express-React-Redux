{"ast":null,"code":"import{GET_IDENTITY,SET_IDENTITY,LOAD_PORTAL}from'../constants/action-types';/**\r\n * Middleware function with the signature\r\n *\r\n * storeInstance =>\r\n * functionToCallWithAnActionThatWillSendItToTheNextMiddleware =>\r\n * actionThatDispatchWasCalledWith =>\r\n * valueToUseAsTheReturnValueOfTheDispatchCall\r\n *\r\n * Typically written as\r\n *\r\n * store => next => action => result\r\n */var arcgisMiddleWare=function arcgisMiddleWare(store){return function(next){return function(action){switch(action.type){case GET_IDENTITY:next(action);fetch('/refresh').then(function(res){return res.json();})//.json is asynch; .parse is sync\n.then(function(jsonRes){//console.log(jsonRes)\nif(jsonRes.refresh){store.dispatch({type:LOAD_PORTAL});}else{store.dispatch({type:SET_IDENTITY,username:null,fullname:null,email:null,thumbnailurl:null});}});default:return next(action);}};};};export default arcgisMiddleWare;","map":{"version":3,"names":["GET_IDENTITY","SET_IDENTITY","LOAD_PORTAL","arcgisMiddleWare","store","next","action","type","fetch","then","res","json","jsonRes","refresh","dispatch","username","fullname","email","thumbnailurl"],"sources":["C:/code-challenge-react/client/src/middleware/arcgis-authentication.js"],"sourcesContent":["import {\r\n  GET_IDENTITY,\r\n  SET_IDENTITY,\r\n  LOAD_PORTAL,\r\n} from '../constants/action-types'\r\n\r\n/**\r\n * Middleware function with the signature\r\n *\r\n * storeInstance =>\r\n * functionToCallWithAnActionThatWillSendItToTheNextMiddleware =>\r\n * actionThatDispatchWasCalledWith =>\r\n * valueToUseAsTheReturnValueOfTheDispatchCall\r\n *\r\n * Typically written as\r\n *\r\n * store => next => action => result\r\n */\r\nconst arcgisMiddleWare = store => next => (action) => {\r\n  switch (action.type) {\r\n    case GET_IDENTITY:\r\n        next(action)\r\n        fetch('/refresh')\r\n        .then(res => res.json()) //.json is asynch; .parse is sync\r\n        .then(jsonRes => { //console.log(jsonRes)\r\n            if(jsonRes.refresh){ store.dispatch({ type: LOAD_PORTAL })}\r\n            else {\r\n              store.dispatch({\r\n                type: SET_IDENTITY,\r\n                username: null,\r\n                fullname: null,\r\n                email: null,\r\n                thumbnailurl: null,\r\n              })\r\n            }\r\n        })\r\n\r\n    default:\r\n      return next(action)\r\n  }\r\n}\r\n\r\nexport default arcgisMiddleWare"],"mappings":"AAAA,OACEA,YAAY,CACZC,YAAY,CACZC,WAAW,KACN,2BAA2B,CAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GACA,GAAM,CAAAC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAGC,KAAK,QAAI,UAAAC,IAAI,QAAI,UAACC,MAAM,CAAK,CACpD,OAAQA,MAAM,CAACC,IAAI,EACjB,IAAK,CAAAP,YAAY,CACbK,IAAI,CAACC,MAAM,CAAC,CACZE,KAAK,CAAC,UAAU,CAAC,CAChBC,IAAI,CAAC,SAAAC,GAAG,QAAI,CAAAA,GAAG,CAACC,IAAI,EAAE,GAAE;AAAA,CACxBF,IAAI,CAAC,SAAAG,OAAO,CAAI,CAAE;AACf,GAAGA,OAAO,CAACC,OAAO,CAAC,CAAET,KAAK,CAACU,QAAQ,CAAC,CAAEP,IAAI,CAAEL,WAAY,CAAC,CAAC,EAAC,IACtD,CACHE,KAAK,CAACU,QAAQ,CAAC,CACbP,IAAI,CAAEN,YAAY,CAClBc,QAAQ,CAAE,IAAI,CACdC,QAAQ,CAAE,IAAI,CACdC,KAAK,CAAE,IAAI,CACXC,YAAY,CAAE,IAChB,CAAC,CAAC,CACJ,CACJ,CAAC,CAAC,CAEN,QACE,MAAO,CAAAb,IAAI,CAACC,MAAM,CAAC,EAEzB,CAAC,KAED,cAAe,CAAAH,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}