{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { px2pt as e, pt2px as t } from \"../../core/screenUtils.js\";\nimport { OverrideHelper as i, CIMSymbolHelper as o } from \"../cim/CIMSymbolHelper.js\";\nimport { CIMSymbolRasterizer as l, GeometryStyle as n } from \"../cim/CIMSymbolRasterizer.js\";\nimport { mapCIMSymbolToGeometryType as r } from \"../cim/utils.js\";\nimport { SymbolSizeDefaults as s } from \"./previewUtils.js\";\nimport { renderSymbol as a } from \"./renderUtils.js\";\nconst h = new l(null, !0),\n  m = e(s.size),\n  c = e(s.maxSize),\n  u = e(s.lineWidth),\n  f = 1;\nfunction y(e) {\n  const t = e?.size;\n  if (\"number\" == typeof t) return {\n    width: t,\n    height: t\n  };\n  return {\n    width: null != t && \"object\" == typeof t && \"width\" in t ? t.width : null,\n    height: null != t && \"object\" == typeof t && \"height\" in t ? t.height : null\n  };\n}\nasync function d(e) {\n  let l = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const {\n      node: s,\n      opacity: d,\n      symbolConfig: p\n    } = l,\n    g = \"object\" == typeof p && \"isSquareFill\" in p && p.isSquareFill,\n    w = l.cimOptions || l,\n    b = w.geometryType || r(e?.data?.symbol),\n    M = y(l),\n    {\n      feature: j,\n      fieldMap: v\n    } = w;\n  if (null == M.width || null == M.height) {\n    const t = await i.resolveSymbolOverrides(e.data, j, null, v, b);\n    if (!t) return null;\n    (e = e.clone()).data = {\n      type: \"CIMSymbolReference\",\n      symbol: t\n    }, e.data.primitiveOverrides = void 0;\n    const l = [];\n    o.fetchResources(t, h.resourceManager, l), l.length > 0 && (await Promise.all(l));\n    const n = o.getEnvelope(t, null, h.resourceManager),\n      r = n?.width,\n      s = n?.height;\n    M.width = \"esriGeometryPolygon\" === b ? m : \"esriGeometryPolyline\" === b ? u : null != r && isFinite(r) ? Math.min(r, c) : m, M.height = \"esriGeometryPolygon\" === b ? m : null != s && isFinite(s) ? Math.max(Math.min(s, c), f) : m;\n  }\n  const S = await h.rasterizeCIMSymbolAsync(e, j, M, g || \"esriGeometryPolygon\" !== b ? n.Preview : n.Legend, v, b);\n  if (!S) return null;\n  const {\n      width: C,\n      height: I\n    } = S,\n    P = document.createElement(\"canvas\");\n  P.width = C, P.height = I;\n  P.getContext(\"2d\").putImageData(S, 0, 0);\n  const x = t(M.width),\n    z = t(M.height),\n    F = new Image(x, z);\n  F.src = P.toDataURL(), null != d && (F.style.opacity = `${d}`);\n  let G = F;\n  if (null != l.effectView) {\n    const e = {\n      shape: {\n        type: \"image\",\n        x: 0,\n        y: 0,\n        width: x,\n        height: z,\n        src: F.src\n      },\n      fill: null,\n      stroke: null,\n      offset: [0, 0]\n    };\n    G = a([[e]], [x, z], {\n      effectView: l.effectView\n    });\n  }\n  return s && G && s.appendChild(G), G;\n}\nexport { d as previewCIMSymbol };","map":{"version":3,"names":["px2pt","e","pt2px","t","OverrideHelper","i","CIMSymbolHelper","o","CIMSymbolRasterizer","l","GeometryStyle","n","mapCIMSymbolToGeometryType","r","SymbolSizeDefaults","s","renderSymbol","a","h","m","size","c","maxSize","u","lineWidth","f","y","width","height","d","arguments","length","undefined","node","opacity","symbolConfig","p","g","isSquareFill","w","cimOptions","b","geometryType","data","symbol","M","feature","j","fieldMap","v","resolveSymbolOverrides","clone","type","primitiveOverrides","fetchResources","resourceManager","Promise","all","getEnvelope","isFinite","Math","min","max","S","rasterizeCIMSymbolAsync","Preview","Legend","C","I","P","document","createElement","getContext","putImageData","x","z","F","Image","src","toDataURL","style","G","effectView","shape","fill","stroke","offset","appendChild","previewCIMSymbol"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{px2pt as e,pt2px as t}from\"../../core/screenUtils.js\";import{OverrideHelper as i,CIMSymbolHelper as o}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as l,GeometryStyle as n}from\"../cim/CIMSymbolRasterizer.js\";import{mapCIMSymbolToGeometryType as r}from\"../cim/utils.js\";import{SymbolSizeDefaults as s}from\"./previewUtils.js\";import{renderSymbol as a}from\"./renderUtils.js\";const h=new l(null,!0),m=e(s.size),c=e(s.maxSize),u=e(s.lineWidth),f=1;function y(e){const t=e?.size;if(\"number\"==typeof t)return{width:t,height:t};return{width:null!=t&&\"object\"==typeof t&&\"width\"in t?t.width:null,height:null!=t&&\"object\"==typeof t&&\"height\"in t?t.height:null}}async function d(e,l={}){const{node:s,opacity:d,symbolConfig:p}=l,g=\"object\"==typeof p&&\"isSquareFill\"in p&&p.isSquareFill,w=l.cimOptions||l,b=w.geometryType||r(e?.data?.symbol),M=y(l),{feature:j,fieldMap:v}=w;if(null==M.width||null==M.height){const t=await i.resolveSymbolOverrides(e.data,j,null,v,b);if(!t)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:t},e.data.primitiveOverrides=void 0;const l=[];o.fetchResources(t,h.resourceManager,l),l.length>0&&await Promise.all(l);const n=o.getEnvelope(t,null,h.resourceManager),r=n?.width,s=n?.height;M.width=\"esriGeometryPolygon\"===b?m:\"esriGeometryPolyline\"===b?u:null!=r&&isFinite(r)?Math.min(r,c):m,M.height=\"esriGeometryPolygon\"===b?m:null!=s&&isFinite(s)?Math.max(Math.min(s,c),f):m}const S=await h.rasterizeCIMSymbolAsync(e,j,M,g||\"esriGeometryPolygon\"!==b?n.Preview:n.Legend,v,b);if(!S)return null;const{width:C,height:I}=S,P=document.createElement(\"canvas\");P.width=C,P.height=I;P.getContext(\"2d\").putImageData(S,0,0);const x=t(M.width),z=t(M.height),F=new Image(x,z);F.src=P.toDataURL(),null!=d&&(F.style.opacity=`${d}`);let G=F;if(null!=l.effectView){const e={shape:{type:\"image\",x:0,y:0,width:x,height:z,src:F.src},fill:null,stroke:null,offset:[0,0]};G=a([[e]],[x,z],{effectView:l.effectView})}return s&&G&&s.appendChild(G),G}export{d as previewCIMSymbol};\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAAOA,KAAK,IAAIC,CAAC,EAACC,KAAK,IAAIC,CAAC,QAAK,2BAA2B;AAAC,SAAOC,cAAc,IAAIC,CAAC,EAACC,eAAe,IAAIC,CAAC,QAAK,2BAA2B;AAAC,SAAOC,mBAAmB,IAAIC,CAAC,EAACC,aAAa,IAAIC,CAAC,QAAK,+BAA+B;AAAC,SAAOC,0BAA0B,IAAIC,CAAC,QAAK,iBAAiB;AAAC,SAAOC,kBAAkB,IAAIC,CAAC,QAAK,mBAAmB;AAAC,SAAOC,YAAY,IAAIC,CAAC,QAAK,kBAAkB;AAAC,MAAMC,CAAC,GAAC,IAAIT,CAAC,CAAC,IAAI,EAAC,CAAC,CAAC,CAAC;EAACU,CAAC,GAAClB,CAAC,CAACc,CAAC,CAACK,IAAI,CAAC;EAACC,CAAC,GAACpB,CAAC,CAACc,CAAC,CAACO,OAAO,CAAC;EAACC,CAAC,GAACtB,CAAC,CAACc,CAAC,CAACS,SAAS,CAAC;EAACC,CAAC,GAAC,CAAC;AAAC,SAASC,CAACA,CAACzB,CAAC,EAAC;EAAC,MAAME,CAAC,GAACF,CAAC,EAAEmB,IAAI;EAAC,IAAG,QAAQ,IAAE,OAAOjB,CAAC,EAAC,OAAM;IAACwB,KAAK,EAACxB,CAAC;IAACyB,MAAM,EAACzB;EAAC,CAAC;EAAC,OAAM;IAACwB,KAAK,EAAC,IAAI,IAAExB,CAAC,IAAE,QAAQ,IAAE,OAAOA,CAAC,IAAE,OAAO,IAAGA,CAAC,GAACA,CAAC,CAACwB,KAAK,GAAC,IAAI;IAACC,MAAM,EAAC,IAAI,IAAEzB,CAAC,IAAE,QAAQ,IAAE,OAAOA,CAAC,IAAE,QAAQ,IAAGA,CAAC,GAACA,CAAC,CAACyB,MAAM,GAAC;EAAI,CAAC;AAAA;AAAC,eAAeC,CAACA,CAAC5B,CAAC,EAAM;EAAA,IAALQ,CAAC,GAAAqB,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAC,CAAC,CAAC;EAAE,MAAK;MAACG,IAAI,EAAClB,CAAC;MAACmB,OAAO,EAACL,CAAC;MAACM,YAAY,EAACC;IAAC,CAAC,GAAC3B,CAAC;IAAC4B,CAAC,GAAC,QAAQ,IAAE,OAAOD,CAAC,IAAE,cAAc,IAAGA,CAAC,IAAEA,CAAC,CAACE,YAAY;IAACC,CAAC,GAAC9B,CAAC,CAAC+B,UAAU,IAAE/B,CAAC;IAACgC,CAAC,GAACF,CAAC,CAACG,YAAY,IAAE7B,CAAC,CAACZ,CAAC,EAAE0C,IAAI,EAAEC,MAAM,CAAC;IAACC,CAAC,GAACnB,CAAC,CAACjB,CAAC,CAAC;IAAC;MAACqC,OAAO,EAACC,CAAC;MAACC,QAAQ,EAACC;IAAC,CAAC,GAACV,CAAC;EAAC,IAAG,IAAI,IAAEM,CAAC,CAAClB,KAAK,IAAE,IAAI,IAAEkB,CAAC,CAACjB,MAAM,EAAC;IAAC,MAAMzB,CAAC,GAAC,MAAME,CAAC,CAAC6C,sBAAsB,CAACjD,CAAC,CAAC0C,IAAI,EAACI,CAAC,EAAC,IAAI,EAACE,CAAC,EAACR,CAAC,CAAC;IAAC,IAAG,CAACtC,CAAC,EAAC,OAAO,IAAI;IAAC,CAACF,CAAC,GAACA,CAAC,CAACkD,KAAK,EAAE,EAAER,IAAI,GAAC;MAACS,IAAI,EAAC,oBAAoB;MAACR,MAAM,EAACzC;IAAC,CAAC,EAACF,CAAC,CAAC0C,IAAI,CAACU,kBAAkB,GAAC,KAAK,CAAC;IAAC,MAAM5C,CAAC,GAAC,EAAE;IAACF,CAAC,CAAC+C,cAAc,CAACnD,CAAC,EAACe,CAAC,CAACqC,eAAe,EAAC9C,CAAC,CAAC,EAACA,CAAC,CAACsB,MAAM,GAAC,CAAC,KAAE,MAAMyB,OAAO,CAACC,GAAG,CAAChD,CAAC,CAAC;IAAC,MAAME,CAAC,GAACJ,CAAC,CAACmD,WAAW,CAACvD,CAAC,EAAC,IAAI,EAACe,CAAC,CAACqC,eAAe,CAAC;MAAC1C,CAAC,GAACF,CAAC,EAAEgB,KAAK;MAACZ,CAAC,GAACJ,CAAC,EAAEiB,MAAM;IAACiB,CAAC,CAAClB,KAAK,GAAC,qBAAqB,KAAGc,CAAC,GAACtB,CAAC,GAAC,sBAAsB,KAAGsB,CAAC,GAAClB,CAAC,GAAC,IAAI,IAAEV,CAAC,IAAE8C,QAAQ,CAAC9C,CAAC,CAAC,GAAC+C,IAAI,CAACC,GAAG,CAAChD,CAAC,EAACQ,CAAC,CAAC,GAACF,CAAC,EAAC0B,CAAC,CAACjB,MAAM,GAAC,qBAAqB,KAAGa,CAAC,GAACtB,CAAC,GAAC,IAAI,IAAEJ,CAAC,IAAE4C,QAAQ,CAAC5C,CAAC,CAAC,GAAC6C,IAAI,CAACE,GAAG,CAACF,IAAI,CAACC,GAAG,CAAC9C,CAAC,EAACM,CAAC,CAAC,EAACI,CAAC,CAAC,GAACN,CAAC;EAAA;EAAC,MAAM4C,CAAC,GAAC,MAAM7C,CAAC,CAAC8C,uBAAuB,CAAC/D,CAAC,EAAC8C,CAAC,EAACF,CAAC,EAACR,CAAC,IAAE,qBAAqB,KAAGI,CAAC,GAAC9B,CAAC,CAACsD,OAAO,GAACtD,CAAC,CAACuD,MAAM,EAACjB,CAAC,EAACR,CAAC,CAAC;EAAC,IAAG,CAACsB,CAAC,EAAC,OAAO,IAAI;EAAC,MAAK;MAACpC,KAAK,EAACwC,CAAC;MAACvC,MAAM,EAACwC;IAAC,CAAC,GAACL,CAAC;IAACM,CAAC,GAACC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;EAACF,CAAC,CAAC1C,KAAK,GAACwC,CAAC,EAACE,CAAC,CAACzC,MAAM,GAACwC,CAAC;EAACC,CAAC,CAACG,UAAU,CAAC,IAAI,CAAC,CAACC,YAAY,CAACV,CAAC,EAAC,CAAC,EAAC,CAAC,CAAC;EAAC,MAAMW,CAAC,GAACvE,CAAC,CAAC0C,CAAC,CAAClB,KAAK,CAAC;IAACgD,CAAC,GAACxE,CAAC,CAAC0C,CAAC,CAACjB,MAAM,CAAC;IAACgD,CAAC,GAAC,IAAIC,KAAK,CAACH,CAAC,EAACC,CAAC,CAAC;EAACC,CAAC,CAACE,GAAG,GAACT,CAAC,CAACU,SAAS,EAAE,EAAC,IAAI,IAAElD,CAAC,KAAG+C,CAAC,CAACI,KAAK,CAAC9C,OAAO,GAAE,GAAEL,CAAE,EAAC,CAAC;EAAC,IAAIoD,CAAC,GAACL,CAAC;EAAC,IAAG,IAAI,IAAEnE,CAAC,CAACyE,UAAU,EAAC;IAAC,MAAMjF,CAAC,GAAC;MAACkF,KAAK,EAAC;QAAC/B,IAAI,EAAC,OAAO;QAACsB,CAAC,EAAC,CAAC;QAAChD,CAAC,EAAC,CAAC;QAACC,KAAK,EAAC+C,CAAC;QAAC9C,MAAM,EAAC+C,CAAC;QAACG,GAAG,EAACF,CAAC,CAACE;MAAG,CAAC;MAACM,IAAI,EAAC,IAAI;MAACC,MAAM,EAAC,IAAI;MAACC,MAAM,EAAC,CAAC,CAAC,EAAC,CAAC;IAAC,CAAC;IAACL,CAAC,GAAChE,CAAC,CAAC,CAAC,CAAChB,CAAC,CAAC,CAAC,EAAC,CAACyE,CAAC,EAACC,CAAC,CAAC,EAAC;MAACO,UAAU,EAACzE,CAAC,CAACyE;IAAU,CAAC,CAAC;EAAA;EAAC,OAAOnE,CAAC,IAAEkE,CAAC,IAAElE,CAAC,CAACwE,WAAW,CAACN,CAAC,CAAC,EAACA,CAAC;AAAA;AAAC,SAAOpD,CAAC,IAAI2D,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}