{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from \"../../../../core/has.js\";\nimport { clamp as t, lerp as e, acosClamped as s } from \"../../../../core/mathUtils.js\";\nimport { isSome as a, disposeMaybe as i } from \"../../../../core/maybe.js\";\nimport { c as r } from \"../../../../chunks/mat3f64.js\";\nimport { w as h, m as c, a as n, u as o } from \"../../../../chunks/mat4.js\";\nimport { c as _ } from \"../../../../chunks/mat4f64.js\";\nimport { s as d, j as u, b as m, l, k as p, a as f, h as x, n as g, f as T, c as b } from \"../../../../chunks/vec2.js\";\nimport { a as w } from \"../../../../chunks/vec2f64.js\";\nimport { k as S, c as M, o as C, m as D, s as E } from \"../../../../chunks/vec3.js\";\nimport { c as j } from \"../../../../chunks/vec3f64.js\";\nimport { s as v, t as R } from \"../../../../chunks/vec4.js\";\nimport { c as z } from \"../../../../chunks/vec4f64.js\";\nimport { ViewingMode as U } from \"../../../ViewingMode.js\";\nimport { CascadeCamera as F } from \"./CascadeCamera.js\";\nimport { assert as y, logWithBase as N, verify as O, rayRay2D as A } from \"./Util.js\";\nimport { TextureType as L, ClearBufferBit as k, PixelFormat as B, PixelType as I, TextureWrapMode as V, TextureSamplingMode as G, TargetType as P, DepthStencilTargetType as X } from \"../../../webgl/enums.js\";\nimport { FramebufferObject as H } from \"../../../webgl/FramebufferObject.js\";\nimport { Texture as Y } from \"../../../webgl/Texture.js\";\nimport { getGpuMemoryUsage as q } from \"../../../webgl/Util.js\";\nvar W;\n!function (t) {\n  t[t.Highlight = 0] = \"Highlight\", t[t.Default = 1] = \"Default\";\n}(W || (W = {}));\nclass J {\n  constructor() {\n    this.camera = new F(), this.lightMat = _();\n  }\n}\nclass K {\n  get depthTexture() {\n    return this._depthTexture;\n  }\n  get textureSize() {\n    return this._textureSize;\n  }\n  get numCascades() {\n    return this._numCascades;\n  }\n  get cascadeDistances() {\n    return v(this._usedCascadeDistances, this._cascadeDistances[0], this._numCascades > 1 ? this._cascadeDistances[1] : 1 / 0, this._numCascades > 2 ? this._cascadeDistances[2] : 1 / 0, this._numCascades > 3 ? this._cascadeDistances[3] : 1 / 0);\n  }\n  constructor(t, e) {\n    this._rctx = t, this._viewingMode = e, this._enabled = !1, this._snapshots = new Array(), this._textureSize = 0, this._numCascades = 1, this._maxNumCascades = 4, this._projectionView = _(), this._projectionViewInverse = _(), this._modelViewLight = _(), this._splitSchemeLambda = 0, this._cascadeDistances = [0, 0, 0, 0, 0], this._usedCascadeDistances = z(), this._cascades = [new J(), new J(), new J(), new J()], this._lastOrigin = null, this._maxTextureSize = Math.min(has(\"esri-mobile\") ? 2048 : 8192, this._rctx.parameters.maxTextureSize);\n  }\n  dispose() {\n    this.enabled = !1, this.disposeOffscreenBuffers();\n  }\n  disposeOffscreenBuffers() {\n    this._discardDepthTexture(), this._discardAllSnapshots();\n  }\n  set maxCascades(e) {\n    this._maxNumCascades = t(Math.floor(e), 1, 4);\n  }\n  get maxCascades() {\n    return this._maxNumCascades;\n  }\n  set enabled(t) {\n    this._enabled = t, t || (this._discardDepthTexture(), this._discardAllSnapshots());\n  }\n  get enabled() {\n    return this._enabled;\n  }\n  get ready() {\n    return this._enabled && a(this._depthTexture);\n  }\n  getSnapshot(t) {\n    return this.enabled ? this._snapshots[t] : null;\n  }\n  get cascades() {\n    for (let t = 0; t < this._numCascades; ++t) ht[t] = this._cascades[t];\n    return ht.length = this._numCascades, ht;\n  }\n  start(t, e, s) {\n    y(this.enabled), this._textureSize = this._computeTextureSize(t.fullWidth, t.fullHeight), this._ensureDepthTexture();\n    const {\n      near: a,\n      far: i\n    } = this._clampNearFar(s);\n    this._computeCascadeDistances(i, a), this._setupMatrices(t, e);\n    const {\n      viewMatrix: r,\n      projectionMatrix: h\n    } = t;\n    for (let c = 0; c < this._numCascades; ++c) this._constructCascade(c, h, r, e);\n    this._lastOrigin = null, this.clear();\n  }\n  finish(t) {\n    y(this.enabled), this._rctx.bindFramebuffer(t);\n  }\n  getShadowMapMatrices(t) {\n    if (!this._lastOrigin || !S(t, this._lastOrigin)) {\n      this._lastOrigin = this._lastOrigin || j(), M(this._lastOrigin, t);\n      for (let e = 0; e < this._numCascades; ++e) {\n        h(ct, this._cascades[e].lightMat, t);\n        for (let t = 0; t < 16; ++t) nt[16 * e + t] = ct[t];\n      }\n    }\n    return nt;\n  }\n  takeCascadeSnapshotTo(t, e) {\n    y(this.enabled);\n    const s = this._ensureSnapshot(e);\n    this._bindFbo();\n    const a = this._rctx,\n      i = a.bindTexture(s, Y.TEXTURE_UNIT_FOR_UPDATES);\n    a.gl.copyTexSubImage2D(L.TEXTURE_2D, 0, t.camera.viewport[0], t.camera.viewport[1], t.camera.viewport[0], t.camera.viewport[1], t.camera.viewport[2], t.camera.viewport[3]), a.bindTexture(i, Y.TEXTURE_UNIT_FOR_UPDATES);\n  }\n  clear() {\n    const t = this._rctx;\n    this._bindFbo(), t.setClearColor(1, 1, 1, 1), t.clearSafe(k.COLOR_BUFFER_BIT | k.DEPTH_BUFFER_BIT);\n  }\n  _computeTextureSize(t, e) {\n    const s = .5 * Math.log(t * t + e * e) * Math.LOG2E,\n      a = .35,\n      i = 2 ** Math.round(s + a);\n    return Math.min(this._maxTextureSize, 2 * i);\n  }\n  _ensureDepthTexture() {\n    if (a(this._depthTexture) && this._depthTexture.descriptor.width === this._textureSize) return;\n    this._discardDepthTexture();\n    const t = {\n      target: L.TEXTURE_2D,\n      pixelFormat: B.RGBA,\n      dataType: I.UNSIGNED_BYTE,\n      wrapMode: V.CLAMP_TO_EDGE,\n      samplingMode: G.NEAREST,\n      flipped: !0,\n      width: this._textureSize,\n      height: this._textureSize\n    };\n    this._depthTexture = new Y(this._rctx, t), this._fbo = new H(this._rctx, {\n      colorTarget: P.TEXTURE,\n      depthStencilTarget: X.DEPTH_RENDER_BUFFER,\n      width: this._textureSize,\n      height: this._textureSize\n    }, this._depthTexture);\n  }\n  _ensureSnapshot(t) {\n    let e = this._snapshots[t];\n    if (a(e) && e.descriptor.width === this._textureSize) return e;\n    this._discardSnapshot(t);\n    const s = {\n      target: L.TEXTURE_2D,\n      pixelFormat: B.RGBA,\n      dataType: I.UNSIGNED_BYTE,\n      wrapMode: V.CLAMP_TO_EDGE,\n      samplingMode: G.NEAREST,\n      flipped: !0,\n      width: this._textureSize,\n      height: this._textureSize\n    };\n    return e = new Y(this._rctx, s), this._snapshots[t] = e, e;\n  }\n  _discardDepthTexture() {\n    this._fbo = i(this._fbo), this._depthTexture = i(this._depthTexture);\n  }\n  _discardSnapshot(t) {\n    this._snapshots[t] = i(this._snapshots[t]);\n  }\n  _discardAllSnapshots() {\n    for (let t = 0; t < this._snapshots.length; ++t) this._discardSnapshot(t);\n    this._snapshots.length = 0;\n  }\n  _bindFbo() {\n    const t = this._rctx;\n    t.unbindTexture(this._depthTexture), t.bindFramebuffer(this._fbo);\n  }\n  _constructCascade(t, e, s, a) {\n    const i = this._cascades[t],\n      r = -this._cascadeDistances[t],\n      n = -this._cascadeDistances[t + 1],\n      o = (e[10] * r + e[14]) / Math.abs(e[11] * r + e[15]),\n      _ = (e[10] * n + e[14]) / Math.abs(e[11] * n + e[15]);\n    y(o < _);\n    for (let h = 0; h < 8; ++h) {\n      v(Z, h % 4 == 0 || h % 4 == 3 ? -1 : 1, h % 4 == 0 || h % 4 == 1 ? -1 : 1, h < 4 ? o : _, 1);\n      const t = $[h];\n      R(t, Z, this._projectionViewInverse), t[0] /= t[3], t[1] /= t[3], t[2] /= t[3];\n    }\n    C(rt, $[0]), i.camera.viewMatrix = h(Q, this._modelViewLight, rt);\n    for (let h = 0; h < 8; ++h) D($[h], $[h], i.camera.viewMatrix);\n    let d = $[0][2],\n      u = $[0][2];\n    for (let h = 1; h < 8; ++h) d = Math.min(d, $[h][2]), u = Math.max(u, $[h][2]);\n    d -= 200, u += 200, i.camera.near = -u, i.camera.far = -d, Et(s, a, d, u, i.camera), c(i.lightMat, i.camera.projectionMatrix, i.camera.viewMatrix);\n    const m = this._textureSize / 2;\n    i.camera.viewport = [t % 2 == 0 ? 0 : m, 0 === Math.floor(t / 2) ? 0 : m, m, m];\n  }\n  _setupMatrices(t, e) {\n    c(this._projectionView, t.projectionMatrix, t.viewMatrix), n(this._projectionViewInverse, this._projectionView);\n    const s = this._viewingMode === U.Global ? t.eye : E(rt, 0, 0, 1);\n    o(this._modelViewLight, [0, 0, 0], [-e[0], -e[1], -e[2]], s);\n  }\n  _clampNearFar(t) {\n    let {\n      near: e,\n      far: s\n    } = t;\n    return e < 2 && (e = 2), s < 2 && (s = 2), e >= s && (e = 2, s = 4), {\n      near: e,\n      far: s\n    };\n  }\n  _computeCascadeDistances(t, s) {\n    this._numCascades = Math.min(1 + Math.floor(N(t / s, 4)), this._maxNumCascades);\n    const a = (t - s) / this._numCascades,\n      i = (t / s) ** (1 / this._numCascades);\n    let r = s,\n      h = s;\n    for (let c = 0; c < this._numCascades + 1; ++c) this._cascadeDistances[c] = e(r, h, this._splitSchemeLambda), r *= i, h += a;\n  }\n  get gpuMemoryUsage() {\n    return this._snapshots.reduce((t, e) => t + q(e), this._fbo?.gpuMemoryUsage ?? 0);\n  }\n  get test() {\n    const t = this;\n    return {\n      maxNumCascades: this._maxNumCascades,\n      cascades: this._cascades,\n      textureSize: this._textureSize,\n      set splitSchemeLambda(e) {\n        t._splitSchemeLambda = e;\n      },\n      get splitSchemeLambda() {\n        return t._splitSchemeLambda;\n      }\n    };\n  }\n}\nconst Q = _(),\n  Z = z(),\n  $ = [];\nfor (let jt = 0; jt < 8; ++jt) $.push(z());\nconst tt = w(),\n  et = w(),\n  st = w(),\n  at = w(),\n  it = w(),\n  rt = j(),\n  ht = [],\n  ct = _(),\n  nt = new Float32Array(64),\n  ot = w(),\n  _t = w(),\n  dt = [w(), w(), w(), w()],\n  ut = w(),\n  mt = w(),\n  lt = w(),\n  pt = w(),\n  ft = w(),\n  xt = w(),\n  gt = w();\nfunction Tt(t, e, s, a, i, r, h, c) {\n  d(ot, 0, 0);\n  for (let d = 0; d < 4; ++d) u(ot, ot, t[d]);\n  m(ot, ot, .25), d(_t, 0, 0);\n  for (let d = 4; d < 8; ++d) u(_t, _t, t[d]);\n  m(_t, _t, .25), l(dt[0], t[4], t[5], .5), l(dt[1], t[5], t[6], .5), l(dt[2], t[6], t[7], .5), l(dt[3], t[7], t[4], .5);\n  let n = 0,\n    o = p(dt[0], ot);\n  for (let d = 1; d < 4; ++d) {\n    const t = p(dt[d], ot);\n    t < o && (o = t, n = d);\n  }\n  f(ut, dt[n], t[n + 4]);\n  const _ = ut[0];\n  let w, S;\n  ut[0] = -ut[1], ut[1] = _, f(mt, _t, ot), x(mt, ut) < 0 && g(ut, ut), l(ut, ut, mt, s), T(ut, ut), w = S = x(f(lt, t[0], ot), ut);\n  for (let d = 1; d < 8; ++d) {\n    const e = x(f(lt, t[d], ot), ut);\n    e < w ? w = e : e > S && (S = e);\n  }\n  b(a, ot), m(lt, ut, w - e), u(a, a, lt);\n  let M = -1,\n    C = 1,\n    D = 0,\n    E = 0;\n  for (let d = 0; d < 8; ++d) {\n    f(pt, t[d], a), T(pt, pt);\n    const e = ut[0] * pt[1] - ut[1] * pt[0];\n    e > 0 ? e > M && (M = e, D = d) : e < C && (C = e, E = d);\n  }\n  O(M > 0, \"leftArea\"), O(C < 0, \"rightArea\"), m(ft, ut, w), u(ft, ft, ot), m(xt, ut, S), u(xt, xt, ot), gt[0] = -ut[1], gt[1] = ut[0];\n  const j = A(a, t[E], xt, u(lt, xt, gt), 1, i),\n    v = A(a, t[D], xt, lt, 1, r),\n    R = A(a, t[D], ft, u(lt, ft, gt), 1, h),\n    z = A(a, t[E], ft, lt, 1, c);\n  O(j, \"rayRay\"), O(v, \"rayRay\"), O(R, \"rayRay\"), O(z, \"rayRay\");\n}\nfunction bt(t, e) {\n  return 3 * e + t;\n}\nconst wt = w();\nfunction St(t, e) {\n  return d(wt, t[e], t[e + 3]), wt;\n}\nconst Mt = w(),\n  Ct = r();\nfunction Dt(t, e, s, a, i) {\n  f(Mt, s, a), m(Mt, Mt, .5), Ct[0] = Mt[0], Ct[1] = Mt[1], Ct[2] = 0, Ct[3] = Mt[1], Ct[4] = -Mt[0], Ct[5] = 0, Ct[6] = Mt[0] * Mt[0] + Mt[1] * Mt[1], Ct[7] = Mt[0] * Mt[1] - Mt[1] * Mt[0], Ct[8] = 1, Ct[bt(0, 2)] = -x(St(Ct, 0), t), Ct[bt(1, 2)] = -x(St(Ct, 1), t);\n  let r = x(St(Ct, 0), s) + Ct[bt(0, 2)],\n    h = x(St(Ct, 1), s) + Ct[bt(1, 2)],\n    c = x(St(Ct, 0), a) + Ct[bt(0, 2)],\n    n = x(St(Ct, 1), a) + Ct[bt(1, 2)];\n  r = -(r + c) / (h + n), Ct[bt(0, 0)] += Ct[bt(1, 0)] * r, Ct[bt(0, 1)] += Ct[bt(1, 1)] * r, Ct[bt(0, 2)] += Ct[bt(1, 2)] * r, r = 1 / (x(St(Ct, 0), s) + Ct[bt(0, 2)]), h = 1 / (x(St(Ct, 1), s) + Ct[bt(1, 2)]), Ct[bt(0, 0)] *= r, Ct[bt(0, 1)] *= r, Ct[bt(0, 2)] *= r, Ct[bt(1, 0)] *= h, Ct[bt(1, 1)] *= h, Ct[bt(1, 2)] *= h, Ct[bt(2, 0)] = Ct[bt(1, 0)], Ct[bt(2, 1)] = Ct[bt(1, 1)], Ct[bt(2, 2)] = Ct[bt(1, 2)], Ct[bt(1, 2)] += 1, r = x(St(Ct, 1), e) + Ct[bt(1, 2)], h = x(St(Ct, 2), e) + Ct[bt(2, 2)], c = x(St(Ct, 1), s) + Ct[bt(1, 2)], n = x(St(Ct, 2), s) + Ct[bt(2, 2)], r = -.5 * (r / h + c / n), Ct[bt(1, 0)] += Ct[bt(2, 0)] * r, Ct[bt(1, 1)] += Ct[bt(2, 1)] * r, Ct[bt(1, 2)] += Ct[bt(2, 2)] * r, r = x(St(Ct, 1), e) + Ct[bt(1, 2)], h = x(St(Ct, 2), e) + Ct[bt(2, 2)], c = -h / r, Ct[bt(1, 0)] *= c, Ct[bt(1, 1)] *= c, Ct[bt(1, 2)] *= c, i[0] = Ct[0], i[1] = Ct[1], i[2] = 0, i[3] = Ct[2], i[4] = Ct[3], i[5] = Ct[4], i[6] = 0, i[7] = Ct[5], i[8] = 0, i[9] = 0, i[10] = 1, i[11] = 0, i[12] = Ct[6], i[13] = Ct[7], i[14] = 0, i[15] = Ct[8];\n}\nfunction Et(t, e, a, i, r) {\n  const h = 1 / $[0][3],\n    c = 1 / $[4][3];\n  y(h < c);\n  let n = h + Math.sqrt(h * c);\n  const o = Math.sin(s(t[2] * e[0] + t[6] * e[1] + t[10] * e[2]));\n  n /= o, Tt($, n, o, tt, et, st, at, it), Dt(tt, et, at, it, r.projectionMatrix), r.projectionMatrix[10] = 2 / (a - i), r.projectionMatrix[14] = -(a + i) / (a - i);\n}\nexport { K as ShadowMap, W as SnapshotSlot };","map":{"version":3,"names":["has","clamp","t","lerp","e","acosClamped","s","isSome","a","disposeMaybe","i","c","r","w","h","m","n","u","o","_","d","j","b","l","k","p","f","x","g","T","S","M","C","D","E","v","R","z","ViewingMode","U","CascadeCamera","F","assert","y","logWithBase","N","verify","O","rayRay2D","A","TextureType","L","ClearBufferBit","PixelFormat","B","PixelType","I","TextureWrapMode","V","TextureSamplingMode","G","TargetType","P","DepthStencilTargetType","X","FramebufferObject","H","Texture","Y","getGpuMemoryUsage","q","W","Highlight","Default","J","constructor","camera","lightMat","K","depthTexture","_depthTexture","textureSize","_textureSize","numCascades","_numCascades","cascadeDistances","_usedCascadeDistances","_cascadeDistances","_rctx","_viewingMode","_enabled","_snapshots","Array","_maxNumCascades","_projectionView","_projectionViewInverse","_modelViewLight","_splitSchemeLambda","_cascades","_lastOrigin","_maxTextureSize","Math","min","parameters","maxTextureSize","dispose","enabled","disposeOffscreenBuffers","_discardDepthTexture","_discardAllSnapshots","maxCascades","floor","ready","getSnapshot","cascades","ht","length","start","_computeTextureSize","fullWidth","fullHeight","_ensureDepthTexture","near","far","_clampNearFar","_computeCascadeDistances","_setupMatrices","viewMatrix","projectionMatrix","_constructCascade","clear","finish","bindFramebuffer","getShadowMapMatrices","ct","nt","takeCascadeSnapshotTo","_ensureSnapshot","_bindFbo","bindTexture","TEXTURE_UNIT_FOR_UPDATES","gl","copyTexSubImage2D","TEXTURE_2D","viewport","setClearColor","clearSafe","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","log","LOG2E","round","descriptor","width","target","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","wrapMode","CLAMP_TO_EDGE","samplingMode","NEAREST","flipped","height","_fbo","colorTarget","TEXTURE","depthStencilTarget","DEPTH_RENDER_BUFFER","_discardSnapshot","unbindTexture","abs","Z","$","rt","Q","max","Et","Global","eye","gpuMemoryUsage","reduce","test","maxNumCascades","splitSchemeLambda","jt","push","tt","et","st","at","it","Float32Array","ot","_t","dt","ut","mt","lt","pt","ft","xt","gt","Tt","bt","wt","St","Mt","Ct","Dt","sqrt","sin","ShadowMap","SnapshotSlot"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/webgl-engine/lib/ShadowMap.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{clamp as t,lerp as e,acosClamped as s}from\"../../../../core/mathUtils.js\";import{isSome as a,disposeMaybe as i}from\"../../../../core/maybe.js\";import{c as r}from\"../../../../chunks/mat3f64.js\";import{w as h,m as c,a as n,u as o}from\"../../../../chunks/mat4.js\";import{c as _}from\"../../../../chunks/mat4f64.js\";import{s as d,j as u,b as m,l,k as p,a as f,h as x,n as g,f as T,c as b}from\"../../../../chunks/vec2.js\";import{a as w}from\"../../../../chunks/vec2f64.js\";import{k as S,c as M,o as C,m as D,s as E}from\"../../../../chunks/vec3.js\";import{c as j}from\"../../../../chunks/vec3f64.js\";import{s as v,t as R}from\"../../../../chunks/vec4.js\";import{c as z}from\"../../../../chunks/vec4f64.js\";import{ViewingMode as U}from\"../../../ViewingMode.js\";import{CascadeCamera as F}from\"./CascadeCamera.js\";import{assert as y,logWithBase as N,verify as O,rayRay2D as A}from\"./Util.js\";import{TextureType as L,ClearBufferBit as k,PixelFormat as B,PixelType as I,TextureWrapMode as V,TextureSamplingMode as G,TargetType as P,DepthStencilTargetType as X}from\"../../../webgl/enums.js\";import{FramebufferObject as H}from\"../../../webgl/FramebufferObject.js\";import{Texture as Y}from\"../../../webgl/Texture.js\";import{getGpuMemoryUsage as q}from\"../../../webgl/Util.js\";var W;!function(t){t[t.Highlight=0]=\"Highlight\",t[t.Default=1]=\"Default\"}(W||(W={}));class J{constructor(){this.camera=new F,this.lightMat=_()}}class K{get depthTexture(){return this._depthTexture}get textureSize(){return this._textureSize}get numCascades(){return this._numCascades}get cascadeDistances(){return v(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}constructor(t,e){this._rctx=t,this._viewingMode=e,this._enabled=!1,this._snapshots=new Array,this._textureSize=0,this._numCascades=1,this._maxNumCascades=4,this._projectionView=_(),this._projectionViewInverse=_(),this._modelViewLight=_(),this._splitSchemeLambda=0,this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=z(),this._cascades=[new J,new J,new J,new J],this._lastOrigin=null,this._maxTextureSize=Math.min(has(\"esri-mobile\")?2048:8192,this._rctx.parameters.maxTextureSize)}dispose(){this.enabled=!1,this.disposeOffscreenBuffers()}disposeOffscreenBuffers(){this._discardDepthTexture(),this._discardAllSnapshots()}set maxCascades(e){this._maxNumCascades=t(Math.floor(e),1,4)}get maxCascades(){return this._maxNumCascades}set enabled(t){this._enabled=t,t||(this._discardDepthTexture(),this._discardAllSnapshots())}get enabled(){return this._enabled}get ready(){return this._enabled&&a(this._depthTexture)}getSnapshot(t){return this.enabled?this._snapshots[t]:null}get cascades(){for(let t=0;t<this._numCascades;++t)ht[t]=this._cascades[t];return ht.length=this._numCascades,ht}start(t,e,s){y(this.enabled),this._textureSize=this._computeTextureSize(t.fullWidth,t.fullHeight),this._ensureDepthTexture();const{near:a,far:i}=this._clampNearFar(s);this._computeCascadeDistances(i,a),this._setupMatrices(t,e);const{viewMatrix:r,projectionMatrix:h}=t;for(let c=0;c<this._numCascades;++c)this._constructCascade(c,h,r,e);this._lastOrigin=null,this.clear()}finish(t){y(this.enabled),this._rctx.bindFramebuffer(t)}getShadowMapMatrices(t){if(!this._lastOrigin||!S(t,this._lastOrigin)){this._lastOrigin=this._lastOrigin||j(),M(this._lastOrigin,t);for(let e=0;e<this._numCascades;++e){h(ct,this._cascades[e].lightMat,t);for(let t=0;t<16;++t)nt[16*e+t]=ct[t]}}return nt}takeCascadeSnapshotTo(t,e){y(this.enabled);const s=this._ensureSnapshot(e);this._bindFbo();const a=this._rctx,i=a.bindTexture(s,Y.TEXTURE_UNIT_FOR_UPDATES);a.gl.copyTexSubImage2D(L.TEXTURE_2D,0,t.camera.viewport[0],t.camera.viewport[1],t.camera.viewport[0],t.camera.viewport[1],t.camera.viewport[2],t.camera.viewport[3]),a.bindTexture(i,Y.TEXTURE_UNIT_FOR_UPDATES)}clear(){const t=this._rctx;this._bindFbo(),t.setClearColor(1,1,1,1),t.clearSafe(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT)}_computeTextureSize(t,e){const s=.5*Math.log(t*t+e*e)*Math.LOG2E,a=.35,i=2**Math.round(s+a);return Math.min(this._maxTextureSize,2*i)}_ensureDepthTexture(){if(a(this._depthTexture)&&this._depthTexture.descriptor.width===this._textureSize)return;this._discardDepthTexture();const t={target:L.TEXTURE_2D,pixelFormat:B.RGBA,dataType:I.UNSIGNED_BYTE,wrapMode:V.CLAMP_TO_EDGE,samplingMode:G.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};this._depthTexture=new Y(this._rctx,t),this._fbo=new H(this._rctx,{colorTarget:P.TEXTURE,depthStencilTarget:X.DEPTH_RENDER_BUFFER,width:this._textureSize,height:this._textureSize},this._depthTexture)}_ensureSnapshot(t){let e=this._snapshots[t];if(a(e)&&e.descriptor.width===this._textureSize)return e;this._discardSnapshot(t);const s={target:L.TEXTURE_2D,pixelFormat:B.RGBA,dataType:I.UNSIGNED_BYTE,wrapMode:V.CLAMP_TO_EDGE,samplingMode:G.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};return e=new Y(this._rctx,s),this._snapshots[t]=e,e}_discardDepthTexture(){this._fbo=i(this._fbo),this._depthTexture=i(this._depthTexture)}_discardSnapshot(t){this._snapshots[t]=i(this._snapshots[t])}_discardAllSnapshots(){for(let t=0;t<this._snapshots.length;++t)this._discardSnapshot(t);this._snapshots.length=0}_bindFbo(){const t=this._rctx;t.unbindTexture(this._depthTexture),t.bindFramebuffer(this._fbo)}_constructCascade(t,e,s,a){const i=this._cascades[t],r=-this._cascadeDistances[t],n=-this._cascadeDistances[t+1],o=(e[10]*r+e[14])/Math.abs(e[11]*r+e[15]),_=(e[10]*n+e[14])/Math.abs(e[11]*n+e[15]);y(o<_);for(let h=0;h<8;++h){v(Z,h%4==0||h%4==3?-1:1,h%4==0||h%4==1?-1:1,h<4?o:_,1);const t=$[h];R(t,Z,this._projectionViewInverse),t[0]/=t[3],t[1]/=t[3],t[2]/=t[3]}C(rt,$[0]),i.camera.viewMatrix=h(Q,this._modelViewLight,rt);for(let h=0;h<8;++h)D($[h],$[h],i.camera.viewMatrix);let d=$[0][2],u=$[0][2];for(let h=1;h<8;++h)d=Math.min(d,$[h][2]),u=Math.max(u,$[h][2]);d-=200,u+=200,i.camera.near=-u,i.camera.far=-d,Et(s,a,d,u,i.camera),c(i.lightMat,i.camera.projectionMatrix,i.camera.viewMatrix);const m=this._textureSize/2;i.camera.viewport=[t%2==0?0:m,0===Math.floor(t/2)?0:m,m,m]}_setupMatrices(t,e){c(this._projectionView,t.projectionMatrix,t.viewMatrix),n(this._projectionViewInverse,this._projectionView);const s=this._viewingMode===U.Global?t.eye:E(rt,0,0,1);o(this._modelViewLight,[0,0,0],[-e[0],-e[1],-e[2]],s)}_clampNearFar(t){let{near:e,far:s}=t;return e<2&&(e=2),s<2&&(s=2),e>=s&&(e=2,s=4),{near:e,far:s}}_computeCascadeDistances(t,s){this._numCascades=Math.min(1+Math.floor(N(t/s,4)),this._maxNumCascades);const a=(t-s)/this._numCascades,i=(t/s)**(1/this._numCascades);let r=s,h=s;for(let c=0;c<this._numCascades+1;++c)this._cascadeDistances[c]=e(r,h,this._splitSchemeLambda),r*=i,h+=a}get gpuMemoryUsage(){return this._snapshots.reduce(((t,e)=>t+q(e)),this._fbo?.gpuMemoryUsage??0)}get test(){const t=this;return{maxNumCascades:this._maxNumCascades,cascades:this._cascades,textureSize:this._textureSize,set splitSchemeLambda(e){t._splitSchemeLambda=e},get splitSchemeLambda(){return t._splitSchemeLambda}}}}const Q=_(),Z=z(),$=[];for(let jt=0;jt<8;++jt)$.push(z());const tt=w(),et=w(),st=w(),at=w(),it=w(),rt=j(),ht=[],ct=_(),nt=new Float32Array(64),ot=w(),_t=w(),dt=[w(),w(),w(),w()],ut=w(),mt=w(),lt=w(),pt=w(),ft=w(),xt=w(),gt=w();function Tt(t,e,s,a,i,r,h,c){d(ot,0,0);for(let d=0;d<4;++d)u(ot,ot,t[d]);m(ot,ot,.25),d(_t,0,0);for(let d=4;d<8;++d)u(_t,_t,t[d]);m(_t,_t,.25),l(dt[0],t[4],t[5],.5),l(dt[1],t[5],t[6],.5),l(dt[2],t[6],t[7],.5),l(dt[3],t[7],t[4],.5);let n=0,o=p(dt[0],ot);for(let d=1;d<4;++d){const t=p(dt[d],ot);t<o&&(o=t,n=d)}f(ut,dt[n],t[n+4]);const _=ut[0];let w,S;ut[0]=-ut[1],ut[1]=_,f(mt,_t,ot),x(mt,ut)<0&&g(ut,ut),l(ut,ut,mt,s),T(ut,ut),w=S=x(f(lt,t[0],ot),ut);for(let d=1;d<8;++d){const e=x(f(lt,t[d],ot),ut);e<w?w=e:e>S&&(S=e)}b(a,ot),m(lt,ut,w-e),u(a,a,lt);let M=-1,C=1,D=0,E=0;for(let d=0;d<8;++d){f(pt,t[d],a),T(pt,pt);const e=ut[0]*pt[1]-ut[1]*pt[0];e>0?e>M&&(M=e,D=d):e<C&&(C=e,E=d)}O(M>0,\"leftArea\"),O(C<0,\"rightArea\"),m(ft,ut,w),u(ft,ft,ot),m(xt,ut,S),u(xt,xt,ot),gt[0]=-ut[1],gt[1]=ut[0];const j=A(a,t[E],xt,u(lt,xt,gt),1,i),v=A(a,t[D],xt,lt,1,r),R=A(a,t[D],ft,u(lt,ft,gt),1,h),z=A(a,t[E],ft,lt,1,c);O(j,\"rayRay\"),O(v,\"rayRay\"),O(R,\"rayRay\"),O(z,\"rayRay\")}function bt(t,e){return 3*e+t}const wt=w();function St(t,e){return d(wt,t[e],t[e+3]),wt}const Mt=w(),Ct=r();function Dt(t,e,s,a,i){f(Mt,s,a),m(Mt,Mt,.5),Ct[0]=Mt[0],Ct[1]=Mt[1],Ct[2]=0,Ct[3]=Mt[1],Ct[4]=-Mt[0],Ct[5]=0,Ct[6]=Mt[0]*Mt[0]+Mt[1]*Mt[1],Ct[7]=Mt[0]*Mt[1]-Mt[1]*Mt[0],Ct[8]=1,Ct[bt(0,2)]=-x(St(Ct,0),t),Ct[bt(1,2)]=-x(St(Ct,1),t);let r=x(St(Ct,0),s)+Ct[bt(0,2)],h=x(St(Ct,1),s)+Ct[bt(1,2)],c=x(St(Ct,0),a)+Ct[bt(0,2)],n=x(St(Ct,1),a)+Ct[bt(1,2)];r=-(r+c)/(h+n),Ct[bt(0,0)]+=Ct[bt(1,0)]*r,Ct[bt(0,1)]+=Ct[bt(1,1)]*r,Ct[bt(0,2)]+=Ct[bt(1,2)]*r,r=1/(x(St(Ct,0),s)+Ct[bt(0,2)]),h=1/(x(St(Ct,1),s)+Ct[bt(1,2)]),Ct[bt(0,0)]*=r,Ct[bt(0,1)]*=r,Ct[bt(0,2)]*=r,Ct[bt(1,0)]*=h,Ct[bt(1,1)]*=h,Ct[bt(1,2)]*=h,Ct[bt(2,0)]=Ct[bt(1,0)],Ct[bt(2,1)]=Ct[bt(1,1)],Ct[bt(2,2)]=Ct[bt(1,2)],Ct[bt(1,2)]+=1,r=x(St(Ct,1),e)+Ct[bt(1,2)],h=x(St(Ct,2),e)+Ct[bt(2,2)],c=x(St(Ct,1),s)+Ct[bt(1,2)],n=x(St(Ct,2),s)+Ct[bt(2,2)],r=-.5*(r/h+c/n),Ct[bt(1,0)]+=Ct[bt(2,0)]*r,Ct[bt(1,1)]+=Ct[bt(2,1)]*r,Ct[bt(1,2)]+=Ct[bt(2,2)]*r,r=x(St(Ct,1),e)+Ct[bt(1,2)],h=x(St(Ct,2),e)+Ct[bt(2,2)],c=-h/r,Ct[bt(1,0)]*=c,Ct[bt(1,1)]*=c,Ct[bt(1,2)]*=c,i[0]=Ct[0],i[1]=Ct[1],i[2]=0,i[3]=Ct[2],i[4]=Ct[3],i[5]=Ct[4],i[6]=0,i[7]=Ct[5],i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=Ct[6],i[13]=Ct[7],i[14]=0,i[15]=Ct[8]}function Et(t,e,a,i,r){const h=1/$[0][3],c=1/$[4][3];y(h<c);let n=h+Math.sqrt(h*c);const o=Math.sin(s(t[2]*e[0]+t[6]*e[1]+t[10]*e[2]));n/=o,Tt($,n,o,tt,et,st,at,it),Dt(tt,et,at,it,r.projectionMatrix),r.projectionMatrix[10]=2/(a-i),r.projectionMatrix[14]=-(a+i)/(a-i)}export{K as ShadowMap,W as SnapshotSlot};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}