{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as e, get as t, isNone as s } from \"../../../core/maybe.js\";\nimport { TextureUpdate as i } from \"./interfaces.js\";\nimport { PROGRESSIVE_LOADING_MODULO as l } from \"./TerrainConst.js\";\nimport { getLayerWithExtentRange as a } from \"./terrainUtils.js\";\nimport { fallsWithinLayer as r } from \"./tileUtils.js\";\nclass n {\n  get updating() {\n    return !!this._tileRequested;\n  }\n  init(e, t, s, i) {\n    this.tile = e, this._layerIdx = t, this._layerClass = s, this._suspended = i, this._tileLayerInfo = e.getLayerInfo(t, s), this._tileRequested = null;\n    const l = this._findAncestorWithData();\n    this._setUpsampleTile(l);\n  }\n  startLoading() {\n    return this._requestNext();\n  }\n  dispose() {\n    this._tileRequested && (this._tileRequested.unrequestLayerData(this._layerIdx, this._layerClass, this), this._tileRequested = null), this.tile = null, this._tileLayerInfo = null;\n  }\n  setSuspension(e) {\n    e !== this._suspended && (this._suspended = e, e ? this._tileRequested && (this._tileRequested.unrequestLayerData(this._layerIdx, this._layerClass, this), this._tileRequested = null) : this._tileLayerInfo.data || this.update());\n  }\n  update() {\n    const e = this._findAncestorWithData();\n    return this._setUpsampleTile(e), this._requestNext();\n  }\n  dataArrived(e) {\n    this._setUpsampleTile(e), this._tileRequested = null, e === this.tile ? this.tile.updateRenderData(this._layerClass, i.FADING) : this._requestNext();\n  }\n  dataMissing() {\n    this._tileRequested = null, this._tileLayerInfo.data = null, this._requestNext();\n  }\n  _agentDone() {\n    this.tile.agentDone(this._layerIdx, this._layerClass), this.dispose();\n  }\n  _requestNext() {\n    if (this._suspended) return !0;\n    const t = this._findNextDownload();\n    if (this._tileRequested) {\n      if (t === this._tileRequested) return !0;\n      this._tileRequested.unrequestLayerData(this._layerIdx, this._layerClass, this), this._tileRequested = null;\n    }\n    return e(t) ? t.requestLayerData(this._layerIdx, this._layerClass, this) && (this._tileRequested = t) : this._agentDone(), !!this._tileRequested;\n  }\n  _findNextDownload() {\n    const i = this._layerIdx,\n      n = this._layerClass,\n      h = this.tile.surface.layerViewByIndex(i, n),\n      d = a(h),\n      {\n        minLevel: _,\n        maxLevel: o\n      } = h.dataLevelRange,\n      u = this._desiredMinLevelDelta,\n      p = this._progressiveLevelModulo + u,\n      y = this._scaleRangeEnabled ? r : () => !0;\n    let f = this.tile;\n    const I = f.level;\n    let q;\n    const v = this._tileLayerInfo.upsampleInfo,\n      L = e(v) ? v.tile.level : -1,\n      m = !!e(v) && L - I >= u,\n      D = t(d, \"tilemapCache\");\n    for (; f && y(f, d, !1) && f.level >= _;) {\n      const e = f.level,\n        t = I - e,\n        a = f.layerInfo[n][i];\n      if (a.data && t >= u) {\n        (!m || e > L) && this._setUpsampleTile(f), a.dataInvalidated && (q = f);\n        break;\n      }\n      if ((s(D) || \"unavailable\" !== D.getAvailability(f.lij[0], f.lij[1], f.lij[2])) && e <= o && !a.data && !a.dataMissing && ((s(q) || f.level === _ || e % l == 0 || I - q.level < u) && (q = f), t >= p)) break;\n      f = f.parent;\n    }\n    return e(q) && I - q.level < u && this._tileLayerInfo.upsampleInfo && (q = null), q;\n  }\n  _findAncestorWithData() {\n    const e = this.tile.vlevel,\n      t = this._desiredMinLevelDelta;\n    let s;\n    for (let i = this.tile; i; i = i.parent) if (i.hasLayerData(this._layerIdx, this._layerClass)) {\n      if (e - i.level >= t) return i;\n      s = i;\n    }\n    return s;\n  }\n  _setUpsampleTile(e) {\n    this._tileLayerInfo.setUpsampleInfo(this.tile, e), this.tile.updateRenderData(this._layerClass, i.FADING);\n  }\n  get test() {\n    return {\n      findNextDownload: () => this._findNextDownload(),\n      tileLayerInfo: this._tileLayerInfo\n    };\n  }\n}\nclass h extends n {\n  get _desiredMinLevelDelta() {\n    throw d;\n  }\n  get _progressiveLevelModulo() {\n    throw d;\n  }\n  dispose() {}\n}\nconst d = new Error(\"Abstract method called on TileAgent\"),\n  _ = new h();\nexport { _ as TILE_AGENT_DONE, n as TileAgent };","map":{"version":3,"names":["isSome","e","get","t","isNone","s","TextureUpdate","i","PROGRESSIVE_LOADING_MODULO","l","getLayerWithExtentRange","a","fallsWithinLayer","r","n","updating","_tileRequested","init","tile","_layerIdx","_layerClass","_suspended","_tileLayerInfo","getLayerInfo","_findAncestorWithData","_setUpsampleTile","startLoading","_requestNext","dispose","unrequestLayerData","setSuspension","data","update","dataArrived","updateRenderData","FADING","dataMissing","_agentDone","agentDone","_findNextDownload","requestLayerData","h","surface","layerViewByIndex","d","minLevel","_","maxLevel","o","dataLevelRange","u","_desiredMinLevelDelta","p","_progressiveLevelModulo","y","_scaleRangeEnabled","f","I","level","q","v","upsampleInfo","L","m","D","layerInfo","dataInvalidated","getAvailability","lij","parent","vlevel","hasLayerData","setUpsampleInfo","test","findNextDownload","tileLayerInfo","Error","TILE_AGENT_DONE","TileAgent"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/terrain/TileAgent.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e,get as t,isNone as s}from\"../../../core/maybe.js\";import{TextureUpdate as i}from\"./interfaces.js\";import{PROGRESSIVE_LOADING_MODULO as l}from\"./TerrainConst.js\";import{getLayerWithExtentRange as a}from\"./terrainUtils.js\";import{fallsWithinLayer as r}from\"./tileUtils.js\";class n{get updating(){return!!this._tileRequested}init(e,t,s,i){this.tile=e,this._layerIdx=t,this._layerClass=s,this._suspended=i,this._tileLayerInfo=e.getLayerInfo(t,s),this._tileRequested=null;const l=this._findAncestorWithData();this._setUpsampleTile(l)}startLoading(){return this._requestNext()}dispose(){this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null),this.tile=null,this._tileLayerInfo=null}setSuspension(e){e!==this._suspended&&(this._suspended=e,e?this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null):this._tileLayerInfo.data||this.update())}update(){const e=this._findAncestorWithData();return this._setUpsampleTile(e),this._requestNext()}dataArrived(e){this._setUpsampleTile(e),this._tileRequested=null,e===this.tile?this.tile.updateRenderData(this._layerClass,i.FADING):this._requestNext()}dataMissing(){this._tileRequested=null,this._tileLayerInfo.data=null,this._requestNext()}_agentDone(){this.tile.agentDone(this._layerIdx,this._layerClass),this.dispose()}_requestNext(){if(this._suspended)return!0;const t=this._findNextDownload();if(this._tileRequested){if(t===this._tileRequested)return!0;this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null}return e(t)?t.requestLayerData(this._layerIdx,this._layerClass,this)&&(this._tileRequested=t):this._agentDone(),!!this._tileRequested}_findNextDownload(){const i=this._layerIdx,n=this._layerClass,h=this.tile.surface.layerViewByIndex(i,n),d=a(h),{minLevel:_,maxLevel:o}=h.dataLevelRange,u=this._desiredMinLevelDelta,p=this._progressiveLevelModulo+u,y=this._scaleRangeEnabled?r:()=>!0;let f=this.tile;const I=f.level;let q;const v=this._tileLayerInfo.upsampleInfo,L=e(v)?v.tile.level:-1,m=!!e(v)&&L-I>=u,D=t(d,\"tilemapCache\");for(;f&&y(f,d,!1)&&f.level>=_;){const e=f.level,t=I-e,a=f.layerInfo[n][i];if(a.data&&t>=u){(!m||e>L)&&this._setUpsampleTile(f),a.dataInvalidated&&(q=f);break}if((s(D)||\"unavailable\"!==D.getAvailability(f.lij[0],f.lij[1],f.lij[2]))&&e<=o&&!a.data&&!a.dataMissing&&((s(q)||f.level===_||e%l==0||I-q.level<u)&&(q=f),t>=p))break;f=f.parent}return e(q)&&I-q.level<u&&this._tileLayerInfo.upsampleInfo&&(q=null),q}_findAncestorWithData(){const e=this.tile.vlevel,t=this._desiredMinLevelDelta;let s;for(let i=this.tile;i;i=i.parent)if(i.hasLayerData(this._layerIdx,this._layerClass)){if(e-i.level>=t)return i;s=i}return s}_setUpsampleTile(e){this._tileLayerInfo.setUpsampleInfo(this.tile,e),this.tile.updateRenderData(this._layerClass,i.FADING)}get test(){return{findNextDownload:()=>this._findNextDownload(),tileLayerInfo:this._tileLayerInfo}}}class h extends n{get _desiredMinLevelDelta(){throw d}get _progressiveLevelModulo(){throw d}dispose(){}}const d=new Error(\"Abstract method called on TileAgent\"),_=new h;export{_ as TILE_AGENT_DONE,n as TileAgent};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}