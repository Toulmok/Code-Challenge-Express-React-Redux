{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport \"../../../geometry.js\";\nimport e from \"../../../core/Error.js\";\nimport { isSome as s } from \"../../../core/maybe.js\";\nimport { eachAlways as r } from \"../../../core/promiseUtils.js\";\nimport { property as i } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport a from \"../RasterInfo.js\";\nimport m from \"./BaseRaster.js\";\nimport { split as n } from \"../rasterFunctions/pixelUtils.js\";\nimport { estimateStatisticsHistograms as l } from \"../rasterFunctions/stretchUtils.js\";\nimport p from \"../../../geometry/Extent.js\";\nimport c from \"../../../geometry/SpatialReference.js\";\nlet h = class extends m {\n  constructor() {\n    super(...arguments), this.datasetFormat = \"MEMORY\", this.data = null;\n  }\n  async open(t) {\n    await this.init();\n    const e = this.data,\n      {\n        pixelBlock: s,\n        statistics: r,\n        histograms: i,\n        name: o,\n        keyProperties: m,\n        nativeExtent: n,\n        transform: l\n      } = this.data,\n      {\n        width: h,\n        height: f,\n        pixelType: d\n      } = s,\n      u = e.extent ?? new p({\n        xmin: -.5,\n        ymin: .5,\n        xmax: h - .5,\n        ymax: f - .5,\n        spatialReference: new c({\n          wkid: 3857\n        })\n      }),\n      y = e.isPseudoSpatialReference ?? !e.extent,\n      x = {\n        x: u.width / h,\n        y: u.height / f\n      },\n      g = new a({\n        width: h,\n        height: f,\n        pixelType: d,\n        extent: u,\n        nativeExtent: n,\n        transform: l,\n        pixelSize: x,\n        spatialReference: u.spatialReference,\n        bandCount: s.pixels.length,\n        keyProperties: m || {},\n        statistics: r,\n        isPseudoSpatialReference: y,\n        histograms: i\n      });\n    this.createRemoteDatasetStorageInfo(g, 512, 512), this._set(\"rasterInfo\", g), this.updateTileInfo(), await this._buildInMemoryRaster(s, {\n      width: 512,\n      height: 512\n    }, t), this.datasetName = o, this.url = \"/InMemory/\" + o;\n  }\n  fetchRawTile(t, e, s) {\n    let r = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    const i = this._pixelBlockTiles.get(`${t}/${e}/${s}`);\n    return Promise.resolve(i);\n  }\n  async _buildInMemoryRaster(t, i, o) {\n    const a = this.rasterInfo.storageInfo.maximumPyramidLevel,\n      m = this.rasterJobHandler ? this.rasterJobHandler.split({\n        pixelBlock: t,\n        tileSize: i,\n        maximumPyramidLevel: a\n      }, o) : Promise.resolve(n(t, i, a)),\n      p = s(this.rasterInfo.statistics),\n      c = s(this.rasterInfo.histograms),\n      h = p ? Promise.resolve({\n        statistics: null,\n        histograms: null\n      }) : this.rasterJobHandler ? this.rasterJobHandler.estimateStatisticsHistograms({\n        pixelBlock: t\n      }, o) : Promise.resolve(l(t)),\n      f = await r([m, h]);\n    if (!f[0].value && f[1].value) throw new e(\"inmemory-raster:open\", \"failed to build in memory raster\");\n    this._pixelBlockTiles = f[0].value, p || (this.rasterInfo.statistics = f[1].value?.statistics), c || (this.rasterInfo.histograms = f[1].value?.histograms);\n  }\n};\nt([i({\n  type: String,\n  json: {\n    write: !0\n  }\n})], h.prototype, \"datasetFormat\", void 0), t([i()], h.prototype, \"data\", void 0), h = t([o(\"esri.layers.support.rasterDatasets.InMemoryRaster\")], h);\nconst f = h;\nexport { f as default };","map":{"version":3,"names":["_","t","e","isSome","s","eachAlways","r","property","i","subclass","o","a","m","split","n","estimateStatisticsHistograms","l","p","c","h","constructor","arguments","datasetFormat","data","open","init","pixelBlock","statistics","histograms","name","keyProperties","nativeExtent","transform","width","height","f","pixelType","d","u","extent","xmin","ymin","xmax","ymax","spatialReference","wkid","y","isPseudoSpatialReference","x","g","pixelSize","bandCount","pixels","length","createRemoteDatasetStorageInfo","_set","updateTileInfo","_buildInMemoryRaster","datasetName","url","fetchRawTile","undefined","_pixelBlockTiles","get","Promise","resolve","rasterInfo","storageInfo","maximumPyramidLevel","rasterJobHandler","tileSize","value","type","String","json","write","prototype","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/layers/support/rasterDatasets/InMemoryRaster.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import e from\"../../../core/Error.js\";import{isSome as s}from\"../../../core/maybe.js\";import{eachAlways as r}from\"../../../core/promiseUtils.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import a from\"../RasterInfo.js\";import m from\"./BaseRaster.js\";import{split as n}from\"../rasterFunctions/pixelUtils.js\";import{estimateStatisticsHistograms as l}from\"../rasterFunctions/stretchUtils.js\";import p from\"../../../geometry/Extent.js\";import c from\"../../../geometry/SpatialReference.js\";let h=class extends m{constructor(){super(...arguments),this.datasetFormat=\"MEMORY\",this.data=null}async open(t){await this.init();const e=this.data,{pixelBlock:s,statistics:r,histograms:i,name:o,keyProperties:m,nativeExtent:n,transform:l}=this.data,{width:h,height:f,pixelType:d}=s,u=e.extent??new p({xmin:-.5,ymin:.5,xmax:h-.5,ymax:f-.5,spatialReference:new c({wkid:3857})}),y=e.isPseudoSpatialReference??!e.extent,x={x:u.width/h,y:u.height/f},g=new a({width:h,height:f,pixelType:d,extent:u,nativeExtent:n,transform:l,pixelSize:x,spatialReference:u.spatialReference,bandCount:s.pixels.length,keyProperties:m||{},statistics:r,isPseudoSpatialReference:y,histograms:i});this.createRemoteDatasetStorageInfo(g,512,512),this._set(\"rasterInfo\",g),this.updateTileInfo(),await this._buildInMemoryRaster(s,{width:512,height:512},t),this.datasetName=o,this.url=\"/InMemory/\"+o}fetchRawTile(t,e,s,r={}){const i=this._pixelBlockTiles.get(`${t}/${e}/${s}`);return Promise.resolve(i)}async _buildInMemoryRaster(t,i,o){const a=this.rasterInfo.storageInfo.maximumPyramidLevel,m=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:t,tileSize:i,maximumPyramidLevel:a},o):Promise.resolve(n(t,i,a)),p=s(this.rasterInfo.statistics),c=s(this.rasterInfo.histograms),h=p?Promise.resolve({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:t},o):Promise.resolve(l(t)),f=await r([m,h]);if(!f[0].value&&f[1].value)throw new e(\"inmemory-raster:open\",\"failed to build in memory raster\");this._pixelBlockTiles=f[0].value,p||(this.rasterInfo.statistics=f[1].value?.statistics),c||(this.rasterInfo.histograms=f[1].value?.histograms)}};t([i({type:String,json:{write:!0}})],h.prototype,\"datasetFormat\",void 0),t([i()],h.prototype,\"data\",void 0),h=t([o(\"esri.layers.support.rasterDatasets.InMemoryRaster\")],h);const f=h;export{f as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}