{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../../core/Logger.js\";\nimport { analyzeCIMResource as t } from \"../../../../../../symbols/cim/cimAnalyzer.js\";\nimport { evaluateValueOrFunction as a } from \"../../../../../../symbols/cim/utils.js\";\nimport s from \"./WGLMeshTemplate.js\";\nconst i = e.getLogger(\"esri.views.2d.engine.webgl.WGLDynamicMeshTemplate\");\nclass r extends s {\n  constructor(e) {\n    super(), this._ongoingMaterialRequestMap = new Map(), this._materialCache = new Map(), this._dynamicPropertyMap = new Map(), this._cimLayer = e;\n  }\n  analyze(e, s, r, n, o) {\n    if (o && 0 === o.length) return null;\n    const l = o && o.length > 0,\n      m = s.readLegacyFeature(),\n      c = s.getObjectId(),\n      h = this._materialCache,\n      u = this._cimLayer.materialHash;\n    if (!u) return i.error(\"A Dynamic mesh template must have a material hash value or function!\"), Promise.reject(null);\n    const p = \"function\" == typeof u ? u(m, r, n, c) : u,\n      g = h.get(p);\n    if (null != g) return Promise.resolve(g);\n    const y = this._ongoingMaterialRequestMap.get(p);\n    if (y) return y;\n    const M = this._cimLayer,\n      d = t(M.cim, this._cimLayer.materialOverrides);\n    d.mosaicHash = p;\n    const {\n        type: f,\n        url: _\n      } = M,\n      b = {\n        cim: d,\n        type: f,\n        mosaicHash: p,\n        url: _,\n        size: null,\n        dashTemplate: null,\n        text: null,\n        fontName: null,\n        objectId: c,\n        animatedSymbolProperties: null\n      };\n    switch (f) {\n      case \"marker\":\n        b.size = a(M.size, m, r, n), b.animatedSymbolProperties = a(M.animatedSymbolProperties, m, r, n);\n        break;\n      case \"line\":\n        b.dashTemplate = M.dashTemplate;\n        break;\n      case \"text\":\n        b.text = a(M.text, m, r, n), b.fontName = a(M.fontName, m, r, n);\n    }\n    const L = e.getMosaicItem(b, o).then(e => (l || (this._ongoingMaterialRequestMap.delete(p), h.set(p, e)), e)).catch(e => (this._ongoingMaterialRequestMap.delete(p), i.error(\".analyze()\", e.message), null));\n    return l || this._ongoingMaterialRequestMap.set(p, L), L;\n  }\n}\nexport { r as default };","map":{"version":3,"names":["e","analyzeCIMResource","t","evaluateValueOrFunction","a","s","i","getLogger","r","constructor","_ongoingMaterialRequestMap","Map","_materialCache","_dynamicPropertyMap","_cimLayer","analyze","n","o","length","l","m","readLegacyFeature","c","getObjectId","h","u","materialHash","error","Promise","reject","p","g","get","resolve","y","M","d","cim","materialOverrides","mosaicHash","type","f","url","_","b","size","dashTemplate","text","fontName","objectId","animatedSymbolProperties","L","getMosaicItem","then","delete","set","catch","message","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../../core/Logger.js\";import{analyzeCIMResource as t}from\"../../../../../../symbols/cim/cimAnalyzer.js\";import{evaluateValueOrFunction as a}from\"../../../../../../symbols/cim/utils.js\";import s from\"./WGLMeshTemplate.js\";const i=e.getLogger(\"esri.views.2d.engine.webgl.WGLDynamicMeshTemplate\");class r extends s{constructor(e){super(),this._ongoingMaterialRequestMap=new Map,this._materialCache=new Map,this._dynamicPropertyMap=new Map,this._cimLayer=e}analyze(e,s,r,n,o){if(o&&0===o.length)return null;const l=o&&o.length>0,m=s.readLegacyFeature(),c=s.getObjectId(),h=this._materialCache,u=this._cimLayer.materialHash;if(!u)return i.error(\"A Dynamic mesh template must have a material hash value or function!\"),Promise.reject(null);const p=\"function\"==typeof u?u(m,r,n,c):u,g=h.get(p);if(null!=g)return Promise.resolve(g);const y=this._ongoingMaterialRequestMap.get(p);if(y)return y;const M=this._cimLayer,d=t(M.cim,this._cimLayer.materialOverrides);d.mosaicHash=p;const{type:f,url:_}=M,b={cim:d,type:f,mosaicHash:p,url:_,size:null,dashTemplate:null,text:null,fontName:null,objectId:c,animatedSymbolProperties:null};switch(f){case\"marker\":b.size=a(M.size,m,r,n),b.animatedSymbolProperties=a(M.animatedSymbolProperties,m,r,n);break;case\"line\":b.dashTemplate=M.dashTemplate;break;case\"text\":b.text=a(M.text,m,r,n),b.fontName=a(M.fontName,m,r,n)}const L=e.getMosaicItem(b,o).then((e=>(l||(this._ongoingMaterialRequestMap.delete(p),h.set(p,e)),e))).catch((e=>(this._ongoingMaterialRequestMap.delete(p),i.error(\".analyze()\",e.message),null)));return l||this._ongoingMaterialRequestMap.set(p,L),L}}export{r as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}