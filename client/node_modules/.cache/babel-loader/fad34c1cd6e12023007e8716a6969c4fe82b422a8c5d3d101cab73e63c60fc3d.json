{"ast":null,"code":"import _createForOfIteratorHelper from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as t } from \"../../../core/maybe.js\";\nimport { isArrayBuffer as r } from \"../../../core/typedArrayUtil.js\";\nimport { c as e } from \"../../../chunks/quat.js\";\nimport { c as a } from \"../../../chunks/quatf32.js\";\nimport { q as o } from \"../../../chunks/vec3.js\";\nimport { f, c as i } from \"../../../chunks/vec3f32.js\";\nimport { projectBuffer as n } from \"../../../geometry/projection.js\";\nimport s from \"../../../geometry/SpatialReference.js\";\nimport { readGeometry as u, getAttributeValues as l, evaluateRenderer as b, filterInPlace as m } from \"./i3s/PointCloudWorkerUtil.js\";\nvar c = /*#__PURE__*/function () {\n  function c() {\n    _classCallCheck(this, c);\n  }\n  _createClass(c, [{\n    key: \"transform\",\n    value: function transform(e) {\n      var a = this._transform(e),\n        o = [a.points.buffer, a.rgb.buffer];\n      t(a.pointIdFilterMap) && o.push(a.pointIdFilterMap.buffer);\n      var _iterator = _createForOfIteratorHelper(a.attributes),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _t = _step.value;\n          \"buffer\" in _t.values && r(_t.values.buffer) && _t.values.buffer !== a.rgb.buffer && o.push(_t.values.buffer);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      return Promise.resolve({\n        result: a,\n        transferList: o\n      });\n    }\n  }, {\n    key: \"_transform\",\n    value: function _transform(r) {\n      var e = u(r.schema, r.geometryBuffer);\n      var a = e.length / 3,\n        o = null;\n      var f = [],\n        i = l(r.primaryAttributeData, e, a);\n      t(r.primaryAttributeData) && i && f.push({\n        attributeInfo: r.primaryAttributeData.attributeInfo,\n        values: i\n      });\n      var n = l(r.modulationAttributeData, e, a);\n      t(r.modulationAttributeData) && n && f.push({\n        attributeInfo: r.modulationAttributeData.attributeInfo,\n        values: n\n      });\n      var _c = b(r.rendererInfo, i, n, a);\n      if (r.filterInfo && r.filterInfo.length > 0 && t(r.filterAttributesData)) {\n        var _i = r.filterAttributesData.filter(t).map(function (t) {\n          var r = l(t, e, a),\n            o = {\n              attributeInfo: t.attributeInfo,\n              values: r\n            };\n          return f.push(o), o;\n        });\n        o = new Uint32Array(a), a = m(e, _c, o, r.filterInfo, _i);\n      }\n      var _iterator2 = _createForOfIteratorHelper(r.userAttributesData),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _t2 = _step2.value;\n          var _r = l(_t2, e, a);\n          f.push({\n            attributeInfo: _t2.attributeInfo,\n            values: _r\n          });\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      3 * a < _c.length && (_c = new Uint8Array(_c.buffer.slice(0, 3 * a))), this._applyElevationOffsetInPlace(e, a, r.elevationOffset);\n      var p = this._transformCoordinates(e, a, r.obb, s.fromJSON(r.inSR), s.fromJSON(r.outSR));\n      return {\n        obb: r.obb,\n        points: p,\n        rgb: _c,\n        attributes: f,\n        pointIdFilterMap: o\n      };\n    }\n  }, {\n    key: \"_transformCoordinates\",\n    value: function _transformCoordinates(t, r, a, s, u) {\n      if (!n(t, s, 0, t, u, 0, r)) throw new Error(\"Can't reproject\");\n      var l = f(a.center[0], a.center[1], a.center[2]),\n        b = i(),\n        m = i();\n      e(p, a.quaternion);\n      var _c2 = new Float32Array(3 * r);\n      for (var _e = 0; _e < r; _e++) b[0] = t[3 * _e] - l[0], b[1] = t[3 * _e + 1] - l[1], b[2] = t[3 * _e + 2] - l[2], o(m, b, p), a.halfSize[0] = Math.max(a.halfSize[0], Math.abs(m[0])), a.halfSize[1] = Math.max(a.halfSize[1], Math.abs(m[1])), a.halfSize[2] = Math.max(a.halfSize[2], Math.abs(m[2])), _c2[3 * _e] = b[0], _c2[3 * _e + 1] = b[1], _c2[3 * _e + 2] = b[2];\n      return _c2;\n    }\n  }, {\n    key: \"_applyElevationOffsetInPlace\",\n    value: function _applyElevationOffsetInPlace(t, r, e) {\n      if (0 !== e) for (var _a = 0; _a < r; _a++) t[3 * _a + 2] += e;\n    }\n  }]);\n  return c;\n}();\nvar p = a();\nfunction h() {\n  return new c();\n}\nexport { h as default };","map":{"version":3,"names":["isSome","t","isArrayBuffer","r","c","e","a","q","o","f","i","projectBuffer","n","s","readGeometry","u","getAttributeValues","l","evaluateRenderer","b","filterInPlace","m","_classCallCheck","_createClass","key","value","transform","_transform","points","buffer","rgb","pointIdFilterMap","push","_iterator","_createForOfIteratorHelper","attributes","_step","done","values","err","Promise","resolve","result","transferList","schema","geometryBuffer","length","primaryAttributeData","attributeInfo","modulationAttributeData","rendererInfo","filterInfo","filterAttributesData","filter","map","Uint32Array","_iterator2","userAttributesData","_step2","Uint8Array","slice","_applyElevationOffsetInPlace","elevationOffset","p","_transformCoordinates","obb","fromJSON","inSR","outSR","Error","center","quaternion","Float32Array","halfSize","Math","max","abs","h","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/PointCloudWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../core/maybe.js\";import{isArrayBuffer as r}from\"../../../core/typedArrayUtil.js\";import{c as e}from\"../../../chunks/quat.js\";import{c as a}from\"../../../chunks/quatf32.js\";import{q as o}from\"../../../chunks/vec3.js\";import{f,c as i}from\"../../../chunks/vec3f32.js\";import{projectBuffer as n}from\"../../../geometry/projection.js\";import s from\"../../../geometry/SpatialReference.js\";import{readGeometry as u,getAttributeValues as l,evaluateRenderer as b,filterInPlace as m}from\"./i3s/PointCloudWorkerUtil.js\";class c{transform(e){const a=this._transform(e),o=[a.points.buffer,a.rgb.buffer];t(a.pointIdFilterMap)&&o.push(a.pointIdFilterMap.buffer);for(const t of a.attributes)\"buffer\"in t.values&&r(t.values.buffer)&&t.values.buffer!==a.rgb.buffer&&o.push(t.values.buffer);return Promise.resolve({result:a,transferList:o})}_transform(r){const e=u(r.schema,r.geometryBuffer);let a=e.length/3,o=null;const f=[],i=l(r.primaryAttributeData,e,a);t(r.primaryAttributeData)&&i&&f.push({attributeInfo:r.primaryAttributeData.attributeInfo,values:i});const n=l(r.modulationAttributeData,e,a);t(r.modulationAttributeData)&&n&&f.push({attributeInfo:r.modulationAttributeData.attributeInfo,values:n});let c=b(r.rendererInfo,i,n,a);if(r.filterInfo&&r.filterInfo.length>0&&t(r.filterAttributesData)){const i=r.filterAttributesData.filter(t).map((t=>{const r=l(t,e,a),o={attributeInfo:t.attributeInfo,values:r};return f.push(o),o}));o=new Uint32Array(a),a=m(e,c,o,r.filterInfo,i)}for(const t of r.userAttributesData){const r=l(t,e,a);f.push({attributeInfo:t.attributeInfo,values:r})}3*a<c.length&&(c=new Uint8Array(c.buffer.slice(0,3*a))),this._applyElevationOffsetInPlace(e,a,r.elevationOffset);const p=this._transformCoordinates(e,a,r.obb,s.fromJSON(r.inSR),s.fromJSON(r.outSR));return{obb:r.obb,points:p,rgb:c,attributes:f,pointIdFilterMap:o}}_transformCoordinates(t,r,a,s,u){if(!n(t,s,0,t,u,0,r))throw new Error(\"Can't reproject\");const l=f(a.center[0],a.center[1],a.center[2]),b=i(),m=i();e(p,a.quaternion);const c=new Float32Array(3*r);for(let e=0;e<r;e++)b[0]=t[3*e]-l[0],b[1]=t[3*e+1]-l[1],b[2]=t[3*e+2]-l[2],o(m,b,p),a.halfSize[0]=Math.max(a.halfSize[0],Math.abs(m[0])),a.halfSize[1]=Math.max(a.halfSize[1],Math.abs(m[1])),a.halfSize[2]=Math.max(a.halfSize[2],Math.abs(m[2])),c[3*e]=b[0],c[3*e+1]=b[1],c[3*e+2]=b[2];return c}_applyElevationOffsetInPlace(t,r,e){if(0!==e)for(let a=0;a<r;a++)t[3*a+2]+=e}}const p=a();function h(){return new c}export{h as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}