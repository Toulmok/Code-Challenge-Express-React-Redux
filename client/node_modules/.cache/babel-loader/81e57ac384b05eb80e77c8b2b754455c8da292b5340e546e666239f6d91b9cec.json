{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport \"../../../../geometry.js\";\nimport t from \"../../../../request.js\";\nimport r from \"../../../../core/Error.js\";\nimport s from \"../../../../core/Logger.js\";\nimport { isSome as o, isNone as i, unwrapOr as n, get as a } from \"../../../../core/maybe.js\";\nimport { createResolver as c } from \"../../../../core/promiseUtils.js\";\nimport { addQueryParameters as u } from \"../../../../core/urlUtils.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport \"../../../../core/has.js\";\nimport { subclass as d } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { WebSocketConnection as l } from \"./WebSocketConnection.js\";\nimport { executeQuery as f } from \"../../../../rest/query/operations/query.js\";\nimport h from \"../../../../rest/support/Query.js\";\nimport { fromJSON as g } from \"../../../../geometry/support/jsonUtils.js\";\nimport y from \"../../../../geometry/SpatialReference.js\";\nconst m = 1e4,\n  p = {\n    maxQueryDepth: 5,\n    maxRecordCountFactor: 3\n  };\nlet _ = class extends l {\n  constructor(e) {\n    super({\n      ...p,\n      ...e\n    }), this._buddyServicesQuery = null, this._relatedFeatures = null;\n  }\n  async _open() {\n    const e = await this._fetchServiceDefinition(this._config.source);\n    e.timeInfo.trackIdField || s.getLogger(this.declaredClass).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");\n    const t = this._fetchWebSocketUrl(e.streamUrls, this._config.spatialReference);\n    this._buddyServicesQuery || (this._buddyServicesQuery = this._queryBuddyServices()), await this._buddyServicesQuery, await this._tryCreateWebSocket(t);\n    const {\n      filter: r,\n      outFields: o\n    } = this._config;\n    this.destroyed || this._setFilter(r, o);\n  }\n  _onMessage(e) {\n    if (\"attributes\" in e) {\n      let i;\n      try {\n        i = this._enrich(e), o(this._featureZScaler) && this._featureZScaler(i.geometry);\n      } catch (t) {\n        return void s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Failed to parse message\", t));\n      }\n      this.onFeature(i);\n    } else this.onMessage(e);\n  }\n  async _fetchServiceDefinition(e) {\n    const r = {\n        f: \"json\",\n        ...this._config.customParameters\n      },\n      s = t(e.path, {\n        query: r,\n        responseType: \"json\"\n      }),\n      o = (await s).data;\n    return this._serviceDefinition = o, o;\n  }\n  _fetchWebSocketUrl(e, t) {\n    const r = e[0],\n      {\n        urls: s,\n        token: o\n      } = r,\n      i = this._inferWebSocketBaseUrl(s);\n    return u(`${i}/subscribe`, {\n      outSR: \"\" + t.wkid,\n      token: o\n    });\n  }\n  _inferWebSocketBaseUrl(e) {\n    if (1 === e.length) return e[0];\n    for (const t of e) if (t.includes(\"wss\")) return t;\n    return s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Unable to infer WebSocket url\", e)), null;\n  }\n  async _setFilter(e, t) {\n    const o = this._websocket;\n    if (i(o) || i(e) && i(t)) return;\n    const n = JSON.stringify({\n      filter: this._serializeFilter(e, t)\n    });\n    let a = !1;\n    const u = c(),\n      d = () => {\n        a || (this.destroyed || this._websocket !== o || s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Server timed out when setting filter\")), u.reject());\n      },\n      l = e => {\n        const t = JSON.parse(e.data);\n        t.filter && (t.error && (s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Failed to set service filter\", t.error)), this._set(\"errorString\", `Could not set service filter - ${t.error}`), u.reject(t.error)), this._setWebSocketJSONParseHandler(o), a = !0, u.resolve());\n      };\n    return o.onmessage = l, o.send(n), setTimeout(d, m), u.promise;\n  }\n  _serializeFilter(e, t) {\n    const n = {};\n    if (i(e) && i(t)) return n;\n    if (o(e) && e.geometry) try {\n      const t = g(e.geometry);\n      if (\"extent\" !== t.type) throw new r(`Expected extent but found type ${t.type}`);\n      n.geometry = JSON.stringify(t.shiftCentralMeridian());\n    } catch (a) {\n      s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Encountered an error when setting connection geometryDefinition\", a));\n    }\n    return o(e) && e.where && \"1 = 1\" !== e.where && \"1=1\" !== e.where && (n.where = e.where), o(t) && (n.outFields = t.join(\",\")), n;\n  }\n  _enrich(e) {\n    if (!this._relatedFeatures) return e;\n    const t = this._serviceDefinition.relatedFeatures.joinField,\n      o = e.attributes[t],\n      i = this._relatedFeatures.get(o);\n    if (!i) return s.getLogger(this.declaredClass).warn(\"geoevent-connection\", \"Feature join failed. Is the join field configured correctly?\", e), e;\n    const {\n      attributes: n,\n      geometry: a\n    } = i;\n    for (const r in n) e.attributes[r] = n[r];\n    return a && (e.geometry = a), e.geometry || e.centroid || s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Found malformed feature - no geometry found\", e)), e;\n  }\n  async _queryBuddyServices() {\n    try {\n      const {\n          relatedFeatures: e,\n          keepLatestArchive: t\n        } = this._serviceDefinition,\n        r = this._queryRelatedFeatures(e),\n        s = this._queryArchive(t);\n      await r;\n      const o = await s;\n      if (!o) return;\n      for (const i of o.features) this.onFeature(this._enrich(i));\n    } catch (e) {\n      s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\", \"Encountered an error when querying buddy services\", {\n        error: e\n      }));\n    }\n  }\n  async _queryRelatedFeatures(e) {\n    if (!e) return;\n    const t = await this._queryBuddy(e.featuresUrl);\n    this._addRelatedFeatures(t);\n  }\n  async _queryArchive(e) {\n    if (e) return this._queryBuddy(e.featuresUrl);\n  }\n  async _queryBuddy(e) {\n    const t = new (await import(\"../../../FeatureLayer.js\")).default({\n        url: e\n      }),\n      {\n        capabilities: r\n      } = await t.load(),\n      s = r.query.supportsMaxRecordCountFactor,\n      o = r.query.supportsPagination,\n      i = r.query.supportsCentroid,\n      c = this._config.maxRecordCountFactor,\n      u = t.capabilities.query.maxRecordCount,\n      d = s ? u * c : u,\n      l = new h();\n    if (l.outFields = n(this._config.outFields, [\"*\"]), l.where = n(a(this._config.filter, \"where\"), \"1=1\"), l.returnGeometry = !0, l.returnExceededLimitFeatures = !0, l.outSpatialReference = y.fromJSON(this._config.spatialReference), i && (l.returnCentroid = !0), s && (l.maxRecordCountFactor = c), o) return l.num = d, t.destroy(), this._queryPages(e, l);\n    const g = await f(e, l, this._config.sourceSpatialReference);\n    return t.destroy(), g.data;\n  }\n  async _queryPages(e, t) {\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    let s = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    t.start = o(t.num) ? s * t.num : null;\n    const {\n      data: i\n    } = await f(e, t, this._config.sourceSpatialReference);\n    return i.exceededTransferLimit && s < (this._config.maxQueryDepth ?? 0) ? (i.features.forEach(e => r.push(e)), this._queryPages(e, t, r, s + 1)) : (r.forEach(e => i.features.push(e)), i);\n  }\n  _addRelatedFeatures(e) {\n    const t = new Map(),\n      r = e.features,\n      s = this._serviceDefinition.relatedFeatures.joinField;\n    for (const o of r) {\n      const e = o.attributes[s];\n      t.set(e, o);\n    }\n    this._relatedFeatures = t;\n  }\n};\n_ = e([d(\"esri.layers.graphics.sources.connections.GeoEventConnection\")], _);\nconst w = _;\nexport { w as default };","map":{"version":3,"names":["_","e","t","r","s","isSome","o","isNone","i","unwrapOr","n","get","a","createResolver","c","addQueryParameters","u","subclass","d","WebSocketConnection","l","executeQuery","f","h","fromJSON","g","y","m","p","maxQueryDepth","maxRecordCountFactor","constructor","_buddyServicesQuery","_relatedFeatures","_open","_fetchServiceDefinition","_config","source","timeInfo","trackIdField","getLogger","declaredClass","warn","_fetchWebSocketUrl","streamUrls","spatialReference","_queryBuddyServices","_tryCreateWebSocket","filter","outFields","destroyed","_setFilter","_onMessage","_enrich","_featureZScaler","geometry","error","onFeature","onMessage","customParameters","path","query","responseType","data","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","outSR","wkid","length","includes","_websocket","JSON","stringify","_serializeFilter","reject","parse","_set","_setWebSocketJSONParseHandler","resolve","onmessage","send","setTimeout","promise","type","shiftCentralMeridian","where","join","relatedFeatures","joinField","attributes","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","features","_queryBuddy","featuresUrl","_addRelatedFeatures","default","url","capabilities","load","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","returnGeometry","returnExceededLimitFeatures","outSpatialReference","returnCentroid","num","destroy","_queryPages","sourceSpatialReference","arguments","undefined","start","exceededTransferLimit","forEach","push","Map","set","w"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import\"../../../../geometry.js\";import t from\"../../../../request.js\";import r from\"../../../../core/Error.js\";import s from\"../../../../core/Logger.js\";import{isSome as o,isNone as i,unwrapOr as n,get as a}from\"../../../../core/maybe.js\";import{createResolver as c}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as u}from\"../../../../core/urlUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/has.js\";import{subclass as d}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{WebSocketConnection as l}from\"./WebSocketConnection.js\";import{executeQuery as f}from\"../../../../rest/query/operations/query.js\";import h from\"../../../../rest/support/Query.js\";import{fromJSON as g}from\"../../../../geometry/support/jsonUtils.js\";import y from\"../../../../geometry/SpatialReference.js\";const m=1e4,p={maxQueryDepth:5,maxRecordCountFactor:3};let _=class extends l{constructor(e){super({...p,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||s.getLogger(this.declaredClass).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){if(\"attributes\"in e){let i;try{i=this._enrich(e),o(this._featureZScaler)&&this._featureZScaler(i.geometry)}catch(t){return void s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Failed to parse message\",t))}this.onFeature(i)}else this.onMessage(e)}async _fetchServiceDefinition(e){const r={f:\"json\",...this._config.customParameters},s=t(e.path,{query:r,responseType:\"json\"}),o=(await s).data;return this._serviceDefinition=o,o}_fetchWebSocketUrl(e,t){const r=e[0],{urls:s,token:o}=r,i=this._inferWebSocketBaseUrl(s);return u(`${i}/subscribe`,{outSR:\"\"+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const o=this._websocket;if(i(o)||i(e)&&i(t))return;const n=JSON.stringify({filter:this._serializeFilter(e,t)});let a=!1;const u=c(),d=()=>{a||(this.destroyed||this._websocket!==o||s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Server timed out when setting filter\")),u.reject())},l=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Failed to set service filter\",t.error)),this._set(\"errorString\",`Could not set service filter - ${t.error}`),u.reject(t.error)),this._setWebSocketJSONParseHandler(o),a=!0,u.resolve())};return o.onmessage=l,o.send(n),setTimeout(d,m),u.promise}_serializeFilter(e,t){const n={};if(i(e)&&i(t))return n;if(o(e)&&e.geometry)try{const t=g(e.geometry);if(\"extent\"!==t.type)throw new r(`Expected extent but found type ${t.type}`);n.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(a){s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",a))}return o(e)&&e.where&&\"1 = 1\"!==e.where&&\"1=1\"!==e.where&&(n.where=e.where),o(t)&&(n.outFields=t.join(\",\")),n}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t],i=this._relatedFeatures.get(o);if(!i)return s.getLogger(this.declaredClass).warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:n,geometry:a}=i;for(const r in n)e.attributes[r]=n[r];return a&&(e.geometry=a),e.geometry||e.centroid||s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),s=this._queryArchive(t);await r;const o=await s;if(!o)return;for(const i of o.features)this.onFeature(this._enrich(i))}catch(e){s.getLogger(this.declaredClass).error(new r(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await import(\"../../../FeatureLayer.js\")).default)({url:e}),{capabilities:r}=await t.load(),s=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,i=r.query.supportsCentroid,c=this._config.maxRecordCountFactor,u=t.capabilities.query.maxRecordCount,d=s?u*c:u,l=new h;if(l.outFields=n(this._config.outFields,[\"*\"]),l.where=n(a(this._config.filter,\"where\"),\"1=1\"),l.returnGeometry=!0,l.returnExceededLimitFeatures=!0,l.outSpatialReference=y.fromJSON(this._config.spatialReference),i&&(l.returnCentroid=!0),s&&(l.maxRecordCountFactor=c),o)return l.num=d,t.destroy(),this._queryPages(e,l);const g=await f(e,l,this._config.sourceSpatialReference);return t.destroy(),g.data}async _queryPages(e,t,r=[],s=0){t.start=o(t.num)?s*t.num:null;const{data:i}=await f(e,t,this._config.sourceSpatialReference);return i.exceededTransferLimit&&s<(this._config.maxQueryDepth??0)?(i.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,s+1)):(r.forEach((e=>i.features.push(e))),i)}_addRelatedFeatures(e){const t=new Map,r=e.features,s=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const e=o.attributes[s];t.set(e,o)}this._relatedFeatures=t}};_=e([d(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],_);const w=_;export{w as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}