{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as s } from \"../../../../../core/maybe.js\";\nimport t from \"../../../../../core/PooledArray.js\";\nimport { BufferRange as e } from \"./BufferRange.js\";\nimport { DrawCommand as n } from \"./DrawCommand.js\";\nclass i {\n  constructor() {\n    this._numElements = 0, this._instances = new Map(), this.holes = new t({\n      allocator: s => s || new e(),\n      deallocator: null\n    }), this.hasHiddenInstances = !1, this.hasHighlights = !1, this.hasOccludees = !1, this.drawCommandsDirty = !0, this.drawCommandsDefault = h(), this.drawCommandsHighlight = h(), this.drawCommandsOccludees = h(), this.drawCommandsShadowHighlightRest = h();\n  }\n  get numElements() {\n    return this._numElements;\n  }\n  get instances() {\n    return this._instances;\n  }\n  addInstance(s, t) {\n    this.deleteInstance(s), this._instances.set(s, t), this._numElements += t.numElements;\n  }\n  deleteInstance(s) {\n    const t = this._instances.get(s);\n    t && (this._numElements -= t.numElements, this._instances.delete(s));\n  }\n  updateInstance(s, t, e) {\n    const n = this._instances.get(s);\n    n && (this._numElements -= n.numElements, n.from = t, n.to = e, this._numElements += n.numElements);\n  }\n  updateDrawState(s) {\n    s.isVisible ? (s.hasHighlights && (this.hasHighlights = !0), s.hasOccludees && (this.hasOccludees = !0)) : this.hasHiddenInstances = !0;\n  }\n  updateDrawCommands(t) {\n    if (this.drawCommandsDefault.clear(), this.drawCommandsHighlight.clear(), this.drawCommandsOccludees.clear(), this.drawCommandsShadowHighlightRest.clear(), this.drawCommandsDirty = !1, 0 === this._instances.size) return;\n    if (!this.needsMultipleCommands()) {\n      const e = this.drawCommandsDefault.pushNew(),\n        n = this.holes.front();\n      return s(this.vao) && 1 === this.holes.length && n.to === Math.floor(this.vao.size / t) ? (e.first = 0, void (e.count = n.from)) : (e.first = 1 / 0, e.count = 0, this._instances.forEach(s => {\n        e.first = Math.min(e.first, s.from), e.count = Math.max(e.count, s.to);\n      }), void (e.count -= e.first));\n    }\n    const e = Array.from(this._instances.values()).sort((s, t) => s.from === t.from ? s.to - t.to : s.from - t.from);\n    for (const s of e) s.isVisible && (r(s.hasOccludees ? this.drawCommandsOccludees : this.drawCommandsDefault, s), r(s.hasHighlights ? this.drawCommandsHighlight : this.drawCommandsShadowHighlightRest, s));\n  }\n  needsMultipleCommands() {\n    return this.hasOccludees || this.hasHighlights || this.hasHiddenInstances;\n  }\n}\nclass a extends i {}\nfunction o(t) {\n  return s(t.vao);\n}\nfunction h() {\n  return new t({\n    allocator: s => s || new n(),\n    deallocator: s => s\n  });\n}\nfunction r(s, t) {\n  const e = s.back();\n  if (null == e) {\n    const e = s.pushNew();\n    return e.first = t.from, void (e.count = t.numElements);\n  }\n  if (m(e, t)) {\n    const s = t.from - e.first + t.numElements;\n    e.count = s;\n  } else {\n    const e = s.pushNew();\n    e.first = t.from, e.count = t.numElements;\n  }\n}\nfunction m(s, t) {\n  return s.first + s.count >= t.from;\n}\nexport { i as PerBufferData, a as PerVaoData, o as hasVao };","map":{"version":3,"names":["isSome","s","t","BufferRange","e","DrawCommand","n","i","constructor","_numElements","_instances","Map","holes","allocator","deallocator","hasHiddenInstances","hasHighlights","hasOccludees","drawCommandsDirty","drawCommandsDefault","h","drawCommandsHighlight","drawCommandsOccludees","drawCommandsShadowHighlightRest","numElements","instances","addInstance","deleteInstance","set","get","delete","updateInstance","from","to","updateDrawState","isVisible","updateDrawCommands","clear","size","needsMultipleCommands","pushNew","front","vao","length","Math","floor","first","count","forEach","min","max","Array","values","sort","r","a","o","back","m","PerBufferData","PerVaoData","hasVao"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/PerBufferData.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as s}from\"../../../../../core/maybe.js\";import t from\"../../../../../core/PooledArray.js\";import{BufferRange as e}from\"./BufferRange.js\";import{DrawCommand as n}from\"./DrawCommand.js\";class i{constructor(){this._numElements=0,this._instances=new Map,this.holes=new t({allocator:s=>s||new e,deallocator:null}),this.hasHiddenInstances=!1,this.hasHighlights=!1,this.hasOccludees=!1,this.drawCommandsDirty=!0,this.drawCommandsDefault=h(),this.drawCommandsHighlight=h(),this.drawCommandsOccludees=h(),this.drawCommandsShadowHighlightRest=h()}get numElements(){return this._numElements}get instances(){return this._instances}addInstance(s,t){this.deleteInstance(s),this._instances.set(s,t),this._numElements+=t.numElements}deleteInstance(s){const t=this._instances.get(s);t&&(this._numElements-=t.numElements,this._instances.delete(s))}updateInstance(s,t,e){const n=this._instances.get(s);n&&(this._numElements-=n.numElements,n.from=t,n.to=e,this._numElements+=n.numElements)}updateDrawState(s){s.isVisible?(s.hasHighlights&&(this.hasHighlights=!0),s.hasOccludees&&(this.hasOccludees=!0)):this.hasHiddenInstances=!0}updateDrawCommands(t){if(this.drawCommandsDefault.clear(),this.drawCommandsHighlight.clear(),this.drawCommandsOccludees.clear(),this.drawCommandsShadowHighlightRest.clear(),this.drawCommandsDirty=!1,0===this._instances.size)return;if(!this.needsMultipleCommands()){const e=this.drawCommandsDefault.pushNew(),n=this.holes.front();return s(this.vao)&&1===this.holes.length&&n.to===Math.floor(this.vao.size/t)?(e.first=0,void(e.count=n.from)):(e.first=1/0,e.count=0,this._instances.forEach((s=>{e.first=Math.min(e.first,s.from),e.count=Math.max(e.count,s.to)})),void(e.count-=e.first))}const e=Array.from(this._instances.values()).sort(((s,t)=>s.from===t.from?s.to-t.to:s.from-t.from));for(const s of e)s.isVisible&&(r(s.hasOccludees?this.drawCommandsOccludees:this.drawCommandsDefault,s),r(s.hasHighlights?this.drawCommandsHighlight:this.drawCommandsShadowHighlightRest,s))}needsMultipleCommands(){return this.hasOccludees||this.hasHighlights||this.hasHiddenInstances}}class a extends i{}function o(t){return s(t.vao)}function h(){return new t({allocator:s=>s||new n,deallocator:s=>s})}function r(s,t){const e=s.back();if(null==e){const e=s.pushNew();return e.first=t.from,void(e.count=t.numElements)}if(m(e,t)){const s=t.from-e.first+t.numElements;e.count=s}else{const e=s.pushNew();e.first=t.from,e.count=t.numElements}}function m(s,t){return s.first+s.count>=t.from}export{i as PerBufferData,a as PerVaoData,o as hasVao};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}