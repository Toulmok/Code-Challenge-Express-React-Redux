{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { create as e, contains as t, intersects as s } from \"../../../../geometry/support/aaBoundingBox.js\";\nimport { transformObb as n } from \"./I3SUtil.js\";\nimport { set as i, toAaBoundingBox as r, intersectPlane as o, ObbArray as p } from \"../../support/orientedBoundingBox.js\";\nclass h {\n  constructor(e, t, s) {\n    this._pages = [], this.pageSize = 0, this._nodeSR = null, this._renderSR = null, this._nodeSR = e, this._renderSR = t, this.pageSize = s;\n  }\n  addPage(e, t) {\n    let s = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    for (; this._pages.length < e;) this._pages.push(null);\n    const n = g(t, this._nodeSR, this._renderSR, s);\n    this._pages[e] = {\n      nodes: t,\n      renderObbs: n,\n      parents: new Uint32Array(this.pageSize)\n    }, u(this._pages, this.pageSize);\n  }\n  hasPage(e) {\n    return !!this._pages[e];\n  }\n  getNode(e) {\n    const t = this.pageSize;\n    return this._pages[l(e, t)].nodes[c(e, t)];\n  }\n  getRenderObb(e) {\n    const t = this.pageSize;\n    return this._pages[l(e, t)].renderObbs[c(e, t)];\n  }\n  getRenderCenter(e) {\n    return this.getRenderObb(e).center;\n  }\n  setRenderObb(e, t) {\n    const s = this.pageSize;\n    i(t, this._pages[l(e, s)].renderObbs[c(e, s)]);\n  }\n  getParentId(e) {\n    const t = this.pageSize;\n    return this._pages[l(e, t)].parents[c(e, t)];\n  }\n  hasNodes(e, t) {\n    const s = l(e, this.pageSize),\n      n = l(e + t - 1, this.pageSize);\n    for (let i = s; i <= n; i++) if (null == this._pages[i]) return !1;\n    return !0;\n  }\n  forEachNodeId(e) {\n    for (let t = 0; t < this._pages.length; t++) {\n      const s = this._pages[t];\n      if (s) for (let n = 0; n < s.nodes.length; n++) e(t * this.pageSize + n);\n    }\n  }\n  createVisibilityTraverse() {\n    const t = {\n      index: this,\n      queue: [],\n      masks: [],\n      tempAabb: e()\n    };\n    return (e, s) => a(t, e, s);\n  }\n}\nfunction a(e, n, i) {\n  const p = e.index;\n  if (!p.hasNodes(0, 1)) return;\n  const h = e.queue;\n  h.length = 0, h.push(0);\n  const a = e.masks;\n  for (a.length = 0, a.push(0); h.length > 0;) {\n    const g = h.pop();\n    let u = a.pop();\n    const c = p.getNode(g),\n      d = p.getRenderObb(g);\n    let f = !0;\n    if (null != n.clippingBox) {\n      const i = 1 << n.frustum.length;\n      if (0 == (u & i)) {\n        const o = r(d, e.tempAabb);\n        t(n.clippingBox, o) ? u |= i : s(n.clippingBox, o) || (f = !1);\n      }\n    }\n    for (let e = 0; e < n.frustum.length && f; e++) {\n      const t = 1 << e;\n      if (0 == (u & t)) {\n        const s = o(d, n.frustum[e]);\n        s > 0 ? f = !1 : s < 0 && (u |= t);\n      }\n    }\n    if (i.predicate(g, c, f)) {\n      const e = c.firstChild,\n        t = c.childCount;\n      let s = !1;\n      const n = l(e, p.pageSize),\n        r = l(e + t - 1, p.pageSize);\n      for (let o = n; o <= r; o++) if (!p.hasPage(o)) {\n        i.pageMiss(g, o), s = !0;\n        break;\n      }\n      if (!s) for (let i = 0; i < t; i++) h.push(e + i), a.push(u);\n    }\n  }\n}\nfunction g(e, t, s, i) {\n  const r = new p(e.length);\n  for (let o = 0; o < e.length; o++) n(e[o].obb, t, r.obbs[o], s, i);\n  return r.obbs;\n}\nfunction u(e, t) {\n  const s = [0];\n  for (; s.length;) {\n    const n = s.pop(),\n      i = e[l(n, t)].nodes[c(n, t)];\n    for (let r = 0; r < i.childCount; r++) {\n      const o = i.firstChild + r;\n      null != e[l(o, t)] && (e[l(o, t)].parents[c(o, t)] = n, s.push(o));\n    }\n  }\n}\nfunction l(e, t) {\n  return e / t | 0;\n}\nfunction c(e, t) {\n  return e % t;\n}\nexport { h as default };","map":{"version":3,"names":["create","e","contains","t","intersects","s","transformObb","n","set","i","toAaBoundingBox","r","intersectPlane","o","ObbArray","p","h","constructor","_pages","pageSize","_nodeSR","_renderSR","addPage","arguments","length","undefined","push","g","nodes","renderObbs","parents","Uint32Array","u","hasPage","getNode","l","c","getRenderObb","getRenderCenter","center","setRenderObb","getParentId","hasNodes","forEachNodeId","createVisibilityTraverse","index","queue","masks","tempAabb","a","pop","d","f","clippingBox","frustum","predicate","firstChild","childCount","pageMiss","obb","obbs","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/i3s/PagedNodeIndex.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{create as e,contains as t,intersects as s}from\"../../../../geometry/support/aaBoundingBox.js\";import{transformObb as n}from\"./I3SUtil.js\";import{set as i,toAaBoundingBox as r,intersectPlane as o,ObbArray as p}from\"../../support/orientedBoundingBox.js\";class h{constructor(e,t,s){this._pages=[],this.pageSize=0,this._nodeSR=null,this._renderSR=null,this._nodeSR=e,this._renderSR=t,this.pageSize=s}addPage(e,t,s=0){for(;this._pages.length<e;)this._pages.push(null);const n=g(t,this._nodeSR,this._renderSR,s);this._pages[e]={nodes:t,renderObbs:n,parents:new Uint32Array(this.pageSize)},u(this._pages,this.pageSize)}hasPage(e){return!!this._pages[e]}getNode(e){const t=this.pageSize;return this._pages[l(e,t)].nodes[c(e,t)]}getRenderObb(e){const t=this.pageSize;return this._pages[l(e,t)].renderObbs[c(e,t)]}getRenderCenter(e){return this.getRenderObb(e).center}setRenderObb(e,t){const s=this.pageSize;i(t,this._pages[l(e,s)].renderObbs[c(e,s)])}getParentId(e){const t=this.pageSize;return this._pages[l(e,t)].parents[c(e,t)]}hasNodes(e,t){const s=l(e,this.pageSize),n=l(e+t-1,this.pageSize);for(let i=s;i<=n;i++)if(null==this._pages[i])return!1;return!0}forEachNodeId(e){for(let t=0;t<this._pages.length;t++){const s=this._pages[t];if(s)for(let n=0;n<s.nodes.length;n++)e(t*this.pageSize+n)}}createVisibilityTraverse(){const t={index:this,queue:[],masks:[],tempAabb:e()};return(e,s)=>a(t,e,s)}}function a(e,n,i){const p=e.index;if(!p.hasNodes(0,1))return;const h=e.queue;h.length=0,h.push(0);const a=e.masks;for(a.length=0,a.push(0);h.length>0;){const g=h.pop();let u=a.pop();const c=p.getNode(g),d=p.getRenderObb(g);let f=!0;if(null!=n.clippingBox){const i=1<<n.frustum.length;if(0==(u&i)){const o=r(d,e.tempAabb);t(n.clippingBox,o)?u|=i:s(n.clippingBox,o)||(f=!1)}}for(let e=0;e<n.frustum.length&&f;e++){const t=1<<e;if(0==(u&t)){const s=o(d,n.frustum[e]);s>0?f=!1:s<0&&(u|=t)}}if(i.predicate(g,c,f)){const e=c.firstChild,t=c.childCount;let s=!1;const n=l(e,p.pageSize),r=l(e+t-1,p.pageSize);for(let o=n;o<=r;o++)if(!p.hasPage(o)){i.pageMiss(g,o),s=!0;break}if(!s)for(let i=0;i<t;i++)h.push(e+i),a.push(u)}}}function g(e,t,s,i){const r=new p(e.length);for(let o=0;o<e.length;o++)n(e[o].obb,t,r.obbs[o],s,i);return r.obbs}function u(e,t){const s=[0];for(;s.length;){const n=s.pop(),i=e[l(n,t)].nodes[c(n,t)];for(let r=0;r<i.childCount;r++){const o=i.firstChild+r;null!=e[l(o,t)]&&(e[l(o,t)].parents[c(o,t)]=n,s.push(o))}}}function l(e,t){return e/t|0}function c(e,t){return e%t}export{h as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}