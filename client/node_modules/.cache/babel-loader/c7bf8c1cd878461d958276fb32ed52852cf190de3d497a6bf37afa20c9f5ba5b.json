{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as e, unwrapOr as r } from \"../../core/maybe.js\";\nimport { sqlAnd as t } from \"../../core/sql.js\";\nimport { getJsonType as i } from \"../../geometry/support/jsonUtils.js\";\nimport { getScale as n } from \"../../geometry/support/scaleUtils.js\";\nimport { getLayerFloorFilterClause as s } from \"../../layers/support/floorFilterUtils.js\";\nimport { isExportDynamic as o } from \"../../layers/support/sublayerUtils.js\";\nconst l = e => e.spatialReference.wkid || JSON.stringify(e.spatialReference);\nfunction a(r, t) {\n  const {\n      dpi: n,\n      gdbVersion: s,\n      geometry: o,\n      geometryPrecision: a,\n      height: p,\n      layerOption: m,\n      mapExtent: y,\n      maxAllowableOffset: c,\n      returnFieldName: u,\n      returnGeometry: d,\n      returnUnformattedValues: g,\n      returnZ: x,\n      spatialReference: b,\n      timeExtent: h,\n      tolerance: E,\n      width: O\n    } = r.toJSON(),\n    {\n      dynamicLayers: S,\n      layerDefs: j,\n      layerIds: N\n    } = f(r),\n    J = t && e(t.geometry) ? t.geometry : null,\n    R = {\n      geometryPrecision: a,\n      maxAllowableOffset: c,\n      returnFieldName: u,\n      returnGeometry: d,\n      returnUnformattedValues: g,\n      returnZ: x,\n      tolerance: E\n    },\n    $ = J && J.toJSON() || o;\n  if (R.imageDisplay = `${O},${p},${n}`, s && (R.gdbVersion = s), $ && (delete $.spatialReference, R.geometry = JSON.stringify($), R.geometryType = i($)), b ? R.sr = b.wkid || JSON.stringify(b) : $ && $.spatialReference ? R.sr = l($) : y && y.spatialReference && (R.sr = l(y)), R.time = h ? [h.start, h.end].join(\",\") : null, y) {\n    const {\n      xmin: e,\n      ymin: r,\n      xmax: t,\n      ymax: i\n    } = y;\n    R.mapExtent = `${e},${r},${t},${i}`;\n  }\n  return j && (R.layerDefs = j), S && !j && (R.dynamicLayers = S), R.layers = \"popup\" === m ? \"visible\" : m, N && !S && (R.layers += `:${N.join(\",\")}`), R;\n}\nfunction f(r) {\n  const {\n      mapExtent: t,\n      floors: i,\n      width: l,\n      sublayers: a,\n      layerIds: f,\n      layerOption: m,\n      gdbVersion: y\n    } = r,\n    c = a?.find(e => null != e.layer)?.layer?.serviceSublayers,\n    u = \"popup\" === m,\n    d = {},\n    g = n({\n      extent: t,\n      width: l,\n      spatialReference: t?.spatialReference\n    }),\n    x = [],\n    b = e => {\n      const r = 0 === g,\n        t = 0 === e.minScale || g <= e.minScale,\n        i = 0 === e.maxScale || g >= e.maxScale;\n      if (e.visible && (r || t && i)) if (e.sublayers) e.sublayers.forEach(b);else {\n        if (!1 === f?.includes(e.id) || u && (!e.popupTemplate || !e.popupEnabled)) return;\n        x.unshift(e);\n      }\n    };\n  if (a?.forEach(b), a && !x.length) d.layerIds = [];else {\n    const r = o(x, c, y),\n      t = x.map(e => {\n        const r = s(i, e);\n        return e.toExportImageJSON(r);\n      });\n    if (r) d.dynamicLayers = JSON.stringify(t);else {\n      if (a) {\n        let e = x.map(_ref => {\n          let {\n            id: e\n          } = _ref;\n          return e;\n        });\n        f && (e = e.filter(e => f.includes(e))), d.layerIds = e;\n      } else f?.length && (d.layerIds = f);\n      const r = p(i, x);\n      if (e(r) && r.length) {\n        const e = {};\n        for (const t of r) t.definitionExpression && (e[t.id] = t.definitionExpression);\n        Object.keys(e).length && (d.layerDefs = JSON.stringify(e));\n      }\n    }\n  }\n  return d;\n}\nfunction p(e, i) {\n  const n = !!e?.length,\n    o = i.filter(e => null != e.definitionExpression || n && null != e.floorInfo);\n  return o.length ? o.map(i => {\n    const n = s(e, i),\n      o = t(n, i.definitionExpression);\n    return {\n      id: i.id,\n      definitionExpression: r(o, void 0)\n    };\n  }) : null;\n}\nexport { a as identifyToIdentifyRESTParameters, f as toDynamicLayersJSON };","map":{"version":3,"names":["isSome","e","unwrapOr","r","sqlAnd","t","getJsonType","i","getScale","n","getLayerFloorFilterClause","s","isExportDynamic","o","l","spatialReference","wkid","JSON","stringify","a","dpi","gdbVersion","geometry","geometryPrecision","height","p","layerOption","m","mapExtent","y","maxAllowableOffset","c","returnFieldName","u","returnGeometry","d","returnUnformattedValues","g","returnZ","x","b","timeExtent","h","tolerance","E","width","O","toJSON","dynamicLayers","S","layerDefs","j","layerIds","N","f","J","R","$","imageDisplay","geometryType","sr","time","start","end","join","xmin","ymin","xmax","ymax","layers","floors","sublayers","find","layer","serviceSublayers","extent","minScale","maxScale","visible","forEach","includes","id","popupTemplate","popupEnabled","unshift","length","map","toExportImageJSON","_ref","filter","definitionExpression","Object","keys","floorInfo","identifyToIdentifyRESTParameters","toDynamicLayersJSON"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/rest/operations/identify.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e,unwrapOr as r}from\"../../core/maybe.js\";import{sqlAnd as t}from\"../../core/sql.js\";import{getJsonType as i}from\"../../geometry/support/jsonUtils.js\";import{getScale as n}from\"../../geometry/support/scaleUtils.js\";import{getLayerFloorFilterClause as s}from\"../../layers/support/floorFilterUtils.js\";import{isExportDynamic as o}from\"../../layers/support/sublayerUtils.js\";const l=e=>e.spatialReference.wkid||JSON.stringify(e.spatialReference);function a(r,t){const{dpi:n,gdbVersion:s,geometry:o,geometryPrecision:a,height:p,layerOption:m,mapExtent:y,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,spatialReference:b,timeExtent:h,tolerance:E,width:O}=r.toJSON(),{dynamicLayers:S,layerDefs:j,layerIds:N}=f(r),J=t&&e(t.geometry)?t.geometry:null,R={geometryPrecision:a,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,tolerance:E},$=J&&J.toJSON()||o;if(R.imageDisplay=`${O},${p},${n}`,s&&(R.gdbVersion=s),$&&(delete $.spatialReference,R.geometry=JSON.stringify($),R.geometryType=i($)),b?R.sr=b.wkid||JSON.stringify(b):$&&$.spatialReference?R.sr=l($):y&&y.spatialReference&&(R.sr=l(y)),R.time=h?[h.start,h.end].join(\",\"):null,y){const{xmin:e,ymin:r,xmax:t,ymax:i}=y;R.mapExtent=`${e},${r},${t},${i}`}return j&&(R.layerDefs=j),S&&!j&&(R.dynamicLayers=S),R.layers=\"popup\"===m?\"visible\":m,N&&!S&&(R.layers+=`:${N.join(\",\")}`),R}function f(r){const{mapExtent:t,floors:i,width:l,sublayers:a,layerIds:f,layerOption:m,gdbVersion:y}=r,c=a?.find((e=>null!=e.layer))?.layer?.serviceSublayers,u=\"popup\"===m,d={},g=n({extent:t,width:l,spatialReference:t?.spatialReference}),x=[],b=e=>{const r=0===g,t=0===e.minScale||g<=e.minScale,i=0===e.maxScale||g>=e.maxScale;if(e.visible&&(r||t&&i))if(e.sublayers)e.sublayers.forEach(b);else{if(!1===f?.includes(e.id)||u&&(!e.popupTemplate||!e.popupEnabled))return;x.unshift(e)}};if(a?.forEach(b),a&&!x.length)d.layerIds=[];else{const r=o(x,c,y),t=x.map((e=>{const r=s(i,e);return e.toExportImageJSON(r)}));if(r)d.dynamicLayers=JSON.stringify(t);else{if(a){let e=x.map((({id:e})=>e));f&&(e=e.filter((e=>f.includes(e)))),d.layerIds=e}else f?.length&&(d.layerIds=f);const r=p(i,x);if(e(r)&&r.length){const e={};for(const t of r)t.definitionExpression&&(e[t.id]=t.definitionExpression);Object.keys(e).length&&(d.layerDefs=JSON.stringify(e))}}}return d}function p(e,i){const n=!!e?.length,o=i.filter((e=>null!=e.definitionExpression||n&&null!=e.floorInfo));return o.length?o.map((i=>{const n=s(e,i),o=t(n,i.definitionExpression);return{id:i.id,definitionExpression:r(o,void 0)}})):null}export{a as identifyToIdentifyRESTParameters,f as toDynamicLayersJSON};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}