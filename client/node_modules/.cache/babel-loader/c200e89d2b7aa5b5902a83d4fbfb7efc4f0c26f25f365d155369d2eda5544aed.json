{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport { result as t, forEach as i } from \"../../../core/asyncUtils.js\";\nimport r from \"../../../core/Collection.js\";\nimport s from \"../../../core/Logger.js\";\nimport { unwrapOr as o, destroyMaybe as n, abortMaybe as a, isSome as d, isNone as l, mapSome as h } from \"../../../core/maybe.js\";\nimport { eachAlways as u, isAbortError as p, eachAlwaysValues as c, throwIfAborted as _ } from \"../../../core/promiseUtils.js\";\nimport { initial as m, watch as g, sync as f } from \"../../../core/reactiveUtils.js\";\nimport { pt2px as y } from \"../../../core/screenUtils.js\";\nimport { estimateSize as b, isArrayBuffer as w } from \"../../../core/typedArrayUtil.js\";\nimport { getMetersPerVerticalUnitForSR as N } from \"../../../core/unitUtils.js\";\nimport { property as P } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as x } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { e as v, c as C } from \"../../../chunks/vec3.js\";\nimport { b as S } from \"../../../chunks/vec3f32.js\";\nimport { projectBoundingRect as A } from \"../../../geometry/projection.js\";\nimport { create as I } from \"../../../geometry/support/aaBoundingBox.js\";\nimport { containsPoint as k, create as V } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { create as R, fromNormalAndOffset as L } from \"../../../geometry/support/plane.js\";\nimport { makeDehydratedPoint as j } from \"../../../layers/graphics/dehydratedFeatures.js\";\nimport { CodedValue as U } from \"../../../layers/support/CodedValue.js\";\nimport \"../../../core/has.js\";\nimport Q from \"../../../layers/support/CodedValueDomain.js\";\nimport \"../../../layers/support/Domain.js\";\nimport \"../../../layers/support/InheritedDomain.js\";\nimport \"../../../layers/support/RangeDomain.js\";\nimport { unpackFieldNames as D } from \"../../../layers/support/fieldUtils.js\";\nimport { PromiseQueue as F } from \"../../../layers/support/PromiseQueue.js\";\nimport { getMetersPerUnit as z } from \"../../../symbols/support/unitConversionUtils.js\";\nimport { LayerView3D as M } from \"./LayerView3D.js\";\nimport { PointCloudWorkerHandle as W } from \"./PointCloudWorkerHandle.js\";\nimport { checkPointCloudLayerValid as E, checkPointCloudLayerCompatibleWithView as O } from \"./i3s/I3SUtil.js\";\nimport { nodeDiff as B, sortFrontToBack as G, splitWorkEntries as H } from \"./i3s/LoDUtil.js\";\nimport q from \"./i3s/PagedNodeIndex.js\";\nimport { getSplatSizeAlgorithm as T, getFixedSizeAlgorithm as $, getRendererInfo as J, getFilterInfo as K, rendererUsesFixedSizes as X, getAttributeInfo as Y } from \"./i3s/PointCloudRendererUtil.js\";\nimport { getAttributeValues as Z, readGeometry as ee, elevationFromPositions as te } from \"./i3s/PointCloudWorkerUtil.js\";\nimport { PointGraphic as ie } from \"./i3s/PointGraphic.js\";\nimport { PointRenderer as re, isInstanceOfNode as se, PointRendererNode as oe } from \"./i3s/PointRenderer.js\";\nimport { PopupSceneLayerView as ne } from \"./support/PopupSceneLayerView.js\";\nimport { projectToBoundingBox as ae } from \"../support/extentUtils.js\";\nimport { ClientType as de } from \"../support/index.js\";\nimport { minimumDistancePlane as le } from \"../support/orientedBoundingBox.js\";\nimport { updatingProgress as he } from \"../support/updatingProperties.js\";\nimport { RenderSlot as ue } from \"../webgl-engine/lib/RenderSlot.js\";\nimport pe from \"../../layers/LayerView.js\";\nimport { isScaleRangeActive as ce, extractSafeScaleBounds as _e, scaleBoundsPredicate as me } from \"../../support/layerViewUtils.js\";\nimport { TaskPriority as ge } from \"../../support/Scheduler.js\";\nconst fe = 8,\n  ye = R();\nlet be = class extends ne(M(pe)) {\n  constructor() {\n    super(...arguments), this.type = \"point-cloud-3d\", this.maximumPointCount = 4e6, this.slicePlaneEnabled = !1, this._renderer = null, this._rendererAdded = !1, this._renderedNodes = new Set(), this._nodeScales = new Map(), this._updateViewNeeded = !0, this._lodFactor = 1, this._maxLoggedBoxWarnings = 5, this._pageMultiplier = 1, this._nodeLoadEpoch = 0, this._indexQueue = [], this._workQueue = new Array(), this._idleQueue = new F(), this._indexPagesLoading = new Map(), this._loadingNodes = new Map(), this._recalcWork = !0, this._layerIsVisible = !1, this._codedDomainPopulationPromise = null, this._codedDomainPopulationAbortController = null, this._totalWork = 0, this._index = null, this._loadingInitNodePage = !1, this._nodeIdArray = [];\n  }\n  get baseUrl() {\n    return this.layer.parsedUrl.path;\n  }\n  get pointScale() {\n    const e = T(this.layer && this.layer.renderer),\n      t = 1;\n    return e && null != e.scaleFactor ? e.scaleFactor : t;\n  }\n  get useRealWorldSymbolSizes() {\n    const e = $(this.layer && this.layer.renderer),\n      t = !1;\n    return e && null != e.useRealWorldSymbolSizes ? e.useRealWorldSymbolSizes : t;\n  }\n  get pointSize() {\n    const e = $(this.layer && this.layer.renderer),\n      t = 0;\n    return e && null != e.size ? e.size : t;\n  }\n  get inverseDensity() {\n    const e = 96;\n    return this.layer && this.layer.renderer ? 1 * e / this.layer.renderer.pointsPerInch : 5;\n  }\n  get availableFields() {\n    const e = J(this.layer),\n      t = new Set();\n    e.primaryAttribute && t.add(e.primaryAttribute.name), e.modulationAttribute && t.add(e.modulationAttribute.name);\n    const i = K(this.layer);\n    if (i) for (const r of i) r.attributeInfo && t.add(r.attributeInfo.name);\n    if (this.layer.outFields) for (const r of D(this.layer.fieldsIndex, this.layer.outFields)) t.add(r);\n    return Array.from(t);\n  }\n  get _clippingBox() {\n    if (!this.view || !this.view.clippingArea) return null;\n    const e = I(),\n      t = this.view.renderSpatialReference;\n    return ae(this.view.clippingArea, e, t) ? e : null;\n  }\n  get _elevationOffset() {\n    const e = this.layer && this.layer.elevationInfo;\n    if (e && \"absolute-height\" === e.mode) {\n      const t = N(this.layer.spatialReference),\n        i = z(e.unit);\n      return o(e.offset, 0) * i / t;\n    }\n    return 0;\n  }\n  initialize() {\n    const e = this.view.resourceController;\n    this._worker = new W(t => e.immediate.schedule(t)), this.addResolvingPromise(this._worker.promise), this._tmpPoint = j(0, 0, 0, this.layer.spatialReference), E(this.layer), O(this.layer, this.view), this._indexRequester = e.createStreamDataRequester(de.I3S_INDEX), this._dataRequester = e.createStreamDataRequester(de.I3S_DATA), this._initRenderer();\n    const t = this._initNodePages(),\n      i = this.view.resourceController.memoryController;\n    this._memCache = i.newCache(this.layer.uid), this.updatingHandles.add(() => this._clippingBox, () => this._setUpdateViewNeeded(), m), this.updatingHandles.add(() => this._elevationOffset, () => this._elevationOffsetChanged(), m), this.updatingHandles.add(() => this.layer.renderer, () => this._rendererChanged(), m), this.updatingHandles.add(() => this.layer.filters, () => this._reload(), m), this.updatingHandles.add(() => this.layer.outFields, () => this._reload(), m), this.updatingHandles.add(() => this.layer.effectiveScaleRange, () => this._setUpdateViewNeeded()), this.updatingHandles.add(() => this.view.state.contentCamera, () => this._setUpdateViewNeeded()), this.handles.add([this.view.basemapTerrain.on(\"scale-change\", e => this._scaleUpdateHandler(e)), g(() => i.memoryFactor, () => this._setUpdateViewNeeded(), f)]), this.addResolvingPromise(t), this.when(() => {\n      this.handles.add([e.scheduler.registerTask(ge.POINT_CLOUD_LAYER, this), e.scheduler.registerIdleStateCallbacks(() => this._idleBegin(), () => this._idleEnd()), this.updatingHandles.add(() => this.suspended, e => {\n        e ? this._clearNodeState() : this._setUpdateViewNeeded();\n      }, m)]);\n    }, () => {\n      this.updatingHandles.removeAll(), this.handles.removeAll();\n    });\n  }\n  _setUpdateViewNeeded() {\n    this._updateViewNeeded = !0, this._updateLoading();\n  }\n  destroy() {\n    this.cancelLoading(), this._worker = n(this._worker), this._destroyRenderer(), this._memCache = n(this._memCache), this._codedDomainPopulationAbortController = a(this._codedDomainPopulationAbortController), this._codedDomainPopulationPromise = null;\n  }\n  _initRenderer() {\n    this._renderer = new re({\n      createGraphic: (e, t, i) => this._createGraphic(e, t, i)\n    }), this._renderer.layerUid = this.layer.uid, this.updatingHandles.add(() => this._clippingBox, e => this._renderer.clippingBox = e, m), this.updatingHandles.add(() => this.suspended, e => this._setPointsVisible(!e), m), this.updatingHandles.add(() => this.pointScale, e => this._renderer.scaleFactor = e, m), this._renderer.minSizePx = Math.sqrt(2), this.updatingHandles.add(() => this.useRealWorldSymbolSizes, e => this._renderer.useRealWorldSymbolSizes = e, m), this.updatingHandles.add(() => this.pointSize, e => {\n      const t = y(e);\n      this._renderer.size = e, this._renderer.sizePx = t;\n    }, m), this.updatingHandles.add(() => this.slicePlaneEnabled, e => this._renderer.slicePlaneEnabled = e, m), this.updatingHandles.add(() => this.inverseDensity, () => this._setUpdateViewNeeded(), m), this.updatingHandles.add(() => this.maximumPointCount, () => this._setUpdateViewNeeded(), m), this.updatingHandles.add(() => this.view.qualitySettings.sceneService.pointCloud.lodFactor, e => {\n      this._lodFactor = e, this._setUpdateViewNeeded();\n    }, m);\n  }\n  _destroyRenderer() {\n    this._renderer.removeAll(), this._setPointsVisible(!1);\n  }\n  _createGraphic(e, t, i) {\n    const r = d(e.pointIdFilterMap) ? e.pointIdFilterMap[t] : t,\n      s = this.view.computeMapPointFromVec3d(i),\n      o = this._createGraphicAttributes(e, r);\n    return new ie({\n      pointCloudMetadata: {\n        nodeId: e.id,\n        pointIndexInNode: t,\n        attributePointIndexInNode: r,\n        epoch: this._nodeLoadEpoch\n      },\n      geometry: s,\n      attributes: o,\n      layer: this.layer,\n      sourceLayer: this.layer\n    });\n  }\n  _createGraphicAttributes(e, t) {\n    const i = {};\n    for (const r of e.attributes) this._encodeGraphicAttribute(r.attributeInfo, r.values, t, i);\n    return i;\n  }\n  _encodeGraphicAttribute(e, t, i, r) {\n    const s = e.storageInfo?.attributeValues,\n      o = s?.valuesPerElement ?? 1;\n    if (1 === o) r[e.name] = t[i];else if (\"UInt8\" === s?.valueType && o <= 4) {\n      let s = 0;\n      const n = i * o;\n      for (let e = n; e < n + o; e++) s = (s << 8) + t[e];\n      r[e.name] = s;\n    } else r[e.name] = void 0;\n  }\n  _setPointsVisible(e) {\n    e && !this._rendererAdded ? (this.view._stage.addRenderPlugin([ue.OPAQUE_MATERIAL], this._renderer), this._rendererAdded = !0) : !e && this._rendererAdded && (this.view._stage.removeRenderPlugin(this._renderer), this._rendererAdded = !1);\n  }\n  _rendererChanged() {\n    this._renderer.useFixedSizes = X(this.layer.renderer), this._reload();\n  }\n  _reload() {\n    this._clearNodeState(), this._memCache.clear(), this._setUpdateViewNeeded();\n  }\n  _elevationOffsetChanged() {\n    this._clearNodeState(), this._memCache.clear(), this._initNodePages();\n  }\n  _scaleUpdateHandler(e) {\n    const t = this.layer.effectiveScaleRange;\n    ce(t.minScale, t.maxScale) ? A(e.extent, e.spatialReference, Pe, this.layer.spatialReference) && (this._nodeScales.forEach((t, i) => {\n      if (!this._renderedNodes.has(i)) return void this._nodeScales.delete(i);\n      const r = this._index.getNode(i);\n      k(Pe, r.obb.center) && this._nodeScales.set(i, e.scale);\n    }), this._setUpdateViewNeeded()) : this._nodeScales.clear();\n  }\n  _displayNodes(e) {\n    this._workQueue = B([...this._renderedNodes], e, this._index), G(this._workQueue, this.view.state.contentCamera.viewForward, this._index), H(this._workQueue, fe, this._index), this._updateQueues(), this._totalWork = this._computeWork(), this._updateLoading(), this._layerIsVisible = e.length > 0 || this._loadingInitNodePage, this.notifyChange(\"suspended\");\n  }\n  cancelLoading() {\n    this._cancelNodeLoading(), this._cancelIndexLoading();\n  }\n  _cancelNodeLoading() {\n    const e = new Array();\n    this._loadingNodes.forEach(_ref => {\n      let {\n        abortController: t\n      } = _ref;\n      return e.push(t);\n    }), this._loadingNodes.clear();\n    for (const t of e) t.abort();\n    this._workQueue = [], this._idleQueue.cancelAll(), this._totalWork = this._computeWork(), this._updateLoading();\n  }\n  _updateQueues() {\n    const e = new Set();\n    this._workQueue.forEach(t => t.load.forEach(t => e.add(t)));\n    const t = new Array(),\n      i = new Map();\n    this._loadingNodes.forEach((r, s) => {\n      e.has(s) ? i.set(s, r) : t.push(r);\n    }), this._loadingNodes = i;\n    for (const {\n      abortController: r\n    } of t) r.abort();\n    this._workQueue = this._workQueue.filter(e => {\n      for (const t of e.load) if (this._loadingNodes.has(t)) return this._recalcWork = !0, !1;\n      return !0;\n    }), this._totalWork = this._computeWork(), this._updateLoading();\n  }\n  _cancelIndexLoading() {\n    this._indexQueue = [], this._indexPagesLoading.forEach(_ref2 => {\n      let {\n        abortController: e\n      } = _ref2;\n      return e.abort();\n    }), this._indexPagesLoading.clear(), this._totalWork = this._computeWork(), this._updateLoading();\n  }\n  _clearNodeState() {\n    this._nodeLoadEpoch++, this._renderedNodes.forEach(e => this._removeFromRenderer(e)), this._cancelNodeLoading();\n  }\n  _idleBegin() {\n    this._setUpdateViewNeeded();\n  }\n  _idleEnd() {\n    this._setUpdateViewNeeded();\n  }\n  get running() {\n    return this.suspended ? this._updateViewNeeded : this._updateViewNeeded || this._indexQueue.length > 0 || this._workQueue.length > 0 || this._idleQueue.running;\n  }\n  runTask(e) {\n    if (this.suspended) {\n      if (this._updateViewNeeded) {\n        this._updateViewNeeded = !1;\n        const e = this._isRootNodeVisible();\n        e !== this._layerIsVisible && (this._layerIsVisible = e, this.notifyChange(\"suspended\")), this._updateLoading();\n      }\n    } else {\n      for (e.run(() => this._updateWorkQueues()); this._indexQueue.length > 0 && e.run(() => this._processIndexQueue()););\n      this._processWorkQueue(e), this._idleQueue.runTask(e);\n    }\n  }\n  _processIndexQueue() {\n    const e = this._indexQueue.shift(),\n      t = this._loadNodePage(e);\n    return this._indexPagesLoading.set(e, t), t.promise.then(t => {\n      this._index.addPage(e, t, this._elevationOffset), this._setUpdateViewNeeded();\n    }).then(() => {\n      this._indexPagesLoading.delete(e);\n    }, () => {\n      this._indexPagesLoading.delete(e);\n    }), !0;\n  }\n  _processWorkQueue(e) {\n    for (; !e.done;) {\n      const t = this._scheduleWorkEntry();\n      if (l(t)) return;\n      this._processWorkEntry(t), e.madeProgress();\n    }\n  }\n  _scheduleWorkEntry() {\n    let e = this._workQueue.length;\n    for (; e--;) {\n      const e = this._workQueue.shift();\n      if (!e.remove.find(e => !this._renderedNodes.has(e))) return e;\n      this._workQueue.push(e);\n    }\n    return null;\n  }\n  _processWorkEntry(e) {\n    if (0 !== e.load.length) Promise.all(e.load.map(e => {\n      const t = new AbortController(),\n        i = this._memCache.pop(e.toString());\n      return d(i) ? this._loadingNodes.set(e, {\n        abortController: t,\n        promise: Promise.resolve(i)\n      }) : this._loadingNodes.has(e) || this._loadingNodes.set(e, {\n        abortController: t,\n        promise: this._loadNode(e, t.signal)\n      }), this._loadingNodes.get(e).promise;\n    })).then(t => {\n      for (let i = 0; i < e.load.length; i++) if (t[i]) {\n        const r = this._setupRendererData(e.load[i], t[i]);\n        this._addToRenderer(r);\n      }\n      for (const i of e.remove) this._removeFromRenderer(i);\n    }).catch(() => {}).then(() => {\n      for (const t of e.load) this._loadingNodes.delete(t);\n      this._updateLoading(), this._recalcWork && !this._idleQueue.running && 0 === this._indexQueue.length && 0 === this._loadingNodes.size && (this._recalcWork = !1, this._setUpdateViewNeeded());\n    }), this._updateLoading();else for (const t of e.remove) this._removeFromRenderer(t);\n  }\n  async _populateClassCodeCodedDomain(e, i) {\n    const r = \"CLASS_CODE\",\n      s = this.layer.fieldsIndex.get(r);\n    if (!s || s.domain) return;\n    if (!e.includes(s.name)) return;\n    const o = await t(this.layer.queryCachedStatistics(r, {\n      signal: i\n    }));\n    if (!1 === o.ok) return;\n    const n = o.value,\n      a = n && n.labels && n.labels.labels;\n    a && Array.isArray(a) && (s.domain = new Q({\n      name: \"CLASS_CODE\",\n      codedValues: a.map(e => new U({\n        code: e.value,\n        name: e.label\n      }))\n    }));\n  }\n  async prepareFetchPopupFeatures(e) {\n    return this._codedDomainPopulationPromise || (this._codedDomainPopulationAbortController = new AbortController(), this._codedDomainPopulationPromise = this._populateClassCodeCodedDomain(e, this._codedDomainPopulationAbortController.signal).then(() => {\n      this._codedDomainPopulationAbortController = null;\n    })), this._codedDomainPopulationPromise;\n  }\n  async whenGraphicAttributes(e, t) {\n    const r = this._splitGraphicsPerNode(e),\n      s = this.layer.attributeStorageInfo,\n      o = t.map(e => Y(s, e)).filter(d),\n      n = async (e, t) => {\n        const r = this._index.getNode(t);\n        await i(o, async t => {\n          const i = t.useElevation ? await this._loadElevationAttributeFromGeometry(r.resourceId) : await this._loadAndParseAttribute(r, t);\n          if (i) for (const r of e) if (this._isValidPointGraphic(r)) {\n            const e = r.pointCloudMetadata.attributePointIndexInNode;\n            this._encodeGraphicAttribute(t, i, e, r.attributes);\n          }\n        });\n      },\n      a = [];\n    return r.forEach((e, t) => {\n      a.push(n(e, t));\n    }), await u(a), e;\n  }\n  _isValidPointGraphic(e) {\n    return e instanceof ie && e.pointCloudMetadata && e.pointCloudMetadata.epoch === this._nodeLoadEpoch;\n  }\n  _splitGraphicsPerNode(e) {\n    const t = new Map();\n    for (const i of e) {\n      if (!this._isValidPointGraphic(i)) continue;\n      const e = i.pointCloudMetadata,\n        r = t.get(e.nodeId);\n      r ? r.push(i) : t.set(e.nodeId, [i]);\n    }\n    return t;\n  }\n  async _loadAndParseAttribute(e, t) {\n    const i = await this._loadAttribute(e.resourceId, t, null);\n    return d(i) ? Z({\n      attributeInfo: t,\n      buffer: i\n    }, null, e.vertexCount) : null;\n  }\n  async _loadElevationAttributeFromGeometry(e) {\n    const t = this.layer.store.defaultGeometrySchema,\n      i = ee(t, await this._loadGeometry(e, null));\n    return te(i, i.length / 3);\n  }\n  highlight(e) {\n    if (!e) return {\n      remove() {}\n    };\n    const t = r.isCollection(e) ? e.toArray() : Array.isArray(e) ? e : [e];\n    return this._renderer.highlight(t.map(e => this._graphicToPointDefinition(e)));\n  }\n  _graphicToPointDefinition(e) {\n    if (!this._isValidPointGraphic(e)) return null;\n    const {\n      nodeId: t,\n      pointIndexInNode: i\n    } = e.pointCloudMetadata;\n    return null != t && null != i ? {\n      nodeId: t,\n      pointId: i\n    } : null;\n  }\n  _computeWork() {\n    let e = 0;\n    for (const t of this._workQueue) e += t.load.length + t.remove.length;\n    return e += this._loadingNodes.size, e += (this._indexQueue.length + this._indexPagesLoading.size) * this._index.pageSize, e += this._loadingInitNodePage ? 100 : 0, e += this._updateViewNeeded ? 100 : 0, e;\n  }\n  get updatingProgressValue() {\n    if (this.suspended) return this._updateViewNeeded ? 0 : 1;\n    const e = this._computeWork();\n    return 1 - Math.min(this._totalWork, e) / this._totalWork;\n  }\n  _updateLoading() {\n    this.notifyChange(\"updating\"), this.notifyChange(\"updatingProgressValue\");\n  }\n  canResume() {\n    return super.canResume() && this._layerIsVisible;\n  }\n  isUpdating() {\n    return this.suspended ? this._updateViewNeeded : this._computeWork() > 0;\n  }\n  _initNodePages() {\n    const e = this.layer.store.index,\n      t = e.nodesPerPage || e.nodePerIndexBlock;\n    return this._index = new q(this.layer.spatialReference, this.view.renderCoordsHelper.spatialReference, t), this._cancelIndexLoading(), this._traverseVisible = this._index.createVisibilityTraverse(), this._loadingInitNodePage = !0, this._layerIsVisible = !0, this.notifyChange(\"suspended\"), this._updateLoading(), this._pageMultiplier = null != e.nodesPerPage ? 1 : e.nodePerIndexBlock, this._loadNodePage(0).promise.then(e => {\n      this._index.addPage(0, e, this._elevationOffset), this._loadingInitNodePage = !1, this._setUpdateViewNeeded();\n    });\n  }\n  _loadNodePage(e) {\n    const t = new AbortController(),\n      i = `${this.baseUrl}/nodepages/${e * this._pageMultiplier}`;\n    return {\n      promise: this._requestNodePage(i, t.signal).then(t => t.nodes.map((t, i) => ({\n        resourceId: null != t.resourceId ? t.resourceId : e * this._index.pageSize + i,\n        obb: t.obb,\n        firstChild: t.firstChild,\n        childCount: t.childCount,\n        vertexCount: t.vertexCount ?? t.pointCount,\n        lodThreshold: t.lodThreshold ?? t.effectiveArea\n      }))),\n      abortController: t\n    };\n  }\n  _updateWorkQueues() {\n    if (!this._updateViewNeeded) return !1;\n    let e = this.inverseDensity / this._lodFactor * this._getLodMemoryFactor();\n    const t = this.maximumPointCount * this._lodFactor * this._getLodMemoryFactor();\n    let i = this._computeNodesForMinimumDensity(e),\n      r = this._computePointCount(i),\n      s = Math.sqrt(r / (.75 * t));\n    for (; r > t;) e *= s, i = this._computeNodesForMinimumDensity(e), r = this._computePointCount(i), s = Math.sqrt(2);\n    return this._displayNodes(i), this._updateViewNeeded = !1, this._updateLoading(), !0;\n  }\n  _computePointCount(e) {\n    let t = 0;\n    for (let i = 0; i < e.length; i++) {\n      const r = this._index.getNode(e[i]);\n      r && (t += r.vertexCount);\n    }\n    return t;\n  }\n  _getLodMemoryFactor() {\n    return this.view.resourceController.memoryController.memoryFactor;\n  }\n  _isRootNodeVisible() {\n    let e = !1;\n    return this._traverseVisible({\n      frustum: this.view.state.contentCamera.frustum,\n      clippingBox: this._clippingBox\n    }, {\n      predicate: (t, i, r) => (e = r, !1),\n      pageMiss: () => {}\n    }), e;\n  }\n  _computeNodesForMinimumDensity(e) {\n    const t = this.view.state.contentCamera,\n      i = t.frustum,\n      r = this._clippingBox,\n      s = t.viewForward,\n      o = v(s, t.eye),\n      n = L(s, -o, ye),\n      a = t.perScreenPixelRatio / 2,\n      d = e * e,\n      l = this._nodeIdArray;\n    l.length = 0;\n    const {\n        minScale: h,\n        maxScale: u\n      } = _e(this.layer),\n      p = 0 === h && 0 === u ? e => l.push(e) : e => {\n        const t = this._getScale(e);\n        me(t, h, u) && l.push(e);\n      };\n    return this._traverseVisible({\n      frustum: i,\n      clippingBox: r\n    }, {\n      predicate: (e, t, i) => {\n        if (!i) return !1;\n        if (0 === t.childCount) return p(e), !1;\n        const r = this._index.getRenderObb(e);\n        return !(this._computeAveragePixelArea(r, t.lodThreshold, t.vertexCount, n, a) <= d) || (p(e), !1);\n      },\n      pageMiss: (e, t) => {\n        p(e), this._indexQueue.includes(t) || this._indexQueue.push(t);\n      }\n    }), l;\n  }\n  _getScale(e) {\n    let t = this._nodeScales.get(e);\n    if (null == t) {\n      const i = this._index.getNode(e).obb.center;\n      this._tmpPoint.x = i[0], this._tmpPoint.y = i[1], this._tmpPoint.z = i[2], t = this.view.basemapTerrain.getScale(this._tmpPoint), this._nodeScales.set(e, t);\n    }\n    return t;\n  }\n  _computeAveragePixelArea(e, t, i, r, s) {\n    const o = 1e-7,\n      n = Math.max(o, le(e, r));\n    return t / (n * n) / (4 * s * s) / i;\n  }\n  _loadNode(e, t) {\n    try {\n      return this._loadNodeAsync(e, t);\n    } catch (i) {\n      throw p(i) || s.getLogger(this.declaredClass).error(i), i;\n    }\n  }\n  async _loadAdditionalUserAttributes(e, t, i) {\n    const r = this.layer.outFields;\n    if (!r) return [];\n    const s = D(this.layer.fieldsIndex, r),\n      o = new Set(e.map(e => d(e) ? e.name : null)),\n      n = this.layer.attributeStorageInfo,\n      a = [];\n    for (const d of s) {\n      if (o.has(d)) continue;\n      const e = Y(n, d);\n      e && a.push(t(e));\n    }\n    const l = await c(a);\n    return _(i), h(l, e => e);\n  }\n  async _loadNodeAsync(e, t) {\n    const i = this._index.getNode(e),\n      r = J(this.layer),\n      s = K(this.layer),\n      o = i.resourceId,\n      n = async e => {\n        if (l(e)) return null;\n        if (e.useElevation) return {\n          attributeInfo: e,\n          buffer: null\n        };\n        const i = await this._loadAttribute(o, e, t);\n        return d(i) ? {\n          attributeInfo: e,\n          buffer: i\n        } : null;\n      };\n    return this._idleQueue.push(async () => {\n      const i = this._loadGeometry(o, t),\n        {\n          primaryAttribute: a,\n          modulationAttribute: d\n        } = r,\n        l = n(a),\n        h = n(d),\n        u = s.map(e => e.attributeInfo),\n        p = u.map(e => n(e)),\n        c = this._loadAdditionalUserAttributes([a, d, ...u], n, t),\n        [m, g, f, y, b] = await Promise.all([i, l, h, Promise.all(p), c]);\n      _(t);\n      const w = {\n        geometryBuffer: m,\n        primaryAttributeData: g,\n        modulationAttributeData: f,\n        filterAttributesData: y,\n        userAttributesData: b,\n        schema: this.layer.store.defaultGeometrySchema,\n        rendererInfo: r,\n        filterInfo: s,\n        obb: this._index.getRenderObb(e),\n        elevationOffset: this._elevationOffset,\n        inSR: this.layer.spatialReference.toJSON(),\n        outSR: this.view.renderCoordsHelper.spatialReference.toJSON()\n      };\n      return this._worker.invoke(w, t);\n    }, t);\n  }\n  async _loadGeometry(e, t) {\n    return this._requestData(`${this.baseUrl}/nodes/${e}/geometries/0`, t);\n  }\n  async _loadAttribute(e, t, i) {\n    if (l(t) || !t.storageInfo) return null;\n    const r = t.storageInfo.key;\n    return this._requestData(`${this.baseUrl}/nodes/${e}/attributes/${r}`, i);\n  }\n  _requestNodePage(e, t) {\n    const i = {\n      f: \"json\",\n      token: this.layer.apiKey\n    };\n    return this._indexRequester.request(e, \"json\", {\n      query: i,\n      signal: t\n    });\n  }\n  _requestData(e, t) {\n    return this._dataRequester.request(e, \"binary\", {\n      query: {\n        token: this.layer.apiKey\n      },\n      signal: t\n    });\n  }\n  _removeFromRenderer(e) {\n    if (this._renderedNodes.has(e)) {\n      const t = this._renderer.removeNode(e);\n      this._renderedNodes.delete(e), this._nodeScales.delete(e), this._memCache.put(t.id.toString(), t, Ne(t));\n    }\n  }\n  _addToRenderer(e) {\n    this._renderedNodes.has(e.id) || (this._renderedNodes.add(e.id), this._renderer.addNode(e));\n  }\n  _setupRendererData(e, t) {\n    const i = this._index.getNode(e),\n      r = Math.sqrt(i.lodThreshold / i.vertexCount),\n      o = this._index.getRenderObb(e);\n    if (se(t)) return t.splatSize = r, t.obb = o, C(t.origin, t.obb.center), t;\n    const n = .01 * Math.max(o.halfSize[0], o.halfSize[1], o.halfSize[2]);\n    if (t.obb.halfSize[0] > o.halfSize[0] + n || t.obb.halfSize[1] > o.halfSize[1] + n || t.obb.halfSize[2] > o.halfSize[2] + n) {\n      if (this._maxLoggedBoxWarnings > 0) {\n        const i = e => `[${e.halfSize[0]}, ${e.halfSize[1]}, ${e.halfSize[2]}]`;\n        s.getLogger(this.declaredClass).warn(`Node ${e} reported bounding box too small. got ${i(o)} but points cover ${i(t.obb)}`), 0 == --this._maxLoggedBoxWarnings && s.getLogger(this.declaredClass).warn(\"  Too many bounding box errors, stopping reporting for this layer.\");\n      }\n      this._index.setRenderObb(e, t.obb);\n    }\n    return new oe(e, r, S(o.center), o, 0 === i.childCount, t.points, t.rgb, t.attributes, t.pointIdFilterMap);\n  }\n  getUsedMemory() {\n    let e = 0;\n    return this._renderer.forEachNode(t => {\n      e += xe, e += b(t.coordinates);\n      for (const i of t.attributes) {\n        const t = i.values;\n        w(t.buffer) && (e += b(t));\n      }\n    }), e;\n  }\n  getUnloadedMemory() {\n    const e = this._renderedNodes.size;\n    if (e < 4) return 0;\n    const t = [...this._renderedNodes].reduce((e, t) => e + this._index.getNode(t).vertexCount);\n    let i = this._loadingNodes.size;\n    for (let r = 0; r < this._workQueue.length; r++) i += this._workQueue[r].load.length, i -= this._workQueue[r].remove.length;\n    if (i < 0) return 0;\n    return i * t / e * ((this.getUsedMemory() - e * xe) / t) + i * xe;\n  }\n  ignoresMemoryFactor() {\n    return !1;\n  }\n  get performanceInfo() {\n    return {\n      nodes: this._renderedNodes.size,\n      displayedNumberOfFeatures: [...this._renderedNodes].reduce((e, t) => e + this._index.getNode(t).vertexCount, 0),\n      maximumNumberOfFeatures: this.maximumPointCount,\n      totalNumberOfFeatures: -1,\n      core: null,\n      \"Loading Nodes\": this._loadingNodes.size,\n      \"Index Queue\": this._indexQueue.length,\n      \"Work Queue\": this._workQueue.length,\n      \"Idle Queue\": this._idleQueue.length\n    };\n  }\n  get test() {\n    return {\n      index: this._index,\n      visibleNodes: this._renderedNodes\n    };\n  }\n};\ne([P()], be.prototype, \"layer\", void 0), e([P()], be.prototype, \"baseUrl\", null), e([P()], be.prototype, \"pointScale\", null), e([P()], be.prototype, \"useRealWorldSymbolSizes\", null), e([P()], be.prototype, \"pointSize\", null), e([P()], be.prototype, \"inverseDensity\", null), e([P()], be.prototype, \"maximumPointCount\", void 0), e([P({\n  readOnly: !0\n})], be.prototype, \"availableFields\", null), e([P({\n  readOnly: !0\n})], be.prototype, \"_clippingBox\", null), e([P({\n  readOnly: !0\n})], be.prototype, \"_elevationOffset\", null), e([P({\n  type: Boolean\n})], be.prototype, \"slicePlaneEnabled\", void 0), e([P()], be.prototype, \"updating\", void 0), e([P(he)], be.prototype, \"updatingProgress\", void 0), e([P({\n  readOnly: !0\n})], be.prototype, \"updatingProgressValue\", null), be = e([x(\"esri.views.3d.layers.PointCloudLayerView3D\")], be);\nconst we = be;\nfunction Ne(e) {\n  return 5 * e.coordinates.length + 128;\n}\nconst Pe = V(),\n  xe = 160;\nexport { we as default };","map":{"version":3,"names":["_","e","result","t","forEach","i","r","s","unwrapOr","o","destroyMaybe","n","abortMaybe","a","isSome","d","isNone","l","mapSome","h","eachAlways","u","isAbortError","p","eachAlwaysValues","c","throwIfAborted","initial","m","watch","g","sync","f","pt2px","y","estimateSize","b","isArrayBuffer","w","getMetersPerVerticalUnitForSR","N","property","P","subclass","x","v","C","S","projectBoundingRect","A","create","I","containsPoint","k","V","R","fromNormalAndOffset","L","makeDehydratedPoint","j","CodedValue","U","Q","unpackFieldNames","D","PromiseQueue","F","getMetersPerUnit","z","LayerView3D","M","PointCloudWorkerHandle","W","checkPointCloudLayerValid","E","checkPointCloudLayerCompatibleWithView","O","nodeDiff","B","sortFrontToBack","G","splitWorkEntries","H","q","getSplatSizeAlgorithm","T","getFixedSizeAlgorithm","$","getRendererInfo","J","getFilterInfo","K","rendererUsesFixedSizes","X","getAttributeInfo","Y","getAttributeValues","Z","readGeometry","ee","elevationFromPositions","te","PointGraphic","ie","PointRenderer","re","isInstanceOfNode","se","PointRendererNode","oe","PopupSceneLayerView","ne","projectToBoundingBox","ae","ClientType","de","minimumDistancePlane","le","updatingProgress","he","RenderSlot","ue","pe","isScaleRangeActive","ce","extractSafeScaleBounds","_e","scaleBoundsPredicate","me","TaskPriority","ge","fe","ye","be","constructor","arguments","type","maximumPointCount","slicePlaneEnabled","_renderer","_rendererAdded","_renderedNodes","Set","_nodeScales","Map","_updateViewNeeded","_lodFactor","_maxLoggedBoxWarnings","_pageMultiplier","_nodeLoadEpoch","_indexQueue","_workQueue","Array","_idleQueue","_indexPagesLoading","_loadingNodes","_recalcWork","_layerIsVisible","_codedDomainPopulationPromise","_codedDomainPopulationAbortController","_totalWork","_index","_loadingInitNodePage","_nodeIdArray","baseUrl","layer","parsedUrl","path","pointScale","renderer","scaleFactor","useRealWorldSymbolSizes","pointSize","size","inverseDensity","pointsPerInch","availableFields","primaryAttribute","add","name","modulationAttribute","attributeInfo","outFields","fieldsIndex","from","_clippingBox","view","clippingArea","renderSpatialReference","_elevationOffset","elevationInfo","mode","spatialReference","unit","offset","initialize","resourceController","_worker","immediate","schedule","addResolvingPromise","promise","_tmpPoint","_indexRequester","createStreamDataRequester","I3S_INDEX","_dataRequester","I3S_DATA","_initRenderer","_initNodePages","memoryController","_memCache","newCache","uid","updatingHandles","_setUpdateViewNeeded","_elevationOffsetChanged","_rendererChanged","filters","_reload","effectiveScaleRange","state","contentCamera","handles","basemapTerrain","on","_scaleUpdateHandler","memoryFactor","when","scheduler","registerTask","POINT_CLOUD_LAYER","registerIdleStateCallbacks","_idleBegin","_idleEnd","suspended","_clearNodeState","removeAll","_updateLoading","destroy","cancelLoading","_destroyRenderer","createGraphic","_createGraphic","layerUid","clippingBox","_setPointsVisible","minSizePx","Math","sqrt","sizePx","qualitySettings","sceneService","pointCloud","lodFactor","pointIdFilterMap","computeMapPointFromVec3d","_createGraphicAttributes","pointCloudMetadata","nodeId","id","pointIndexInNode","attributePointIndexInNode","epoch","geometry","attributes","sourceLayer","_encodeGraphicAttribute","values","storageInfo","attributeValues","valuesPerElement","valueType","_stage","addRenderPlugin","OPAQUE_MATERIAL","removeRenderPlugin","useFixedSizes","clear","minScale","maxScale","extent","Pe","has","delete","getNode","obb","center","set","scale","_displayNodes","viewForward","_updateQueues","_computeWork","length","notifyChange","_cancelNodeLoading","_cancelIndexLoading","_ref","abortController","push","abort","cancelAll","load","filter","_ref2","_removeFromRenderer","running","runTask","_isRootNodeVisible","run","_updateWorkQueues","_processIndexQueue","_processWorkQueue","shift","_loadNodePage","then","addPage","done","_scheduleWorkEntry","_processWorkEntry","madeProgress","remove","find","Promise","all","map","AbortController","pop","toString","resolve","_loadNode","signal","get","_setupRendererData","_addToRenderer","catch","_populateClassCodeCodedDomain","domain","includes","queryCachedStatistics","ok","value","labels","isArray","codedValues","code","label","prepareFetchPopupFeatures","whenGraphicAttributes","_splitGraphicsPerNode","attributeStorageInfo","useElevation","_loadElevationAttributeFromGeometry","resourceId","_loadAndParseAttribute","_isValidPointGraphic","_loadAttribute","buffer","vertexCount","store","defaultGeometrySchema","_loadGeometry","highlight","isCollection","toArray","_graphicToPointDefinition","pointId","pageSize","updatingProgressValue","min","canResume","isUpdating","index","nodesPerPage","nodePerIndexBlock","renderCoordsHelper","_traverseVisible","createVisibilityTraverse","_requestNodePage","nodes","firstChild","childCount","pointCount","lodThreshold","effectiveArea","_getLodMemoryFactor","_computeNodesForMinimumDensity","_computePointCount","frustum","predicate","pageMiss","eye","perScreenPixelRatio","_getScale","getRenderObb","_computeAveragePixelArea","getScale","max","_loadNodeAsync","getLogger","declaredClass","error","_loadAdditionalUserAttributes","geometryBuffer","primaryAttributeData","modulationAttributeData","filterAttributesData","userAttributesData","schema","rendererInfo","filterInfo","elevationOffset","inSR","toJSON","outSR","invoke","_requestData","key","token","apiKey","request","query","removeNode","put","Ne","addNode","splatSize","origin","halfSize","warn","setRenderObb","points","rgb","getUsedMemory","forEachNode","xe","coordinates","getUnloadedMemory","reduce","ignoresMemoryFactor","performanceInfo","displayedNumberOfFeatures","maximumNumberOfFeatures","totalNumberOfFeatures","core","test","visibleNodes","prototype","readOnly","Boolean","we","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/PointCloudLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{result as t,forEach as i}from\"../../../core/asyncUtils.js\";import r from\"../../../core/Collection.js\";import s from\"../../../core/Logger.js\";import{unwrapOr as o,destroyMaybe as n,abortMaybe as a,isSome as d,isNone as l,mapSome as h}from\"../../../core/maybe.js\";import{eachAlways as u,isAbortError as p,eachAlwaysValues as c,throwIfAborted as _}from\"../../../core/promiseUtils.js\";import{initial as m,watch as g,sync as f}from\"../../../core/reactiveUtils.js\";import{pt2px as y}from\"../../../core/screenUtils.js\";import{estimateSize as b,isArrayBuffer as w}from\"../../../core/typedArrayUtil.js\";import{getMetersPerVerticalUnitForSR as N}from\"../../../core/unitUtils.js\";import{property as P}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as x}from\"../../../core/accessorSupport/decorators/subclass.js\";import{e as v,c as C}from\"../../../chunks/vec3.js\";import{b as S}from\"../../../chunks/vec3f32.js\";import{projectBoundingRect as A}from\"../../../geometry/projection.js\";import{create as I}from\"../../../geometry/support/aaBoundingBox.js\";import{containsPoint as k,create as V}from\"../../../geometry/support/aaBoundingRect.js\";import{create as R,fromNormalAndOffset as L}from\"../../../geometry/support/plane.js\";import{makeDehydratedPoint as j}from\"../../../layers/graphics/dehydratedFeatures.js\";import{CodedValue as U}from\"../../../layers/support/CodedValue.js\";import\"../../../core/has.js\";import Q from\"../../../layers/support/CodedValueDomain.js\";import\"../../../layers/support/Domain.js\";import\"../../../layers/support/InheritedDomain.js\";import\"../../../layers/support/RangeDomain.js\";import{unpackFieldNames as D}from\"../../../layers/support/fieldUtils.js\";import{PromiseQueue as F}from\"../../../layers/support/PromiseQueue.js\";import{getMetersPerUnit as z}from\"../../../symbols/support/unitConversionUtils.js\";import{LayerView3D as M}from\"./LayerView3D.js\";import{PointCloudWorkerHandle as W}from\"./PointCloudWorkerHandle.js\";import{checkPointCloudLayerValid as E,checkPointCloudLayerCompatibleWithView as O}from\"./i3s/I3SUtil.js\";import{nodeDiff as B,sortFrontToBack as G,splitWorkEntries as H}from\"./i3s/LoDUtil.js\";import q from\"./i3s/PagedNodeIndex.js\";import{getSplatSizeAlgorithm as T,getFixedSizeAlgorithm as $,getRendererInfo as J,getFilterInfo as K,rendererUsesFixedSizes as X,getAttributeInfo as Y}from\"./i3s/PointCloudRendererUtil.js\";import{getAttributeValues as Z,readGeometry as ee,elevationFromPositions as te}from\"./i3s/PointCloudWorkerUtil.js\";import{PointGraphic as ie}from\"./i3s/PointGraphic.js\";import{PointRenderer as re,isInstanceOfNode as se,PointRendererNode as oe}from\"./i3s/PointRenderer.js\";import{PopupSceneLayerView as ne}from\"./support/PopupSceneLayerView.js\";import{projectToBoundingBox as ae}from\"../support/extentUtils.js\";import{ClientType as de}from\"../support/index.js\";import{minimumDistancePlane as le}from\"../support/orientedBoundingBox.js\";import{updatingProgress as he}from\"../support/updatingProperties.js\";import{RenderSlot as ue}from\"../webgl-engine/lib/RenderSlot.js\";import pe from\"../../layers/LayerView.js\";import{isScaleRangeActive as ce,extractSafeScaleBounds as _e,scaleBoundsPredicate as me}from\"../../support/layerViewUtils.js\";import{TaskPriority as ge}from\"../../support/Scheduler.js\";const fe=8,ye=R();let be=class extends(ne(M(pe))){constructor(){super(...arguments),this.type=\"point-cloud-3d\",this.maximumPointCount=4e6,this.slicePlaneEnabled=!1,this._renderer=null,this._rendererAdded=!1,this._renderedNodes=new Set,this._nodeScales=new Map,this._updateViewNeeded=!0,this._lodFactor=1,this._maxLoggedBoxWarnings=5,this._pageMultiplier=1,this._nodeLoadEpoch=0,this._indexQueue=[],this._workQueue=new Array,this._idleQueue=new F,this._indexPagesLoading=new Map,this._loadingNodes=new Map,this._recalcWork=!0,this._layerIsVisible=!1,this._codedDomainPopulationPromise=null,this._codedDomainPopulationAbortController=null,this._totalWork=0,this._index=null,this._loadingInitNodePage=!1,this._nodeIdArray=[]}get baseUrl(){return this.layer.parsedUrl.path}get pointScale(){const e=T(this.layer&&this.layer.renderer),t=1;return e&&null!=e.scaleFactor?e.scaleFactor:t}get useRealWorldSymbolSizes(){const e=$(this.layer&&this.layer.renderer),t=!1;return e&&null!=e.useRealWorldSymbolSizes?e.useRealWorldSymbolSizes:t}get pointSize(){const e=$(this.layer&&this.layer.renderer),t=0;return e&&null!=e.size?e.size:t}get inverseDensity(){const e=96;return this.layer&&this.layer.renderer?1*e/this.layer.renderer.pointsPerInch:5}get availableFields(){const e=J(this.layer),t=new Set;e.primaryAttribute&&t.add(e.primaryAttribute.name),e.modulationAttribute&&t.add(e.modulationAttribute.name);const i=K(this.layer);if(i)for(const r of i)r.attributeInfo&&t.add(r.attributeInfo.name);if(this.layer.outFields)for(const r of D(this.layer.fieldsIndex,this.layer.outFields))t.add(r);return Array.from(t)}get _clippingBox(){if(!this.view||!this.view.clippingArea)return null;const e=I(),t=this.view.renderSpatialReference;return ae(this.view.clippingArea,e,t)?e:null}get _elevationOffset(){const e=this.layer&&this.layer.elevationInfo;if(e&&\"absolute-height\"===e.mode){const t=N(this.layer.spatialReference),i=z(e.unit);return o(e.offset,0)*i/t}return 0}initialize(){const e=this.view.resourceController;this._worker=new W((t=>e.immediate.schedule(t))),this.addResolvingPromise(this._worker.promise),this._tmpPoint=j(0,0,0,this.layer.spatialReference),E(this.layer),O(this.layer,this.view),this._indexRequester=e.createStreamDataRequester(de.I3S_INDEX),this._dataRequester=e.createStreamDataRequester(de.I3S_DATA),this._initRenderer();const t=this._initNodePages(),i=this.view.resourceController.memoryController;this._memCache=i.newCache(this.layer.uid),this.updatingHandles.add((()=>this._clippingBox),(()=>this._setUpdateViewNeeded()),m),this.updatingHandles.add((()=>this._elevationOffset),(()=>this._elevationOffsetChanged()),m),this.updatingHandles.add((()=>this.layer.renderer),(()=>this._rendererChanged()),m),this.updatingHandles.add((()=>this.layer.filters),(()=>this._reload()),m),this.updatingHandles.add((()=>this.layer.outFields),(()=>this._reload()),m),this.updatingHandles.add((()=>this.layer.effectiveScaleRange),(()=>this._setUpdateViewNeeded())),this.updatingHandles.add((()=>this.view.state.contentCamera),(()=>this._setUpdateViewNeeded())),this.handles.add([this.view.basemapTerrain.on(\"scale-change\",(e=>this._scaleUpdateHandler(e))),g((()=>i.memoryFactor),(()=>this._setUpdateViewNeeded()),f)]),this.addResolvingPromise(t),this.when((()=>{this.handles.add([e.scheduler.registerTask(ge.POINT_CLOUD_LAYER,this),e.scheduler.registerIdleStateCallbacks((()=>this._idleBegin()),(()=>this._idleEnd())),this.updatingHandles.add((()=>this.suspended),(e=>{e?this._clearNodeState():this._setUpdateViewNeeded()}),m)])}),(()=>{this.updatingHandles.removeAll(),this.handles.removeAll()}))}_setUpdateViewNeeded(){this._updateViewNeeded=!0,this._updateLoading()}destroy(){this.cancelLoading(),this._worker=n(this._worker),this._destroyRenderer(),this._memCache=n(this._memCache),this._codedDomainPopulationAbortController=a(this._codedDomainPopulationAbortController),this._codedDomainPopulationPromise=null}_initRenderer(){this._renderer=new re({createGraphic:(e,t,i)=>this._createGraphic(e,t,i)}),this._renderer.layerUid=this.layer.uid,this.updatingHandles.add((()=>this._clippingBox),(e=>this._renderer.clippingBox=e),m),this.updatingHandles.add((()=>this.suspended),(e=>this._setPointsVisible(!e)),m),this.updatingHandles.add((()=>this.pointScale),(e=>this._renderer.scaleFactor=e),m),this._renderer.minSizePx=Math.sqrt(2),this.updatingHandles.add((()=>this.useRealWorldSymbolSizes),(e=>this._renderer.useRealWorldSymbolSizes=e),m),this.updatingHandles.add((()=>this.pointSize),(e=>{const t=y(e);this._renderer.size=e,this._renderer.sizePx=t}),m),this.updatingHandles.add((()=>this.slicePlaneEnabled),(e=>this._renderer.slicePlaneEnabled=e),m),this.updatingHandles.add((()=>this.inverseDensity),(()=>this._setUpdateViewNeeded()),m),this.updatingHandles.add((()=>this.maximumPointCount),(()=>this._setUpdateViewNeeded()),m),this.updatingHandles.add((()=>this.view.qualitySettings.sceneService.pointCloud.lodFactor),(e=>{this._lodFactor=e,this._setUpdateViewNeeded()}),m)}_destroyRenderer(){this._renderer.removeAll(),this._setPointsVisible(!1)}_createGraphic(e,t,i){const r=d(e.pointIdFilterMap)?e.pointIdFilterMap[t]:t,s=this.view.computeMapPointFromVec3d(i),o=this._createGraphicAttributes(e,r);return new ie({pointCloudMetadata:{nodeId:e.id,pointIndexInNode:t,attributePointIndexInNode:r,epoch:this._nodeLoadEpoch},geometry:s,attributes:o,layer:this.layer,sourceLayer:this.layer})}_createGraphicAttributes(e,t){const i={};for(const r of e.attributes)this._encodeGraphicAttribute(r.attributeInfo,r.values,t,i);return i}_encodeGraphicAttribute(e,t,i,r){const s=e.storageInfo?.attributeValues,o=s?.valuesPerElement??1;if(1===o)r[e.name]=t[i];else if(\"UInt8\"===s?.valueType&&o<=4){let s=0;const n=i*o;for(let e=n;e<n+o;e++)s=(s<<8)+t[e];r[e.name]=s}else r[e.name]=void 0}_setPointsVisible(e){e&&!this._rendererAdded?(this.view._stage.addRenderPlugin([ue.OPAQUE_MATERIAL],this._renderer),this._rendererAdded=!0):!e&&this._rendererAdded&&(this.view._stage.removeRenderPlugin(this._renderer),this._rendererAdded=!1)}_rendererChanged(){this._renderer.useFixedSizes=X(this.layer.renderer),this._reload()}_reload(){this._clearNodeState(),this._memCache.clear(),this._setUpdateViewNeeded()}_elevationOffsetChanged(){this._clearNodeState(),this._memCache.clear(),this._initNodePages()}_scaleUpdateHandler(e){const t=this.layer.effectiveScaleRange;ce(t.minScale,t.maxScale)?A(e.extent,e.spatialReference,Pe,this.layer.spatialReference)&&(this._nodeScales.forEach(((t,i)=>{if(!this._renderedNodes.has(i))return void this._nodeScales.delete(i);const r=this._index.getNode(i);k(Pe,r.obb.center)&&this._nodeScales.set(i,e.scale)})),this._setUpdateViewNeeded()):this._nodeScales.clear()}_displayNodes(e){this._workQueue=B([...this._renderedNodes],e,this._index),G(this._workQueue,this.view.state.contentCamera.viewForward,this._index),H(this._workQueue,fe,this._index),this._updateQueues(),this._totalWork=this._computeWork(),this._updateLoading(),this._layerIsVisible=e.length>0||this._loadingInitNodePage,this.notifyChange(\"suspended\")}cancelLoading(){this._cancelNodeLoading(),this._cancelIndexLoading()}_cancelNodeLoading(){const e=new Array;this._loadingNodes.forEach((({abortController:t})=>e.push(t))),this._loadingNodes.clear();for(const t of e)t.abort();this._workQueue=[],this._idleQueue.cancelAll(),this._totalWork=this._computeWork(),this._updateLoading()}_updateQueues(){const e=new Set;this._workQueue.forEach((t=>t.load.forEach((t=>e.add(t)))));const t=new Array,i=new Map;this._loadingNodes.forEach(((r,s)=>{e.has(s)?i.set(s,r):t.push(r)})),this._loadingNodes=i;for(const{abortController:r}of t)r.abort();this._workQueue=this._workQueue.filter((e=>{for(const t of e.load)if(this._loadingNodes.has(t))return this._recalcWork=!0,!1;return!0})),this._totalWork=this._computeWork(),this._updateLoading()}_cancelIndexLoading(){this._indexQueue=[],this._indexPagesLoading.forEach((({abortController:e})=>e.abort())),this._indexPagesLoading.clear(),this._totalWork=this._computeWork(),this._updateLoading()}_clearNodeState(){this._nodeLoadEpoch++,this._renderedNodes.forEach((e=>this._removeFromRenderer(e))),this._cancelNodeLoading()}_idleBegin(){this._setUpdateViewNeeded()}_idleEnd(){this._setUpdateViewNeeded()}get running(){return this.suspended?this._updateViewNeeded:this._updateViewNeeded||this._indexQueue.length>0||this._workQueue.length>0||this._idleQueue.running}runTask(e){if(this.suspended){if(this._updateViewNeeded){this._updateViewNeeded=!1;const e=this._isRootNodeVisible();e!==this._layerIsVisible&&(this._layerIsVisible=e,this.notifyChange(\"suspended\")),this._updateLoading()}}else{for(e.run((()=>this._updateWorkQueues()));this._indexQueue.length>0&&e.run((()=>this._processIndexQueue())););this._processWorkQueue(e),this._idleQueue.runTask(e)}}_processIndexQueue(){const e=this._indexQueue.shift(),t=this._loadNodePage(e);return this._indexPagesLoading.set(e,t),t.promise.then((t=>{this._index.addPage(e,t,this._elevationOffset),this._setUpdateViewNeeded()})).then((()=>{this._indexPagesLoading.delete(e)}),(()=>{this._indexPagesLoading.delete(e)})),!0}_processWorkQueue(e){for(;!e.done;){const t=this._scheduleWorkEntry();if(l(t))return;this._processWorkEntry(t),e.madeProgress()}}_scheduleWorkEntry(){let e=this._workQueue.length;for(;e--;){const e=this._workQueue.shift();if(!e.remove.find((e=>!this._renderedNodes.has(e))))return e;this._workQueue.push(e)}return null}_processWorkEntry(e){if(0!==e.load.length)Promise.all(e.load.map((e=>{const t=new AbortController,i=this._memCache.pop(e.toString());return d(i)?this._loadingNodes.set(e,{abortController:t,promise:Promise.resolve(i)}):this._loadingNodes.has(e)||this._loadingNodes.set(e,{abortController:t,promise:this._loadNode(e,t.signal)}),this._loadingNodes.get(e).promise}))).then((t=>{for(let i=0;i<e.load.length;i++)if(t[i]){const r=this._setupRendererData(e.load[i],t[i]);this._addToRenderer(r)}for(const i of e.remove)this._removeFromRenderer(i)})).catch((()=>{})).then((()=>{for(const t of e.load)this._loadingNodes.delete(t);this._updateLoading(),this._recalcWork&&!this._idleQueue.running&&0===this._indexQueue.length&&0===this._loadingNodes.size&&(this._recalcWork=!1,this._setUpdateViewNeeded())})),this._updateLoading();else for(const t of e.remove)this._removeFromRenderer(t)}async _populateClassCodeCodedDomain(e,i){const r=\"CLASS_CODE\",s=this.layer.fieldsIndex.get(r);if(!s||s.domain)return;if(!e.includes(s.name))return;const o=await t(this.layer.queryCachedStatistics(r,{signal:i}));if(!1===o.ok)return;const n=o.value,a=n&&n.labels&&n.labels.labels;a&&Array.isArray(a)&&(s.domain=new Q({name:\"CLASS_CODE\",codedValues:a.map((e=>new U({code:e.value,name:e.label})))}))}async prepareFetchPopupFeatures(e){return this._codedDomainPopulationPromise||(this._codedDomainPopulationAbortController=new AbortController,this._codedDomainPopulationPromise=this._populateClassCodeCodedDomain(e,this._codedDomainPopulationAbortController.signal).then((()=>{this._codedDomainPopulationAbortController=null}))),this._codedDomainPopulationPromise}async whenGraphicAttributes(e,t){const r=this._splitGraphicsPerNode(e),s=this.layer.attributeStorageInfo,o=t.map((e=>Y(s,e))).filter(d),n=async(e,t)=>{const r=this._index.getNode(t);await i(o,(async t=>{const i=t.useElevation?await this._loadElevationAttributeFromGeometry(r.resourceId):await this._loadAndParseAttribute(r,t);if(i)for(const r of e)if(this._isValidPointGraphic(r)){const e=r.pointCloudMetadata.attributePointIndexInNode;this._encodeGraphicAttribute(t,i,e,r.attributes)}}))},a=[];return r.forEach(((e,t)=>{a.push(n(e,t))})),await u(a),e}_isValidPointGraphic(e){return e instanceof ie&&e.pointCloudMetadata&&e.pointCloudMetadata.epoch===this._nodeLoadEpoch}_splitGraphicsPerNode(e){const t=new Map;for(const i of e){if(!this._isValidPointGraphic(i))continue;const e=i.pointCloudMetadata,r=t.get(e.nodeId);r?r.push(i):t.set(e.nodeId,[i])}return t}async _loadAndParseAttribute(e,t){const i=await this._loadAttribute(e.resourceId,t,null);return d(i)?Z({attributeInfo:t,buffer:i},null,e.vertexCount):null}async _loadElevationAttributeFromGeometry(e){const t=this.layer.store.defaultGeometrySchema,i=ee(t,await this._loadGeometry(e,null));return te(i,i.length/3)}highlight(e){if(!e)return{remove(){}};const t=r.isCollection(e)?e.toArray():Array.isArray(e)?e:[e];return this._renderer.highlight(t.map((e=>this._graphicToPointDefinition(e))))}_graphicToPointDefinition(e){if(!this._isValidPointGraphic(e))return null;const{nodeId:t,pointIndexInNode:i}=e.pointCloudMetadata;return null!=t&&null!=i?{nodeId:t,pointId:i}:null}_computeWork(){let e=0;for(const t of this._workQueue)e+=t.load.length+t.remove.length;return e+=this._loadingNodes.size,e+=(this._indexQueue.length+this._indexPagesLoading.size)*this._index.pageSize,e+=this._loadingInitNodePage?100:0,e+=this._updateViewNeeded?100:0,e}get updatingProgressValue(){if(this.suspended)return this._updateViewNeeded?0:1;const e=this._computeWork();return 1-Math.min(this._totalWork,e)/this._totalWork}_updateLoading(){this.notifyChange(\"updating\"),this.notifyChange(\"updatingProgressValue\")}canResume(){return super.canResume()&&this._layerIsVisible}isUpdating(){return this.suspended?this._updateViewNeeded:this._computeWork()>0}_initNodePages(){const e=this.layer.store.index,t=e.nodesPerPage||e.nodePerIndexBlock;return this._index=new q(this.layer.spatialReference,this.view.renderCoordsHelper.spatialReference,t),this._cancelIndexLoading(),this._traverseVisible=this._index.createVisibilityTraverse(),this._loadingInitNodePage=!0,this._layerIsVisible=!0,this.notifyChange(\"suspended\"),this._updateLoading(),this._pageMultiplier=null!=e.nodesPerPage?1:e.nodePerIndexBlock,this._loadNodePage(0).promise.then((e=>{this._index.addPage(0,e,this._elevationOffset),this._loadingInitNodePage=!1,this._setUpdateViewNeeded()}))}_loadNodePage(e){const t=new AbortController,i=`${this.baseUrl}/nodepages/${e*this._pageMultiplier}`;return{promise:this._requestNodePage(i,t.signal).then((t=>t.nodes.map(((t,i)=>({resourceId:null!=t.resourceId?t.resourceId:e*this._index.pageSize+i,obb:t.obb,firstChild:t.firstChild,childCount:t.childCount,vertexCount:t.vertexCount??t.pointCount,lodThreshold:t.lodThreshold??t.effectiveArea}))))),abortController:t}}_updateWorkQueues(){if(!this._updateViewNeeded)return!1;let e=this.inverseDensity/this._lodFactor*this._getLodMemoryFactor();const t=this.maximumPointCount*this._lodFactor*this._getLodMemoryFactor();let i=this._computeNodesForMinimumDensity(e),r=this._computePointCount(i),s=Math.sqrt(r/(.75*t));for(;r>t;)e*=s,i=this._computeNodesForMinimumDensity(e),r=this._computePointCount(i),s=Math.sqrt(2);return this._displayNodes(i),this._updateViewNeeded=!1,this._updateLoading(),!0}_computePointCount(e){let t=0;for(let i=0;i<e.length;i++){const r=this._index.getNode(e[i]);r&&(t+=r.vertexCount)}return t}_getLodMemoryFactor(){return this.view.resourceController.memoryController.memoryFactor}_isRootNodeVisible(){let e=!1;return this._traverseVisible({frustum:this.view.state.contentCamera.frustum,clippingBox:this._clippingBox},{predicate:(t,i,r)=>(e=r,!1),pageMiss:()=>{}}),e}_computeNodesForMinimumDensity(e){const t=this.view.state.contentCamera,i=t.frustum,r=this._clippingBox,s=t.viewForward,o=v(s,t.eye),n=L(s,-o,ye),a=t.perScreenPixelRatio/2,d=e*e,l=this._nodeIdArray;l.length=0;const{minScale:h,maxScale:u}=_e(this.layer),p=0===h&&0===u?e=>l.push(e):e=>{const t=this._getScale(e);me(t,h,u)&&l.push(e)};return this._traverseVisible({frustum:i,clippingBox:r},{predicate:(e,t,i)=>{if(!i)return!1;if(0===t.childCount)return p(e),!1;const r=this._index.getRenderObb(e);return!(this._computeAveragePixelArea(r,t.lodThreshold,t.vertexCount,n,a)<=d)||(p(e),!1)},pageMiss:(e,t)=>{p(e),this._indexQueue.includes(t)||this._indexQueue.push(t)}}),l}_getScale(e){let t=this._nodeScales.get(e);if(null==t){const i=this._index.getNode(e).obb.center;this._tmpPoint.x=i[0],this._tmpPoint.y=i[1],this._tmpPoint.z=i[2],t=this.view.basemapTerrain.getScale(this._tmpPoint),this._nodeScales.set(e,t)}return t}_computeAveragePixelArea(e,t,i,r,s){const o=1e-7,n=Math.max(o,le(e,r));return t/(n*n)/(4*s*s)/i}_loadNode(e,t){try{return this._loadNodeAsync(e,t)}catch(i){throw p(i)||s.getLogger(this.declaredClass).error(i),i}}async _loadAdditionalUserAttributes(e,t,i){const r=this.layer.outFields;if(!r)return[];const s=D(this.layer.fieldsIndex,r),o=new Set(e.map((e=>d(e)?e.name:null))),n=this.layer.attributeStorageInfo,a=[];for(const d of s){if(o.has(d))continue;const e=Y(n,d);e&&a.push(t(e))}const l=await c(a);return _(i),h(l,(e=>e))}async _loadNodeAsync(e,t){const i=this._index.getNode(e),r=J(this.layer),s=K(this.layer),o=i.resourceId,n=async e=>{if(l(e))return null;if(e.useElevation)return{attributeInfo:e,buffer:null};const i=await this._loadAttribute(o,e,t);return d(i)?{attributeInfo:e,buffer:i}:null};return this._idleQueue.push((async()=>{const i=this._loadGeometry(o,t),{primaryAttribute:a,modulationAttribute:d}=r,l=n(a),h=n(d),u=s.map((e=>e.attributeInfo)),p=u.map((e=>n(e))),c=this._loadAdditionalUserAttributes([a,d,...u],n,t),[m,g,f,y,b]=await Promise.all([i,l,h,Promise.all(p),c]);_(t);const w={geometryBuffer:m,primaryAttributeData:g,modulationAttributeData:f,filterAttributesData:y,userAttributesData:b,schema:this.layer.store.defaultGeometrySchema,rendererInfo:r,filterInfo:s,obb:this._index.getRenderObb(e),elevationOffset:this._elevationOffset,inSR:this.layer.spatialReference.toJSON(),outSR:this.view.renderCoordsHelper.spatialReference.toJSON()};return this._worker.invoke(w,t)}),t)}async _loadGeometry(e,t){return this._requestData(`${this.baseUrl}/nodes/${e}/geometries/0`,t)}async _loadAttribute(e,t,i){if(l(t)||!t.storageInfo)return null;const r=t.storageInfo.key;return this._requestData(`${this.baseUrl}/nodes/${e}/attributes/${r}`,i)}_requestNodePage(e,t){const i={f:\"json\",token:this.layer.apiKey};return this._indexRequester.request(e,\"json\",{query:i,signal:t})}_requestData(e,t){return this._dataRequester.request(e,\"binary\",{query:{token:this.layer.apiKey},signal:t})}_removeFromRenderer(e){if(this._renderedNodes.has(e)){const t=this._renderer.removeNode(e);this._renderedNodes.delete(e),this._nodeScales.delete(e),this._memCache.put(t.id.toString(),t,Ne(t))}}_addToRenderer(e){this._renderedNodes.has(e.id)||(this._renderedNodes.add(e.id),this._renderer.addNode(e))}_setupRendererData(e,t){const i=this._index.getNode(e),r=Math.sqrt(i.lodThreshold/i.vertexCount),o=this._index.getRenderObb(e);if(se(t))return t.splatSize=r,t.obb=o,C(t.origin,t.obb.center),t;const n=.01*Math.max(o.halfSize[0],o.halfSize[1],o.halfSize[2]);if(t.obb.halfSize[0]>o.halfSize[0]+n||t.obb.halfSize[1]>o.halfSize[1]+n||t.obb.halfSize[2]>o.halfSize[2]+n){if(this._maxLoggedBoxWarnings>0){const i=e=>`[${e.halfSize[0]}, ${e.halfSize[1]}, ${e.halfSize[2]}]`;s.getLogger(this.declaredClass).warn(`Node ${e} reported bounding box too small. got ${i(o)} but points cover ${i(t.obb)}`),0==--this._maxLoggedBoxWarnings&&s.getLogger(this.declaredClass).warn(\"  Too many bounding box errors, stopping reporting for this layer.\")}this._index.setRenderObb(e,t.obb)}return new oe(e,r,S(o.center),o,0===i.childCount,t.points,t.rgb,t.attributes,t.pointIdFilterMap)}getUsedMemory(){let e=0;return this._renderer.forEachNode((t=>{e+=xe,e+=b(t.coordinates);for(const i of t.attributes){const t=i.values;w(t.buffer)&&(e+=b(t))}})),e}getUnloadedMemory(){const e=this._renderedNodes.size;if(e<4)return 0;const t=[...this._renderedNodes].reduce(((e,t)=>e+this._index.getNode(t).vertexCount));let i=this._loadingNodes.size;for(let r=0;r<this._workQueue.length;r++)i+=this._workQueue[r].load.length,i-=this._workQueue[r].remove.length;if(i<0)return 0;return i*t/e*((this.getUsedMemory()-e*xe)/t)+i*xe}ignoresMemoryFactor(){return!1}get performanceInfo(){return{nodes:this._renderedNodes.size,displayedNumberOfFeatures:[...this._renderedNodes].reduce(((e,t)=>e+this._index.getNode(t).vertexCount),0),maximumNumberOfFeatures:this.maximumPointCount,totalNumberOfFeatures:-1,core:null,\"Loading Nodes\":this._loadingNodes.size,\"Index Queue\":this._indexQueue.length,\"Work Queue\":this._workQueue.length,\"Idle Queue\":this._idleQueue.length}}get test(){return{index:this._index,visibleNodes:this._renderedNodes}}};e([P()],be.prototype,\"layer\",void 0),e([P()],be.prototype,\"baseUrl\",null),e([P()],be.prototype,\"pointScale\",null),e([P()],be.prototype,\"useRealWorldSymbolSizes\",null),e([P()],be.prototype,\"pointSize\",null),e([P()],be.prototype,\"inverseDensity\",null),e([P()],be.prototype,\"maximumPointCount\",void 0),e([P({readOnly:!0})],be.prototype,\"availableFields\",null),e([P({readOnly:!0})],be.prototype,\"_clippingBox\",null),e([P({readOnly:!0})],be.prototype,\"_elevationOffset\",null),e([P({type:Boolean})],be.prototype,\"slicePlaneEnabled\",void 0),e([P()],be.prototype,\"updating\",void 0),e([P(he)],be.prototype,\"updatingProgress\",void 0),e([P({readOnly:!0})],be.prototype,\"updatingProgressValue\",null),be=e([x(\"esri.views.3d.layers.PointCloudLayerView3D\")],be);const we=be;function Ne(e){return 5*e.coordinates.length+128}const Pe=V(),xe=160;export{we as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}