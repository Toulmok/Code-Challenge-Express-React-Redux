{"ast":null,"code":"import _regeneratorRuntime from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _classCallCheck from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _inherits from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/code-challenge-react/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../../core/Accessor.js\";\nimport { ByteSizeUnit as s, estimateAttributesObjectSize as i, estimateFixedArraySize as r } from \"../../../../../core/byteSizeEstimations.js\";\nimport { isNone as o, isSome as n } from \"../../../../../core/maybe.js\";\nimport { property as l } from \"../../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../../core/arrayUtils.js\";\nimport { subclass as a } from \"../../../../../core/accessorSupport/decorators/subclass.js\";\nimport { create as c, intersects as h, fromExtent as u, area as d } from \"../../../../../geometry/support/aaBoundingRect.js\";\nimport { getBoundsOptimizedGeometry as f } from \"../../../../../layers/graphics/featureConversionUtils.js\";\nimport { BoundsStore as _ } from \"../../../../../layers/graphics/data/BoundsStore.js\";\nimport p from \"../../../../../layers/support/TileInfo.js\";\nimport { TileKey as m } from \"../../../../../layers/support/TileKey.js\";\nimport { executeQueryForCount as g } from \"../../../../../rest/query/operations/query.js\";\nimport { FeatureServiceTileCache as y } from \"./FeatureServiceTileCache.js\";\nvar v = /*#__PURE__*/function (_t) {\n  _inherits(v, _t);\n  var _super = _createSuper(v);\n  function v(e) {\n    var _this;\n    _classCallCheck(this, v);\n    _this = _super.call(this, e), _this.tileInfo = null, _this.extent = null, _this.maximumByteSize = 10 * s.MEGABYTES, _this._tileBounds = new _(), _this._tiles = new y(), _this._refCounts = new Map(), _this._tileFeatureCounts = new Map(), _this._tmpBoundingRect = c();\n    return _this;\n  }\n  _createClass(v, [{\n    key: \"add\",\n    value: function add(e, t) {\n      var _this2 = this;\n      var s = [];\n      var _iterator = _createForOfIteratorHelper(t),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var _i = _step.value;\n          this._referenceFeature(_i.objectId) === x.ADDED && s.push(_i);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n      this._addTileStorage(e, new Set(t.map(function (e) {\n        return e.objectId;\n      })), C(t)), this.featureStore.addMany(s), this._tiles.applyByteSizeLimit(this.maximumByteSize, function (e) {\n        return _this2._removeTileStorage(e);\n      });\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.clear(), this._tileFeatureCounts.clear();\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.featureStore.clear(), this._tileBounds.clear(), this._tiles.clear(), this._refCounts.clear();\n    }\n  }, {\n    key: \"refresh\",\n    value: function refresh() {\n      this.clear(), this._tileFeatureCounts.clear();\n    }\n  }, {\n    key: \"processEdits\",\n    value: function processEdits(e, t, s) {\n      return this._processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)), this._processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures), t, s);\n    }\n  }, {\n    key: \"_addTileStorage\",\n    value: function _addTileStorage(e, t, s) {\n      var i = e.id;\n      this._tiles.set(i, new T(e, t, s)), this._tileBounds.set(i, e.extent), this._tileFeatureCounts.set(i, t.size);\n    }\n  }, {\n    key: \"_remove\",\n    value: function _remove(_ref) {\n      var e = _ref.id;\n      var t = this._tiles.get(e);\n      t && this._removeTileStorage(t);\n    }\n  }, {\n    key: \"_removeTileStorage\",\n    value: function _removeTileStorage(e) {\n      var t = [];\n      var _iterator2 = _createForOfIteratorHelper(e.objectIds),\n        _step2;\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _i2 = _step2.value;\n          this._unreferenceFeature(_i2) === x.REMOVED && t.push(_i2);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n      this.featureStore.removeManyById(t);\n      var s = e.data.id;\n      this._tiles.delete(s), this._tileBounds.delete(s);\n    }\n  }, {\n    key: \"_processEditsDelete\",\n    value: function _processEditsDelete(e) {\n      this.featureStore.removeManyById(e);\n      var _iterator3 = _createForOfIteratorHelper(this._tiles),\n        _step3;\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var _step3$value = _slicedToArray(_step3.value, 2),\n            _t2 = _step3$value[1];\n          var _iterator5 = _createForOfIteratorHelper(e),\n            _step5;\n          try {\n            for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n              var _s = _step5.value;\n              _t2.objectIds.delete(_s);\n            }\n          } catch (err) {\n            _iterator5.e(err);\n          } finally {\n            _iterator5.f();\n          }\n          this._tileFeatureCounts.set(_t2.data.id, _t2.objectIds.size);\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n      var _iterator4 = _createForOfIteratorHelper(e),\n        _step4;\n      try {\n        for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n          var _t3 = _step4.value;\n          this._refCounts.delete(_t3);\n        }\n      } catch (err) {\n        _iterator4.e(err);\n      } finally {\n        _iterator4.f();\n      }\n    }\n  }, {\n    key: \"_processEditsRefetch\",\n    value: function () {\n      var _processEditsRefetch2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(e, t, s) {\n        var _this3 = this;\n        var i, _this$featureStore, r, n, _iterator6, _step6, _loop;\n        return _regeneratorRuntime().wrap(function _callee$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return t(e, s);\n            case 2:\n              i = _context2.sent.features;\n              _this$featureStore = this.featureStore;\n              r = _this$featureStore.hasZ;\n              n = _this$featureStore.hasM;\n              _iterator6 = _createForOfIteratorHelper(i);\n              _context2.prev = 7;\n              _loop = /*#__PURE__*/_regeneratorRuntime().mark(function _loop() {\n                var l, e;\n                return _regeneratorRuntime().wrap(function _loop$(_context) {\n                  while (1) switch (_context.prev = _context.next) {\n                    case 0:\n                      l = _step6.value;\n                      e = f(_this3._tmpBoundingRect, l.geometry, r, n);\n                      o(e) || _this3._tileBounds.forEachInBounds(e, function (e) {\n                        var t = _this3._tiles.get(e);\n                        _this3.featureStore.add(l);\n                        var s = l.objectId;\n                        t.objectIds.has(s) || (t.objectIds.add(s), _this3._referenceFeature(s), _this3._tileFeatureCounts.set(t.data.id, t.objectIds.size));\n                      });\n                    case 3:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }, _loop);\n              });\n              _iterator6.s();\n            case 10:\n              if ((_step6 = _iterator6.n()).done) {\n                _context2.next = 14;\n                break;\n              }\n              return _context2.delegateYield(_loop(), \"t0\", 12);\n            case 12:\n              _context2.next = 10;\n              break;\n            case 14:\n              _context2.next = 19;\n              break;\n            case 16:\n              _context2.prev = 16;\n              _context2.t1 = _context2[\"catch\"](7);\n              _iterator6.e(_context2.t1);\n            case 19:\n              _context2.prev = 19;\n              _iterator6.f();\n              return _context2.finish(19);\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee, this, [[7, 16, 19, 22]]);\n      }));\n      function _processEditsRefetch(_x, _x2, _x3) {\n        return _processEditsRefetch2.apply(this, arguments);\n      }\n      return _processEditsRefetch;\n    }()\n  }, {\n    key: \"process\",\n    value: function process(e) {\n      var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : function () {\n        return !0;\n      };\n      if (o(this.tileInfo) || !e.extent || n(this.extent) && !h(u(this.extent, this._tmpBoundingRect), e.extent)) return new I(e);\n      if (this._tiles.has(e.id)) return new I(e);\n      var s = this._createTileTree(e, this.tileInfo);\n      return this._simplify(s, t, null, 0, 1), this._collectMissingTiles(e, s, this.tileInfo);\n    }\n  }, {\n    key: \"debugInfo\",\n    get: function get() {\n      var _this4 = this;\n      return Array.from(this._tiles.values()).map(function (_ref2) {\n        var e = _ref2.data;\n        return {\n          data: e,\n          featureCount: _this4._tileFeatureCounts.get(e.id) || 0\n        };\n      });\n    }\n  }, {\n    key: \"getFeatureCount\",\n    value: function getFeatureCount(e) {\n      var _this$_tileFeatureCou;\n      return (_this$_tileFeatureCou = this._tileFeatureCounts.get(e.id)) !== null && _this$_tileFeatureCou !== void 0 ? _this$_tileFeatureCou : 0;\n    }\n  }, {\n    key: \"fetchCount\",\n    value: function () {\n      var _fetchCount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e, t, s, i) {\n        var r, o;\n        return _regeneratorRuntime().wrap(function _callee2$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              r = this._tileFeatureCounts.get(e.id);\n              if (!(null != r)) {\n                _context3.next = 3;\n                break;\n              }\n              return _context3.abrupt(\"return\", r);\n            case 3:\n              _context3.next = 5;\n              return g(t, s, i);\n            case 5:\n              o = _context3.sent;\n              return _context3.abrupt(\"return\", (this._tileFeatureCounts.set(e.id, o.data.count), o.data.count));\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee2, this);\n      }));\n      function fetchCount(_x4, _x5, _x6, _x7) {\n        return _fetchCount.apply(this, arguments);\n      }\n      return fetchCount;\n    }()\n  }, {\n    key: \"_createTileTree\",\n    value: function _createTileTree(e, t) {\n      var _this5 = this;\n      var s = new F(e.level, e.row, e.col);\n      return t.updateTileInfo(s, p.ExtrapolateOptions.POWER_OF_TWO), this._tileBounds.forEachInBounds(e.extent, function (i) {\n        var _this5$_tiles$get;\n        var r = (_this5$_tiles$get = _this5._tiles.get(i)) === null || _this5$_tiles$get === void 0 ? void 0 : _this5$_tiles$get.data;\n        r && _this5._tilesAreRelated(e, r) && _this5._populateChildren(s, r, t, _this5._tileFeatureCounts.get(r.id) || 0);\n      }), s;\n    }\n  }, {\n    key: \"_tilesAreRelated\",\n    value: function _tilesAreRelated(e, t) {\n      if (!e || !t) return !1;\n      if (e.level === t.level) return e.row === t.row && e.col === t.col;\n      var s = e.level < t.level,\n        i = s ? e : t,\n        r = s ? t : e,\n        o = 1 << r.level - i.level;\n      return Math.floor(r.row / o) === i.row && Math.floor(r.col / o) === i.col;\n    }\n  }, {\n    key: \"_populateChildren\",\n    value: function _populateChildren(e, t, s, i) {\n      var r = t.level - e.level - 1;\n      if (r < 0) return void (e.isLeaf = !0);\n      var o = t.row >> r,\n        l = t.col >> r,\n        a = e.row << 1,\n        c = l - (e.col << 1) + (o - a << 1),\n        h = e.children[c];\n      if (n(h)) this._populateChildren(h, t, s, i);else {\n        var _r = new F(e.level + 1, o, l);\n        s.updateTileInfo(_r, p.ExtrapolateOptions.POWER_OF_TWO), e.children[c] = _r, this._populateChildren(_r, t, s, i);\n      }\n    }\n  }, {\n    key: \"_simplify\",\n    value: function _simplify(e, t, s, i, r) {\n      var o = r * r;\n      if (e.isLeaf) return t(this.getFeatureCount(e), r) ? 0 : (this._remove(e), n(s) && (s.children[i] = null), o);\n      var l = r / 2,\n        a = l * l;\n      var c = 0;\n      for (var _h = 0; _h < e.children.length; _h++) {\n        var _s2 = e.children[_h];\n        c += n(_s2) ? this._simplify(_s2, t, e, _h, l) : a;\n      }\n      return 0 === c ? this._mergeChildren(e) : 1 - c / o < w && (this._purge(e), n(s) && (s.children[i] = null), c = o), c;\n    }\n  }, {\n    key: \"_mergeChildren\",\n    value: function _mergeChildren(e) {\n      var _this6 = this;\n      var t = new Set();\n      var s = 0;\n      this._forEachLeaf(e, function (e) {\n        var i = _this6._tiles.get(e.id);\n        if (i) {\n          s += i.byteSize;\n          var _iterator7 = _createForOfIteratorHelper(i.objectIds),\n            _step7;\n          try {\n            for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n              var _e = _step7.value;\n              t.has(_e) || (t.add(_e), _this6._referenceFeature(_e));\n            }\n          } catch (err) {\n            _iterator7.e(err);\n          } finally {\n            _iterator7.f();\n          }\n          _this6._remove(e);\n        }\n      }), this._addTileStorage(e, t, s), e.isLeaf = !0, e.children[0] = e.children[1] = e.children[2] = e.children[3] = null, this._tileFeatureCounts.set(e.id, t.size);\n    }\n  }, {\n    key: \"_forEachLeaf\",\n    value: function _forEachLeaf(e, t) {\n      var _iterator8 = _createForOfIteratorHelper(e.children),\n        _step8;\n      try {\n        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n          var _s3 = _step8.value;\n          o(_s3) || (_s3.isLeaf ? t(_s3) : this._forEachLeaf(_s3, t));\n        }\n      } catch (err) {\n        _iterator8.e(err);\n      } finally {\n        _iterator8.f();\n      }\n    }\n  }, {\n    key: \"_purge\",\n    value: function _purge(e) {\n      if (!o(e)) if (e.isLeaf) this._remove(e);else for (var _t4 = 0; _t4 < e.children.length; _t4++) {\n        var _s4 = e.children[_t4];\n        this._purge(_s4), e.children[_t4] = null;\n      }\n    }\n  }, {\n    key: \"_collectMissingTiles\",\n    value: function _collectMissingTiles(e, t, s) {\n      var i = new j(s, e, this.extent);\n      return this._collectMissingTilesRecurse(t, i, 1), i.info;\n    }\n  }, {\n    key: \"_collectMissingTilesRecurse\",\n    value: function _collectMissingTilesRecurse(e, t, s) {\n      if (e.isLeaf) return;\n      if (!e.hasChildren) return void t.addMissing(e.level, e.row, e.col, s);\n      var i = s / 2;\n      for (var _r2 = 0; _r2 < e.children.length; _r2++) {\n        var _s5 = e.children[_r2];\n        o(_s5) ? t.addMissing(e.level + 1, (e.row << 1) + ((2 & _r2) >> 1), (e.col << 1) + (1 & _r2), i) : this._collectMissingTilesRecurse(_s5, t, i);\n      }\n    }\n  }, {\n    key: \"_referenceFeature\",\n    value: function _referenceFeature(e) {\n      var t = (this._refCounts.get(e) || 0) + 1;\n      return this._refCounts.set(e, t), 1 === t ? x.ADDED : x.UNCHANGED;\n    }\n  }, {\n    key: \"_unreferenceFeature\",\n    value: function _unreferenceFeature(e) {\n      var t = (this._refCounts.get(e) || 0) - 1;\n      return 0 === t ? (this._refCounts.delete(e), x.REMOVED) : (t > 0 && this._refCounts.set(e, t), x.UNCHANGED);\n    }\n  }, {\n    key: \"test\",\n    get: function get() {\n      var _this7 = this;\n      return {\n        tiles: Array.from(this._tiles.values()).map(function (e) {\n          return \"\".concat(e.data.id, \":[\").concat(Array.from(e.objectIds), \"]\");\n        }),\n        featureReferences: Array.from(this._refCounts.keys()).map(function (e) {\n          return \"\".concat(e, \":\").concat(_this7._refCounts.get(e));\n        })\n      };\n    }\n  }]);\n  return v;\n}(t);\nfunction C(e) {\n  return e.reduce(function (e, t) {\n    return e + E(t);\n  }, 0);\n}\nfunction E(e) {\n  return 32 + S(e.geometry) + i(e.attributes);\n}\nfunction S(e) {\n  if (o(e)) return 0;\n  var t = r(e.lengths, 4);\n  return 32 + r(e.coords, 8) + t;\n}\ne([l({\n  constructOnly: !0\n})], v.prototype, \"featureStore\", void 0), e([l()], v.prototype, \"tileInfo\", void 0), e([l()], v.prototype, \"extent\", void 0), e([l()], v.prototype, \"maximumByteSize\", void 0), v = e([a(\"esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore\")], v);\nvar T = /*#__PURE__*/_createClass(function T(e, t, s) {\n  _classCallCheck(this, T);\n  this.data = e, this.objectIds = t, this.byteSize = s;\n});\nvar F = /*#__PURE__*/function () {\n  function F(e, t, s) {\n    _classCallCheck(this, F);\n    this.level = e, this.row = t, this.col = s, this.isLeaf = !1, this.extent = null, this.children = [null, null, null, null];\n  }\n  _createClass(F, [{\n    key: \"hasChildren\",\n    get: function get() {\n      return !this.isLeaf && (n(this.children[0]) || n(this.children[1]) || n(this.children[2]) || n(this.children[3]));\n    }\n  }]);\n  return F;\n}();\nvar I = /*#__PURE__*/function () {\n  function I(e) {\n    var t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    _classCallCheck(this, I);\n    this.missingTiles = t, this.fullArea = 0, this.coveredArea = 0, this.fullArea = d(e.extent), this.coveredArea = this.fullArea;\n  }\n  _createClass(I, [{\n    key: \"prepend\",\n    value: function prepend(e) {\n      this.missingTiles = e.missingTiles.concat(this.missingTiles), this.coveredArea += e.coveredArea, this.fullArea += e.fullArea;\n    }\n  }]);\n  return I;\n}();\nvar j = /*#__PURE__*/function () {\n  function j(e, t, s) {\n    _classCallCheck(this, j);\n    this._tileInfo = e, this._extent = null, this.info = new I(t), n(s) && (this._extent = u(s));\n  }\n  _createClass(j, [{\n    key: \"addMissing\",\n    value: function addMissing(e, t, s, i) {\n      var r = new m(null, e, t, s);\n      this._tileInfo.updateTileInfo(r, p.ExtrapolateOptions.POWER_OF_TWO), o(r.extent) || n(this._extent) && !h(this._extent, r.extent) || (this.info.missingTiles.push({\n        data: r,\n        resolution: i\n      }), this.info.coveredArea -= d(r.extent));\n    }\n  }]);\n  return j;\n}();\nvar w = .18751;\nvar x;\n!function (e) {\n  e[e.ADDED = 0] = \"ADDED\", e[e.REMOVED = 1] = \"REMOVED\", e[e.UNCHANGED = 2] = \"UNCHANGED\";\n}(x || (x = {}));\nexport { v as FeatureServiceTileStore, I as ProcessResult };","map":{"version":3,"names":["_","e","t","ByteSizeUnit","s","estimateAttributesObjectSize","i","estimateFixedArraySize","r","isNone","o","isSome","n","property","l","subclass","a","create","c","intersects","h","fromExtent","u","area","d","getBoundsOptimizedGeometry","f","BoundsStore","p","TileKey","m","executeQueryForCount","g","FeatureServiceTileCache","y","v","_t","_inherits","_super","_createSuper","_this","_classCallCheck","call","tileInfo","extent","maximumByteSize","MEGABYTES","_tileBounds","_tiles","_refCounts","Map","_tileFeatureCounts","_tmpBoundingRect","_createClass","key","value","add","_this2","_iterator","_createForOfIteratorHelper","_step","done","_referenceFeature","objectId","x","ADDED","push","err","_addTileStorage","Set","map","C","featureStore","addMany","applyByteSizeLimit","_removeTileStorage","destroy","clear","refresh","processEdits","_processEditsDelete","deletedFeatures","concat","updatedFeatures","_processEditsRefetch","addedFeatures","id","set","T","size","_remove","_ref","get","_iterator2","objectIds","_step2","_unreferenceFeature","REMOVED","removeManyById","data","delete","_iterator3","_step3","_step3$value","_slicedToArray","_iterator5","_step5","_iterator4","_step4","_processEditsRefetch2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_this3","_this$featureStore","_iterator6","_step6","_loop","wrap","_callee$","_context2","prev","next","sent","features","hasZ","hasM","_loop$","_context","geometry","forEachInBounds","has","stop","delegateYield","t1","finish","_x","_x2","_x3","apply","arguments","process","length","undefined","I","_createTileTree","_simplify","_collectMissingTiles","_this4","Array","from","values","_ref2","featureCount","getFeatureCount","_this$_tileFeatureCou","_fetchCount","_callee2","_callee2$","_context3","abrupt","count","fetchCount","_x4","_x5","_x6","_x7","_this5","F","level","row","col","updateTileInfo","ExtrapolateOptions","POWER_OF_TWO","_this5$_tiles$get","_tilesAreRelated","_populateChildren","Math","floor","isLeaf","children","_mergeChildren","w","_purge","_this6","_forEachLeaf","byteSize","_iterator7","_step7","_iterator8","_step8","j","_collectMissingTilesRecurse","info","hasChildren","addMissing","UNCHANGED","_this7","tiles","featureReferences","keys","reduce","E","S","attributes","lengths","coords","constructOnly","prototype","missingTiles","fullArea","coveredArea","prepend","_tileInfo","_extent","resolution","FeatureServiceTileStore","ProcessResult"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileStore.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import t from\"../../../../../core/Accessor.js\";import{ByteSizeUnit as s,estimateAttributesObjectSize as i,estimateFixedArraySize as r}from\"../../../../../core/byteSizeEstimations.js\";import{isNone as o,isSome as n}from\"../../../../../core/maybe.js\";import{property as l}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import{subclass as a}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{create as c,intersects as h,fromExtent as u,area as d}from\"../../../../../geometry/support/aaBoundingRect.js\";import{getBoundsOptimizedGeometry as f}from\"../../../../../layers/graphics/featureConversionUtils.js\";import{BoundsStore as _}from\"../../../../../layers/graphics/data/BoundsStore.js\";import p from\"../../../../../layers/support/TileInfo.js\";import{TileKey as m}from\"../../../../../layers/support/TileKey.js\";import{executeQueryForCount as g}from\"../../../../../rest/query/operations/query.js\";import{FeatureServiceTileCache as y}from\"./FeatureServiceTileCache.js\";let v=class extends t{constructor(e){super(e),this.tileInfo=null,this.extent=null,this.maximumByteSize=10*s.MEGABYTES,this._tileBounds=new _,this._tiles=new y,this._refCounts=new Map,this._tileFeatureCounts=new Map,this._tmpBoundingRect=c()}add(e,t){const s=[];for(const i of t)this._referenceFeature(i.objectId)===x.ADDED&&s.push(i);this._addTileStorage(e,new Set(t.map((e=>e.objectId))),C(t)),this.featureStore.addMany(s),this._tiles.applyByteSizeLimit(this.maximumByteSize,(e=>this._removeTileStorage(e)))}destroy(){this.clear(),this._tileFeatureCounts.clear()}clear(){this.featureStore.clear(),this._tileBounds.clear(),this._tiles.clear(),this._refCounts.clear()}refresh(){this.clear(),this._tileFeatureCounts.clear()}processEdits(e,t,s){return this._processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)),this._processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures),t,s)}_addTileStorage(e,t,s){const i=e.id;this._tiles.set(i,new T(e,t,s)),this._tileBounds.set(i,e.extent),this._tileFeatureCounts.set(i,t.size)}_remove({id:e}){const t=this._tiles.get(e);t&&this._removeTileStorage(t)}_removeTileStorage(e){const t=[];for(const i of e.objectIds)this._unreferenceFeature(i)===x.REMOVED&&t.push(i);this.featureStore.removeManyById(t);const s=e.data.id;this._tiles.delete(s),this._tileBounds.delete(s)}_processEditsDelete(e){this.featureStore.removeManyById(e);for(const[,t]of this._tiles){for(const s of e)t.objectIds.delete(s);this._tileFeatureCounts.set(t.data.id,t.objectIds.size)}for(const t of e)this._refCounts.delete(t)}async _processEditsRefetch(e,t,s){const i=(await t(e,s)).features,{hasZ:r,hasM:n}=this.featureStore;for(const l of i){const e=f(this._tmpBoundingRect,l.geometry,r,n);o(e)||this._tileBounds.forEachInBounds(e,(e=>{const t=this._tiles.get(e);this.featureStore.add(l);const s=l.objectId;t.objectIds.has(s)||(t.objectIds.add(s),this._referenceFeature(s),this._tileFeatureCounts.set(t.data.id,t.objectIds.size))}))}}process(e,t=(()=>!0)){if(o(this.tileInfo)||!e.extent||n(this.extent)&&!h(u(this.extent,this._tmpBoundingRect),e.extent))return new I(e);if(this._tiles.has(e.id))return new I(e);const s=this._createTileTree(e,this.tileInfo);return this._simplify(s,t,null,0,1),this._collectMissingTiles(e,s,this.tileInfo)}get debugInfo(){return Array.from(this._tiles.values()).map((({data:e})=>({data:e,featureCount:this._tileFeatureCounts.get(e.id)||0})))}getFeatureCount(e){return this._tileFeatureCounts.get(e.id)??0}async fetchCount(e,t,s,i){const r=this._tileFeatureCounts.get(e.id);if(null!=r)return r;const o=await g(t,s,i);return this._tileFeatureCounts.set(e.id,o.data.count),o.data.count}_createTileTree(e,t){const s=new F(e.level,e.row,e.col);return t.updateTileInfo(s,p.ExtrapolateOptions.POWER_OF_TWO),this._tileBounds.forEachInBounds(e.extent,(i=>{const r=this._tiles.get(i)?.data;r&&this._tilesAreRelated(e,r)&&this._populateChildren(s,r,t,this._tileFeatureCounts.get(r.id)||0)})),s}_tilesAreRelated(e,t){if(!e||!t)return!1;if(e.level===t.level)return e.row===t.row&&e.col===t.col;const s=e.level<t.level,i=s?e:t,r=s?t:e,o=1<<r.level-i.level;return Math.floor(r.row/o)===i.row&&Math.floor(r.col/o)===i.col}_populateChildren(e,t,s,i){const r=t.level-e.level-1;if(r<0)return void(e.isLeaf=!0);const o=t.row>>r,l=t.col>>r,a=e.row<<1,c=l-(e.col<<1)+(o-a<<1),h=e.children[c];if(n(h))this._populateChildren(h,t,s,i);else{const r=new F(e.level+1,o,l);s.updateTileInfo(r,p.ExtrapolateOptions.POWER_OF_TWO),e.children[c]=r,this._populateChildren(r,t,s,i)}}_simplify(e,t,s,i,r){const o=r*r;if(e.isLeaf)return t(this.getFeatureCount(e),r)?0:(this._remove(e),n(s)&&(s.children[i]=null),o);const l=r/2,a=l*l;let c=0;for(let h=0;h<e.children.length;h++){const s=e.children[h];c+=n(s)?this._simplify(s,t,e,h,l):a}return 0===c?this._mergeChildren(e):1-c/o<w&&(this._purge(e),n(s)&&(s.children[i]=null),c=o),c}_mergeChildren(e){const t=new Set;let s=0;this._forEachLeaf(e,(e=>{const i=this._tiles.get(e.id);if(i){s+=i.byteSize;for(const e of i.objectIds)t.has(e)||(t.add(e),this._referenceFeature(e));this._remove(e)}})),this._addTileStorage(e,t,s),e.isLeaf=!0,e.children[0]=e.children[1]=e.children[2]=e.children[3]=null,this._tileFeatureCounts.set(e.id,t.size)}_forEachLeaf(e,t){for(const s of e.children)o(s)||(s.isLeaf?t(s):this._forEachLeaf(s,t))}_purge(e){if(!o(e))if(e.isLeaf)this._remove(e);else for(let t=0;t<e.children.length;t++){const s=e.children[t];this._purge(s),e.children[t]=null}}_collectMissingTiles(e,t,s){const i=new j(s,e,this.extent);return this._collectMissingTilesRecurse(t,i,1),i.info}_collectMissingTilesRecurse(e,t,s){if(e.isLeaf)return;if(!e.hasChildren)return void t.addMissing(e.level,e.row,e.col,s);const i=s/2;for(let r=0;r<e.children.length;r++){const s=e.children[r];o(s)?t.addMissing(e.level+1,(e.row<<1)+((2&r)>>1),(e.col<<1)+(1&r),i):this._collectMissingTilesRecurse(s,t,i)}}_referenceFeature(e){const t=(this._refCounts.get(e)||0)+1;return this._refCounts.set(e,t),1===t?x.ADDED:x.UNCHANGED}_unreferenceFeature(e){const t=(this._refCounts.get(e)||0)-1;return 0===t?(this._refCounts.delete(e),x.REMOVED):(t>0&&this._refCounts.set(e,t),x.UNCHANGED)}get test(){return{tiles:Array.from(this._tiles.values()).map((e=>`${e.data.id}:[${Array.from(e.objectIds)}]`)),featureReferences:Array.from(this._refCounts.keys()).map((e=>`${e}:${this._refCounts.get(e)}`))}}};function C(e){return e.reduce(((e,t)=>e+E(t)),0)}function E(e){return 32+S(e.geometry)+i(e.attributes)}function S(e){if(o(e))return 0;const t=r(e.lengths,4);return 32+r(e.coords,8)+t}e([l({constructOnly:!0})],v.prototype,\"featureStore\",void 0),e([l()],v.prototype,\"tileInfo\",void 0),e([l()],v.prototype,\"extent\",void 0),e([l()],v.prototype,\"maximumByteSize\",void 0),v=e([a(\"esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore\")],v);class T{constructor(e,t,s){this.data=e,this.objectIds=t,this.byteSize=s}}class F{constructor(e,t,s){this.level=e,this.row=t,this.col=s,this.isLeaf=!1,this.extent=null,this.children=[null,null,null,null]}get hasChildren(){return!this.isLeaf&&(n(this.children[0])||n(this.children[1])||n(this.children[2])||n(this.children[3]))}}class I{constructor(e,t=[]){this.missingTiles=t,this.fullArea=0,this.coveredArea=0,this.fullArea=d(e.extent),this.coveredArea=this.fullArea}prepend(e){this.missingTiles=e.missingTiles.concat(this.missingTiles),this.coveredArea+=e.coveredArea,this.fullArea+=e.fullArea}}class j{constructor(e,t,s){this._tileInfo=e,this._extent=null,this.info=new I(t),n(s)&&(this._extent=u(s))}addMissing(e,t,s,i){const r=new m(null,e,t,s);this._tileInfo.updateTileInfo(r,p.ExtrapolateOptions.POWER_OF_TWO),o(r.extent)||n(this._extent)&&!h(this._extent,r.extent)||(this.info.missingTiles.push({data:r,resolution:i}),this.info.coveredArea-=d(r.extent))}}const w=.18751;var x;!function(e){e[e.ADDED=0]=\"ADDED\",e[e.REMOVED=1]=\"REMOVED\",e[e.UNCHANGED=2]=\"UNCHANGED\"}(x||(x={}));export{v as FeatureServiceTileStore,I as ProcessResult};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}