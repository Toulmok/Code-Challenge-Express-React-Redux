{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport { isNone as s } from \"../../../core/maybe.js\";\nimport { property as e } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport r from \"./BaseRasterFunction.js\";\nimport { lookupPixels as u } from \"./pixelUtils.js\";\nimport n from \"./StretchFunctionArguments.js\";\nimport { getStretchCutoff as i, createStretchLUT as a, stretch as p, computeGammaCorrection as c } from \"./stretchUtils.js\";\nlet m = class extends r {\n  constructor() {\n    super(...arguments), this.functionName = \"Stretch\", this.functionArguments = null, this.rasterArgumentNames = [\"raster\"], this.lookup = null, this.cutOffs = null;\n  }\n  _bindSourceRasters() {\n    this.lookup = null, this.cutOffs = null;\n    const t = this.sourceRasterInfos[0],\n      {\n        pixelType: s\n      } = t,\n      {\n        functionArguments: e\n      } = this,\n      {\n        dynamicRangeAdjustment: o,\n        gamma: r,\n        useGamma: u\n      } = e;\n    if (!o && [\"u8\", \"u16\", \"s8\", \"s16\"].includes(s)) {\n      const o = i(e.toJSON(), {\n          rasterInfo: t\n        }),\n        n = this._isOutputRoundingNeeded() ? \"round\" : \"float\";\n      this.lookup = a({\n        pixelType: s,\n        ...o,\n        gamma: u ? r : null,\n        rounding: n\n      }), this.cutOffs = o;\n    } else o || (this.cutOffs = i(e.toJSON(), {\n      rasterInfo: t\n    }));\n    this.outputPixelType = this._getOutputPixelType(s);\n    const n = t.clone();\n    n.pixelType = this.outputPixelType, n.statistics = null, n.histograms = null, n.colormap = null, n.attributeTable = null, \"u8\" === this.outputPixelType && (n.keyProperties.DataType = \"processed\"), this.rasterInfo = n;\n    return {\n      success: !0,\n      supportsGPU: !o\n    };\n  }\n  _processPixels(t) {\n    const e = t.pixelBlocks?.[0];\n    if (s(e)) return e;\n    const {\n      lookup: o\n    } = this;\n    if (o) return u(e, {\n      ...o,\n      outputPixelType: this.rasterInfo.pixelType\n    });\n    const {\n        functionArguments: r\n      } = this,\n      n = this.cutOffs || i(r.toJSON(), {\n        rasterInfo: this.sourceRasterInfos[0],\n        pixelBlock: e\n      }),\n      a = r.useGamma ? r.gamma : null;\n    return p(e, {\n      ...n,\n      gamma: a,\n      outputPixelType: this.outputPixelType\n    });\n  }\n  _getWebGLParameters() {\n    const {\n        outputMin: t = 0,\n        outputMax: s = 255,\n        gamma: e,\n        useGamma: o\n      } = this.functionArguments,\n      r = this.rasterInfo.bandCount >= 2 ? 3 : 1,\n      u = o && e && e.length ? c(r, e) : [1, 1, 1],\n      {\n        minCutOff: n,\n        maxCutOff: i\n      } = this.cutOffs ?? {\n        minCutOff: [0, 0, 0],\n        maxCutOff: [255, 255, 255]\n      };\n    1 === n.length && (n[1] = n[2] = n[0], i[1] = i[2] = i[0]);\n    const a = new Float32Array(r);\n    let p;\n    for (p = 0; p < r; p++) a[p] = (s - t) / (i[p] - n[p]);\n    const m = this._isOutputRoundingNeeded();\n    return {\n      bandCount: r,\n      outMin: t,\n      outMax: s,\n      minCutOff: n,\n      maxCutOff: i,\n      factor: a,\n      useGamma: o,\n      gamma: o && e ? e : [1, 1, 1],\n      gammaCorrection: o && u ? u : [1, 1, 1],\n      stretchType: this.functionArguments.stretchType,\n      isOutputRounded: m,\n      type: \"stretch\"\n    };\n  }\n};\nt([e({\n  json: {\n    write: !0,\n    name: \"rasterFunction\"\n  }\n})], m.prototype, \"functionName\", void 0), t([e({\n  type: n,\n  json: {\n    write: !0,\n    name: \"rasterFunctionArguments\"\n  }\n})], m.prototype, \"functionArguments\", void 0), t([e()], m.prototype, \"rasterArgumentNames\", void 0), t([e({\n  json: {\n    write: !0\n  }\n})], m.prototype, \"lookup\", void 0), t([e({\n  json: {\n    write: !0\n  }\n})], m.prototype, \"cutOffs\", void 0), m = t([o(\"esri.layers.support.rasterFunctions.StretchFunction\")], m);\nconst l = m;\nexport { l as default };","map":{"version":3,"names":["_","t","isNone","s","property","e","subclass","o","r","lookupPixels","u","n","getStretchCutoff","i","createStretchLUT","a","stretch","p","computeGammaCorrection","c","m","constructor","arguments","functionName","functionArguments","rasterArgumentNames","lookup","cutOffs","_bindSourceRasters","sourceRasterInfos","pixelType","dynamicRangeAdjustment","gamma","useGamma","includes","toJSON","rasterInfo","_isOutputRoundingNeeded","rounding","outputPixelType","_getOutputPixelType","clone","statistics","histograms","colormap","attributeTable","keyProperties","DataType","success","supportsGPU","_processPixels","pixelBlocks","pixelBlock","_getWebGLParameters","outputMin","outputMax","bandCount","length","minCutOff","maxCutOff","Float32Array","outMin","outMax","factor","gammaCorrection","stretchType","isOutputRounded","type","json","write","name","prototype","l","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/layers/support/rasterFunctions/StretchFunction.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import{isNone as s}from\"../../../core/maybe.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./BaseRasterFunction.js\";import{lookupPixels as u}from\"./pixelUtils.js\";import n from\"./StretchFunctionArguments.js\";import{getStretchCutoff as i,createStretchLUT as a,stretch as p,computeGammaCorrection as c}from\"./stretchUtils.js\";let m=class extends r{constructor(){super(...arguments),this.functionName=\"Stretch\",this.functionArguments=null,this.rasterArgumentNames=[\"raster\"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const t=this.sourceRasterInfos[0],{pixelType:s}=t,{functionArguments:e}=this,{dynamicRangeAdjustment:o,gamma:r,useGamma:u}=e;if(!o&&[\"u8\",\"u16\",\"s8\",\"s16\"].includes(s)){const o=i(e.toJSON(),{rasterInfo:t}),n=this._isOutputRoundingNeeded()?\"round\":\"float\";this.lookup=a({pixelType:s,...o,gamma:u?r:null,rounding:n}),this.cutOffs=o}else o||(this.cutOffs=i(e.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(s);const n=t.clone();n.pixelType=this.outputPixelType,n.statistics=null,n.histograms=null,n.colormap=null,n.attributeTable=null,\"u8\"===this.outputPixelType&&(n.keyProperties.DataType=\"processed\"),this.rasterInfo=n;return{success:!0,supportsGPU:!o}}_processPixels(t){const e=t.pixelBlocks?.[0];if(s(e))return e;const{lookup:o}=this;if(o)return u(e,{...o,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:r}=this,n=this.cutOffs||i(r.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:e}),a=r.useGamma?r.gamma:null;return p(e,{...n,gamma:a,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const{outputMin:t=0,outputMax:s=255,gamma:e,useGamma:o}=this.functionArguments,r=this.rasterInfo.bandCount>=2?3:1,u=o&&e&&e.length?c(r,e):[1,1,1],{minCutOff:n,maxCutOff:i}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===n.length&&(n[1]=n[2]=n[0],i[1]=i[2]=i[0]);const a=new Float32Array(r);let p;for(p=0;p<r;p++)a[p]=(s-t)/(i[p]-n[p]);const m=this._isOutputRoundingNeeded();return{bandCount:r,outMin:t,outMax:s,minCutOff:n,maxCutOff:i,factor:a,useGamma:o,gamma:o&&e?e:[1,1,1],gammaCorrection:o&&u?u:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:m,type:\"stretch\"}}};t([e({json:{write:!0,name:\"rasterFunction\"}})],m.prototype,\"functionName\",void 0),t([e({type:n,json:{write:!0,name:\"rasterFunctionArguments\"}})],m.prototype,\"functionArguments\",void 0),t([e()],m.prototype,\"rasterArgumentNames\",void 0),t([e({json:{write:!0}})],m.prototype,\"lookup\",void 0),t([e({json:{write:!0}})],m.prototype,\"cutOffs\",void 0),m=t([o(\"esri.layers.support.rasterFunctions.StretchFunction\")],m);const l=m;export{l as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}