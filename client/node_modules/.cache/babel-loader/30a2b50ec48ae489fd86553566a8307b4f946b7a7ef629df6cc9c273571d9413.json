{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as t } from \"../../../../../../core/maybe.js\";\nimport { pt2px as e } from \"../../../../../../core/screenUtils.js\";\nimport { premultiplyAlphaRGBA as s } from \"../../color.js\";\nimport { BITSET_GENERIC_LOCK_COLOR as i, BITSET_FILL_RANDOM_PATTERN_OFFSET as o, BITSET_GENERIC_CONSIDER_ALPHA_ONLY as r, BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR as a, SPRITE_PADDING as l, MIN_MAX_ZOOM_PRECISION_FACTOR as n } from \"../../definitions.js\";\nimport { degToByte as c } from \"../../GeometryUtils.js\";\nimport { i1616to32 as h, i8888to32 as f } from \"../../number.js\";\nimport { FillMaterialKey as m } from \"../../materialKey/MaterialKey.js\";\nimport { isFunction as p, getMinMaxZoom as _ } from \"./util.js\";\nimport y from \"./WGLBaseFillTemplate.js\";\nimport d from \"./WGLDynamicMeshTemplate.js\";\nimport { ok as u } from \"../../util/Result.js\";\nconst M = 128;\nclass g extends y(d) {\n  constructor(l, f, m) {\n    if (super(l), this._minMaxZoom = h(Math.round(f * n), Math.round(m * n)), p(l.color)) {\n      const t = (t, e, i) => {\n        const o = l.color(t, e, i);\n        return o && s(o) || 0;\n      };\n      this._dynamicPropertyMap.set(\"fillColor\", t);\n    } else {\n      const t = l.color;\n      this.fillColor = t && s(t) || 0;\n    }\n    const _ = \"CIMMarkerPlacementInsidePolygon\" === l.cim.placement?.type && l.cim.placement.shiftOddRows ? 2 : 1,\n      y = l.height;\n    if (p(y)) {\n      const t = (t, e, s) => y(t, e, s) * _;\n      this._dynamicPropertyMap.set(\"_height\", t);\n    } else this._height = (y || 0) * _;\n    const d = l.offsetX;\n    if (p(d)) {\n      const t = (t, s, i) => e(d(t, s, i));\n      this._dynamicPropertyMap.set(\"_offsetX\", t);\n    } else this._offsetX = e(d || 0);\n    const u = l.offsetY;\n    if (p(u)) {\n      const t = (t, s, i) => e(-u(t, s, i));\n      this._dynamicPropertyMap.set(\"_offsetY\", t);\n    } else this._offsetY = e(-u || 0);\n    const M = l.scaleX;\n    p(M) ? this._dynamicPropertyMap.set(\"_scaleX\", M) : this._scaleX = M || 1;\n    const g = l.angle;\n    if (p(g)) {\n      const t = (t, e, s) => c(g(t, e, s));\n      this._dynamicPropertyMap.set(\"_angle\", t);\n    } else this._angle = c(g) || 0;\n    if (t(l.effects)) {\n      const t = l.effects;\n      p(t) ? this._dynamicPropertyMap.set(\"_effects\", t) : this._effects = t;\n    }\n    this._cimFillLayer = l, this._bitset = (l.colorLocked ? i : 0) | (l.applyRandomOffset ? o : 0) | (l.sampleAlphaOnly ? r : 0) | (l.hasUnresolvedReplacementColor ? a : 0), this._fillMaterialKey = l.materialKey;\n  }\n  static fromCIMFill(t, e) {\n    const [s, i] = _(t.scaleInfo, e);\n    return new g(t, s, i);\n  }\n  bindFeature(t, s, i) {\n    const o = t.readLegacyFeature();\n    this._dynamicPropertyMap.forEach((t, e) => {\n      this[e] = t(o, s, i);\n    });\n    const r = m.load(this._fillMaterialKey),\n      a = this._materialCache,\n      n = (0, this._cimFillLayer.materialHash)(o, s, i),\n      c = a.get(n);\n    let p = null;\n    if (c && u(c.spriteMosaicItem) && (p = c.spriteMosaicItem), p) {\n      const {\n          rect: t,\n          width: s,\n          height: i\n        } = p,\n        o = t.x + l,\n        a = t.y + l,\n        n = o + s,\n        c = a + i;\n      let m = Math.round(e(this._height));\n      m <= 0 && (m = c - a);\n      let _ = Math.round(e(this._height / i * s || 0));\n      _ <= 0 && (_ = n - o);\n      const y = this._scaleX,\n        d = 1;\n      this.tl = h(o, a), this.br = h(n, c), this.aux21 = h(_, m), this.aux22 = h(this._offsetX, this._offsetY), this.aux3 = f(y * M, d * M, this._angle, 0), r.sdf = p.sdf, r.pattern = !0, r.textureBinding = p.textureBinding;\n    } else this.tl = 0, this.br = 0, this.aux21 = 0, this.aux22 = 0, this.aux3 = 0, r.sdf = !1, r.pattern = !1, r.textureBinding = 0;\n    this._materialKey = r.data;\n  }\n}\nexport { g as default };","map":{"version":3,"names":["isSome","t","pt2px","e","premultiplyAlphaRGBA","s","BITSET_GENERIC_LOCK_COLOR","i","BITSET_FILL_RANDOM_PATTERN_OFFSET","o","BITSET_GENERIC_CONSIDER_ALPHA_ONLY","r","BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR","a","SPRITE_PADDING","l","MIN_MAX_ZOOM_PRECISION_FACTOR","n","degToByte","c","i1616to32","h","i8888to32","f","FillMaterialKey","m","isFunction","p","getMinMaxZoom","_","y","d","ok","u","M","g","constructor","_minMaxZoom","Math","round","color","_dynamicPropertyMap","set","fillColor","cim","placement","type","shiftOddRows","height","_height","offsetX","_offsetX","offsetY","_offsetY","scaleX","_scaleX","angle","_angle","effects","_effects","_cimFillLayer","_bitset","colorLocked","applyRandomOffset","sampleAlphaOnly","hasUnresolvedReplacementColor","_fillMaterialKey","materialKey","fromCIMFill","scaleInfo","bindFeature","readLegacyFeature","forEach","load","_materialCache","materialHash","get","spriteMosaicItem","rect","width","x","tl","br","aux21","aux22","aux3","sdf","pattern","textureBinding","_materialKey","data","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../../../../../../core/maybe.js\";import{pt2px as e}from\"../../../../../../core/screenUtils.js\";import{premultiplyAlphaRGBA as s}from\"../../color.js\";import{BITSET_GENERIC_LOCK_COLOR as i,BITSET_FILL_RANDOM_PATTERN_OFFSET as o,BITSET_GENERIC_CONSIDER_ALPHA_ONLY as r,BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR as a,SPRITE_PADDING as l,MIN_MAX_ZOOM_PRECISION_FACTOR as n}from\"../../definitions.js\";import{degToByte as c}from\"../../GeometryUtils.js\";import{i1616to32 as h,i8888to32 as f}from\"../../number.js\";import{FillMaterialKey as m}from\"../../materialKey/MaterialKey.js\";import{isFunction as p,getMinMaxZoom as _}from\"./util.js\";import y from\"./WGLBaseFillTemplate.js\";import d from\"./WGLDynamicMeshTemplate.js\";import{ok as u}from\"../../util/Result.js\";const M=128;class g extends(y(d)){constructor(l,f,m){if(super(l),this._minMaxZoom=h(Math.round(f*n),Math.round(m*n)),p(l.color)){const t=(t,e,i)=>{const o=l.color(t,e,i);return o&&s(o)||0};this._dynamicPropertyMap.set(\"fillColor\",t)}else{const t=l.color;this.fillColor=t&&s(t)||0}const _=\"CIMMarkerPlacementInsidePolygon\"===l.cim.placement?.type&&l.cim.placement.shiftOddRows?2:1,y=l.height;if(p(y)){const t=(t,e,s)=>y(t,e,s)*_;this._dynamicPropertyMap.set(\"_height\",t)}else this._height=(y||0)*_;const d=l.offsetX;if(p(d)){const t=(t,s,i)=>e(d(t,s,i));this._dynamicPropertyMap.set(\"_offsetX\",t)}else this._offsetX=e(d||0);const u=l.offsetY;if(p(u)){const t=(t,s,i)=>e(-u(t,s,i));this._dynamicPropertyMap.set(\"_offsetY\",t)}else this._offsetY=e(-u||0);const M=l.scaleX;p(M)?this._dynamicPropertyMap.set(\"_scaleX\",M):this._scaleX=M||1;const g=l.angle;if(p(g)){const t=(t,e,s)=>c(g(t,e,s));this._dynamicPropertyMap.set(\"_angle\",t)}else this._angle=c(g)||0;if(t(l.effects)){const t=l.effects;p(t)?this._dynamicPropertyMap.set(\"_effects\",t):this._effects=t}this._cimFillLayer=l,this._bitset=(l.colorLocked?i:0)|(l.applyRandomOffset?o:0)|(l.sampleAlphaOnly?r:0)|(l.hasUnresolvedReplacementColor?a:0),this._fillMaterialKey=l.materialKey}static fromCIMFill(t,e){const[s,i]=_(t.scaleInfo,e);return new g(t,s,i)}bindFeature(t,s,i){const o=t.readLegacyFeature();this._dynamicPropertyMap.forEach(((t,e)=>{this[e]=t(o,s,i)}));const r=m.load(this._fillMaterialKey),a=this._materialCache,n=(0,this._cimFillLayer.materialHash)(o,s,i),c=a.get(n);let p=null;if(c&&u(c.spriteMosaicItem)&&(p=c.spriteMosaicItem),p){const{rect:t,width:s,height:i}=p,o=t.x+l,a=t.y+l,n=o+s,c=a+i;let m=Math.round(e(this._height));m<=0&&(m=c-a);let _=Math.round(e(this._height/i*s||0));_<=0&&(_=n-o);const y=this._scaleX,d=1;this.tl=h(o,a),this.br=h(n,c),this.aux21=h(_,m),this.aux22=h(this._offsetX,this._offsetY),this.aux3=f(y*M,d*M,this._angle,0),r.sdf=p.sdf,r.pattern=!0,r.textureBinding=p.textureBinding}else this.tl=0,this.br=0,this.aux21=0,this.aux22=0,this.aux3=0,r.sdf=!1,r.pattern=!1,r.textureBinding=0;this._materialKey=r.data}}export{g as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}