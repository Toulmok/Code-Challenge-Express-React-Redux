{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { estimateAttributesObjectSize as t, estimateFixedArraySize as r, estimateNumberByteSize as i } from \"../../../../core/byteSizeEstimations.js\";\nimport { HandleOwner as a } from \"../../../../core/HandleOwner.js\";\nimport { makeHandle as s } from \"../../../../core/handleUtils.js\";\nimport o from \"../../../../core/Logger.js\";\nimport { isSome as n, disposeMaybe as l, isNone as p, unwrap as d, applySome as m, mapSome as u } from \"../../../../core/maybe.js\";\nimport { initial as h, sync as c, watch as y } from \"../../../../core/reactiveUtils.js\";\nimport { pt2px as _ } from \"../../../../core/screenUtils.js\";\nimport { property as f } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as g } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { c as F } from \"../../../../chunks/vec3.js\";\nimport { c as R } from \"../../../../chunks/vec3f64.js\";\nimport { projectPointToVector as b } from \"../../../../geometry/projection.js\";\nimport { getResolutionForScale as v } from \"../../../../geometry/support/scaleUtils.js\";\nimport { getObjectId as S } from \"../../../../layers/graphics/dehydratedFeatures.js\";\nimport { convertFromPoint as w } from \"../../../../layers/graphics/featureConversionUtils.js\";\nimport { OptimizedFeature as P } from \"../../../../layers/graphics/OptimizedFeature.js\";\nimport j from \"../../../../layers/graphics/OptimizedGeometry.js\";\nimport T from \"../../../../layers/graphics/data/FeatureStore.js\";\nimport { isNumericField as V } from \"../../../../layers/support/fieldUtils.js\";\nimport { generateGradient as x } from \"../../../../renderers/support/heatmapUtils.js\";\nimport { DrapeSourceType as G } from \"../interfaces.js\";\nimport { FeatureVisibilityFilter as M } from \"./FeatureVisibilityFilter.js\";\nimport { DRAPED_Z as I } from \"../../terrain/OverlayRenderer.js\";\nimport { Attribute as N } from \"../../webgl-engine/lib/Attribute.js\";\nimport { ContentObjectType as O } from \"../../webgl-engine/lib/ContentObjectType.js\";\nimport { DrapedHeatmapRenderer as A } from \"../../webgl-engine/lib/DrapedHeatmapRenderer.js\";\nimport { Geometry as U } from \"../../webgl-engine/lib/Geometry.js\";\nimport { DirtyOperation as C, DirtyState as E } from \"../../webgl-engine/lib/ModelDirtyTypes.js\";\nimport { RenderGeometry as H } from \"../../webgl-engine/lib/RenderGeometry.js\";\nimport { UpdatePolicy as D } from \"../../webgl-engine/lib/UpdatePolicy.js\";\nimport { VertexAttribute as L } from \"../../webgl-engine/lib/VertexAttribute.js\";\nimport { HeatmapDensityMaterial as W } from \"../../webgl-engine/materials/HeatmapDensityMaterial.js\";\nimport { scaleBoundsPredicate as B, isScaleRangeActive as Z } from \"../../../support/layerViewUtils.js\";\nimport { PixelType as z, PixelFormat as $ } from \"../../../webgl/enums.js\";\nimport { loadHeatmapTextureConfiguration as k } from \"../../../webgl/heatmapTextureUtils.js\";\nconst q = \"esri.views.3d.layers.support.HeatmapFeatureProcessor\",\n  Y = o.getLogger(q),\n  J = 112;\nlet K = class extends a {\n  constructor(e) {\n    super(e), this.type = \"heatmap\", this.preferredUpdatePolicy = D.ASYNC, this.dataExtent = null, this.drapeSourceType = G.Features, this._renderGeometries = new Map(), this._fieldTotal = 0, this._drapeSourceRenderer = null, this._dataType = z.HALF_FLOAT, this._pixelFormat = $.RGBA, this.initializePromise = Promise.resolve();\n  }\n  initialize() {\n    this._featureStore = new T({\n      geometryType: \"esriGeometryPoint\",\n      hasZ: this.hasZ,\n      hasM: this.hasM\n    });\n    const {\n      dataType: e,\n      samplingMode: t,\n      pixelFormat: r,\n      internalFormat: i\n    } = k(this._renderView.renderingContext, Y);\n    this._dataType = e, this._pixelFormat = r;\n    const a = e !== z.FLOAT;\n    this._drapeSourceRenderer = this.view.basemapTerrain.overlayManager.registerDrapeSource(this, A, {\n      ...this._rendererParameters,\n      dataType: e,\n      samplingMode: t,\n      pixelFormat: r,\n      internalFormat: i\n    }), this._material = new W({\n      usesHalfFloats: a\n    }), this._materialWithField = new W({\n      usesHalfFloats: a,\n      isAttributeDriven: !0\n    }), this._filterVisibility = new M({\n      context: {\n        layerView: this.owner,\n        featureStore: this.featureStore,\n        getFeatureCount: () => this._loadedPointGraphics.length,\n        setAllFeaturesVisibility: e => this._setAllFeaturesVisibility(e),\n        clearFeaturesVisibility: () => this._setAllFeaturesVisibility(!0),\n        updateFeatureVisibilities: e => this._updateFeatureVisibilities(e)\n      }\n    }), this.updatingHandles.addOnCollectionChange(() => this._loadedPointGraphics, e => this._onLoadedFeaturesChange(e), h), this.updatingHandles.addWhen(() => this._materialParameters, e => this._forEachMaterial(t => t.setParameters(e)), h), this.updatingHandles.add(() => this._rendererParameters, e => this._drapeSourceRenderer.set(e)), this.updatingHandles.add(() => this._heatmapRendererField, () => {\n      this._recreate();\n    }, c), this.updatingHandles.add(() => ({\n      fieldName: this._heatmapRendererFieldName,\n      numeric: this._heatmapRendererFieldIsNumeric\n    }), _ref => {\n      let {\n        fieldName: e,\n        numeric: t\n      } = _ref;\n      if (n(e) && t) {\n        let t = 0;\n        this._featureStore.forEach(r => t += r.attributes[e] ?? 0), this._fieldTotal = t;\n      } else this._fieldTotal = this._featureStore.numFeatures;\n    }, h), this.handles.add([y(() => ({\n      fieldName: this._heatmapRendererFieldName,\n      field: this._heatmapRendererField\n    }), _ref2 => {\n      let {\n        fieldName: e,\n        field: t\n      } = _ref2;\n      e && !t && Y.warn(`Heatmap renderer field '${e}' for layer '${this.layer.title ?? this.layer.id}' not found`);\n    }), y(() => ({\n      field: this._heatmapRendererField,\n      numeric: this._heatmapRendererFieldIsNumeric\n    }), _ref3 => {\n      let {\n        field: e,\n        numeric: t\n      } = _ref3;\n      n(e) && !t && Y.warn(`Heatmap renderer field '${e.name}' for layer '${this.layer.title ?? this.layer.id}' does not contain numeric values and cannot be used to drive the heatmap density`);\n    }), s(() => this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this))]);\n  }\n  destroy() {\n    this._renderGeometries.clear(), this._material = l(this._material), this._materialWithField = l(this._materialWithField), this._featureStore.clear(), this._featureStore = null;\n  }\n  get layer() {\n    return this.owner.layer;\n  }\n  get featureStore() {\n    return this._featureStore;\n  }\n  get updating() {\n    return this.updatingHandles.updating || this.filterVisibility.updating;\n  }\n  get updatingRemaining() {\n    return 0;\n  }\n  get suspendInfo() {\n    return {};\n  }\n  get legendEnabled() {\n    return !0;\n  }\n  get filterVisibility() {\n    return this._filterVisibility;\n  }\n  get displayFeatureLimit() {\n    const e = this.owner?.view?.resourceController?.memoryController?.memoryFactor ?? 1,\n      t = this.owner?.view?.qualitySettings,\n      r = t ? Math.ceil(t.heatmap.maxTotalNumberOfFeatures * e) : 0;\n    return {\n      minimumTotalNumberOfFeatures: 0,\n      maximumTotalNumberOfFeatures: r,\n      maximumTotalNumberOfPrimitives: r * 2,\n      maximumNumberOfFeatures: r\n    };\n  }\n  get hasZ() {\n    return \"hasZ\" in this.layer && this.layer.hasZ;\n  }\n  get hasM() {\n    return \"hasM\" in this.layer && this.layer.hasM;\n  }\n  get view() {\n    return this.owner.view;\n  }\n  get fullOpacity() {\n    return this.owner.fullOpacity;\n  }\n  get updatePolicy() {\n    return this.owner.updatePolicy;\n  }\n  get scaleVisibilitySuspended() {\n    if (!this._isScaleRangeActive) return !1;\n    const {\n        minScale: e,\n        maxScale: t\n      } = this.layer.effectiveScaleRange,\n      {\n        scale: r\n      } = this.view;\n    return !B(r, e ?? 0, t ?? 0);\n  }\n  get usedMemory() {\n    const e = this.usedMemoryPerFeature * this._featureStore.numFeatures,\n      t = this._pixelFormat === $.RED ? 1 : 4,\n      r = this._dataType === z.FLOAT ? 4 : 2,\n      i = Math.ceil((this._overlayRenderer?.overlays[0]?.resolution ?? 0) * this._densityMapPixelRatio) ?? 0;\n    return i * i * t * r + e;\n  }\n  get usedMemoryPerFeature() {\n    const e = this._loadedPointGraphics.find(() => !0);\n    if (p(e)) return 0;\n    const a = t(e),\n      s = i(),\n      o = 6;\n    return o * r([0, 0, 0], s) + o * r([0, 0], s) + (this._heatmapRendererFieldIsNumeric ? o * s : 0) + a;\n  }\n  get loadedFeatures() {\n    return this._featureStore.numFeatures;\n  }\n  get unprocessedMemoryEstimate() {\n    return 0;\n  }\n  get performanceInfo() {\n    return {\n      core: {\n        visible: this._visibleFeatures,\n        missing: 0,\n        pending: 0\n      },\n      elevationUpdating: !1,\n      visibilityFrustum: !0,\n      visibilityScale: !0\n    };\n  }\n  get renderer() {\n    return this._heatmapRenderer;\n  }\n  get _overlayRenderer() {\n    return this.view.basemapTerrain.overlayManager.renderer;\n  }\n  get _overlaySpatialReference() {\n    return d(this._overlayRenderer.spatialReference);\n  }\n  get _rendererParameters() {\n    return {\n      ...this._radiusParameter,\n      ...this._densityParameters,\n      ...this._colorRampParameter,\n      ...this._pixelRatioParameter\n    };\n  }\n  get _materialParameters() {\n    return {\n      ...this._radiusParameter,\n      ...this._resolutionForScaleParameter\n    };\n  }\n  get _densityParameters() {\n    const e = this._heatmapRenderer;\n    if (p(e)) return null;\n    const {\n      minDensity: t,\n      maxDensity: r\n    } = e;\n    return {\n      minDensity: t,\n      maxDensity: r,\n      fieldTotal: this._fieldTotal\n    };\n  }\n  get _radiusParameter() {\n    return m(this._heatmapRenderer, _ref4 => {\n      let {\n        radius: e\n      } = _ref4;\n      return {\n        searchRadius: _(this._clampSearchRadius(e))\n      };\n    });\n  }\n  get _resolutionForScaleParameter() {\n    return m(this._heatmapRenderer, _ref5 => {\n      let {\n        referenceScale: e\n      } = _ref5;\n      return {\n        resolutionForScale: 0 === e ? 0 : v(e, this.view.spatialReference)\n      };\n    });\n  }\n  get _colorRampParameter() {\n    return m(this._heatmapRenderer, e => ({\n      colorRampData: x(e.colorStops)\n    }));\n  }\n  get _pixelRatioParameter() {\n    return {\n      pixelRatio: this._densityMapPixelRatio\n    };\n  }\n  get _densityMapPixelRatio() {\n    const e = this.owner?.view?.resourceController?.memoryController?.memoryFactor ?? 1;\n    return (this.owner?.view?.qualitySettings.heatmap.pixelRatio ?? 1) * Math.sqrt(e);\n  }\n  get _renderView() {\n    return this.view._stage.renderView;\n  }\n  get _featuresArePoints() {\n    return \"point\" === this.layer.geometryType;\n  }\n  get _loadedPointGraphics() {\n    return this.owner.loadedGraphics;\n  }\n  get _heatmapRenderer() {\n    const e = this.layer.renderer;\n    return \"heatmap\" === e?.type ? e : null;\n  }\n  get _heatmapRendererFieldName() {\n    return m(this._heatmapRenderer, e => e.field);\n  }\n  get _heatmapRendererField() {\n    return m(this._heatmapRendererFieldName, e => this.layer.fieldsIndex.get(e));\n  }\n  get _heatmapRendererFieldIsNumeric() {\n    const e = this._heatmapRendererField;\n    return !p(e) && V(e);\n  }\n  get _isScaleRangeActive() {\n    const {\n      layer: e\n    } = this;\n    if (!(\"effectiveScaleRange\" in e)) return !1;\n    const {\n      minScale: t,\n      maxScale: r\n    } = e.effectiveScaleRange;\n    return Z(t, r);\n  }\n  get _visibleFeatures() {\n    let e = 0;\n    return this._renderGeometries.forEach(t => {\n      t.visible && ++e;\n    }), e;\n  }\n  async whenGraphicBounds() {\n    return null;\n  }\n  computeAttachmentOrigin() {\n    return null;\n  }\n  highlight() {\n    return Q;\n  }\n  maskOccludee() {\n    return Q;\n  }\n  setObjectIdVisibility() {}\n  refreshFilter() {\n    this.filterVisibility.reapply();\n  }\n  _onLoadedFeaturesChange(e) {\n    if (!this._featuresArePoints) return;\n    const {\n      objectIdField: t\n    } = this.layer;\n    this._featureStore.removeManyById(e.removed.map(e => S(e, t))), this._featureStore.addMany(e.added.map(e => {\n      const r = new P(w(new j(), e.geometry), e.attributes, m(e.centroid, e => w(new j(), e)), S(e, t));\n      return r.displayId = e.uid, r;\n    }));\n    const r = e.added,\n      i = e.removed;\n    this._fieldTotal += this._computeFieldTotalChange(r, i);\n    const a = u(i, _ref6 => {\n        let {\n          uid: e\n        } = _ref6;\n        const t = this._renderGeometries.get(e);\n        return this._renderGeometries.delete(e), t;\n      }),\n      s = r.map(e => {\n        const t = this._pointGraphicToRenderGeometry(e);\n        return this._renderGeometries.set(e.uid, t), t;\n      });\n    a.length > 0 && this._drapeSourceRenderer.removeGeometries(a, C.REMOVE), s.length > 0 && this._drapeSourceRenderer.addGeometries(s, C.ADD), (s.length > 0 || a.length > 0) && (this.filterVisibility.reapply(), this._renderView.requestRender());\n  }\n  _recreate() {\n    if (!this._loadedPointGraphics) return;\n    const e = this._loadedPointGraphics.toArray();\n    this._onLoadedFeaturesChange({\n      added: e,\n      removed: e\n    });\n  }\n  _pointGraphicToRenderGeometry(e) {\n    const t = this._heatmapRendererFieldName,\n      r = n(t) ? this._materialWithField : this._material,\n      i = R();\n    b(e.geometry, i, this._overlaySpatialReference), i[2] = I;\n    const a = [[L.POSITION, new N(i, i.length)]],\n      s = this._heatmapRendererFieldIsNumeric;\n    n(t) && a.push([L.FEATUREATTRIBUTE, new N([s ? e.attributes[t] ?? 0 : 0], 1)]);\n    const o = new H(new U(r, a, null, null, O.Point), {\n      layerUid: this.layer.uid,\n      graphicUid: e.uid\n    });\n    return F(o.boundingSphere, i), o.visible = this.filterVisibility.defaultVisibility, o;\n  }\n  _forEachMaterial(e) {\n    e(this._material), e(this._materialWithField);\n  }\n  _computeFieldTotalChange(e, t) {\n    if (p(this._heatmapRendererFieldName) || !this._heatmapRendererFieldIsNumeric) return e.length - t.length;\n    const r = this._heatmapRendererFieldName,\n      i = (e, t) => e + (t.attributes[r] ?? 0);\n    return e.reduce(i, 0) - t.reduce(i, 0);\n  }\n  _clampSearchRadius(e) {\n    return e > J && Y.warnOnce(`SceneView supports a maximum radius of ${J} pt for HeatmapRenderer.`), Math.min(e, J);\n  }\n  _updateFeatureVisibilities(e) {\n    const t = [];\n    this._featureStore.forEach(_ref7 => {\n      let {\n        objectId: r,\n        displayId: i\n      } = _ref7;\n      const a = e(r),\n        s = this._renderGeometries.get(i);\n      s && s.visible !== a && (t.push(s), s.visible = a);\n    }), this._drapeSourceRenderer.modifyGeometries(t, E.VISIBILITY);\n  }\n  _setAllFeaturesVisibility(e) {\n    const t = [];\n    for (const r of this._renderGeometries.values()) r.visible !== e && (t.push(r), r.visible = e);\n    this._drapeSourceRenderer.modifyGeometries(t, E.VISIBILITY);\n  }\n  get test() {\n    return {\n      visibleFeatureCount: this._visibleFeatures\n    };\n  }\n};\ne([f()], K.prototype, \"type\", void 0), e([f({\n  constructOnly: !0\n})], K.prototype, \"owner\", void 0), e([f()], K.prototype, \"layer\", null), e([f()], K.prototype, \"featureStore\", null), e([f()], K.prototype, \"updating\", null), e([f()], K.prototype, \"updatingRemaining\", null), e([f()], K.prototype, \"suspendInfo\", null), e([f()], K.prototype, \"legendEnabled\", null), e([f()], K.prototype, \"filterVisibility\", null), e([f()], K.prototype, \"displayFeatureLimit\", null), e([f()], K.prototype, \"preferredUpdatePolicy\", void 0), e([f()], K.prototype, \"hasZ\", null), e([f()], K.prototype, \"hasM\", null), e([f()], K.prototype, \"dataExtent\", void 0), e([f()], K.prototype, \"view\", null), e([f()], K.prototype, \"fullOpacity\", null), e([f()], K.prototype, \"updatePolicy\", null), e([f()], K.prototype, \"drapeSourceType\", void 0), e([f()], K.prototype, \"scaleVisibilitySuspended\", null), e([f()], K.prototype, \"renderer\", null), e([f()], K.prototype, \"_featureStore\", void 0), e([f()], K.prototype, \"_filterVisibility\", void 0), e([f()], K.prototype, \"_overlayRenderer\", null), e([f()], K.prototype, \"_overlaySpatialReference\", null), e([f()], K.prototype, \"_rendererParameters\", null), e([f()], K.prototype, \"_materialParameters\", null), e([f()], K.prototype, \"_densityParameters\", null), e([f()], K.prototype, \"_radiusParameter\", null), e([f()], K.prototype, \"_resolutionForScaleParameter\", null), e([f()], K.prototype, \"_colorRampParameter\", null), e([f()], K.prototype, \"_pixelRatioParameter\", null), e([f()], K.prototype, \"_densityMapPixelRatio\", null), e([f()], K.prototype, \"_renderGeometries\", void 0), e([f()], K.prototype, \"_material\", void 0), e([f()], K.prototype, \"_materialWithField\", void 0), e([f()], K.prototype, \"_renderView\", null), e([f()], K.prototype, \"_featuresArePoints\", null), e([f()], K.prototype, \"_loadedPointGraphics\", null), e([f()], K.prototype, \"_heatmapRenderer\", null), e([f()], K.prototype, \"_heatmapRendererFieldName\", null), e([f()], K.prototype, \"_heatmapRendererField\", null), e([f()], K.prototype, \"_heatmapRendererFieldIsNumeric\", null), e([f()], K.prototype, \"_fieldTotal\", void 0), e([f()], K.prototype, \"_drapeSourceRenderer\", void 0), e([f()], K.prototype, \"_isScaleRangeActive\", null), K = e([g(q)], K);\nconst Q = s();\nexport { K as HeatmapFeatureProcessor, J as MAX_RADIUS_PT };","map":{"version":3,"names":["_","e","estimateAttributesObjectSize","t","estimateFixedArraySize","r","estimateNumberByteSize","i","HandleOwner","a","makeHandle","s","o","isSome","n","disposeMaybe","l","isNone","p","unwrap","d","applySome","m","mapSome","u","initial","h","sync","c","watch","y","pt2px","property","f","subclass","g","F","R","projectPointToVector","b","getResolutionForScale","v","getObjectId","S","convertFromPoint","w","OptimizedFeature","P","j","T","isNumericField","V","generateGradient","x","DrapeSourceType","G","FeatureVisibilityFilter","M","DRAPED_Z","I","Attribute","N","ContentObjectType","O","DrapedHeatmapRenderer","A","Geometry","U","DirtyOperation","C","DirtyState","E","RenderGeometry","H","UpdatePolicy","D","VertexAttribute","L","HeatmapDensityMaterial","W","scaleBoundsPredicate","B","isScaleRangeActive","Z","PixelType","z","PixelFormat","$","loadHeatmapTextureConfiguration","k","q","Y","getLogger","J","K","constructor","type","preferredUpdatePolicy","ASYNC","dataExtent","drapeSourceType","Features","_renderGeometries","Map","_fieldTotal","_drapeSourceRenderer","_dataType","HALF_FLOAT","_pixelFormat","RGBA","initializePromise","Promise","resolve","initialize","_featureStore","geometryType","hasZ","hasM","dataType","samplingMode","pixelFormat","internalFormat","_renderView","renderingContext","FLOAT","view","basemapTerrain","overlayManager","registerDrapeSource","_rendererParameters","_material","usesHalfFloats","_materialWithField","isAttributeDriven","_filterVisibility","context","layerView","owner","featureStore","getFeatureCount","_loadedPointGraphics","length","setAllFeaturesVisibility","_setAllFeaturesVisibility","clearFeaturesVisibility","updateFeatureVisibilities","_updateFeatureVisibilities","updatingHandles","addOnCollectionChange","_onLoadedFeaturesChange","addWhen","_materialParameters","_forEachMaterial","setParameters","add","set","_heatmapRendererField","_recreate","fieldName","_heatmapRendererFieldName","numeric","_heatmapRendererFieldIsNumeric","_ref","forEach","attributes","numFeatures","handles","field","_ref2","warn","layer","title","id","_ref3","name","unregisterDrapeSource","destroy","clear","updating","filterVisibility","updatingRemaining","suspendInfo","legendEnabled","displayFeatureLimit","resourceController","memoryController","memoryFactor","qualitySettings","Math","ceil","heatmap","maxTotalNumberOfFeatures","minimumTotalNumberOfFeatures","maximumTotalNumberOfFeatures","maximumTotalNumberOfPrimitives","maximumNumberOfFeatures","fullOpacity","updatePolicy","scaleVisibilitySuspended","_isScaleRangeActive","minScale","maxScale","effectiveScaleRange","scale","usedMemory","usedMemoryPerFeature","RED","_overlayRenderer","overlays","resolution","_densityMapPixelRatio","find","loadedFeatures","unprocessedMemoryEstimate","performanceInfo","core","visible","_visibleFeatures","missing","pending","elevationUpdating","visibilityFrustum","visibilityScale","renderer","_heatmapRenderer","_overlaySpatialReference","spatialReference","_radiusParameter","_densityParameters","_colorRampParameter","_pixelRatioParameter","_resolutionForScaleParameter","minDensity","maxDensity","fieldTotal","_ref4","radius","searchRadius","_clampSearchRadius","_ref5","referenceScale","resolutionForScale","colorRampData","colorStops","pixelRatio","sqrt","_stage","renderView","_featuresArePoints","loadedGraphics","fieldsIndex","get","whenGraphicBounds","computeAttachmentOrigin","highlight","Q","maskOccludee","setObjectIdVisibility","refreshFilter","reapply","objectIdField","removeManyById","removed","map","addMany","added","geometry","centroid","displayId","uid","_computeFieldTotalChange","_ref6","delete","_pointGraphicToRenderGeometry","removeGeometries","REMOVE","addGeometries","ADD","requestRender","toArray","POSITION","push","FEATUREATTRIBUTE","Point","layerUid","graphicUid","boundingSphere","defaultVisibility","reduce","warnOnce","min","_ref7","objectId","modifyGeometries","VISIBILITY","values","test","visibleFeatureCount","prototype","constructOnly","HeatmapFeatureProcessor","MAX_RADIUS_PT"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/support/HeatmapFeatureProcessor.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{estimateAttributesObjectSize as t,estimateFixedArraySize as r,estimateNumberByteSize as i}from\"../../../../core/byteSizeEstimations.js\";import{HandleOwner as a}from\"../../../../core/HandleOwner.js\";import{makeHandle as s}from\"../../../../core/handleUtils.js\";import o from\"../../../../core/Logger.js\";import{isSome as n,disposeMaybe as l,isNone as p,unwrap as d,applySome as m,mapSome as u}from\"../../../../core/maybe.js\";import{initial as h,sync as c,watch as y}from\"../../../../core/reactiveUtils.js\";import{pt2px as _}from\"../../../../core/screenUtils.js\";import{property as f}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as g}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{c as F}from\"../../../../chunks/vec3.js\";import{c as R}from\"../../../../chunks/vec3f64.js\";import{projectPointToVector as b}from\"../../../../geometry/projection.js\";import{getResolutionForScale as v}from\"../../../../geometry/support/scaleUtils.js\";import{getObjectId as S}from\"../../../../layers/graphics/dehydratedFeatures.js\";import{convertFromPoint as w}from\"../../../../layers/graphics/featureConversionUtils.js\";import{OptimizedFeature as P}from\"../../../../layers/graphics/OptimizedFeature.js\";import j from\"../../../../layers/graphics/OptimizedGeometry.js\";import T from\"../../../../layers/graphics/data/FeatureStore.js\";import{isNumericField as V}from\"../../../../layers/support/fieldUtils.js\";import{generateGradient as x}from\"../../../../renderers/support/heatmapUtils.js\";import{DrapeSourceType as G}from\"../interfaces.js\";import{FeatureVisibilityFilter as M}from\"./FeatureVisibilityFilter.js\";import{DRAPED_Z as I}from\"../../terrain/OverlayRenderer.js\";import{Attribute as N}from\"../../webgl-engine/lib/Attribute.js\";import{ContentObjectType as O}from\"../../webgl-engine/lib/ContentObjectType.js\";import{DrapedHeatmapRenderer as A}from\"../../webgl-engine/lib/DrapedHeatmapRenderer.js\";import{Geometry as U}from\"../../webgl-engine/lib/Geometry.js\";import{DirtyOperation as C,DirtyState as E}from\"../../webgl-engine/lib/ModelDirtyTypes.js\";import{RenderGeometry as H}from\"../../webgl-engine/lib/RenderGeometry.js\";import{UpdatePolicy as D}from\"../../webgl-engine/lib/UpdatePolicy.js\";import{VertexAttribute as L}from\"../../webgl-engine/lib/VertexAttribute.js\";import{HeatmapDensityMaterial as W}from\"../../webgl-engine/materials/HeatmapDensityMaterial.js\";import{scaleBoundsPredicate as B,isScaleRangeActive as Z}from\"../../../support/layerViewUtils.js\";import{PixelType as z,PixelFormat as $}from\"../../../webgl/enums.js\";import{loadHeatmapTextureConfiguration as k}from\"../../../webgl/heatmapTextureUtils.js\";const q=\"esri.views.3d.layers.support.HeatmapFeatureProcessor\",Y=o.getLogger(q),J=112;let K=class extends a{constructor(e){super(e),this.type=\"heatmap\",this.preferredUpdatePolicy=D.ASYNC,this.dataExtent=null,this.drapeSourceType=G.Features,this._renderGeometries=new Map,this._fieldTotal=0,this._drapeSourceRenderer=null,this._dataType=z.HALF_FLOAT,this._pixelFormat=$.RGBA,this.initializePromise=Promise.resolve()}initialize(){this._featureStore=new T({geometryType:\"esriGeometryPoint\",hasZ:this.hasZ,hasM:this.hasM});const{dataType:e,samplingMode:t,pixelFormat:r,internalFormat:i}=k(this._renderView.renderingContext,Y);this._dataType=e,this._pixelFormat=r;const a=e!==z.FLOAT;this._drapeSourceRenderer=this.view.basemapTerrain.overlayManager.registerDrapeSource(this,A,{...this._rendererParameters,dataType:e,samplingMode:t,pixelFormat:r,internalFormat:i}),this._material=new W({usesHalfFloats:a}),this._materialWithField=new W({usesHalfFloats:a,isAttributeDriven:!0}),this._filterVisibility=new M({context:{layerView:this.owner,featureStore:this.featureStore,getFeatureCount:()=>this._loadedPointGraphics.length,setAllFeaturesVisibility:e=>this._setAllFeaturesVisibility(e),clearFeaturesVisibility:()=>this._setAllFeaturesVisibility(!0),updateFeatureVisibilities:e=>this._updateFeatureVisibilities(e)}}),this.updatingHandles.addOnCollectionChange((()=>this._loadedPointGraphics),(e=>this._onLoadedFeaturesChange(e)),h),this.updatingHandles.addWhen((()=>this._materialParameters),(e=>this._forEachMaterial((t=>t.setParameters(e)))),h),this.updatingHandles.add((()=>this._rendererParameters),(e=>this._drapeSourceRenderer.set(e))),this.updatingHandles.add((()=>this._heatmapRendererField),(()=>{this._recreate()}),c),this.updatingHandles.add((()=>({fieldName:this._heatmapRendererFieldName,numeric:this._heatmapRendererFieldIsNumeric})),(({fieldName:e,numeric:t})=>{if(n(e)&&t){let t=0;this._featureStore.forEach((r=>t+=r.attributes[e]??0)),this._fieldTotal=t}else this._fieldTotal=this._featureStore.numFeatures}),h),this.handles.add([y((()=>({fieldName:this._heatmapRendererFieldName,field:this._heatmapRendererField})),(({fieldName:e,field:t})=>{e&&!t&&Y.warn(`Heatmap renderer field '${e}' for layer '${this.layer.title??this.layer.id}' not found`)})),y((()=>({field:this._heatmapRendererField,numeric:this._heatmapRendererFieldIsNumeric})),(({field:e,numeric:t})=>{n(e)&&!t&&Y.warn(`Heatmap renderer field '${e.name}' for layer '${this.layer.title??this.layer.id}' does not contain numeric values and cannot be used to drive the heatmap density`)})),s((()=>this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this)))])}destroy(){this._renderGeometries.clear(),this._material=l(this._material),this._materialWithField=l(this._materialWithField),this._featureStore.clear(),this._featureStore=null}get layer(){return this.owner.layer}get featureStore(){return this._featureStore}get updating(){return this.updatingHandles.updating||this.filterVisibility.updating}get updatingRemaining(){return 0}get suspendInfo(){return{}}get legendEnabled(){return!0}get filterVisibility(){return this._filterVisibility}get displayFeatureLimit(){const e=this.owner?.view?.resourceController?.memoryController?.memoryFactor??1,t=this.owner?.view?.qualitySettings,r=t?Math.ceil(t.heatmap.maxTotalNumberOfFeatures*e):0;return{minimumTotalNumberOfFeatures:0,maximumTotalNumberOfFeatures:r,maximumTotalNumberOfPrimitives:r*2,maximumNumberOfFeatures:r}}get hasZ(){return\"hasZ\"in this.layer&&this.layer.hasZ}get hasM(){return\"hasM\"in this.layer&&this.layer.hasM}get view(){return this.owner.view}get fullOpacity(){return this.owner.fullOpacity}get updatePolicy(){return this.owner.updatePolicy}get scaleVisibilitySuspended(){if(!this._isScaleRangeActive)return!1;const{minScale:e,maxScale:t}=this.layer.effectiveScaleRange,{scale:r}=this.view;return!B(r,e??0,t??0)}get usedMemory(){const e=this.usedMemoryPerFeature*this._featureStore.numFeatures,t=this._pixelFormat===$.RED?1:4,r=this._dataType===z.FLOAT?4:2,i=Math.ceil((this._overlayRenderer?.overlays[0]?.resolution??0)*this._densityMapPixelRatio)??0;return i*i*t*r+e}get usedMemoryPerFeature(){const e=this._loadedPointGraphics.find((()=>!0));if(p(e))return 0;const a=t(e),s=i(),o=6;return o*r([0,0,0],s)+o*r([0,0],s)+(this._heatmapRendererFieldIsNumeric?o*s:0)+a}get loadedFeatures(){return this._featureStore.numFeatures}get unprocessedMemoryEstimate(){return 0}get performanceInfo(){return{core:{visible:this._visibleFeatures,missing:0,pending:0},elevationUpdating:!1,visibilityFrustum:!0,visibilityScale:!0}}get renderer(){return this._heatmapRenderer}get _overlayRenderer(){return this.view.basemapTerrain.overlayManager.renderer}get _overlaySpatialReference(){return d(this._overlayRenderer.spatialReference)}get _rendererParameters(){return{...this._radiusParameter,...this._densityParameters,...this._colorRampParameter,...this._pixelRatioParameter}}get _materialParameters(){return{...this._radiusParameter,...this._resolutionForScaleParameter}}get _densityParameters(){const e=this._heatmapRenderer;if(p(e))return null;const{minDensity:t,maxDensity:r}=e;return{minDensity:t,maxDensity:r,fieldTotal:this._fieldTotal}}get _radiusParameter(){return m(this._heatmapRenderer,(({radius:e})=>({searchRadius:_(this._clampSearchRadius(e))})))}get _resolutionForScaleParameter(){return m(this._heatmapRenderer,(({referenceScale:e})=>({resolutionForScale:0===e?0:v(e,this.view.spatialReference)})))}get _colorRampParameter(){return m(this._heatmapRenderer,(e=>({colorRampData:x(e.colorStops)})))}get _pixelRatioParameter(){return{pixelRatio:this._densityMapPixelRatio}}get _densityMapPixelRatio(){const e=this.owner?.view?.resourceController?.memoryController?.memoryFactor??1;return(this.owner?.view?.qualitySettings.heatmap.pixelRatio??1)*Math.sqrt(e)}get _renderView(){return this.view._stage.renderView}get _featuresArePoints(){return\"point\"===this.layer.geometryType}get _loadedPointGraphics(){return this.owner.loadedGraphics}get _heatmapRenderer(){const e=this.layer.renderer;return\"heatmap\"===e?.type?e:null}get _heatmapRendererFieldName(){return m(this._heatmapRenderer,(e=>e.field))}get _heatmapRendererField(){return m(this._heatmapRendererFieldName,(e=>this.layer.fieldsIndex.get(e)))}get _heatmapRendererFieldIsNumeric(){const e=this._heatmapRendererField;return!p(e)&&V(e)}get _isScaleRangeActive(){const{layer:e}=this;if(!(\"effectiveScaleRange\"in e))return!1;const{minScale:t,maxScale:r}=e.effectiveScaleRange;return Z(t,r)}get _visibleFeatures(){let e=0;return this._renderGeometries.forEach((t=>{t.visible&&++e})),e}async whenGraphicBounds(){return null}computeAttachmentOrigin(){return null}highlight(){return Q}maskOccludee(){return Q}setObjectIdVisibility(){}refreshFilter(){this.filterVisibility.reapply()}_onLoadedFeaturesChange(e){if(!this._featuresArePoints)return;const{objectIdField:t}=this.layer;this._featureStore.removeManyById(e.removed.map((e=>S(e,t)))),this._featureStore.addMany(e.added.map((e=>{const r=new P(w(new j,e.geometry),e.attributes,m(e.centroid,(e=>w(new j,e))),S(e,t));return r.displayId=e.uid,r})));const r=e.added,i=e.removed;this._fieldTotal+=this._computeFieldTotalChange(r,i);const a=u(i,(({uid:e})=>{const t=this._renderGeometries.get(e);return this._renderGeometries.delete(e),t})),s=r.map((e=>{const t=this._pointGraphicToRenderGeometry(e);return this._renderGeometries.set(e.uid,t),t}));a.length>0&&this._drapeSourceRenderer.removeGeometries(a,C.REMOVE),s.length>0&&this._drapeSourceRenderer.addGeometries(s,C.ADD),(s.length>0||a.length>0)&&(this.filterVisibility.reapply(),this._renderView.requestRender())}_recreate(){if(!this._loadedPointGraphics)return;const e=this._loadedPointGraphics.toArray();this._onLoadedFeaturesChange({added:e,removed:e})}_pointGraphicToRenderGeometry(e){const t=this._heatmapRendererFieldName,r=n(t)?this._materialWithField:this._material,i=R();b(e.geometry,i,this._overlaySpatialReference),i[2]=I;const a=[[L.POSITION,new N(i,i.length)]],s=this._heatmapRendererFieldIsNumeric;n(t)&&a.push([L.FEATUREATTRIBUTE,new N([s?e.attributes[t]??0:0],1)]);const o=new H(new U(r,a,null,null,O.Point),{layerUid:this.layer.uid,graphicUid:e.uid});return F(o.boundingSphere,i),o.visible=this.filterVisibility.defaultVisibility,o}_forEachMaterial(e){e(this._material),e(this._materialWithField)}_computeFieldTotalChange(e,t){if(p(this._heatmapRendererFieldName)||!this._heatmapRendererFieldIsNumeric)return e.length-t.length;const r=this._heatmapRendererFieldName,i=(e,t)=>e+(t.attributes[r]??0);return e.reduce(i,0)-t.reduce(i,0)}_clampSearchRadius(e){return e>J&&Y.warnOnce(`SceneView supports a maximum radius of ${J} pt for HeatmapRenderer.`),Math.min(e,J)}_updateFeatureVisibilities(e){const t=[];this._featureStore.forEach((({objectId:r,displayId:i})=>{const a=e(r),s=this._renderGeometries.get(i);s&&s.visible!==a&&(t.push(s),s.visible=a)})),this._drapeSourceRenderer.modifyGeometries(t,E.VISIBILITY)}_setAllFeaturesVisibility(e){const t=[];for(const r of this._renderGeometries.values())r.visible!==e&&(t.push(r),r.visible=e);this._drapeSourceRenderer.modifyGeometries(t,E.VISIBILITY)}get test(){return{visibleFeatureCount:this._visibleFeatures}}};e([f()],K.prototype,\"type\",void 0),e([f({constructOnly:!0})],K.prototype,\"owner\",void 0),e([f()],K.prototype,\"layer\",null),e([f()],K.prototype,\"featureStore\",null),e([f()],K.prototype,\"updating\",null),e([f()],K.prototype,\"updatingRemaining\",null),e([f()],K.prototype,\"suspendInfo\",null),e([f()],K.prototype,\"legendEnabled\",null),e([f()],K.prototype,\"filterVisibility\",null),e([f()],K.prototype,\"displayFeatureLimit\",null),e([f()],K.prototype,\"preferredUpdatePolicy\",void 0),e([f()],K.prototype,\"hasZ\",null),e([f()],K.prototype,\"hasM\",null),e([f()],K.prototype,\"dataExtent\",void 0),e([f()],K.prototype,\"view\",null),e([f()],K.prototype,\"fullOpacity\",null),e([f()],K.prototype,\"updatePolicy\",null),e([f()],K.prototype,\"drapeSourceType\",void 0),e([f()],K.prototype,\"scaleVisibilitySuspended\",null),e([f()],K.prototype,\"renderer\",null),e([f()],K.prototype,\"_featureStore\",void 0),e([f()],K.prototype,\"_filterVisibility\",void 0),e([f()],K.prototype,\"_overlayRenderer\",null),e([f()],K.prototype,\"_overlaySpatialReference\",null),e([f()],K.prototype,\"_rendererParameters\",null),e([f()],K.prototype,\"_materialParameters\",null),e([f()],K.prototype,\"_densityParameters\",null),e([f()],K.prototype,\"_radiusParameter\",null),e([f()],K.prototype,\"_resolutionForScaleParameter\",null),e([f()],K.prototype,\"_colorRampParameter\",null),e([f()],K.prototype,\"_pixelRatioParameter\",null),e([f()],K.prototype,\"_densityMapPixelRatio\",null),e([f()],K.prototype,\"_renderGeometries\",void 0),e([f()],K.prototype,\"_material\",void 0),e([f()],K.prototype,\"_materialWithField\",void 0),e([f()],K.prototype,\"_renderView\",null),e([f()],K.prototype,\"_featuresArePoints\",null),e([f()],K.prototype,\"_loadedPointGraphics\",null),e([f()],K.prototype,\"_heatmapRenderer\",null),e([f()],K.prototype,\"_heatmapRendererFieldName\",null),e([f()],K.prototype,\"_heatmapRendererField\",null),e([f()],K.prototype,\"_heatmapRendererFieldIsNumeric\",null),e([f()],K.prototype,\"_fieldTotal\",void 0),e([f()],K.prototype,\"_drapeSourceRenderer\",void 0),e([f()],K.prototype,\"_isScaleRangeActive\",null),K=e([g(q)],K);const Q=s();export{K as HeatmapFeatureProcessor,J as MAX_RADIUS_PT};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}