{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { HandleOwner as t } from \"../../../../core/HandleOwner.js\";\nimport \"../../../../core/has.js\";\nimport { watch as r } from \"../../../../core/reactiveUtils.js\";\nimport { property as s } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as o } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { equals as i } from \"../../../../geometry/support/spatialReferenceUtils.js\";\nimport l from \"../../../../layers/support/TileInfo.js\";\nimport { loadProcessorModule as n } from \"./processors.js\";\nimport a from \"./controllers/FeatureController2D.js\";\nimport c from \"./support/TileStore.js\";\nimport { UpdateToken as p } from \"./support/UpdateToken.js\";\nimport h from \"../../tiling/TileInfoView.js\";\nlet d = class extends t {\n  constructor() {\n    super(...arguments), this.controller = null, this.processor = null, this.remoteClient = null, this.tileStore = null, this.service = null, this.viewState = null, this._paused = !1, this._pendingTileUpdates = [];\n  }\n  initialize() {\n    this.handles.add(r(() => this.updating, e => {\n      this.remoteClient.invoke(\"setUpdating\", e).catch(e => {});\n    }));\n  }\n  destroy() {\n    this.stop(), this.controller?.destroy(), this.processor?.destroy(), this.controller = this.processor = this.tileStore = this.remoteClient = null;\n  }\n  get updating() {\n    return !this.controller || this.controller.updating;\n  }\n  stop() {\n    this._paused = !0, Array.isArray(this.service?.source) && (this.service.source.forEach(e => e.close()), this.service.source.length = 0), this.tileStore?.updateTiles({\n      added: [],\n      removed: this.tileStore.tiles.map(e => e.id)\n    }), this.tileStore?.destroy(), this.tileStore = null, this._pendingTileUpdates.length = 0;\n  }\n  async startup(_ref) {\n    let {\n      service: e,\n      config: t,\n      tileInfo: r,\n      tiles: s\n    } = _ref;\n    if (this._paused = !0, Array.isArray(this.service?.source) && (this.service.source.forEach(e => e.close()), this.service.source.length = 0), this.service = e, !this.tileStore || !i(this.tileStore.tileScheme.spatialReference, r.spatialReference)) {\n      const e = new h(l.fromJSON(r));\n      s.added.length = s.removed.length = 0, this.tileStore?.updateTiles({\n        added: [],\n        removed: this.tileStore.tiles.map(e => e.id)\n      }), this.tileStore?.destroy(), this.tileStore = new c(e), this._pendingTileUpdates.length = 0;\n    }\n    for (await this._createProcessorAndController(t), await this.update({\n      config: t\n    }), this.controller.resume(), this.tileStore.clear(), this.tileStore.updateTiles(s), this._paused = !1; this._pendingTileUpdates.length;) this.tileStore.updateTiles(this._pendingTileUpdates.pop());\n  }\n  async updateTiles(e) {\n    this._paused ? this._pendingTileUpdates.push(e) : this.tileStore?.updateTiles(e);\n  }\n  async update(_ref2) {\n    let {\n      config: e\n    } = _ref2;\n    const t = p.empty();\n    return await Promise.all([this.processor.update(t, e), this.controller.update(t, e)]), t.toJSON();\n  }\n  async applyUpdate(e) {\n    return this.controller.applyUpdate(p.create(e));\n  }\n  async _createProcessorAndController(e) {\n    await Promise.all([this._handleControllerConfig(e), this._handleProcessorConfig(e)]), this.controller.processor = this.processor;\n  }\n  async _handleControllerConfig(e) {\n    return this._createController(this.service, e);\n  }\n  async _handleProcessorConfig(e) {\n    return this._createProcessor(this.service, e);\n  }\n  async _createController(e, t) {\n    this.controller && this.controller.destroy();\n    const {\n        tileStore: r,\n        remoteClient: s\n      } = this,\n      o = new a({\n        service: e,\n        tileStore: r,\n        remoteClient: s\n      });\n    return this.controller = o, o;\n  }\n  async _createProcessor(e, t) {\n    const r = t.schema.processors[0].type,\n      s = (await n(r)).default,\n      {\n        remoteClient: o,\n        tileStore: i\n      } = this,\n      l = new s({\n        service: e,\n        config: t,\n        tileStore: i,\n        remoteClient: o\n      });\n    return this.processor && this.processor.destroy(), this.processor = l, l;\n  }\n};\ne([s()], d.prototype, \"controller\", void 0), e([s()], d.prototype, \"processor\", void 0), e([s()], d.prototype, \"updating\", null), e([s()], d.prototype, \"viewState\", void 0), d = e([o(\"esri.views.2d.layers.features.Pipeline\")], d);\nconst u = d;\nexport { u as default };","map":{"version":3,"names":["_","e","HandleOwner","t","watch","r","property","s","subclass","o","equals","i","l","loadProcessorModule","n","a","c","UpdateToken","p","h","d","constructor","arguments","controller","processor","remoteClient","tileStore","service","viewState","_paused","_pendingTileUpdates","initialize","handles","add","updating","invoke","catch","destroy","stop","Array","isArray","source","forEach","close","length","updateTiles","added","removed","tiles","map","id","startup","_ref","config","tileInfo","tileScheme","spatialReference","fromJSON","_createProcessorAndController","update","resume","clear","pop","push","_ref2","empty","Promise","all","toJSON","applyUpdate","create","_handleControllerConfig","_handleProcessorConfig","_createController","_createProcessor","schema","processors","type","default","prototype","u"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/2d/layers/features/Pipeline.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{HandleOwner as t}from\"../../../../core/HandleOwner.js\";import\"../../../../core/has.js\";import{watch as r}from\"../../../../core/reactiveUtils.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{equals as i}from\"../../../../geometry/support/spatialReferenceUtils.js\";import l from\"../../../../layers/support/TileInfo.js\";import{loadProcessorModule as n}from\"./processors.js\";import a from\"./controllers/FeatureController2D.js\";import c from\"./support/TileStore.js\";import{UpdateToken as p}from\"./support/UpdateToken.js\";import h from\"../../tiling/TileInfoView.js\";let d=class extends t{constructor(){super(...arguments),this.controller=null,this.processor=null,this.remoteClient=null,this.tileStore=null,this.service=null,this.viewState=null,this._paused=!1,this._pendingTileUpdates=[]}initialize(){this.handles.add(r((()=>this.updating),(e=>{this.remoteClient.invoke(\"setUpdating\",e).catch((e=>{}))})))}destroy(){this.stop(),this.controller?.destroy(),this.processor?.destroy(),this.controller=this.processor=this.tileStore=this.remoteClient=null}get updating(){return!this.controller||this.controller.updating}stop(){this._paused=!0,Array.isArray(this.service?.source)&&(this.service.source.forEach((e=>e.close())),this.service.source.length=0),this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map((e=>e.id))}),this.tileStore?.destroy(),this.tileStore=null,this._pendingTileUpdates.length=0}async startup({service:e,config:t,tileInfo:r,tiles:s}){if(this._paused=!0,Array.isArray(this.service?.source)&&(this.service.source.forEach((e=>e.close())),this.service.source.length=0),this.service=e,!this.tileStore||!i(this.tileStore.tileScheme.spatialReference,r.spatialReference)){const e=new h(l.fromJSON(r));s.added.length=s.removed.length=0,this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map((e=>e.id))}),this.tileStore?.destroy(),this.tileStore=new c(e),this._pendingTileUpdates.length=0}for(await this._createProcessorAndController(t),await this.update({config:t}),this.controller.resume(),this.tileStore.clear(),this.tileStore.updateTiles(s),this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())}async updateTiles(e){this._paused?this._pendingTileUpdates.push(e):this.tileStore?.updateTiles(e)}async update({config:e}){const t=p.empty();return await Promise.all([this.processor.update(t,e),this.controller.update(t,e)]),t.toJSON()}async applyUpdate(e){return this.controller.applyUpdate(p.create(e))}async _createProcessorAndController(e){await Promise.all([this._handleControllerConfig(e),this._handleProcessorConfig(e)]),this.controller.processor=this.processor}async _handleControllerConfig(e){return this._createController(this.service,e)}async _handleProcessorConfig(e){return this._createProcessor(this.service,e)}async _createController(e,t){this.controller&&this.controller.destroy();const{tileStore:r,remoteClient:s}=this,o=new a({service:e,tileStore:r,remoteClient:s});return this.controller=o,o}async _createProcessor(e,t){const r=t.schema.processors[0].type,s=(await n(r)).default,{remoteClient:o,tileStore:i}=this,l=new s({service:e,config:t,tileStore:i,remoteClient:o});return this.processor&&this.processor.destroy(),this.processor=l,l}};e([s()],d.prototype,\"controller\",void 0),e([s()],d.prototype,\"processor\",void 0),e([s()],d.prototype,\"updating\",null),e([s()],d.prototype,\"viewState\",void 0),d=e([o(\"esri.views.2d.layers.features.Pipeline\")],d);const u=d;export{u as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}