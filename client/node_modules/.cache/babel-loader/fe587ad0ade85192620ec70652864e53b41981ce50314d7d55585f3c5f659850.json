{"ast":null,"code":"import esriConfig from'@arcgis/core/config';import OAuthInfo from'@arcgis/core/identity/OAuthInfo';import IdentityManager from'@arcgis/core/identity/IdentityManager';import{APP_ID,APP_PORTAL_URL}from'../constants/app-constants';import{idManager}from'../api/api';import{GET_IDENTITY,SIGN_IN,SIGN_OUT,LOAD_PORTAL}from'../constants/action-types';esriConfig.portalUrl=APP_PORTAL_URL;var info=new OAuthInfo({appId:APP_ID,popup:false,portalUrl:APP_PORTAL_URL});IdentityManager.registerOAuthInfos([info]);/**\r\n * Middleware function with the signature\r\n *\r\n * storeInstance =>\r\n * functionToCallWithAnActionThatWillSendItToTheNextMiddleware =>\r\n * actionThatDispatchWasCalledWith =>\r\n * valueToUseAsTheReturnValueOfTheDispatchCall\r\n *\r\n * Typically written as\r\n *\r\n * store => next => action => result\r\n */var arcgisMiddleWare=function arcgisMiddleWare(store){return function(next){return function(action){switch(action.type){case GET_IDENTITY:{next(action);return idManager('checkSignInStatus').then(function(result){console.log(result);//store.dispatch({ type: LOAD_PORTAL })\n});}case SIGN_IN:{IdentityManager.getCredential(\"\".concat(info.portalUrl,\"/sharing\"));//idManager('signIn')\nreturn next(action);}case SIGN_OUT:{idManager('signOut');window.location.reload();return next(action);}default:{return next(action);}}};};};export default arcgisMiddleWare;/*eslint-disable */ /* eslint-enable */","map":{"version":3,"names":["esriConfig","OAuthInfo","IdentityManager","APP_ID","APP_PORTAL_URL","idManager","GET_IDENTITY","SIGN_IN","SIGN_OUT","LOAD_PORTAL","portalUrl","info","appId","popup","registerOAuthInfos","arcgisMiddleWare","store","next","action","type","then","result","console","log","getCredential","concat","window","location","reload"],"sources":["C:/code-challenge-react/client/src/middleware/arcgis-authentication.js"],"sourcesContent":["import esriConfig from '@arcgis/core/config'\r\nimport OAuthInfo from '@arcgis/core/identity/OAuthInfo'\r\nimport IdentityManager from '@arcgis/core/identity/IdentityManager'\r\nimport { APP_ID, APP_PORTAL_URL } from '../constants/app-constants'\r\nimport { idManager } from '../api/api'\r\nimport {\r\n  GET_IDENTITY,\r\n  SIGN_IN,\r\n  SIGN_OUT,\r\n  LOAD_PORTAL,\r\n} from '../constants/action-types'\r\n\r\nesriConfig.portalUrl = APP_PORTAL_URL;\r\nconst info = new OAuthInfo({ appId: APP_ID, popup: false, portalUrl: APP_PORTAL_URL })\r\nIdentityManager.registerOAuthInfos([info])\r\n\r\n/**\r\n * Middleware function with the signature\r\n *\r\n * storeInstance =>\r\n * functionToCallWithAnActionThatWillSendItToTheNextMiddleware =>\r\n * actionThatDispatchWasCalledWith =>\r\n * valueToUseAsTheReturnValueOfTheDispatchCall\r\n *\r\n * Typically written as\r\n *\r\n * store => next => action => result\r\n */\r\nconst arcgisMiddleWare = store => next => (action) => {\r\n  switch (action.type) {\r\n    case GET_IDENTITY: {\r\n      next(action)\r\n      return idManager('checkSignInStatus')\r\n      .then((result) => { console.log(result)\r\n        //store.dispatch({ type: LOAD_PORTAL })\r\n      })\r\n    }\r\n    case SIGN_IN: {\r\n      IdentityManager.getCredential(`${info.portalUrl}/sharing`)\r\n      //idManager('signIn')\r\n      return next(action)\r\n    }\r\n    case SIGN_OUT: {\r\n      idManager('signOut')\r\n      window.location.reload()\r\n      return next(action)\r\n    }\r\n    default: {\r\n      return next(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default arcgisMiddleWare\r\n/*eslint-disable */\r\n/* eslint-enable */"],"mappings":"AAAA,MAAO,CAAAA,UAAU,KAAM,qBAAqB,CAC5C,MAAO,CAAAC,SAAS,KAAM,iCAAiC,CACvD,MAAO,CAAAC,eAAe,KAAM,uCAAuC,CACnE,OAASC,MAAM,CAAEC,cAAc,KAAQ,4BAA4B,CACnE,OAASC,SAAS,KAAQ,YAAY,CACtC,OACEC,YAAY,CACZC,OAAO,CACPC,QAAQ,CACRC,WAAW,KACN,2BAA2B,CAElCT,UAAU,CAACU,SAAS,CAAGN,cAAc,CACrC,GAAM,CAAAO,IAAI,CAAG,GAAI,CAAAV,SAAS,CAAC,CAAEW,KAAK,CAAET,MAAM,CAAEU,KAAK,CAAE,KAAK,CAAEH,SAAS,CAAEN,cAAe,CAAC,CAAC,CACtFF,eAAe,CAACY,kBAAkB,CAAC,CAACH,IAAI,CAAC,CAAC,CAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GACA,GAAM,CAAAI,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAGC,KAAK,QAAI,UAAAC,IAAI,QAAI,UAACC,MAAM,CAAK,CACpD,OAAQA,MAAM,CAACC,IAAI,EACjB,IAAK,CAAAb,YAAY,CAAE,CACjBW,IAAI,CAACC,MAAM,CAAC,CACZ,MAAO,CAAAb,SAAS,CAAC,mBAAmB,CAAC,CACpCe,IAAI,CAAC,SAACC,MAAM,CAAK,CAAEC,OAAO,CAACC,GAAG,CAACF,MAAM,CAAC,CACrC;AACF,CAAC,CAAC,CACJ,CACA,IAAK,CAAAd,OAAO,CAAE,CACZL,eAAe,CAACsB,aAAa,IAAAC,MAAA,CAAId,IAAI,CAACD,SAAS,aAAW,CAC1D;AACA,MAAO,CAAAO,IAAI,CAACC,MAAM,CAAC,CACrB,CACA,IAAK,CAAAV,QAAQ,CAAE,CACbH,SAAS,CAAC,SAAS,CAAC,CACpBqB,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CACxB,MAAO,CAAAX,IAAI,CAACC,MAAM,CAAC,CACrB,CACA,QAAS,CACP,MAAO,CAAAD,IAAI,CAACC,MAAM,CAAC,CACrB,CAAC,CAEL,CAAC,KAED,cAAe,CAAAH,gBAAgB,CAC/B,oBACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}