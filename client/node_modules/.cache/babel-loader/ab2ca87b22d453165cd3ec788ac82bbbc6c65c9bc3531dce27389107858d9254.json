{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from \"../../../core/Error.js\";\nimport { isSome as t, isNone as s } from \"../../../core/maybe.js\";\nimport { whenOrAbort as r, eachAlwaysValues as o, isAborted as n, throwIfAborted as a } from \"../../../core/promiseUtils.js\";\nimport { removeFile as i, makeRelative as l } from \"../../../core/urlUtils.js\";\nimport c from \"../../Point.js\";\nasync function u(e, s, o) {\n  const {\n      loadGLTFMesh: n\n    } = await r(import(\"./loadGLTFMesh.js\"), o),\n    a = await m(s, o),\n    i = n(new c({\n      x: 0,\n      y: 0,\n      z: 0,\n      spatialReference: e.spatialReference\n    }), a.url, {\n      resolveFile: f(a),\n      useTransform: !0,\n      signal: t(o) ? o.signal : null\n    });\n  i.then(() => a.dispose(), () => a.dispose());\n  const {\n    vertexAttributes: l,\n    components: u\n  } = await i;\n  e.vertexAttributes = l, e.components = u;\n}\nfunction f(e) {\n  const t = i(e.url);\n  return s => {\n    const r = l(s, t, t),\n      o = r ? r.replace(/^ *\\.\\//, \"\") : null;\n    return (o ? e.files.get(o) : null) ?? s;\n  };\n}\nasync function m(e, t) {\n  return e instanceof Blob ? y.fromBlob(e) : \"string\" == typeof e ? new y(e) : Array.isArray(e) ? p(e, t) : w(e, t);\n}\nasync function p(t, r) {\n  const i = new Map();\n  let l = null;\n  const c = await o(t.map(async e => ({\n      name: e.name,\n      source: await m(e instanceof Blob ? e : e.source, r)\n    }))),\n    u = [];\n  for (const e of c) e && (n(r) ? e.source.dispose() : u.push(e));\n  a(r);\n  for (const {\n    name: e,\n    source: o\n  } of u) (s(l) || /\\.(gltf|glb)/i.test(e)) && (l = o.url), i.set(e, o.url), o.files && o.files.forEach((e, t) => i.set(t, e));\n  if (s(l)) throw new e(\"mesh-load-external:missing-files\", \"Missing files to load external mesh source\");\n  return new y(l, () => u.forEach(_ref => {\n    let {\n      source: e\n    } = _ref;\n    return e.dispose();\n  }), i);\n}\nasync function w(e, t) {\n  const {\n      default: s\n    } = await r(import(\"../../../request.js\"), t),\n    o = \"string\" == typeof e.multipart[0] ? await Promise.all(e.multipart.map(async e => (await s(e, {\n      responseType: \"array-buffer\"\n    })).data)) : e.multipart;\n  return y.fromBlob(new Blob(o));\n}\nclass y {\n  constructor(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};\n    let s = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Map();\n    this.url = e, this.dispose = t, this.files = s;\n  }\n  static fromBlob(e) {\n    const t = URL.createObjectURL(e);\n    return new y(t, () => URL.revokeObjectURL(t));\n  }\n}\nexport { u as loadExternal };","map":{"version":3,"names":["e","isSome","t","isNone","s","whenOrAbort","r","eachAlwaysValues","o","isAborted","n","throwIfAborted","a","removeFile","i","makeRelative","l","c","u","loadGLTFMesh","m","x","y","z","spatialReference","url","resolveFile","f","useTransform","signal","then","dispose","vertexAttributes","components","replace","files","get","Blob","fromBlob","Array","isArray","p","w","Map","map","name","source","push","test","set","forEach","_ref","default","multipart","Promise","all","responseType","data","constructor","arguments","length","undefined","URL","createObjectURL","revokeObjectURL","loadExternal"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/geometry/support/meshUtils/loadExternal.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Error.js\";import{isSome as t,isNone as s}from\"../../../core/maybe.js\";import{whenOrAbort as r,eachAlwaysValues as o,isAborted as n,throwIfAborted as a}from\"../../../core/promiseUtils.js\";import{removeFile as i,makeRelative as l}from\"../../../core/urlUtils.js\";import c from\"../../Point.js\";async function u(e,s,o){const{loadGLTFMesh:n}=await r(import(\"./loadGLTFMesh.js\"),o),a=await m(s,o),i=n(new c({x:0,y:0,z:0,spatialReference:e.spatialReference}),a.url,{resolveFile:f(a),useTransform:!0,signal:t(o)?o.signal:null});i.then((()=>a.dispose()),(()=>a.dispose()));const{vertexAttributes:l,components:u}=await i;e.vertexAttributes=l,e.components=u}function f(e){const t=i(e.url);return s=>{const r=l(s,t,t),o=r?r.replace(/^ *\\.\\//,\"\"):null;return(o?e.files.get(o):null)??s}}async function m(e,t){return e instanceof Blob?y.fromBlob(e):\"string\"==typeof e?new y(e):Array.isArray(e)?p(e,t):w(e,t)}async function p(t,r){const i=new Map;let l=null;const c=await o(t.map((async e=>({name:e.name,source:await m(e instanceof Blob?e:e.source,r)})))),u=[];for(const e of c)e&&(n(r)?e.source.dispose():u.push(e));a(r);for(const{name:e,source:o}of u)(s(l)||/\\.(gltf|glb)/i.test(e))&&(l=o.url),i.set(e,o.url),o.files&&o.files.forEach(((e,t)=>i.set(t,e)));if(s(l))throw new e(\"mesh-load-external:missing-files\",\"Missing files to load external mesh source\");return new y(l,(()=>u.forEach((({source:e})=>e.dispose()))),i)}async function w(e,t){const{default:s}=await r(import(\"../../../request.js\"),t),o=\"string\"==typeof e.multipart[0]?await Promise.all(e.multipart.map((async e=>(await s(e,{responseType:\"array-buffer\"})).data))):e.multipart;return y.fromBlob(new Blob(o))}class y{constructor(e,t=(()=>{}),s=new Map){this.url=e,this.dispose=t,this.files=s}static fromBlob(e){const t=URL.createObjectURL(e);return new y(t,(()=>URL.revokeObjectURL(t)))}}export{u as loadExternal};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}