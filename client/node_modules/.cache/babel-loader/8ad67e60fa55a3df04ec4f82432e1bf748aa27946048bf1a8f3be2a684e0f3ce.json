{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from \"../../../../../core/has.js\";\nimport { throwIfAborted as e, isAbortError as t } from \"../../../../../core/promiseUtils.js\";\nimport { BaseFeatureSource as r } from \"./BaseFeatureSource.js\";\nconst s = has(\"esri-mobile\"),\n  i = {\n    maxDrillLevel: s ? 1 : 4,\n    maxRecordCountFactor: s ? 1 : 3\n  };\nclass a extends r {\n  constructor(e) {\n    super(e);\n  }\n  async _fetchDataTile(r) {\n    const s = this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,\n      a = this._subscriptions.get(r.key.id),\n      o = a.signal,\n      n = r.getQuantizationParameters();\n    let c = 0;\n    const d = async (u, l) => {\n      const p = this._queryInfo,\n        m = this.createTileQuery(u, {\n          maxRecordCountFactor: s ? i.maxRecordCountFactor : void 0,\n          returnExceededLimitFeatures: !1,\n          quantizationParameters: n\n        });\n      c++;\n      try {\n        const t = await this._queue.push({\n          tile: r,\n          query: m,\n          signal: o,\n          depth: l\n        });\n        if (c--, e(o), !t) return;\n        if (p !== this._queryInfo) return void d(u, l);\n        if (t.exceededTransferLimit && l < i.maxDrillLevel) {\n          for (const e of u.createChildTiles()) d(e, l + 1);\n          return;\n        }\n        const s = {\n          id: r.id,\n          addOrUpdate: t,\n          end: 0 === c,\n          type: \"append\"\n        };\n        a.add({\n          query: m,\n          message: s\n        }), this._onMessage(s);\n      } catch (h) {\n        t(h) || this._onMessage({\n          id: r.id,\n          addOrUpdate: null,\n          end: !0,\n          type: \"append\"\n        });\n      }\n    };\n    d(r, 0);\n  }\n}\nexport { a as DrillDownFeatureSource };","map":{"version":3,"names":["has","throwIfAborted","e","isAbortError","t","BaseFeatureSource","r","s","i","maxDrillLevel","maxRecordCountFactor","a","constructor","_fetchDataTile","_serviceInfo","capabilities","query","supportsMaxRecordCountFactor","_subscriptions","get","key","id","o","signal","n","getQuantizationParameters","c","d","u","l","p","_queryInfo","m","createTileQuery","returnExceededLimitFeatures","quantizationParameters","_queue","push","tile","depth","exceededTransferLimit","createChildTiles","addOrUpdate","end","type","add","message","_onMessage","h","DrillDownFeatureSource"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/2d/layers/features/sources/DrillDownFeatureSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{throwIfAborted as e,isAbortError as t}from\"../../../../../core/promiseUtils.js\";import{BaseFeatureSource as r}from\"./BaseFeatureSource.js\";const s=has(\"esri-mobile\"),i={maxDrillLevel:s?1:4,maxRecordCountFactor:s?1:3};class a extends r{constructor(e){super(e)}async _fetchDataTile(r){const s=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,a=this._subscriptions.get(r.key.id),o=a.signal,n=r.getQuantizationParameters();let c=0;const d=async(u,l)=>{const p=this._queryInfo,m=this.createTileQuery(u,{maxRecordCountFactor:s?i.maxRecordCountFactor:void 0,returnExceededLimitFeatures:!1,quantizationParameters:n});c++;try{const t=await this._queue.push({tile:r,query:m,signal:o,depth:l});if(c--,e(o),!t)return;if(p!==this._queryInfo)return void d(u,l);if(t.exceededTransferLimit&&l<i.maxDrillLevel){for(const e of u.createChildTiles())d(e,l+1);return}const s={id:r.id,addOrUpdate:t,end:0===c,type:\"append\"};a.add({query:m,message:s}),this._onMessage(s)}catch(h){t(h)||this._onMessage({id:r.id,addOrUpdate:null,end:!0,type:\"append\"})}};d(r,0)}}export{a as DrillDownFeatureSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}