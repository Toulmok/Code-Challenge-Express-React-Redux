{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"./chunks/tslib.es6.js\";\nimport { version as t } from \"./kernel.js\";\nimport r from \"./Map.js\";\nimport i from \"./Viewpoint.js\";\nimport o from \"./core/Collection.js\";\nimport s from \"./core/Error.js\";\nimport a from \"./core/Handles.js\";\nimport { clone as n } from \"./core/lang.js\";\nimport l from \"./core/Loadable.js\";\nimport { loadAll as p } from \"./core/loadAll.js\";\nimport c from \"./core/Logger.js\";\nimport { isSome as d, unwrap as h } from \"./core/maybe.js\";\nimport { MultiOriginJSONMixin as u, MultiOriginJSONSupport as m } from \"./core/MultiOriginJSONSupport.js\";\nimport { EsriPromiseMixin as y } from \"./core/Promise.js\";\nimport { debounce as w, eachAlways as g } from \"./core/promiseUtils.js\";\nimport { urlToObject as f, addQueryParameter as v } from \"./core/urlUtils.js\";\nimport { property as b } from \"./core/accessorSupport/decorators/property.js\";\nimport \"./core/accessorSupport/ensureType.js\";\nimport { reader as S } from \"./core/accessorSupport/decorators/reader.js\";\nimport { subclass as _ } from \"./core/accessorSupport/decorators/subclass.js\";\nimport { writer as A } from \"./core/accessorSupport/decorators/writer.js\";\nimport { updateOrigins as I } from \"./core/accessorSupport/originUtils.js\";\nimport { readLoadable as j } from \"./core/accessorSupport/read.js\";\nimport L from \"./geometry/Extent.js\";\nimport R from \"./geometry/HeightModelInfo.js\";\nimport { canProjectWithoutEngine as P } from \"./geometry/projection.js\";\nimport V from \"./geometry/SpatialReference.js\";\nimport { validateWebSceneError as M } from \"./geometry/support/heightModelInfoUtils.js\";\nimport { fromJSON as U } from \"./geometry/support/jsonUtils.js\";\nimport { isEarth as O } from \"./geometry/support/spatialReferenceUtils.js\";\nimport E from \"./portal/Portal.js\";\nimport C from \"./portal/PortalItem.js\";\nimport N from \"./support/MapFloorInfo.js\";\nimport { createSchemaValidationError as T, createCopyError as G } from \"./support/webSceneUtils.js\";\nimport { ViewingMode as F } from \"./views/ViewingMode.js\";\nimport { isSpatialReferenceSupported as $ } from \"./views/support/spatialReferenceSupport.js\";\nimport { saveResources as W } from \"./webdoc/support/saveUtils.js\";\nimport { getOptimalThumbnailSize as J } from \"./webdoc/support/thumbnailUtils.js\";\nimport x from \"./webscene/ApplicationProperties.js\";\nimport k from \"./webscene/Environment.js\";\nimport B from \"./webscene/InitialViewProperties.js\";\nimport q from \"./webscene/Presentation.js\";\nimport K from \"./webscene/TransportationNetwork.js\";\nimport { Version as D } from \"./webscene/Version.js\";\nimport { getLoader as H } from \"./webscene/support/schemaValidatorLoader.js\";\nconst z = new D(1, 30),\n  Q = () => {\n    const e = 8,\n      t = [],\n      r = z.major;\n    for (let i = e; i <= z.minor; i++) t.push(`${r}.${i}`);\n    return t;\n  },\n  X = \"Web Scene\",\n  Y = \"ViewingMode-Local\";\nlet Z = class extends l.LoadableMixin(y(u(r))) {\n  constructor(e) {\n    super(e), this._layersIdGCTimeoutId = void 0, this._handles = new a(), this._updateFromPromise = null, this.applicationProperties = null, this.clippingArea = null, this.clippingEnabled = !1, this.floorInfo = null, this.heightModelInfo = void 0, this.sourceVersion = null, this.transportationNetworks = null, this.presentation = new q(), this.initialViewProperties = new B(), this.portalItem = null, this.resourceInfo = null, this._debouncedSaveOperations = w(async (e, t, r) => {\n      switch (e) {\n        case ee.SAVE:\n          return this._saveImpl(t);\n        case ee.SAVE_AS:\n          return this._saveAsImpl(r, t);\n      }\n    }), this._resourceReferences = {\n      portalItem: null,\n      paths: []\n    }, this.authoringApp = null, this.authoringAppVersion = null, this._isAuthoringAppSetByUser = !1, this._isAuthoringAppVersionSetByUser = !1;\n  }\n  initialize() {\n    if (this.when().catch(e => {\n      c.getLogger(this.declaredClass).error(\"#load()\", \"Failed to load web scene\", e);\n    }), this.resourceInfo) {\n      let t;\n      try {\n        t = this._validateJSON(this.resourceInfo);\n      } catch (e) {\n        return void this.addResolvingPromise(Promise.reject(e));\n      }\n      this.read(t), this.addResolvingPromise(this._validateSpatialReference()), this.addResolvingPromise(this._validateHeightModelInfo());\n    }\n    this._handles.add(this.allLayers.on(\"change\", () => this._scheduleLayersIdGC()));\n  }\n  destroy() {\n    this._unscheduleLayersIdGC(), this._handles.destroy(), this.presentation && this.presentation.destroy();\n    const e = this.portalItem;\n    this.portalItem = null, e?.destroy();\n  }\n  writeClippingArea(e, t) {\n    t.clippingArea || (t.clippingArea = {}), t.clippingArea.geometry = e.toJSON();\n  }\n  readClippingEnabled(e, t) {\n    return !!t.clippingArea && !!t.clippingArea.clip;\n  }\n  writeClippingEnabled(e, t) {\n    this.clippingArea && (t.clippingArea || (t.clippingArea = {}), t.clippingArea.clip = e);\n  }\n  writeLayers(e, t, r, i) {\n    const o = {\n        ...i,\n        layerContainerType: \"operational-layers\"\n      },\n      s = e.map(e => this.verifyWriteLayer(e, i) ? e.write({}, o) : null).filter(e => !!e);\n    t[r] = s.toArray();\n  }\n  verifyWriteLayer(e, t) {\n    return \"write\" in e || (t && t.messages && t.messages.push(new s(\"layer:unsupported\", `Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in web scenes`, {\n      layer: e\n    })), !1);\n  }\n  readSourceVersion(e, t) {\n    const [r, i] = t.version.split(\".\");\n    return new D(parseInt(r, 10), parseInt(i, 10));\n  }\n  writeSourceVersion(e, t, r) {\n    t[r] = `${z.major}.${z.minor}`;\n  }\n  get thumbnailUrl() {\n    return this.portalItem?.thumbnailUrl ?? null;\n  }\n  set thumbnailUrl(e) {\n    e ? this._override(\"thumbnailUrl\", e) : (this._clearOverride(\"thumbnailUrl\"), this.clear(\"thumbnailUrl\", \"user\"));\n  }\n  set authoringApp(e) {\n    this._isAuthoringAppSetByUser = !0, this._set(\"authoringApp\", e);\n  }\n  writeAuthoringApp(e, t) {\n    e && this._isAuthoringAppSetByUser ? t.authoringApp = e : t.authoringApp = \"ArcGIS API for JavaScript\";\n  }\n  set authoringAppVersion(e) {\n    this._isAuthoringAppVersionSetByUser = !0, this._set(\"authoringAppVersion\", e);\n  }\n  writeAuthoringAppVersion(e, r) {\n    e && this._isAuthoringAppVersionSetByUser ? r.authoringAppVersion = e : r.authoringAppVersion = t;\n  }\n  writeGround(e, t, r, i) {\n    t[r] = e ? e.write({}, i) : {\n      transparency: 0,\n      layers: []\n    };\n  }\n  readInitialViewProperties(e, t) {\n    const r = {};\n    return t.initialState && t.initialState.environment && (r.environment = k.fromJSON(t.initialState.environment)), t.spatialReference ? r.spatialReference = V.fromJSON(t.spatialReference) : r.spatialReference = V.WebMercator, r.viewingMode = t.viewingMode || \"global\", t.initialState && t.initialState.viewpoint && (r.viewpoint = i.fromJSON(t.initialState.viewpoint)), new B(r);\n  }\n  get spatialReference() {\n    return this.initialViewProperties?.spatialReference ?? V.WebMercator;\n  }\n  get viewingMode() {\n    return this.initialViewProperties?.viewingMode ?? \"global\";\n  }\n  load(e) {\n    return this.addResolvingPromise(this._loadFromSource()), Promise.resolve(this);\n  }\n  loadAll() {\n    return p(this, e => {\n      const t = this.presentation && this.presentation.slides;\n      e(this.ground, this.basemap, this.layers, t && t.map(e => e.basemap));\n    });\n  }\n  read(e, t) {\n    t = {\n      ...t,\n      origin: \"web-scene\"\n    };\n    const r = this._isAuthoringAppVersionSetByUser,\n      i = this._isAuthoringAppSetByUser;\n    if (j(this, e, t => super.read(e, t), t), i || (this._isAuthoringAppSetByUser = !1), r || (this._isAuthoringAppVersionSetByUser = !1), e.baseMap && Array.isArray(e.baseMap.elevationLayers) && this.sourceVersion?.supportsVisibleElevationLayersInSlides) {\n      const t = e.baseMap.elevationLayers.map(e => ({\n          id: e.id\n        })),\n        r = this.presentation.slides,\n        i = (e, t) => e.visibleLayers.some(e => e.id === t),\n        o = t.filter(e => !r.some(t => i(t, e.id)));\n      r.forEach(e => {\n        e.visibleLayers.addMany(o);\n      });\n    }\n  }\n  _writeBasemapElevationLayers(e) {\n    const t = e.ground && e.ground.layers;\n    !e.baseMap && t && t.length && (e.baseMap = {\n      title: \"Basemap\",\n      baseMapLayers: []\n    }), e.baseMap && (e.baseMap.elevationLayers = n(t));\n  }\n  write(e, t) {\n    if (\"loaded\" !== this.loadStatus) {\n      const e = new s(\"webscene:not-loaded\", \"Web scene must be loaded before it can be serialized\");\n      throw c.getLogger(this.declaredClass).error(\"#toJSON()\", \"Web scene must be loaded before it can be serialized\", this.loadError || this.loadStatus), e;\n    }\n    this._runLayersIdGC();\n    const r = !t?.messages;\n    t = {\n      messages: [],\n      ...t,\n      origin: \"web-scene\"\n    };\n    const i = super.write(e, t);\n    if (r) {\n      const e = t.messages?.filter(e => \"web-document-write:property-required\" === e.name) ?? [];\n      if (e.length) {\n        const t = new s(\"web-document:property-required\", \"One or more properties that are required in the webscene JSON are missing, see details for the specific errors\", {\n          errors: e\n        });\n        throw c.getLogger(this.declaredClass).error(\"#toJSON()\", \"One or more properties that are required in the webscene JSON are missing\", e), t;\n      }\n    }\n    return this._writeBasemapElevationLayers(i), i;\n  }\n  async save(e) {\n    return this._debouncedSaveOperations(ee.SAVE, e);\n  }\n  async _saveImpl(e) {\n    if (!this.portalItem) throw c.getLogger(this.declaredClass).error(\"save(): requires the .portalItem property to be set\"), await Promise.resolve(), new s(\"webscene:portal-item-not-set\", \"Portal item to save to has not been set on the WebScene\");\n    if (this.portalItem?.type !== X) throw await Promise.resolve(), new s(\"webscene:portal-item-wrong-type\", `Portal item needs to have type \"${X}\"`);\n    const t = this._updateFromPromise;\n    await this._ensureLoadBeforeSave();\n    const r = this._enableVerifyItemRelativeUrls({\n        origin: \"web-scene\",\n        url: this.portalItem.itemUrl ? f(this.portalItem.itemUrl) : null,\n        messages: [],\n        portal: this.portalItem.portal ?? E.getDefault(),\n        portalItem: this.portalItem,\n        writtenProperties: [],\n        blockedRelativeUrls: [],\n        resources: {\n          toAdd: [],\n          toUpdate: [],\n          toKeep: [],\n          pendingOperations: []\n        }\n      }),\n      i = this.write({}, r);\n    return await Promise.all(r.resources.pendingOperations), await this._verifySave(i, r, e), this._updateTypeKeywords(this.portalItem), await this.portalItem.update({\n      data: i\n    }), await W(this._resourceReferences, r, null), I(r), t && (await t), await this._saveThumbnail(), this.portalItem;\n  }\n  async saveAs(e, t) {\n    return this._debouncedSaveOperations(ee.SAVE_AS, t, e);\n  }\n  async _saveAsImpl(e, t) {\n    let r = C.from(e);\n    r || (c.getLogger(this.declaredClass).error(\"saveAs(portalItem): requires a portal item parameter\"), await Promise.reject(new s(\"webscene:portal-item-required\", \"saveAs requires a portal item to save to\"))), r.id && (r = r.clone(), r.id = null);\n    const i = r.portal || E.getDefault();\n    await this._ensureLoadBeforeSave(), r.type = X, r.portal = i;\n    const o = this._enableVerifyItemRelativeUrls({\n        origin: \"web-scene\",\n        url: null,\n        messages: [],\n        portal: i,\n        portalItem: r,\n        writtenProperties: [],\n        blockedRelativeUrls: [],\n        resources: {\n          toAdd: [],\n          toUpdate: [],\n          toKeep: [],\n          pendingOperations: []\n        }\n      }),\n      a = this.write({}, o);\n    await Promise.all(o.resources.pendingOperations), await this._verifySaveAs(a, o, t);\n    const n = this.thumbnailUrl,\n      l = !this._isOverridden(\"thumbnailUrl\");\n    return this._updateTypeKeywords(r), await i.signIn(), await i.user?.addItem({\n      item: r,\n      folder: t && t.folder,\n      data: a\n    }), await W(this._resourceReferences, o, null), this.portalItem = r, m.prototype.read.call(this, {\n      version: a.version,\n      authoringApp: a.authoringApp,\n      authoringAppVersion: a.authoringAppVersion\n    }, {\n      name: \"web-scene\",\n      ignoreDefaults: !0,\n      url: r.itemUrl && f(r.itemUrl)\n    }), I(o), n && (this.thumbnailUrl = l ? v(n, \"w\", \"8192\") : n), o.portalItem = r, await this._saveThumbnail(), r;\n  }\n  async _saveThumbnail() {\n    this._isOverridden(\"thumbnailUrl\") && (await this.portalItem?.updateThumbnail({\n      thumbnail: this.thumbnailUrl\n    }), this._clearOverride(\"thumbnailUrl\"), this.clear(\"thumbnailUrl\", \"user\"));\n  }\n  _verifySave(e, t, r) {\n    let i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;\n    if (!O(this.spatialReference)) return Promise.reject(new s(\"webscene:unsupported-spatial-reference\", \"Webscenes using spatial reference systems from Mars or Moon can not be saved currently.\"));\n    let o,\n      a = t.messages?.filter(e => \"error\" === e.type).map(e => new s(e.name, e.message, e.details)) ?? [];\n    t.blockedRelativeUrls && (a = a.concat(t.blockedRelativeUrls.map(e => new s(\"url:unsupported\", `Relative url '${e}' is not supported in Web Scene`)))), r && r.ignoreUnsupported && (a = a.filter(e => \"layer:unsupported\" !== e.name && \"symbol:unsupported\" !== e.name && \"symbol-layer:unsupported\" !== e.name && \"property:unsupported\" !== e.name && \"url:unsupported\" !== e.name && \"scenemodification:unsupported\" !== e.name)), r?.requiredPropertyChecksDisabled && (a = a.filter(e => \"web-document-write:property-required\" !== e.name));\n    const n = !!r?.strictSchemaValidationEnabled,\n      l = H();\n    return o = n && l ? l().then(t => {\n      const r = t.validate(e);\n      if (r.length > 0) {\n        const e = `webscene did not validate:\\n${r.join(\"\\n\")}`;\n        c.getLogger(this.declaredClass).error(`${i ? \"saveAs\" : \"save\"}(): ${e}`);\n      }\n      return r.map(e => new s(\"webscene:schema-validation\", e));\n    }).then(e => {\n      if (e.length > 0) throw T(e.concat(a));\n      return a;\n    }) : Promise.resolve(a), o.then(e => {\n      if (e.length > 0) throw new s(\"webscene:save\", \"Failed to save webscene due to unsupported or invalid content. See 'details.errors' for more detailed information\", {\n        errors: e\n      });\n    });\n  }\n  _verifySaveAs(e, t, r) {\n    return this.canNotSaveAs(t) ? Promise.reject(G()) : this._verifySave(e, t, r, !0);\n  }\n  verifySaveAs(e) {\n    const t = this._enableVerifyItemRelativeUrls({\n        origin: \"web-scene\",\n        messages: []\n      }),\n      r = this.write({}, t);\n    return this._verifySaveAs(r, t, e);\n  }\n  canNotSaveAs(e) {\n    return e || (e = this._enableVerifyItemRelativeUrls({\n      origin: \"web-scene\",\n      messages: []\n    }), this.write({}, e)), (e.verifyItemRelativeUrls?.writtenUrls?.length ?? 0) > 0;\n  }\n  async updateFrom(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const r = this._updateFrom(e, t);\n    this._updateFromPromise = r, await r;\n    this._updateFromPromise === r && (this._updateFromPromise = null);\n  }\n  async _updateFrom(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    if (await e.whenReady(), !t.environmentExcluded && e.environment && (this.initialViewProperties.environment = k.prototype.clone.apply(e.environment)), !t.viewpointExcluded && e.viewpoint && (this.initialViewProperties.viewpoint = e.viewpoint.clone()), this.initialViewProperties.spatialReference = e.spatialReference.clone(), this.initialViewProperties.viewingMode = e.viewingMode, d(e.clippingArea) ? e.clippingArea !== this.clippingArea && (this.clippingArea = e.clippingArea.clone(), this.clippingEnabled = !0) : this.clippingEnabled = !1, e.heightModelInfo && (this.heightModelInfo = e.heightModelInfo.clone()), e.map === this) for (const r of e.allLayerViews) {\n      const e = \"visible\";\n      e in r && e in r.layer && r._isOverridden(e) && (r.layer[e] = r[e]);\n    }\n    (!1 === t.thumbnailExcluded || null == t.thumbnailExcluded && !t.viewpointExcluded) && (await this._updateFromThumbnail(e, t.thumbnailSize ?? void 0));\n  }\n  async _updateFromThumbnail(e, t) {\n    const r = J(e, t),\n      i = await e.takeScreenshot({\n        format: \"jpg\",\n        width: r.width,\n        height: r.height,\n        disableDecorations: !0\n      });\n    this.thumbnailUrl = i.dataUrl;\n  }\n  _loadFromSource() {\n    return this.resourceInfo ? this._loadFromJSON(this.resourceInfo, {\n      origin: \"web-scene\"\n    }) : this.portalItem && this.portalItem.id ? this._loadFromItem(this.portalItem) : this._loadObjectsWithLayers();\n  }\n  _readAndLoadFromJSON(e, t) {\n    const r = this._validateJSON(e);\n    return this.read(r, t), this._loadFromJSON(r, t);\n  }\n  _extractOperationalLayers(e) {\n    const t = [];\n    if (!this.sourceVersion?.supportsGround && e.baseMap && Array.isArray(e.baseMap.elevationLayers)) for (const o of e.baseMap.elevationLayers) t.push(o);\n    const r = [],\n      i = e => (e.layers && (e.layers = e.layers.filter(i)), \"ArcGISTiledElevationServiceLayer\" !== e.layerType || (this.sourceVersion?.supportsGround || r.push(e), !1));\n    return {\n      operationalLayers: e.operationalLayers ? e.operationalLayers.filter(i) : [],\n      operationalElevationLayers: r,\n      basemapElevationLayers: t\n    };\n  }\n  _loadFromJSON(e, t) {\n    const r = new o();\n    return this._validateSpatialReference().then(() => this._validateHeightModelInfo()).then(() => import(\"./layers/support/layersCreator.js\")).then(_ref => {\n      let {\n        populateOperationalLayers: i\n      } = _ref;\n      const {\n          operationalLayers: o,\n          operationalElevationLayers: s,\n          basemapElevationLayers: a\n        } = this._extractOperationalLayers(e),\n        n = [],\n        l = {\n          context: {\n            ...t,\n            layerContainerType: \"operational-layers\"\n          }\n        };\n      if (this.portalItem && (l.context.portal = this.portalItem.portal || E.getDefault()), a.length > 0) {\n        const e = {\n          ...l,\n          context: {\n            ...l.context,\n            layerContainerType: \"ground\"\n          }\n        };\n        e.defaultLayerType = \"ArcGISTiledElevationServiceLayer\", n.push(i(this.ground.layers, a, e));\n      }\n      if (s.length > 0) {\n        const e = {\n          ...l,\n          context: {\n            ...l.context,\n            layerContainerType: \"ground\"\n          }\n        };\n        e.defaultLayerType = \"ArcGISTiledElevationServiceLayer\", n.push(i(r, s, e));\n      }\n      return o && o.length > 0 && n.push(i(this.layers, o, l)), g(n).then(() => {});\n    }).then(() => this._loadObjectsWithLayers()).then(() => {\n      this.ground.layers.addMany(r);\n    });\n  }\n  async _ensureLoadBeforeSave() {\n    await this.load(), await this._loadObjectsWithLayers();\n    const e = [];\n    for (const t of this.allLayers.items) if (\"beforeSave\" in t && \"function\" == typeof t.beforeSave) {\n      const r = t.beforeSave();\n      r && e.push(r);\n    }\n    await g(e);\n  }\n  async _loadObjectsWithLayers() {\n    const e = [];\n    this.ground && e.push(this.ground.load()), this.basemap && e.push(this.basemap.load()), this.presentation.slides.forEach(t => {\n      t.basemap && e.push(t.basemap.load());\n    }), await g(e);\n  }\n  async _loadFromItem(e) {\n    if (await e.load().catch(e => {\n      throw new s(\"webscene:load-portal-item\", \"Failed to load portal item\", {\n        error: e\n      });\n    }), \"Web Scene\" !== e.type) throw new s(\"webscene:invalid-portal-item\", \"Invalid portal item type '${type}', expected 'Web Scene'\", {\n      type: e.type\n    });\n    const t = await e.fetchData();\n    this.resourceInfo = t;\n    const r = {\n      origin: \"web-scene\",\n      url: f(e.itemUrl),\n      portal: e.portal || E.getDefault(),\n      portalItem: e,\n      readResourcePaths: []\n    };\n    await this._readAndLoadFromJSON(t, r), this._resourceReferences = {\n      portalItem: e,\n      paths: r.readResourcePaths ?? []\n    };\n  }\n  _validateSpatialReference() {\n    const e = this.initialViewProperties,\n      t = this._sceneSpatialReference;\n    let r;\n    if (\"local\" !== e.viewingMode) {\n      if (!$(t, F.Global)) return Promise.reject(new s(\"webscene:unsupported-spatial-reference\", \"Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported\", {\n        spatialReference: t,\n        viewingMode: e.viewingMode\n      }));\n      r = e => !e || P(e, t);\n    } else {\n      if (!$(t, F.Local)) return Promise.reject(new s(\"webscene:unsupported-spatial-reference\", \"Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported\", {\n        spatialReference: t,\n        viewingMode: e.viewingMode\n      }));\n      r = e => !e || e.equals(t);\n    }\n    const i = e => h(e?.camera)?.position.spatialReference ?? h(e?.targetGeometry)?.spatialReference,\n      o = e.viewpoint,\n      a = i(o);\n    if (a && !r(a)) return Promise.reject(new s(\"webscene:incompatible-camera-spatial-reference\", \"Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})\", {\n      cameraSpatialReference: a,\n      sceneSpatialReference: t,\n      viewingMode: e.viewingMode\n    }));\n    const n = this.presentation.slides.find(e => !r(i(e.viewpoint)));\n    if (n) {\n      const r = i(n.viewpoint);\n      return Promise.reject(new s(\"webscene:incompatible-slide-spatial-reference\", \"Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})\", {\n        slideSpatialReference: r,\n        sceneSpatialReference: t,\n        viewingMode: e.viewingMode\n      }));\n    }\n    return Promise.resolve();\n  }\n  _validateHeightModelInfo() {\n    const e = this._sceneSpatialReference,\n      t = M(this.heightModelInfo, e);\n    return t ? Promise.reject(t) : Promise.resolve();\n  }\n  _validateJSON(e) {\n    const t = D.parse(e.version || \"\", \"webscene\");\n    return z.validate(t), e.version = `${t.major}.${t.minor}`, 1 === t.major && t.minor <= 2 && (e.spatialReference = V.WebMercator.toJSON()), e;\n  }\n  _updateTypeKeywords(e) {\n    \"local\" === this.initialViewProperties.viewingMode ? e.typeKeywords ? e.typeKeywords.includes(Y) || e.typeKeywords.push(Y) : e.typeKeywords = [Y] : \"global\" === this.initialViewProperties.viewingMode && e.typeKeywords && (e.typeKeywords = e.typeKeywords.filter(e => e !== Y)), e.typeKeywords && (e.typeKeywords = e.typeKeywords.filter((e, t, r) => r.indexOf(e) === t));\n  }\n  get _sceneSpatialReference() {\n    return this.initialViewProperties.spatialReference || V.WebMercator;\n  }\n  get _verifyItemRelativeRootPath() {\n    return this.portalItem?.itemUrl ? f(this.portalItem.itemUrl).path : null;\n  }\n  _enableVerifyItemRelativeUrls(e) {\n    const t = this._verifyItemRelativeRootPath;\n    return t && (e.verifyItemRelativeUrls = {\n      rootPath: t,\n      writtenUrls: []\n    }), e;\n  }\n  _unscheduleLayersIdGC() {\n    this._layersIdGCTimeoutId && (clearTimeout(this._layersIdGCTimeoutId), this._layersIdGCTimeoutId = 0);\n  }\n  _scheduleLayersIdGC() {\n    this._unscheduleLayersIdGC(), this._layersIdGCTimeoutId = setTimeout(() => {\n      this._layersIdGCTimeoutId = 0, this._runLayersIdGC();\n    }, 3e3);\n  }\n  _runLayersIdGC() {\n    this._unscheduleLayersIdGC();\n    const e = this.applicationProperties && this.applicationProperties.viewing && this.applicationProperties.viewing.search,\n      t = e => this.allLayers.some(t => t.id === e);\n    e && e.layers && (e.layers = e.layers.filter(e => t(e.id)));\n    const r = this.presentation && this.presentation.slides;\n    r && r.forEach(e => {\n      e.visibleLayers && (e.visibleLayers = e.visibleLayers.filter(e => t(e.id)));\n    });\n  }\n  static fromJSON(e) {\n    if (!e) throw new s(\"webscene:empty-resource\", \"Expected a JSON resource but got nothing\");\n    return new this({\n      resourceInfo: e\n    });\n  }\n};\nvar ee;\nZ.version = `${z.major}.${z.minor}`, e([b({\n  type: x,\n  json: {\n    write: !0\n  }\n})], Z.prototype, \"applicationProperties\", void 0), e([b({\n  json: {\n    read: {\n      source: \"baseMap\"\n    },\n    write: {\n      target: \"baseMap\"\n    }\n  }\n})], Z.prototype, \"basemap\", void 0), e([b({\n  type: L,\n  json: {\n    read: {\n      source: \"clippingArea.geometry\",\n      reader: U\n    },\n    write: {\n      target: \"clippingArea.geometry\"\n    }\n  }\n})], Z.prototype, \"clippingArea\", void 0), e([A(\"clippingArea\")], Z.prototype, \"writeClippingArea\", null), e([b({\n  type: Boolean,\n  json: {\n    write: {\n      target: \"clippingArea.clip\"\n    }\n  }\n})], Z.prototype, \"clippingEnabled\", void 0), e([S(\"clippingEnabled\", [\"clippingArea\"])], Z.prototype, \"readClippingEnabled\", null), e([A(\"clippingEnabled\")], Z.prototype, \"writeClippingEnabled\", null), e([b({\n  type: N,\n  json: {\n    read: {\n      source: \"mapFloorInfo\"\n    },\n    write: {\n      target: \"mapFloorInfo\"\n    }\n  }\n})], Z.prototype, \"floorInfo\", void 0), e([b({\n  type: R,\n  json: {\n    write: !0\n  }\n})], Z.prototype, \"heightModelInfo\", void 0), e([b({\n  json: {\n    write: {\n      target: \"operationalLayers\",\n      ignoreOrigin: !0\n    }\n  }\n})], Z.prototype, \"layers\", void 0), e([A(\"layers\")], Z.prototype, \"writeLayers\", null), e([b({\n  readOnly: !0,\n  type: D,\n  json: {\n    type: Q(),\n    write: {\n      ignoreOrigin: !0,\n      target: \"version\",\n      isRequired: !0,\n      overridePolicy: () => ({\n        enabled: !0,\n        allowNull: !0,\n        ignoreOrigin: !0\n      })\n    }\n  }\n})], Z.prototype, \"sourceVersion\", void 0), e([S(\"sourceVersion\", [\"version\"])], Z.prototype, \"readSourceVersion\", null), e([A(\"sourceVersion\")], Z.prototype, \"writeSourceVersion\", null), e([b({\n  json: {\n    read: !1,\n    write: !1\n  }\n})], Z.prototype, \"tables\", void 0), e([b()], Z.prototype, \"thumbnailUrl\", null), e([b({\n  type: String,\n  json: {\n    write: {\n      writerEnsuresNonNull: !0,\n      ignoreOrigin: !0\n    }\n  }\n})], Z.prototype, \"authoringApp\", null), e([A(\"authoringApp\")], Z.prototype, \"writeAuthoringApp\", null), e([b({\n  type: String,\n  json: {\n    write: {\n      writerEnsuresNonNull: !0,\n      ignoreOrigin: !0\n    }\n  }\n})], Z.prototype, \"authoringAppVersion\", null), e([A(\"authoringAppVersion\")], Z.prototype, \"writeAuthoringAppVersion\", null), e([b({\n  json: {\n    write: {\n      isRequired: !0,\n      allowNull: !0,\n      ignoreOrigin: !0,\n      enabled: !0\n    }\n  }\n})], Z.prototype, \"ground\", void 0), e([A(\"ground\")], Z.prototype, \"writeGround\", null), e([b({\n  type: o.ofType(K),\n  json: {\n    write: !0\n  }\n})], Z.prototype, \"transportationNetworks\", void 0), e([b({\n  type: q,\n  nonNullable: !0,\n  json: {\n    write: {\n      ignoreOrigin: !0,\n      writer: (e, t, r, i) => {\n        if (e.slides && e.slides.length > 0) {\n          const r = {\n            ...i,\n            isPresentation: !0\n          };\n          t.presentation = e.write({}, r);\n        }\n      }\n    }\n  }\n})], Z.prototype, \"presentation\", void 0), e([b({\n  type: B,\n  nonNullable: !0,\n  json: {\n    write: {\n      target: \"initialState\",\n      isRequired: !0,\n      ignoreOrigin: !0\n    },\n    default: () => new B({\n      viewingMode: \"global\",\n      spatialReference: V.WebMercator\n    })\n  }\n})], Z.prototype, \"initialViewProperties\", void 0), e([S(\"initialViewProperties\", [\"initialState.environment\", \"spatialReference\", \"viewingMode\", \"initialState.viewpoint\"])], Z.prototype, \"readInitialViewProperties\", null), e([b({\n  type: V,\n  json: {\n    read: !1,\n    write: {\n      isRequired: !0,\n      ignoreOrigin: !0\n    }\n  }\n})], Z.prototype, \"spatialReference\", null), e([b({\n  type: [\"local\", \"global\"],\n  json: {\n    read: !1,\n    write: {\n      isRequired: !0,\n      ignoreOrigin: !0\n    }\n  }\n})], Z.prototype, \"viewingMode\", null), e([b({\n  type: C\n})], Z.prototype, \"portalItem\", void 0), e([b()], Z.prototype, \"resourceInfo\", void 0), Z = e([_(\"esri.WebScene\")], Z), function (e) {\n  e[e.SAVE = 0] = \"SAVE\", e[e.SAVE_AS = 1] = \"SAVE_AS\";\n}(ee || (ee = {}));\nconst te = Z;\nexport { te as default };","map":{"version":3,"names":["_","e","version","t","r","i","o","s","a","clone","n","l","loadAll","p","c","isSome","d","unwrap","h","MultiOriginJSONMixin","u","MultiOriginJSONSupport","m","EsriPromiseMixin","y","debounce","w","eachAlways","g","urlToObject","f","addQueryParameter","v","property","b","reader","S","subclass","writer","A","updateOrigins","I","readLoadable","j","L","R","canProjectWithoutEngine","P","V","validateWebSceneError","M","fromJSON","U","isEarth","O","E","C","N","createSchemaValidationError","T","createCopyError","G","ViewingMode","F","isSpatialReferenceSupported","$","saveResources","W","getOptimalThumbnailSize","J","x","k","B","q","K","Version","D","getLoader","H","z","Q","major","minor","push","X","Y","Z","LoadableMixin","constructor","_layersIdGCTimeoutId","_handles","_updateFromPromise","applicationProperties","clippingArea","clippingEnabled","floorInfo","heightModelInfo","sourceVersion","transportationNetworks","presentation","initialViewProperties","portalItem","resourceInfo","_debouncedSaveOperations","ee","SAVE","_saveImpl","SAVE_AS","_saveAsImpl","_resourceReferences","paths","authoringApp","authoringAppVersion","_isAuthoringAppSetByUser","_isAuthoringAppVersionSetByUser","initialize","when","catch","getLogger","declaredClass","error","_validateJSON","addResolvingPromise","Promise","reject","read","_validateSpatialReference","_validateHeightModelInfo","add","allLayers","on","_scheduleLayersIdGC","destroy","_unscheduleLayersIdGC","writeClippingArea","geometry","toJSON","readClippingEnabled","clip","writeClippingEnabled","writeLayers","layerContainerType","map","verifyWriteLayer","write","filter","toArray","messages","title","id","layer","readSourceVersion","split","parseInt","writeSourceVersion","thumbnailUrl","_override","_clearOverride","clear","_set","writeAuthoringApp","writeAuthoringAppVersion","writeGround","transparency","layers","readInitialViewProperties","initialState","environment","spatialReference","WebMercator","viewingMode","viewpoint","load","_loadFromSource","resolve","slides","ground","basemap","origin","baseMap","Array","isArray","elevationLayers","supportsVisibleElevationLayersInSlides","visibleLayers","some","forEach","addMany","_writeBasemapElevationLayers","length","baseMapLayers","loadStatus","loadError","_runLayersIdGC","name","errors","save","type","_ensureLoadBeforeSave","_enableVerifyItemRelativeUrls","url","itemUrl","portal","getDefault","writtenProperties","blockedRelativeUrls","resources","toAdd","toUpdate","toKeep","pendingOperations","all","_verifySave","_updateTypeKeywords","update","data","_saveThumbnail","saveAs","from","_verifySaveAs","_isOverridden","signIn","user","addItem","item","folder","prototype","call","ignoreDefaults","updateThumbnail","thumbnail","arguments","undefined","message","details","concat","ignoreUnsupported","requiredPropertyChecksDisabled","strictSchemaValidationEnabled","then","validate","join","canNotSaveAs","verifySaveAs","verifyItemRelativeUrls","writtenUrls","updateFrom","_updateFrom","whenReady","environmentExcluded","apply","viewpointExcluded","allLayerViews","thumbnailExcluded","_updateFromThumbnail","thumbnailSize","takeScreenshot","format","width","height","disableDecorations","dataUrl","_loadFromJSON","_loadFromItem","_loadObjectsWithLayers","_readAndLoadFromJSON","_extractOperationalLayers","supportsGround","layerType","operationalLayers","operationalElevationLayers","basemapElevationLayers","_ref","populateOperationalLayers","context","defaultLayerType","items","beforeSave","fetchData","readResourcePaths","_sceneSpatialReference","Global","Local","equals","camera","position","targetGeometry","cameraSpatialReference","sceneSpatialReference","find","slideSpatialReference","parse","typeKeywords","includes","indexOf","_verifyItemRelativeRootPath","path","rootPath","clearTimeout","setTimeout","viewing","search","json","source","target","Boolean","ignoreOrigin","readOnly","isRequired","overridePolicy","enabled","allowNull","String","writerEnsuresNonNull","ofType","nonNullable","isPresentation","default","te"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/WebScene.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"./chunks/tslib.es6.js\";import{version as t}from\"./kernel.js\";import r from\"./Map.js\";import i from\"./Viewpoint.js\";import o from\"./core/Collection.js\";import s from\"./core/Error.js\";import a from\"./core/Handles.js\";import{clone as n}from\"./core/lang.js\";import l from\"./core/Loadable.js\";import{loadAll as p}from\"./core/loadAll.js\";import c from\"./core/Logger.js\";import{isSome as d,unwrap as h}from\"./core/maybe.js\";import{MultiOriginJSONMixin as u,MultiOriginJSONSupport as m}from\"./core/MultiOriginJSONSupport.js\";import{EsriPromiseMixin as y}from\"./core/Promise.js\";import{debounce as w,eachAlways as g}from\"./core/promiseUtils.js\";import{urlToObject as f,addQueryParameter as v}from\"./core/urlUtils.js\";import{property as b}from\"./core/accessorSupport/decorators/property.js\";import\"./core/accessorSupport/ensureType.js\";import{reader as S}from\"./core/accessorSupport/decorators/reader.js\";import{subclass as _}from\"./core/accessorSupport/decorators/subclass.js\";import{writer as A}from\"./core/accessorSupport/decorators/writer.js\";import{updateOrigins as I}from\"./core/accessorSupport/originUtils.js\";import{readLoadable as j}from\"./core/accessorSupport/read.js\";import L from\"./geometry/Extent.js\";import R from\"./geometry/HeightModelInfo.js\";import{canProjectWithoutEngine as P}from\"./geometry/projection.js\";import V from\"./geometry/SpatialReference.js\";import{validateWebSceneError as M}from\"./geometry/support/heightModelInfoUtils.js\";import{fromJSON as U}from\"./geometry/support/jsonUtils.js\";import{isEarth as O}from\"./geometry/support/spatialReferenceUtils.js\";import E from\"./portal/Portal.js\";import C from\"./portal/PortalItem.js\";import N from\"./support/MapFloorInfo.js\";import{createSchemaValidationError as T,createCopyError as G}from\"./support/webSceneUtils.js\";import{ViewingMode as F}from\"./views/ViewingMode.js\";import{isSpatialReferenceSupported as $}from\"./views/support/spatialReferenceSupport.js\";import{saveResources as W}from\"./webdoc/support/saveUtils.js\";import{getOptimalThumbnailSize as J}from\"./webdoc/support/thumbnailUtils.js\";import x from\"./webscene/ApplicationProperties.js\";import k from\"./webscene/Environment.js\";import B from\"./webscene/InitialViewProperties.js\";import q from\"./webscene/Presentation.js\";import K from\"./webscene/TransportationNetwork.js\";import{Version as D}from\"./webscene/Version.js\";import{getLoader as H}from\"./webscene/support/schemaValidatorLoader.js\";const z=new D(1,30),Q=()=>{const e=8,t=[],r=z.major;for(let i=e;i<=z.minor;i++)t.push(`${r}.${i}`);return t},X=\"Web Scene\",Y=\"ViewingMode-Local\";let Z=class extends(l.LoadableMixin(y(u(r)))){constructor(e){super(e),this._layersIdGCTimeoutId=void 0,this._handles=new a,this._updateFromPromise=null,this.applicationProperties=null,this.clippingArea=null,this.clippingEnabled=!1,this.floorInfo=null,this.heightModelInfo=void 0,this.sourceVersion=null,this.transportationNetworks=null,this.presentation=new q,this.initialViewProperties=new B,this.portalItem=null,this.resourceInfo=null,this._debouncedSaveOperations=w((async(e,t,r)=>{switch(e){case ee.SAVE:return this._saveImpl(t);case ee.SAVE_AS:return this._saveAsImpl(r,t)}})),this._resourceReferences={portalItem:null,paths:[]},this.authoringApp=null,this.authoringAppVersion=null,this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1}initialize(){if(this.when().catch((e=>{c.getLogger(this.declaredClass).error(\"#load()\",\"Failed to load web scene\",e)})),this.resourceInfo){let t;try{t=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(t),this.addResolvingPromise(this._validateSpatialReference()),this.addResolvingPromise(this._validateHeightModelInfo())}this._handles.add(this.allLayers.on(\"change\",(()=>this._scheduleLayersIdGC())))}destroy(){this._unscheduleLayersIdGC(),this._handles.destroy(),this.presentation&&this.presentation.destroy();const e=this.portalItem;this.portalItem=null,e?.destroy()}writeClippingArea(e,t){t.clippingArea||(t.clippingArea={}),t.clippingArea.geometry=e.toJSON()}readClippingEnabled(e,t){return!!t.clippingArea&&!!t.clippingArea.clip}writeClippingEnabled(e,t){this.clippingArea&&(t.clippingArea||(t.clippingArea={}),t.clippingArea.clip=e)}writeLayers(e,t,r,i){const o={...i,layerContainerType:\"operational-layers\"},s=e.map((e=>this.verifyWriteLayer(e,i)?e.write({},o):null)).filter((e=>!!e));t[r]=s.toArray()}verifyWriteLayer(e,t){return\"write\"in e||(t&&t.messages&&t.messages.push(new s(\"layer:unsupported\",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted in web scenes`,{layer:e})),!1)}readSourceVersion(e,t){const[r,i]=t.version.split(\".\");return new D(parseInt(r,10),parseInt(i,10))}writeSourceVersion(e,t,r){t[r]=`${z.major}.${z.minor}`}get thumbnailUrl(){return this.portalItem?.thumbnailUrl??null}set thumbnailUrl(e){e?this._override(\"thumbnailUrl\",e):(this._clearOverride(\"thumbnailUrl\"),this.clear(\"thumbnailUrl\",\"user\"))}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set(\"authoringApp\",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp=\"ArcGIS API for JavaScript\"}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set(\"authoringAppVersion\",e)}writeAuthoringAppVersion(e,r){e&&this._isAuthoringAppVersionSetByUser?r.authoringAppVersion=e:r.authoringAppVersion=t}writeGround(e,t,r,i){t[r]=e?e.write({},i):{transparency:0,layers:[]}}readInitialViewProperties(e,t){const r={};return t.initialState&&t.initialState.environment&&(r.environment=k.fromJSON(t.initialState.environment)),t.spatialReference?r.spatialReference=V.fromJSON(t.spatialReference):r.spatialReference=V.WebMercator,r.viewingMode=t.viewingMode||\"global\",t.initialState&&t.initialState.viewpoint&&(r.viewpoint=i.fromJSON(t.initialState.viewpoint)),new B(r)}get spatialReference(){return this.initialViewProperties?.spatialReference??V.WebMercator}get viewingMode(){return this.initialViewProperties?.viewingMode??\"global\"}load(e){return this.addResolvingPromise(this._loadFromSource()),Promise.resolve(this)}loadAll(){return p(this,(e=>{const t=this.presentation&&this.presentation.slides;e(this.ground,this.basemap,this.layers,t&&t.map((e=>e.basemap)))}))}read(e,t){t={...t,origin:\"web-scene\"};const r=this._isAuthoringAppVersionSetByUser,i=this._isAuthoringAppSetByUser;if(j(this,e,(t=>super.read(e,t)),t),i||(this._isAuthoringAppSetByUser=!1),r||(this._isAuthoringAppVersionSetByUser=!1),e.baseMap&&Array.isArray(e.baseMap.elevationLayers)&&this.sourceVersion?.supportsVisibleElevationLayersInSlides){const t=e.baseMap.elevationLayers.map((e=>({id:e.id}))),r=this.presentation.slides,i=(e,t)=>e.visibleLayers.some((e=>e.id===t)),o=t.filter((e=>!r.some((t=>i(t,e.id)))));r.forEach((e=>{e.visibleLayers.addMany(o)}))}}_writeBasemapElevationLayers(e){const t=e.ground&&e.ground.layers;!e.baseMap&&t&&t.length&&(e.baseMap={title:\"Basemap\",baseMapLayers:[]}),e.baseMap&&(e.baseMap.elevationLayers=n(t))}write(e,t){if(\"loaded\"!==this.loadStatus){const e=new s(\"webscene:not-loaded\",\"Web scene must be loaded before it can be serialized\");throw c.getLogger(this.declaredClass).error(\"#toJSON()\",\"Web scene must be loaded before it can be serialized\",this.loadError||this.loadStatus),e}this._runLayersIdGC();const r=!t?.messages;t={messages:[],...t,origin:\"web-scene\"};const i=super.write(e,t);if(r){const e=t.messages?.filter((e=>\"web-document-write:property-required\"===e.name))??[];if(e.length){const t=new s(\"web-document:property-required\",\"One or more properties that are required in the webscene JSON are missing, see details for the specific errors\",{errors:e});throw c.getLogger(this.declaredClass).error(\"#toJSON()\",\"One or more properties that are required in the webscene JSON are missing\",e),t}}return this._writeBasemapElevationLayers(i),i}async save(e){return this._debouncedSaveOperations(ee.SAVE,e)}async _saveImpl(e){if(!this.portalItem)throw c.getLogger(this.declaredClass).error(\"save(): requires the .portalItem property to be set\"),await Promise.resolve(),new s(\"webscene:portal-item-not-set\",\"Portal item to save to has not been set on the WebScene\");if(this.portalItem?.type!==X)throw await Promise.resolve(),new s(\"webscene:portal-item-wrong-type\",`Portal item needs to have type \"${X}\"`);const t=this._updateFromPromise;await this._ensureLoadBeforeSave();const r=this._enableVerifyItemRelativeUrls({origin:\"web-scene\",url:this.portalItem.itemUrl?f(this.portalItem.itemUrl):null,messages:[],portal:this.portalItem.portal??E.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),i=this.write({},r);return await Promise.all(r.resources.pendingOperations),await this._verifySave(i,r,e),this._updateTypeKeywords(this.portalItem),await this.portalItem.update({data:i}),await W(this._resourceReferences,r,null),I(r),t&&await t,await this._saveThumbnail(),this.portalItem}async saveAs(e,t){return this._debouncedSaveOperations(ee.SAVE_AS,t,e)}async _saveAsImpl(e,t){let r=C.from(e);r||(c.getLogger(this.declaredClass).error(\"saveAs(portalItem): requires a portal item parameter\"),await Promise.reject(new s(\"webscene:portal-item-required\",\"saveAs requires a portal item to save to\"))),r.id&&(r=r.clone(),r.id=null);const i=r.portal||E.getDefault();await this._ensureLoadBeforeSave(),r.type=X,r.portal=i;const o=this._enableVerifyItemRelativeUrls({origin:\"web-scene\",url:null,messages:[],portal:i,portalItem:r,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}}),a=this.write({},o);await Promise.all(o.resources.pendingOperations),await this._verifySaveAs(a,o,t);const n=this.thumbnailUrl,l=!this._isOverridden(\"thumbnailUrl\");return this._updateTypeKeywords(r),await i.signIn(),await(i.user?.addItem({item:r,folder:t&&t.folder,data:a})),await W(this._resourceReferences,o,null),this.portalItem=r,m.prototype.read.call(this,{version:a.version,authoringApp:a.authoringApp,authoringAppVersion:a.authoringAppVersion},{name:\"web-scene\",ignoreDefaults:!0,url:r.itemUrl&&f(r.itemUrl)}),I(o),n&&(this.thumbnailUrl=l?v(n,\"w\",\"8192\"):n),o.portalItem=r,await this._saveThumbnail(),r}async _saveThumbnail(){this._isOverridden(\"thumbnailUrl\")&&(await(this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl})),this._clearOverride(\"thumbnailUrl\"),this.clear(\"thumbnailUrl\",\"user\"))}_verifySave(e,t,r,i=!1){if(!O(this.spatialReference))return Promise.reject(new s(\"webscene:unsupported-spatial-reference\",\"Webscenes using spatial reference systems from Mars or Moon can not be saved currently.\"));let o,a=t.messages?.filter((e=>\"error\"===e.type)).map((e=>new s(e.name,e.message,e.details)))??[];t.blockedRelativeUrls&&(a=a.concat(t.blockedRelativeUrls.map((e=>new s(\"url:unsupported\",`Relative url '${e}' is not supported in Web Scene`))))),r&&r.ignoreUnsupported&&(a=a.filter((e=>\"layer:unsupported\"!==e.name&&\"symbol:unsupported\"!==e.name&&\"symbol-layer:unsupported\"!==e.name&&\"property:unsupported\"!==e.name&&\"url:unsupported\"!==e.name&&\"scenemodification:unsupported\"!==e.name))),r?.requiredPropertyChecksDisabled&&(a=a.filter((e=>\"web-document-write:property-required\"!==e.name)));const n=!!r?.strictSchemaValidationEnabled,l=H();return o=n&&l?l().then((t=>{const r=t.validate(e);if(r.length>0){const e=`webscene did not validate:\\n${r.join(\"\\n\")}`;c.getLogger(this.declaredClass).error(`${i?\"saveAs\":\"save\"}(): ${e}`)}return r.map((e=>new s(\"webscene:schema-validation\",e)))})).then((e=>{if(e.length>0)throw T(e.concat(a));return a})):Promise.resolve(a),o.then((e=>{if(e.length>0)throw new s(\"webscene:save\",\"Failed to save webscene due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:e})}))}_verifySaveAs(e,t,r){return this.canNotSaveAs(t)?Promise.reject(G()):this._verifySave(e,t,r,!0)}verifySaveAs(e){const t=this._enableVerifyItemRelativeUrls({origin:\"web-scene\",messages:[]}),r=this.write({},t);return this._verifySaveAs(r,t,e)}canNotSaveAs(e){return e||(e=this._enableVerifyItemRelativeUrls({origin:\"web-scene\",messages:[]}),this.write({},e)),(e.verifyItemRelativeUrls?.writtenUrls?.length??0)>0}async updateFrom(e,t={}){const r=this._updateFrom(e,t);this._updateFromPromise=r,await r;this._updateFromPromise===r&&(this._updateFromPromise=null)}async _updateFrom(e,t={}){if(await e.whenReady(),!t.environmentExcluded&&e.environment&&(this.initialViewProperties.environment=k.prototype.clone.apply(e.environment)),!t.viewpointExcluded&&e.viewpoint&&(this.initialViewProperties.viewpoint=e.viewpoint.clone()),this.initialViewProperties.spatialReference=e.spatialReference.clone(),this.initialViewProperties.viewingMode=e.viewingMode,d(e.clippingArea)?e.clippingArea!==this.clippingArea&&(this.clippingArea=e.clippingArea.clone(),this.clippingEnabled=!0):this.clippingEnabled=!1,e.heightModelInfo&&(this.heightModelInfo=e.heightModelInfo.clone()),e.map===this)for(const r of e.allLayerViews){const e=\"visible\";e in r&&e in r.layer&&r._isOverridden(e)&&(r.layer[e]=r[e])}(!1===t.thumbnailExcluded||null==t.thumbnailExcluded&&!t.viewpointExcluded)&&await this._updateFromThumbnail(e,t.thumbnailSize??void 0)}async _updateFromThumbnail(e,t){const r=J(e,t),i=await e.takeScreenshot({format:\"jpg\",width:r.width,height:r.height,disableDecorations:!0});this.thumbnailUrl=i.dataUrl}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:\"web-scene\"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):this._loadObjectsWithLayers()}_readAndLoadFromJSON(e,t){const r=this._validateJSON(e);return this.read(r,t),this._loadFromJSON(r,t)}_extractOperationalLayers(e){const t=[];if(!this.sourceVersion?.supportsGround&&e.baseMap&&Array.isArray(e.baseMap.elevationLayers))for(const o of e.baseMap.elevationLayers)t.push(o);const r=[],i=e=>(e.layers&&(e.layers=e.layers.filter(i)),\"ArcGISTiledElevationServiceLayer\"!==e.layerType||(this.sourceVersion?.supportsGround||r.push(e),!1));return{operationalLayers:e.operationalLayers?e.operationalLayers.filter(i):[],operationalElevationLayers:r,basemapElevationLayers:t}}_loadFromJSON(e,t){const r=new o;return this._validateSpatialReference().then((()=>this._validateHeightModelInfo())).then((()=>import(\"./layers/support/layersCreator.js\"))).then((({populateOperationalLayers:i})=>{const{operationalLayers:o,operationalElevationLayers:s,basemapElevationLayers:a}=this._extractOperationalLayers(e),n=[],l={context:{...t,layerContainerType:\"operational-layers\"}};if(this.portalItem&&(l.context.portal=this.portalItem.portal||E.getDefault()),a.length>0){const e={...l,context:{...l.context,layerContainerType:\"ground\"}};e.defaultLayerType=\"ArcGISTiledElevationServiceLayer\",n.push(i(this.ground.layers,a,e))}if(s.length>0){const e={...l,context:{...l.context,layerContainerType:\"ground\"}};e.defaultLayerType=\"ArcGISTiledElevationServiceLayer\",n.push(i(r,s,e))}return o&&o.length>0&&n.push(i(this.layers,o,l)),g(n).then((()=>{}))})).then((()=>this._loadObjectsWithLayers())).then((()=>{this.ground.layers.addMany(r)}))}async _ensureLoadBeforeSave(){await this.load(),await this._loadObjectsWithLayers();const e=[];for(const t of this.allLayers.items)if(\"beforeSave\"in t&&\"function\"==typeof t.beforeSave){const r=t.beforeSave();r&&e.push(r)}await g(e)}async _loadObjectsWithLayers(){const e=[];this.ground&&e.push(this.ground.load()),this.basemap&&e.push(this.basemap.load()),this.presentation.slides.forEach((t=>{t.basemap&&e.push(t.basemap.load())})),await g(e)}async _loadFromItem(e){if(await e.load().catch((e=>{throw new s(\"webscene:load-portal-item\",\"Failed to load portal item\",{error:e})})),\"Web Scene\"!==e.type)throw new s(\"webscene:invalid-portal-item\",\"Invalid portal item type '${type}', expected 'Web Scene'\",{type:e.type});const t=await e.fetchData();this.resourceInfo=t;const r={origin:\"web-scene\",url:f(e.itemUrl),portal:e.portal||E.getDefault(),portalItem:e,readResourcePaths:[]};await this._readAndLoadFromJSON(t,r),this._resourceReferences={portalItem:e,paths:r.readResourcePaths??[]}}_validateSpatialReference(){const e=this.initialViewProperties,t=this._sceneSpatialReference;let r;if(\"local\"!==e.viewingMode){if(!$(t,F.Global))return Promise.reject(new s(\"webscene:unsupported-spatial-reference\",\"Unsupported spatial reference (${spatialReference.wkid}) in global mode, only Web Mercator, WGS84 GCS or CGCS2000 are supported\",{spatialReference:t,viewingMode:e.viewingMode}));r=e=>!e||P(e,t)}else{if(!$(t,F.Local))return Promise.reject(new s(\"webscene:unsupported-spatial-reference\",\"Unsupported spatial reference (${spatialReference.wkid}) in local mode, only projected coordinate systems are supported\",{spatialReference:t,viewingMode:e.viewingMode}));r=e=>!e||e.equals(t)}const i=e=>h(e?.camera)?.position.spatialReference??h(e?.targetGeometry)?.spatialReference,o=e.viewpoint,a=i(o);if(a&&!r(a))return Promise.reject(new s(\"webscene:incompatible-camera-spatial-reference\",\"Camera spatial reference (${cameraSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})\",{cameraSpatialReference:a,sceneSpatialReference:t,viewingMode:e.viewingMode}));const n=this.presentation.slides.find((e=>!r(i(e.viewpoint))));if(n){const r=i(n.viewpoint);return Promise.reject(new s(\"webscene:incompatible-slide-spatial-reference\",\"Slide spatial reference (${slideSpatialReference.wkid}) is incompatible with the scene spatial reference (${sceneSpatialReference.wkid})\",{slideSpatialReference:r,sceneSpatialReference:t,viewingMode:e.viewingMode}))}return Promise.resolve()}_validateHeightModelInfo(){const e=this._sceneSpatialReference,t=M(this.heightModelInfo,e);return t?Promise.reject(t):Promise.resolve()}_validateJSON(e){const t=D.parse(e.version||\"\",\"webscene\");return z.validate(t),e.version=`${t.major}.${t.minor}`,1===t.major&&t.minor<=2&&(e.spatialReference=V.WebMercator.toJSON()),e}_updateTypeKeywords(e){\"local\"===this.initialViewProperties.viewingMode?e.typeKeywords?e.typeKeywords.includes(Y)||e.typeKeywords.push(Y):e.typeKeywords=[Y]:\"global\"===this.initialViewProperties.viewingMode&&e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((e=>e!==Y))),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}get _sceneSpatialReference(){return this.initialViewProperties.spatialReference||V.WebMercator}get _verifyItemRelativeRootPath(){return this.portalItem?.itemUrl?f(this.portalItem.itemUrl).path:null}_enableVerifyItemRelativeUrls(e){const t=this._verifyItemRelativeRootPath;return t&&(e.verifyItemRelativeUrls={rootPath:t,writtenUrls:[]}),e}_unscheduleLayersIdGC(){this._layersIdGCTimeoutId&&(clearTimeout(this._layersIdGCTimeoutId),this._layersIdGCTimeoutId=0)}_scheduleLayersIdGC(){this._unscheduleLayersIdGC(),this._layersIdGCTimeoutId=setTimeout((()=>{this._layersIdGCTimeoutId=0,this._runLayersIdGC()}),3e3)}_runLayersIdGC(){this._unscheduleLayersIdGC();const e=this.applicationProperties&&this.applicationProperties.viewing&&this.applicationProperties.viewing.search,t=e=>this.allLayers.some((t=>t.id===e));e&&e.layers&&(e.layers=e.layers.filter((e=>t(e.id))));const r=this.presentation&&this.presentation.slides;r&&r.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>t(e.id))))}))}static fromJSON(e){if(!e)throw new s(\"webscene:empty-resource\",\"Expected a JSON resource but got nothing\");return new this({resourceInfo:e})}};var ee;Z.version=`${z.major}.${z.minor}`,e([b({type:x,json:{write:!0}})],Z.prototype,\"applicationProperties\",void 0),e([b({json:{read:{source:\"baseMap\"},write:{target:\"baseMap\"}}})],Z.prototype,\"basemap\",void 0),e([b({type:L,json:{read:{source:\"clippingArea.geometry\",reader:U},write:{target:\"clippingArea.geometry\"}}})],Z.prototype,\"clippingArea\",void 0),e([A(\"clippingArea\")],Z.prototype,\"writeClippingArea\",null),e([b({type:Boolean,json:{write:{target:\"clippingArea.clip\"}}})],Z.prototype,\"clippingEnabled\",void 0),e([S(\"clippingEnabled\",[\"clippingArea\"])],Z.prototype,\"readClippingEnabled\",null),e([A(\"clippingEnabled\")],Z.prototype,\"writeClippingEnabled\",null),e([b({type:N,json:{read:{source:\"mapFloorInfo\"},write:{target:\"mapFloorInfo\"}}})],Z.prototype,\"floorInfo\",void 0),e([b({type:R,json:{write:!0}})],Z.prototype,\"heightModelInfo\",void 0),e([b({json:{write:{target:\"operationalLayers\",ignoreOrigin:!0}}})],Z.prototype,\"layers\",void 0),e([A(\"layers\")],Z.prototype,\"writeLayers\",null),e([b({readOnly:!0,type:D,json:{type:Q(),write:{ignoreOrigin:!0,target:\"version\",isRequired:!0,overridePolicy:()=>({enabled:!0,allowNull:!0,ignoreOrigin:!0})}}})],Z.prototype,\"sourceVersion\",void 0),e([S(\"sourceVersion\",[\"version\"])],Z.prototype,\"readSourceVersion\",null),e([A(\"sourceVersion\")],Z.prototype,\"writeSourceVersion\",null),e([b({json:{read:!1,write:!1}})],Z.prototype,\"tables\",void 0),e([b()],Z.prototype,\"thumbnailUrl\",null),e([b({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],Z.prototype,\"authoringApp\",null),e([A(\"authoringApp\")],Z.prototype,\"writeAuthoringApp\",null),e([b({type:String,json:{write:{writerEnsuresNonNull:!0,ignoreOrigin:!0}}})],Z.prototype,\"authoringAppVersion\",null),e([A(\"authoringAppVersion\")],Z.prototype,\"writeAuthoringAppVersion\",null),e([b({json:{write:{isRequired:!0,allowNull:!0,ignoreOrigin:!0,enabled:!0}}})],Z.prototype,\"ground\",void 0),e([A(\"ground\")],Z.prototype,\"writeGround\",null),e([b({type:o.ofType(K),json:{write:!0}})],Z.prototype,\"transportationNetworks\",void 0),e([b({type:q,nonNullable:!0,json:{write:{ignoreOrigin:!0,writer:(e,t,r,i)=>{if(e.slides&&e.slides.length>0){const r={...i,isPresentation:!0};t.presentation=e.write({},r)}}}}})],Z.prototype,\"presentation\",void 0),e([b({type:B,nonNullable:!0,json:{write:{target:\"initialState\",isRequired:!0,ignoreOrigin:!0},default:()=>new B({viewingMode:\"global\",spatialReference:V.WebMercator})}})],Z.prototype,\"initialViewProperties\",void 0),e([S(\"initialViewProperties\",[\"initialState.environment\",\"spatialReference\",\"viewingMode\",\"initialState.viewpoint\"])],Z.prototype,\"readInitialViewProperties\",null),e([b({type:V,json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],Z.prototype,\"spatialReference\",null),e([b({type:[\"local\",\"global\"],json:{read:!1,write:{isRequired:!0,ignoreOrigin:!0}}})],Z.prototype,\"viewingMode\",null),e([b({type:C})],Z.prototype,\"portalItem\",void 0),e([b()],Z.prototype,\"resourceInfo\",void 0),Z=e([_(\"esri.WebScene\")],Z),function(e){e[e.SAVE=0]=\"SAVE\",e[e.SAVE_AS=1]=\"SAVE_AS\"}(ee||(ee={}));const te=Z;export{te as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}