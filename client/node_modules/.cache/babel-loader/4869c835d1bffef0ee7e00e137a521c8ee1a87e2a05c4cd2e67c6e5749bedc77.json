{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as e } from \"../../../core/maybe.js\";\nimport { throwIfAborted as t, whenOrAbort as r } from \"../../../core/promiseUtils.js\";\nimport { isSVG as s } from \"../../../core/urlUtils.js\";\nimport { TextureCollection as i } from \"./TextureCollection.js\";\nimport { PowerOfTwoResizeMode as o } from \"../webgl-engine/lib/basicInterfaces.js\";\nimport { Texture as n } from \"../webgl-engine/lib/Texture.js\";\nclass l extends i {\n  constructor(e, t, r, s) {\n    super(t, s), this._streamDataRequester = e, this._parameters = r;\n  }\n  async fromUrl(s, i, o) {\n    t(o);\n    const n = e(o) ? o.signal : null,\n      l = this.makeUid(s, i);\n    let a = this._textureRequests.get(l);\n    if (!a) {\n      const e = new AbortController(),\n        t = this._streamDataRequester.request(s, \"image\", {\n          uid: l,\n          signal: e.signal\n        });\n      a = {\n        referenceCount: 0,\n        texture: null,\n        textureAsync: null,\n        abortController: e\n      };\n      const r = a;\n      this._textureRequests.set(l, a), a.textureAsync = t.then(async e => {\n        const t = this._createTexture(s, e, i);\n        return r.texture = t, r.abortController = null, this._stage.add(t), await this._stage.load(t), {\n          uid: l,\n          texture: t,\n          release: () => this._release(l)\n        };\n      }, e => {\n        throw r.abortController = null, e;\n      });\n    }\n    a.referenceCount++;\n    try {\n      return await r(a.textureAsync, n);\n    } catch (h) {\n      throw this._release(l), h;\n    }\n  }\n  _createTexture(e, t, r) {\n    const i = {\n      ...this._parameters,\n      powerOfTwoResizeMode: o.PAD\n    };\n    if (s(e)) {\n      if (r || 0 === t.width && 0 === t.height) {\n        const e = t.width ? t.height / t.width : 1;\n        r = r || 64, e > 1 ? (t.width = Math.round(r / e), t.height = r) : (t.width = r, t.height = Math.round(r * e));\n      }\n      this._stage.renderView?.renderingContext.driverTest.svgPremultipliesAlpha.result && (i.preMultiplyAlpha = !1);\n    }\n    return i.width = t.width, i.height = t.height, new n(t, i);\n  }\n}\nexport { l as StreamTextureCollection };","map":{"version":3,"names":["isSome","e","throwIfAborted","t","whenOrAbort","r","isSVG","s","TextureCollection","i","PowerOfTwoResizeMode","o","Texture","n","l","constructor","_streamDataRequester","_parameters","fromUrl","signal","makeUid","a","_textureRequests","get","AbortController","request","uid","referenceCount","texture","textureAsync","abortController","set","then","_createTexture","_stage","add","load","release","_release","h","powerOfTwoResizeMode","PAD","width","height","Math","round","renderView","renderingContext","driverTest","svgPremultipliesAlpha","result","preMultiplyAlpha","StreamTextureCollection"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/support/StreamTextureCollection.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{throwIfAborted as t,whenOrAbort as r}from\"../../../core/promiseUtils.js\";import{isSVG as s}from\"../../../core/urlUtils.js\";import{TextureCollection as i}from\"./TextureCollection.js\";import{PowerOfTwoResizeMode as o}from\"../webgl-engine/lib/basicInterfaces.js\";import{Texture as n}from\"../webgl-engine/lib/Texture.js\";class l extends i{constructor(e,t,r,s){super(t,s),this._streamDataRequester=e,this._parameters=r}async fromUrl(s,i,o){t(o);const n=e(o)?o.signal:null,l=this.makeUid(s,i);let a=this._textureRequests.get(l);if(!a){const e=new AbortController,t=this._streamDataRequester.request(s,\"image\",{uid:l,signal:e.signal});a={referenceCount:0,texture:null,textureAsync:null,abortController:e};const r=a;this._textureRequests.set(l,a),a.textureAsync=t.then((async e=>{const t=this._createTexture(s,e,i);return r.texture=t,r.abortController=null,this._stage.add(t),await this._stage.load(t),{uid:l,texture:t,release:()=>this._release(l)}}),(e=>{throw r.abortController=null,e}))}a.referenceCount++;try{return await r(a.textureAsync,n)}catch(h){throw this._release(l),h}}_createTexture(e,t,r){const i={...this._parameters,powerOfTwoResizeMode:o.PAD};if(s(e)){if(r||0===t.width&&0===t.height){const e=t.width?t.height/t.width:1;r=r||64,e>1?(t.width=Math.round(r/e),t.height=r):(t.width=r,t.height=Math.round(r*e))}this._stage.renderView?.renderingContext.driverTest.svgPremultipliesAlpha.result&&(i.preMultiplyAlpha=!1)}return i.width=t.width,i.height=t.height,new n(t,i)}}export{l as StreamTextureCollection};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}