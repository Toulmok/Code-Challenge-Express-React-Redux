{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { workerMessages as e } from \"../../kernel.js\";\nimport t from \"../Error.js\";\nimport o from \"../Logger.js\";\nimport { removeMaybe as s } from \"../maybe.js\";\nimport { onAbortOrThrow as r, isPromiseLike as n, isAbortError as a } from \"../promiseUtils.js\";\nimport { newJobId as i, receiveMessage as l, toInvokeError as d, postMessage as h, MessageType as c } from \"./utils.js\";\nimport { createWorker as p } from \"./workerFactory.js\";\nconst {\n  ABORT: b,\n  INVOKE: m,\n  OPEN: _,\n  OPENED: g,\n  RESPONSE: u\n} = c;\nclass j {\n  static async create(e) {\n    const t = await p();\n    return new j(t, e);\n  }\n  constructor(e, t) {\n    this._outJobs = new Map(), this._inJobs = new Map(), this.worker = e, this.id = t, e.addEventListener(\"message\", this._onMessage.bind(this)), e.addEventListener(\"error\", e => {\n      e.preventDefault(), o.getLogger(\"esri.core.workers.WorkerOwner\").error(e);\n    });\n  }\n  terminate() {\n    this.worker.terminate();\n  }\n  async open(e) {\n    let t = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const {\n        signal: o\n      } = t,\n      s = i();\n    return new Promise((t, n) => {\n      const a = {\n        resolve: t,\n        reject: n,\n        abortHandle: r(o, () => {\n          this._outJobs.delete(s), this._post({\n            type: b,\n            jobId: s\n          });\n        })\n      };\n      this._outJobs.set(s, a), this._post({\n        type: _,\n        jobId: s,\n        modulePath: e\n      });\n    });\n  }\n  _onMessage(e) {\n    const t = l(e);\n    if (t) switch (t.type) {\n      case g:\n        this._onOpenedMessage(t);\n        break;\n      case u:\n        this._onResponseMessage(t);\n        break;\n      case b:\n        this._onAbortMessage(t);\n        break;\n      case m:\n        this._onInvokeMessage(t);\n    }\n  }\n  _onAbortMessage(e) {\n    const t = this._inJobs,\n      o = e.jobId,\n      s = t.get(o);\n    s && (s.controller && s.controller.abort(), t.delete(o));\n  }\n  _onInvokeMessage(t) {\n    const {\n        methodName: o,\n        jobId: s,\n        data: r,\n        abortable: i\n      } = t,\n      l = i ? new AbortController() : null,\n      h = this._inJobs,\n      c = e[o];\n    let p;\n    try {\n      if (\"function\" != typeof c) throw new TypeError(`${o} is not a function`);\n      p = c.call(null, r, {\n        signal: l ? l.signal : null\n      });\n    } catch (b) {\n      return void this._post({\n        type: u,\n        jobId: s,\n        error: d(b)\n      });\n    }\n    n(p) ? (h.set(s, {\n      controller: l,\n      promise: p\n    }), p.then(e => {\n      h.has(s) && (h.delete(s), this._post({\n        type: u,\n        jobId: s\n      }, e));\n    }, e => {\n      h.has(s) && (h.delete(s), e || (e = {\n        message: \"Error encountered at method\" + o\n      }), a(e) || this._post({\n        type: u,\n        jobId: s,\n        error: d(e || {\n          message: `Error encountered at method ${o}`\n        })\n      }));\n    })) : this._post({\n      type: u,\n      jobId: s\n    }, p);\n  }\n  _onOpenedMessage(e) {\n    const {\n        jobId: t,\n        data: o\n      } = e,\n      r = this._outJobs.get(t);\n    r && (this._outJobs.delete(t), s(r.abortHandle), r.resolve(o));\n  }\n  _onResponseMessage(e) {\n    const {\n        jobId: o,\n        error: r,\n        data: n\n      } = e,\n      a = this._outJobs.get(o);\n    a && (this._outJobs.delete(o), s(a.abortHandle), r ? a.reject(t.fromJSON(JSON.parse(r))) : a.resolve(n));\n  }\n  _post(e, t, o) {\n    return h(this.worker, e, t, o);\n  }\n}\nexport { j as default };","map":{"version":3,"names":["workerMessages","e","t","o","removeMaybe","s","onAbortOrThrow","r","isPromiseLike","n","isAbortError","a","newJobId","i","receiveMessage","l","toInvokeError","d","postMessage","h","MessageType","c","createWorker","p","ABORT","b","INVOKE","m","OPEN","_","OPENED","g","RESPONSE","u","j","create","constructor","_outJobs","Map","_inJobs","worker","id","addEventListener","_onMessage","bind","preventDefault","getLogger","error","terminate","open","arguments","length","undefined","signal","Promise","resolve","reject","abortHandle","delete","_post","type","jobId","set","modulePath","_onOpenedMessage","_onResponseMessage","_onAbortMessage","_onInvokeMessage","get","controller","abort","methodName","data","abortable","AbortController","TypeError","call","promise","then","has","message","fromJSON","JSON","parse","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/core/workers/WorkerOwner.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{workerMessages as e}from\"../../kernel.js\";import t from\"../Error.js\";import o from\"../Logger.js\";import{removeMaybe as s}from\"../maybe.js\";import{onAbortOrThrow as r,isPromiseLike as n,isAbortError as a}from\"../promiseUtils.js\";import{newJobId as i,receiveMessage as l,toInvokeError as d,postMessage as h,MessageType as c}from\"./utils.js\";import{createWorker as p}from\"./workerFactory.js\";const{ABORT:b,INVOKE:m,OPEN:_,OPENED:g,RESPONSE:u}=c;class j{static async create(e){const t=await p();return new j(t,e)}constructor(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener(\"message\",this._onMessage.bind(this)),e.addEventListener(\"error\",(e=>{e.preventDefault(),o.getLogger(\"esri.core.workers.WorkerOwner\").error(e)}))}terminate(){this.worker.terminate()}async open(e,t={}){const{signal:o}=t,s=i();return new Promise(((t,n)=>{const a={resolve:t,reject:n,abortHandle:r(o,(()=>{this._outJobs.delete(s),this._post({type:b,jobId:s})}))};this._outJobs.set(s,a),this._post({type:_,jobId:s,modulePath:e})}))}_onMessage(e){const t=l(e);if(t)switch(t.type){case g:this._onOpenedMessage(t);break;case u:this._onResponseMessage(t);break;case b:this._onAbortMessage(t);break;case m:this._onInvokeMessage(t)}}_onAbortMessage(e){const t=this._inJobs,o=e.jobId,s=t.get(o);s&&(s.controller&&s.controller.abort(),t.delete(o))}_onInvokeMessage(t){const{methodName:o,jobId:s,data:r,abortable:i}=t,l=i?new AbortController:null,h=this._inJobs,c=e[o];let p;try{if(\"function\"!=typeof c)throw new TypeError(`${o} is not a function`);p=c.call(null,r,{signal:l?l.signal:null})}catch(b){return void this._post({type:u,jobId:s,error:d(b)})}n(p)?(h.set(s,{controller:l,promise:p}),p.then((e=>{h.has(s)&&(h.delete(s),this._post({type:u,jobId:s},e))}),(e=>{h.has(s)&&(h.delete(s),e||(e={message:\"Error encountered at method\"+o}),a(e)||this._post({type:u,jobId:s,error:d(e||{message:`Error encountered at method ${o}`})}))}))):this._post({type:u,jobId:s},p)}_onOpenedMessage(e){const{jobId:t,data:o}=e,r=this._outJobs.get(t);r&&(this._outJobs.delete(t),s(r.abortHandle),r.resolve(o))}_onResponseMessage(e){const{jobId:o,error:r,data:n}=e,a=this._outJobs.get(o);a&&(this._outJobs.delete(o),s(a.abortHandle),r?a.reject(t.fromJSON(JSON.parse(r))):a.resolve(n))}_post(e,t,o){return h(this.worker,e,t,o)}}export{j as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}