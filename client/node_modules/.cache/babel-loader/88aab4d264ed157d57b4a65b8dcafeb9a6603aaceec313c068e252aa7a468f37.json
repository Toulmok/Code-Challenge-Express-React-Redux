{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as r } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Error.js\";\nimport { isNone as e, isSome as s } from \"../../../core/maybe.js\";\nimport { property as a } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport i from \"./BaseRaster.js\";\nlet n = class extends i {\n  constructor() {\n    super(...arguments), this.datasetFormat = \"Function\", this.tileType = \"Raster\", this.rasterFunction = null;\n  }\n  async open(r) {\n    await this.init();\n    const {\n      rasterFunction: e\n    } = this;\n    this.primaryRasters?.rasters?.length ? e.sourceRasters = this.primaryRasters.rasters : this.primaryRasters = e.getPrimaryRasters();\n    const {\n        rasters: s,\n        rasterIds: a\n      } = this.primaryRasters,\n      o = s.map(t => t.rasterInfo ? void 0 : t.open(r));\n    await Promise.all(o);\n    const i = s.map(_ref => {\n        let {\n          rasterInfo: r\n        } = _ref;\n        return r;\n      }),\n      n = e.bind({\n        rasterInfos: i,\n        rasterIds: a\n      });\n    if (!n.success || 0 === i.length) throw new t(\"raster-function:open\", `cannot bind the function: ${n.error ?? \"\"}`);\n    await this.syncJobHandler();\n    const c = i[0];\n    this.hasUniqueSourceStorageInfo = 1 === i.length || i.slice(1).every(r => this._hasSameStorageInfo(r, c)), this.set(\"sourceJSON\", s[0].sourceJSON), this.set(\"rasterInfo\", e.rasterInfo);\n  }\n  async syncJobHandler() {\n    return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction);\n  }\n  async fetchPixels(r, t, a) {\n    let o = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    const {\n        rasters: i,\n        rasterIds: n\n      } = this.primaryRasters,\n      c = i.map(e => e.fetchPixels(r, t, a, o)),\n      p = await Promise.all(c),\n      l = p.map(r => r.pixelBlock);\n    if (o.skipRasterFunction || l.every(r => e(r))) return p[0];\n    const m = p.find(r => s(r.pixelBlock))?.extent ?? r,\n      u = this.rasterJobHandler ? await this.rasterJobHandler.process({\n        extent: m,\n        primaryPixelBlocks: l,\n        primaryRasterIds: n\n      }) : this.rasterFunction.process({\n        extent: m,\n        primaryPixelBlocks: l,\n        primaryRasterIds: n\n      });\n    return {\n      ...p[0],\n      pixelBlock: u\n    };\n  }\n  _hasSameStorageInfo(r, t) {\n    const {\n        storageInfo: e,\n        pixelSize: s,\n        spatialReference: a,\n        extent: o\n      } = r,\n      {\n        storageInfo: i,\n        pixelSize: n,\n        spatialReference: c,\n        extent: p\n      } = t;\n    return s.x === n.x && s.y === n.y && a.equals(c) && o.equals(p) && e.blockHeight === i.blockHeight && e.blockWidth === i.blockWidth && e.maximumPyramidLevel === i.maximumPyramidLevel;\n  }\n};\nr([a({\n  type: String,\n  json: {\n    write: !0\n  }\n})], n.prototype, \"datasetFormat\", void 0), r([a()], n.prototype, \"tileType\", void 0), r([a()], n.prototype, \"rasterFunction\", void 0), r([a()], n.prototype, \"primaryRasters\", void 0), n = r([o(\"esri.layers.support.rasterDatasets.FunctionRaster\")], n);\nconst c = n;\nexport { c as default };","map":{"version":3,"names":["_","r","t","isNone","e","isSome","s","property","a","subclass","o","i","n","constructor","arguments","datasetFormat","tileType","rasterFunction","open","init","primaryRasters","rasters","length","sourceRasters","getPrimaryRasters","rasterIds","map","rasterInfo","Promise","all","_ref","bind","rasterInfos","success","error","syncJobHandler","c","hasUniqueSourceStorageInfo","slice","every","_hasSameStorageInfo","set","sourceJSON","rasterJobHandler","updateRasterFunction","fetchPixels","undefined","p","l","pixelBlock","skipRasterFunction","m","find","extent","u","process","primaryPixelBlocks","primaryRasterIds","storageInfo","pixelSize","spatialReference","x","y","equals","blockHeight","blockWidth","maximumPyramidLevel","type","String","json","write","prototype","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/layers/support/rasterDatasets/FunctionRaster.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{isNone as e,isSome as s}from\"../../../core/maybe.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import i from\"./BaseRaster.js\";let n=class extends i{constructor(){super(...arguments),this.datasetFormat=\"Function\",this.tileType=\"Raster\",this.rasterFunction=null}async open(r){await this.init();const{rasterFunction:e}=this;this.primaryRasters?.rasters?.length?e.sourceRasters=this.primaryRasters.rasters:this.primaryRasters=e.getPrimaryRasters();const{rasters:s,rasterIds:a}=this.primaryRasters,o=s.map((t=>t.rasterInfo?void 0:t.open(r)));await Promise.all(o);const i=s.map((({rasterInfo:r})=>r)),n=e.bind({rasterInfos:i,rasterIds:a});if(!n.success||0===i.length)throw new t(\"raster-function:open\",`cannot bind the function: ${n.error??\"\"}`);await this.syncJobHandler();const c=i[0];this.hasUniqueSourceStorageInfo=1===i.length||i.slice(1).every((r=>this._hasSameStorageInfo(r,c))),this.set(\"sourceJSON\",s[0].sourceJSON),this.set(\"rasterInfo\",e.rasterInfo)}async syncJobHandler(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)}async fetchPixels(r,t,a,o={}){const{rasters:i,rasterIds:n}=this.primaryRasters,c=i.map((e=>e.fetchPixels(r,t,a,o))),p=await Promise.all(c),l=p.map((r=>r.pixelBlock));if(o.skipRasterFunction||l.every((r=>e(r))))return p[0];const m=p.find((r=>s(r.pixelBlock)))?.extent??r,u=this.rasterJobHandler?await this.rasterJobHandler.process({extent:m,primaryPixelBlocks:l,primaryRasterIds:n}):this.rasterFunction.process({extent:m,primaryPixelBlocks:l,primaryRasterIds:n});return{...p[0],pixelBlock:u}}_hasSameStorageInfo(r,t){const{storageInfo:e,pixelSize:s,spatialReference:a,extent:o}=r,{storageInfo:i,pixelSize:n,spatialReference:c,extent:p}=t;return s.x===n.x&&s.y===n.y&&a.equals(c)&&o.equals(p)&&e.blockHeight===i.blockHeight&&e.blockWidth===i.blockWidth&&e.maximumPyramidLevel===i.maximumPyramidLevel}};r([a({type:String,json:{write:!0}})],n.prototype,\"datasetFormat\",void 0),r([a()],n.prototype,\"tileType\",void 0),r([a()],n.prototype,\"rasterFunction\",void 0),r([a()],n.prototype,\"primaryRasters\",void 0),n=r([o(\"esri.layers.support.rasterDatasets.FunctionRaster\")],n);const c=n;export{c as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}