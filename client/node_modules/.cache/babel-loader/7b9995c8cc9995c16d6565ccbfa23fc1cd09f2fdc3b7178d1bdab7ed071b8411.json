{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../request.js\";\nimport s from \"../../../../core/Accessor.js\";\nimport { remove as i, splitIntoChunks as r } from \"../../../../core/arrayUtils.js\";\nimport { resultOrAbort as a, result as n } from \"../../../../core/asyncUtils.js\";\nimport { estimateStringByteSize as o, estimateNumberByteSize as c } from \"../../../../core/byteSizeEstimations.js\";\nimport d from \"../../../../core/Logger.js\";\nimport { isSome as h, unwrap as l, destroyMaybe as u, abortMaybe as m, isNone as g, get as p } from \"../../../../core/maybe.js\";\nimport { whenOrAbort as _ } from \"../../../../core/promiseUtils.js\";\nimport { watch as y, initial as b } from \"../../../../core/reactiveUtils.js\";\nimport { property as f } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport { subclass as O } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { formatNumber as j } from \"../../../../intl/number.js\";\nimport { getMaximumQuerySize as I, queryAllJSON as C } from \"../../../../layers/support/featureQueryAll.js\";\nimport { enableDirect3DObjectFeatureLayerDisplay as v, sceneLayerEditingEnabled as L } from \"../../../../support/featureFlags.js\";\nimport E from \"../FeatureLayerView3D.js\";\nlet A = class extends s {\n  constructor(e) {\n    super(e), this._warnMaximumChangedObjectsExceeded = !1, this._interactiveEditingSessions = null, this._maximumNumberOfEditOVerrides = S, this._original3DOFLDefinitionExpression = null, this._associatedLayerView = null, this._changedObjectIds = new Set(), this._pendingFetchChangedObjectIds = null, this._pendingFetchAbortController = new AbortController();\n  }\n  initialize() {\n    this._memCache = this.memoryController.newCache(`${this.layer.uid}-attribute-overrides`), this._pendingFetchChangedObjectIds = this._fetchChangedObjectIds(this._pendingFetchAbortController?.signal), this._pendingFetchChangedObjectIds.then(() => {\n      this._pendingFetchAbortController = null, this._pendingFetchChangedObjectIds = null;\n    }), this.is3DOFL && v() && h(this._associatedLayer) && this._associatedLayer.load().then(e => {\n      this.destroyed || (this._original3DOFLDefinitionExpression = e.definitionExpression, this.addHandles(y(() => this._definitionExpression, t => e.definitionExpression = t, b)), this._associatedLayerView = new E({\n        layer: this._associatedLayer,\n        view: this.view\n      }));\n    });\n  }\n  destroy() {\n    this.is3DOFL && v() && h(this._associatedLayerView) && h(this._associatedLayer) && (this._associatedLayer.definitionExpression = l(this._original3DOFLDefinitionExpression)), this._set(\"layer\", null), this._memCache = u(this._memCache), this._pendingFetchAbortController = m(this._pendingFetchAbortController), this._pendingFetchChangedObjectIds = null;\n  }\n  get is3DOFL() {\n    return L() && h(this._associatedLayer) && h(this._associatedLayer.infoFor3D);\n  }\n  get geometryChangedObjectIds() {\n    return this.is3DOFL ? [...this._changedObjectIds] : [];\n  }\n  get _associatedLayer() {\n    return null == this.layer ? null : this.layer.associatedLayer;\n  }\n  get _definitionExpression() {\n    const e = this.geometryChangedObjectIds;\n    return 0 === e.length ? \"1 = 0\" : `OBJECTID IN (${e.join(\",\")})`;\n  }\n  get updating() {\n    if (!this.is3DOFL) return !1;\n    if (!v()) return !1;\n    return !h(this._associatedLayerView) || h(this._associatedLayerView) && this._associatedLayerView.updating;\n  }\n  get isEmpty() {\n    return null == this._pendingFetchChangedObjectIds && 0 === this._changedObjectIds.size;\n  }\n  createInteractiveEditSession(e) {\n    this._changedObjectIds.add(e), this.notifyChange(\"_changedObjectIds\"), g(this._interactiveEditingSessions) && (this._interactiveEditingSessions = []);\n    const t = this._interactiveEditingSessions,\n      s = new F(e, {\n        rollback: () => {\n          i(t, s), 0 === t.length && (this._interactiveEditingSessions = null);\n        },\n        commit: t => {\n          for (const [s, i] of t) this.updateAttributeValue(e, s, i);\n        }\n      });\n    return t.unshift(s), s;\n  }\n  async apply(e, t, s) {\n    if (g(t)) return;\n    const {\n      loadedAttributes: i,\n      attributeData: r\n    } = t;\n    if (g(i) || 0 === i.length || g(r)) return;\n    if (this._pendingFetchChangedObjectIds && (await _(this._pendingFetchChangedObjectIds, s)), 0 === this._changedObjectIds.size) return;\n    const a = {\n        loadedAttributes: i,\n        attributeData: r\n      },\n      n = this._getOverridesFromCache(e, a, this._changedObjectIds),\n      {\n        objectIds: o,\n        fieldNames: c\n      } = n;\n    if (0 === o.length || 0 === c.length) return;\n    const d = await this._queryOverridesFromAssociatedLayer(o, c, s);\n    g(d) || this._processOverridesFromAssociatedLayer(e, d, c, a);\n  }\n  updateGeometry(e) {\n    this._changedObjectIds.add(e), this.notifyChange(\"_changedObjectIds\");\n  }\n  updateAttributeValue(e, t, s) {\n    this._changedObjectIds.add(e), this._cacheAttributeValue(e, t, s), this.notifyChange(\"_changedObjectIds\");\n  }\n  _cacheAttributeValue(e, t, s) {\n    this._memCache.put(this._getAttributeCacheKey(e, t), s, this._memCacheAttributeValueSize(s));\n  }\n  _getOverridesFromCache(e, _ref, i) {\n    let {\n      loadedAttributes: t,\n      attributeData: s\n    } = _ref;\n    const r = new Set(),\n      a = new Array();\n    for (const o of t) a[o.index] = s[o.name];\n    const n = new Set();\n    for (let o = 0; o < e.length; o++) {\n      const s = e[o];\n      if (i.has(s)) for (const e of t) {\n        const t = this._fromCache(s, e.index);\n        void 0 === t ? (r.add(s), n.add(e.name)) : a[e.index][o] = t;\n      }\n    }\n    return {\n      objectIds: Array.from(r),\n      fieldNames: Array.from(n)\n    };\n  }\n  _fromCache(e, t) {\n    const s = this._fromInteractiveEditingSession(e, t);\n    if (void 0 !== s) return s;\n    const i = this._getAttributeCacheKey(e, t);\n    return this._memCache.get(i);\n  }\n  _fromInteractiveEditingSession(e, t) {\n    if (!g(this._interactiveEditingSessions)) for (const s of this._interactiveEditingSessions) {\n      if (s.objectId !== e) continue;\n      const i = s.get(t);\n      if (void 0 !== i) return i;\n    }\n  }\n  _getAttributeCacheKey(e, t) {\n    return `${e}-${t}`;\n  }\n  async _queryOverridesFromAssociatedLayer(e, t, s) {\n    if (0 === e.length || 0 === t.length) return null;\n    e = e.sort((e, t) => e - t), this._warnMaximumChangedObjectsExceeded && (this._warnMaximumChangedObjectsExceeded = !1, this._logMaximumObjectsExceededWarning());\n    const i = this.layer.associatedLayer;\n    if (g(i)) return null;\n    const n = i.createQuery();\n    n.where = \"1=1\", n.returnGeometry = !1, n.outFields = [i.objectIdField, ...t], n.cacheHint = !0, n.objectIds = e;\n    const o = I(i),\n      c = e.length > o ? r(e, o).map(e => {\n        const t = n.clone();\n        return t.objectIds = e, a(C(i, t, {\n          signal: s\n        }));\n      }) : [a(C(i, n, {\n        signal: s\n      }))];\n    return (await Promise.all(c)).reduce((e, t) => e.concat(t.ok ? t.value.features : []), []);\n  }\n  _logMaximumObjectsExceededWarning() {\n    let e = `The number of edited objects that are not yet cached in the scene service exceeds the maximum limit. Attribute changes will only be available for the first ${j(this._maximumNumberOfEditOVerrides)} objects. Please consider re-caching the scene service`;\n    const t = this.layer.portalItem;\n    t && t.loaded ? e += ` (${t.portal.url}/home/item.html?id=${t.id}#settings)` : e += ` (${this.layer.parsedUrl.path})`, d.getLogger(\"esri.views.3d.layers.i3s.I3SOverrides\").warn(\"#queryOverrides()\", this.layer.title, `${e}.`);\n  }\n  _processOverridesFromAssociatedLayer(e, t, s, _ref2) {\n    let {\n      loadedAttributes: i,\n      attributeData: r\n    } = _ref2;\n    const a = this.layer.associatedLayer;\n    if (g(a)) return;\n    const n = a.objectIdField,\n      o = s.map(e => r[e]),\n      c = new Map(i.map(e => [e.name, e.index])),\n      d = s.map(e => c.get(e)),\n      h = new Map(Array.from(e, (e, t) => [e, t]));\n    for (const l of t) {\n      const e = l.attributes[n];\n      for (let t = 0; t < s.length; t++) {\n        const i = d[t],\n          r = h.get(e),\n          a = l.attributes[s[t]];\n        o[t][r] = a, this._cacheAttributeValue(e, i, a);\n      }\n    }\n  }\n  _memCacheAttributeValueSize(e) {\n    return \"string\" == typeof e ? o(e) : c();\n  }\n  async _fetchChangedObjectIds(e) {\n    const s = this.layer;\n    if (await s.load({\n      signal: e\n    }), this._changedObjectIds.clear(), g(s.associatedLayer) || !s.associatedLayer.capabilities?.operations?.supportsChangeTracking) return;\n    const i = this._getFetchChangedObjectIdsServerGen();\n    if (g(i)) return;\n    const r = s.associatedLayer.layerId,\n      a = h(s.associatedLayer.infoFor3D),\n      o = await n(t(`${s.associatedLayer.url}/extractChanges`, {\n        method: \"post\",\n        query: {\n          f: \"json\",\n          returnIdsOnly: !0,\n          layers: `[${r}]`,\n          returnUpdates: !0,\n          returnDeletes: a,\n          returnInserts: a,\n          layerServerGens: JSON.stringify([{\n            id: r,\n            serverGen: i\n          }])\n        },\n        timeout: w,\n        signal: e\n      }));\n    if (o.ok && o.value.data?.edits && 1 === o.value.data.edits.length) {\n      const e = o.value.data.edits[0],\n        t = p(e, \"objectIds\", \"adds\"),\n        s = p(e, \"objectIds\", \"updates\"),\n        i = p(e, \"objectIds\", \"deletes\");\n      let r = [];\n      h(t) && (r = r.concat(t)), h(s) && (r = r.concat(s)), h(i) && (r = r.concat(i));\n      const a = Math.min(this._maximumNumberOfEditOVerrides, r.length);\n      a < r.length && (this._warnMaximumChangedObjectsExceeded = !0);\n      const n = r.sort((e, t) => e - t);\n      for (let o = 0; o < a; o++) this._changedObjectIds.add(n[o]);\n    }\n    this.notifyChange(\"_changedObjectIds\");\n  }\n  _getFetchChangedObjectIdsServerGen() {\n    const e = this.layer;\n    if (h(e.serviceUpdateTimeStamp) && h(e.serviceUpdateTimeStamp.lastUpdate)) return e.serviceUpdateTimeStamp.lastUpdate;\n    const t = e.associatedLayer;\n    return h(t) && h(t.serverGens) && h(t.serverGens.minServerGen) ? t.serverGens.minServerGen : null;\n  }\n  get test() {\n    const e = Array.from(this._changedObjectIds),\n      t = this._pendingFetchChangedObjectIds,\n      s = this;\n    return {\n      changedObjectIds: e,\n      pendingFetchChangedObjectIds: t,\n      get maximumNumberOfEditOVerrides() {\n        return s._maximumNumberOfEditOVerrides;\n      },\n      set maximumNumberOfEditOVerrides(e) {\n        s._maximumNumberOfEditOVerrides = e;\n      }\n    };\n  }\n};\ne([f({\n  constructOnly: !0\n})], A.prototype, \"view\", void 0), e([f({\n  constructOnly: !0\n})], A.prototype, \"layer\", void 0), e([f({\n  readOnly: !0\n})], A.prototype, \"is3DOFL\", null), e([f({\n  readOnly: !0\n})], A.prototype, \"geometryChangedObjectIds\", null), e([f()], A.prototype, \"_associatedLayer\", null), e([f()], A.prototype, \"_associatedLayerView\", void 0), e([f({\n  constructOnly: !0\n})], A.prototype, \"memoryController\", void 0), e([f()], A.prototype, \"_changedObjectIds\", void 0), e([f()], A.prototype, \"_pendingFetchChangedObjectIds\", void 0), e([f()], A.prototype, \"_definitionExpression\", null), e([f()], A.prototype, \"updating\", null), e([f()], A.prototype, \"isEmpty\", null), A = e([O(\"esri.views.3d.layers.i3s.I3SOverrides\")], A);\nclass F {\n  constructor(e, t) {\n    this.objectId = e, this._options = t, this._updates = new Map(), this._state = x.ACTIVE;\n  }\n  get(e) {\n    return this._updates.get(e);\n  }\n  set(e, t) {\n    this._isActive && this._updates.set(e, t);\n  }\n  rollback() {\n    this._isActive && (this._state = x.ROLLED_BACK, this._options.rollback());\n  }\n  commit() {\n    this._isActive && (this._state = x.COMMITTED, this._options.commit(this._updates), this._updates.clear());\n  }\n  get _isActive() {\n    return this._state === x.ACTIVE;\n  }\n}\nvar x;\n!function (e) {\n  e[e.ACTIVE = 0] = \"ACTIVE\", e[e.COMMITTED = 1] = \"COMMITTED\", e[e.ROLLED_BACK = 2] = \"ROLLED_BACK\";\n}(x || (x = {}));\nconst w = 1e4,\n  S = 5e4;\nexport { A as I3SOverrides };","map":{"version":3,"names":["_","e","t","s","remove","i","splitIntoChunks","r","resultOrAbort","a","result","n","estimateStringByteSize","o","estimateNumberByteSize","c","d","isSome","h","unwrap","l","destroyMaybe","u","abortMaybe","m","isNone","g","get","p","whenOrAbort","watch","y","initial","b","property","f","subclass","O","formatNumber","j","getMaximumQuerySize","I","queryAllJSON","C","enableDirect3DObjectFeatureLayerDisplay","v","sceneLayerEditingEnabled","L","E","A","constructor","_warnMaximumChangedObjectsExceeded","_interactiveEditingSessions","_maximumNumberOfEditOVerrides","S","_original3DOFLDefinitionExpression","_associatedLayerView","_changedObjectIds","Set","_pendingFetchChangedObjectIds","_pendingFetchAbortController","AbortController","initialize","_memCache","memoryController","newCache","layer","uid","_fetchChangedObjectIds","signal","then","is3DOFL","_associatedLayer","load","destroyed","definitionExpression","addHandles","_definitionExpression","view","destroy","_set","infoFor3D","geometryChangedObjectIds","associatedLayer","length","join","updating","isEmpty","size","createInteractiveEditSession","add","notifyChange","F","rollback","commit","updateAttributeValue","unshift","apply","loadedAttributes","attributeData","_getOverridesFromCache","objectIds","fieldNames","_queryOverridesFromAssociatedLayer","_processOverridesFromAssociatedLayer","updateGeometry","_cacheAttributeValue","put","_getAttributeCacheKey","_memCacheAttributeValueSize","_ref","Array","index","name","has","_fromCache","from","_fromInteractiveEditingSession","objectId","sort","_logMaximumObjectsExceededWarning","createQuery","where","returnGeometry","outFields","objectIdField","cacheHint","map","clone","Promise","all","reduce","concat","ok","value","features","portalItem","loaded","portal","url","id","parsedUrl","path","getLogger","warn","title","_ref2","Map","attributes","clear","capabilities","operations","supportsChangeTracking","_getFetchChangedObjectIdsServerGen","layerId","method","query","returnIdsOnly","layers","returnUpdates","returnDeletes","returnInserts","layerServerGens","JSON","stringify","serverGen","timeout","w","data","edits","Math","min","serviceUpdateTimeStamp","lastUpdate","serverGens","minServerGen","test","changedObjectIds","pendingFetchChangedObjectIds","maximumNumberOfEditOVerrides","constructOnly","prototype","readOnly","_options","_updates","_state","x","ACTIVE","set","_isActive","ROLLED_BACK","COMMITTED","I3SOverrides"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/i3s/I3SOverrides.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../request.js\";import s from\"../../../../core/Accessor.js\";import{remove as i,splitIntoChunks as r}from\"../../../../core/arrayUtils.js\";import{resultOrAbort as a,result as n}from\"../../../../core/asyncUtils.js\";import{estimateStringByteSize as o,estimateNumberByteSize as c}from\"../../../../core/byteSizeEstimations.js\";import d from\"../../../../core/Logger.js\";import{isSome as h,unwrap as l,destroyMaybe as u,abortMaybe as m,isNone as g,get as p}from\"../../../../core/maybe.js\";import{whenOrAbort as _}from\"../../../../core/promiseUtils.js\";import{watch as y,initial as b}from\"../../../../core/reactiveUtils.js\";import{property as f}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as O}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{formatNumber as j}from\"../../../../intl/number.js\";import{getMaximumQuerySize as I,queryAllJSON as C}from\"../../../../layers/support/featureQueryAll.js\";import{enableDirect3DObjectFeatureLayerDisplay as v,sceneLayerEditingEnabled as L}from\"../../../../support/featureFlags.js\";import E from\"../FeatureLayerView3D.js\";let A=class extends s{constructor(e){super(e),this._warnMaximumChangedObjectsExceeded=!1,this._interactiveEditingSessions=null,this._maximumNumberOfEditOVerrides=S,this._original3DOFLDefinitionExpression=null,this._associatedLayerView=null,this._changedObjectIds=new Set,this._pendingFetchChangedObjectIds=null,this._pendingFetchAbortController=new AbortController}initialize(){this._memCache=this.memoryController.newCache(`${this.layer.uid}-attribute-overrides`),this._pendingFetchChangedObjectIds=this._fetchChangedObjectIds(this._pendingFetchAbortController?.signal),this._pendingFetchChangedObjectIds.then((()=>{this._pendingFetchAbortController=null,this._pendingFetchChangedObjectIds=null})),this.is3DOFL&&v()&&h(this._associatedLayer)&&this._associatedLayer.load().then((e=>{this.destroyed||(this._original3DOFLDefinitionExpression=e.definitionExpression,this.addHandles(y((()=>this._definitionExpression),(t=>e.definitionExpression=t),b)),this._associatedLayerView=new E({layer:this._associatedLayer,view:this.view}))}))}destroy(){this.is3DOFL&&v()&&h(this._associatedLayerView)&&h(this._associatedLayer)&&(this._associatedLayer.definitionExpression=l(this._original3DOFLDefinitionExpression)),this._set(\"layer\",null),this._memCache=u(this._memCache),this._pendingFetchAbortController=m(this._pendingFetchAbortController),this._pendingFetchChangedObjectIds=null}get is3DOFL(){return L()&&h(this._associatedLayer)&&h(this._associatedLayer.infoFor3D)}get geometryChangedObjectIds(){return this.is3DOFL?[...this._changedObjectIds]:[]}get _associatedLayer(){return null==this.layer?null:this.layer.associatedLayer}get _definitionExpression(){const e=this.geometryChangedObjectIds;return 0===e.length?\"1 = 0\":`OBJECTID IN (${e.join(\",\")})`}get updating(){if(!this.is3DOFL)return!1;if(!v())return!1;return!h(this._associatedLayerView)||h(this._associatedLayerView)&&this._associatedLayerView.updating}get isEmpty(){return null==this._pendingFetchChangedObjectIds&&0===this._changedObjectIds.size}createInteractiveEditSession(e){this._changedObjectIds.add(e),this.notifyChange(\"_changedObjectIds\"),g(this._interactiveEditingSessions)&&(this._interactiveEditingSessions=[]);const t=this._interactiveEditingSessions,s=new F(e,{rollback:()=>{i(t,s),0===t.length&&(this._interactiveEditingSessions=null)},commit:t=>{for(const[s,i]of t)this.updateAttributeValue(e,s,i)}});return t.unshift(s),s}async apply(e,t,s){if(g(t))return;const{loadedAttributes:i,attributeData:r}=t;if(g(i)||0===i.length||g(r))return;if(this._pendingFetchChangedObjectIds&&await _(this._pendingFetchChangedObjectIds,s),0===this._changedObjectIds.size)return;const a={loadedAttributes:i,attributeData:r},n=this._getOverridesFromCache(e,a,this._changedObjectIds),{objectIds:o,fieldNames:c}=n;if(0===o.length||0===c.length)return;const d=await this._queryOverridesFromAssociatedLayer(o,c,s);g(d)||this._processOverridesFromAssociatedLayer(e,d,c,a)}updateGeometry(e){this._changedObjectIds.add(e),this.notifyChange(\"_changedObjectIds\")}updateAttributeValue(e,t,s){this._changedObjectIds.add(e),this._cacheAttributeValue(e,t,s),this.notifyChange(\"_changedObjectIds\")}_cacheAttributeValue(e,t,s){this._memCache.put(this._getAttributeCacheKey(e,t),s,this._memCacheAttributeValueSize(s))}_getOverridesFromCache(e,{loadedAttributes:t,attributeData:s},i){const r=new Set,a=new Array;for(const o of t)a[o.index]=s[o.name];const n=new Set;for(let o=0;o<e.length;o++){const s=e[o];if(i.has(s))for(const e of t){const t=this._fromCache(s,e.index);void 0===t?(r.add(s),n.add(e.name)):a[e.index][o]=t}}return{objectIds:Array.from(r),fieldNames:Array.from(n)}}_fromCache(e,t){const s=this._fromInteractiveEditingSession(e,t);if(void 0!==s)return s;const i=this._getAttributeCacheKey(e,t);return this._memCache.get(i)}_fromInteractiveEditingSession(e,t){if(!g(this._interactiveEditingSessions))for(const s of this._interactiveEditingSessions){if(s.objectId!==e)continue;const i=s.get(t);if(void 0!==i)return i}}_getAttributeCacheKey(e,t){return`${e}-${t}`}async _queryOverridesFromAssociatedLayer(e,t,s){if(0===e.length||0===t.length)return null;e=e.sort(((e,t)=>e-t)),this._warnMaximumChangedObjectsExceeded&&(this._warnMaximumChangedObjectsExceeded=!1,this._logMaximumObjectsExceededWarning());const i=this.layer.associatedLayer;if(g(i))return null;const n=i.createQuery();n.where=\"1=1\",n.returnGeometry=!1,n.outFields=[i.objectIdField,...t],n.cacheHint=!0,n.objectIds=e;const o=I(i),c=e.length>o?r(e,o).map((e=>{const t=n.clone();return t.objectIds=e,a(C(i,t,{signal:s}))})):[a(C(i,n,{signal:s}))];return(await Promise.all(c)).reduce(((e,t)=>e.concat(t.ok?t.value.features:[])),[])}_logMaximumObjectsExceededWarning(){let e=`The number of edited objects that are not yet cached in the scene service exceeds the maximum limit. Attribute changes will only be available for the first ${j(this._maximumNumberOfEditOVerrides)} objects. Please consider re-caching the scene service`;const t=this.layer.portalItem;t&&t.loaded?e+=` (${t.portal.url}/home/item.html?id=${t.id}#settings)`:e+=` (${this.layer.parsedUrl.path})`,d.getLogger(\"esri.views.3d.layers.i3s.I3SOverrides\").warn(\"#queryOverrides()\",this.layer.title,`${e}.`)}_processOverridesFromAssociatedLayer(e,t,s,{loadedAttributes:i,attributeData:r}){const a=this.layer.associatedLayer;if(g(a))return;const n=a.objectIdField,o=s.map((e=>r[e])),c=new Map(i.map((e=>[e.name,e.index]))),d=s.map((e=>c.get(e))),h=new Map(Array.from(e,((e,t)=>[e,t])));for(const l of t){const e=l.attributes[n];for(let t=0;t<s.length;t++){const i=d[t],r=h.get(e),a=l.attributes[s[t]];o[t][r]=a,this._cacheAttributeValue(e,i,a)}}}_memCacheAttributeValueSize(e){return\"string\"==typeof e?o(e):c()}async _fetchChangedObjectIds(e){const s=this.layer;if(await s.load({signal:e}),this._changedObjectIds.clear(),g(s.associatedLayer)||!s.associatedLayer.capabilities?.operations?.supportsChangeTracking)return;const i=this._getFetchChangedObjectIdsServerGen();if(g(i))return;const r=s.associatedLayer.layerId,a=h(s.associatedLayer.infoFor3D),o=await n(t(`${s.associatedLayer.url}/extractChanges`,{method:\"post\",query:{f:\"json\",returnIdsOnly:!0,layers:`[${r}]`,returnUpdates:!0,returnDeletes:a,returnInserts:a,layerServerGens:JSON.stringify([{id:r,serverGen:i}])},timeout:w,signal:e}));if(o.ok&&o.value.data?.edits&&1===o.value.data.edits.length){const e=o.value.data.edits[0],t=p(e,\"objectIds\",\"adds\"),s=p(e,\"objectIds\",\"updates\"),i=p(e,\"objectIds\",\"deletes\");let r=[];h(t)&&(r=r.concat(t)),h(s)&&(r=r.concat(s)),h(i)&&(r=r.concat(i));const a=Math.min(this._maximumNumberOfEditOVerrides,r.length);a<r.length&&(this._warnMaximumChangedObjectsExceeded=!0);const n=r.sort(((e,t)=>e-t));for(let o=0;o<a;o++)this._changedObjectIds.add(n[o])}this.notifyChange(\"_changedObjectIds\")}_getFetchChangedObjectIdsServerGen(){const e=this.layer;if(h(e.serviceUpdateTimeStamp)&&h(e.serviceUpdateTimeStamp.lastUpdate))return e.serviceUpdateTimeStamp.lastUpdate;const t=e.associatedLayer;return h(t)&&h(t.serverGens)&&h(t.serverGens.minServerGen)?t.serverGens.minServerGen:null}get test(){const e=Array.from(this._changedObjectIds),t=this._pendingFetchChangedObjectIds,s=this;return{changedObjectIds:e,pendingFetchChangedObjectIds:t,get maximumNumberOfEditOVerrides(){return s._maximumNumberOfEditOVerrides},set maximumNumberOfEditOVerrides(e){s._maximumNumberOfEditOVerrides=e}}}};e([f({constructOnly:!0})],A.prototype,\"view\",void 0),e([f({constructOnly:!0})],A.prototype,\"layer\",void 0),e([f({readOnly:!0})],A.prototype,\"is3DOFL\",null),e([f({readOnly:!0})],A.prototype,\"geometryChangedObjectIds\",null),e([f()],A.prototype,\"_associatedLayer\",null),e([f()],A.prototype,\"_associatedLayerView\",void 0),e([f({constructOnly:!0})],A.prototype,\"memoryController\",void 0),e([f()],A.prototype,\"_changedObjectIds\",void 0),e([f()],A.prototype,\"_pendingFetchChangedObjectIds\",void 0),e([f()],A.prototype,\"_definitionExpression\",null),e([f()],A.prototype,\"updating\",null),e([f()],A.prototype,\"isEmpty\",null),A=e([O(\"esri.views.3d.layers.i3s.I3SOverrides\")],A);class F{constructor(e,t){this.objectId=e,this._options=t,this._updates=new Map,this._state=x.ACTIVE}get(e){return this._updates.get(e)}set(e,t){this._isActive&&this._updates.set(e,t)}rollback(){this._isActive&&(this._state=x.ROLLED_BACK,this._options.rollback())}commit(){this._isActive&&(this._state=x.COMMITTED,this._options.commit(this._updates),this._updates.clear())}get _isActive(){return this._state===x.ACTIVE}}var x;!function(e){e[e.ACTIVE=0]=\"ACTIVE\",e[e.COMMITTED=1]=\"COMMITTED\",e[e.ROLLED_BACK=2]=\"ROLLED_BACK\"}(x||(x={}));const w=1e4,S=5e4;export{A as I3SOverrides};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}