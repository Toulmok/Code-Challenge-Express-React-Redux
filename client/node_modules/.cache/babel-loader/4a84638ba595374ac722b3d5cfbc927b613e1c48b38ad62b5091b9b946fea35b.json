{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isNone as t } from \"../../../core/maybe.js\";\nimport { getExpressionFromFieldName as e, getWhereClause as i, getAliasFromFieldName as s } from \"./attributeSupport.js\";\nimport { processNullValue as a, getNormalizedValue as l } from \"../../../statistics/utils.js\";\nclass r {\n  constructor(t, a, l) {\n    this._fieldDataCache = new Map(), this._returnDistinctMap = new Map(), this.returnDistinctValues = t.returnDistinctValues ?? !1, this.fieldsIndex = l, this.featureAdapter = a;\n    const r = t.outFields;\n    if (r && !r.includes(\"*\")) {\n      this.outFields = r;\n      let t = 0;\n      for (const a of r) {\n        const r = e(a),\n          n = this.fieldsIndex.get(r),\n          u = n ? null : i(r, l),\n          d = n ? n.name : s(a) || \"FIELD_EXP_\" + t++;\n        this._fieldDataCache.set(a, {\n          alias: d,\n          clause: u\n        });\n      }\n    }\n  }\n  countDistinctValues(t) {\n    return this.returnDistinctValues ? (t.forEach(t => this.getAttributes(t)), this._returnDistinctMap.size) : t.length;\n  }\n  getAttributes(t) {\n    const e = this._processAttributesForOutFields(t);\n    return this._processAttributesForDistinctValues(e);\n  }\n  getFieldValue(t, e, s) {\n    const a = s ? s.name : e;\n    let l = null;\n    return this._fieldDataCache.has(a) ? l = this._fieldDataCache.get(a)?.clause : s || (l = i(e, this.fieldsIndex), this._fieldDataCache.set(a, {\n      alias: a,\n      clause: l\n    })), s ? this.featureAdapter.getAttribute(t, a) : l?.calculateValue(t, this.featureAdapter);\n  }\n  getDataValue(t, e) {\n    const i = e.normalizationType,\n      s = e.normalizationTotal;\n    let r = e.field && this.getFieldValue(t, e.field, this.fieldsIndex.get(e.field));\n    if (e.field2 && (r = `${a(r)}${e.fieldDelimiter}${a(this.getFieldValue(t, e.field2, this.fieldsIndex.get(e.field2)))}`, e.field3 && (r = `${r}${e.fieldDelimiter}${a(this.getFieldValue(t, e.field3, this.fieldsIndex.get(e.field3)))}`)), i && Number.isFinite(r)) {\n      const a = \"field\" === i && e.normalizationField ? this.getFieldValue(t, e.normalizationField, this.fieldsIndex.get(e.normalizationField)) : null;\n      r = l(r, i, a, s);\n    }\n    return r;\n  }\n  getExpressionValue(t, e, i, s) {\n    const a = {\n        attributes: this.featureAdapter.getAttributes(t),\n        layer: {\n          fields: this.fieldsIndex.fields\n        }\n      },\n      l = s.createExecContext(a, i);\n    return s.executeFunction(e, l);\n  }\n  getExpressionValues(t, e, i, s) {\n    const a = {\n      fields: this.fieldsIndex.fields\n    };\n    return t.map(t => {\n      const l = {\n          attributes: this.featureAdapter.getAttributes(t),\n          layer: a\n        },\n        r = s.createExecContext(l, i);\n      return s.executeFunction(e, r);\n    });\n  }\n  validateItem(t, e) {\n    return this._fieldDataCache.has(e) || this._fieldDataCache.set(e, {\n      alias: e,\n      clause: i(e, this.fieldsIndex)\n    }), this._fieldDataCache.get(e)?.clause?.testFeature(t, this.featureAdapter) ?? !1;\n  }\n  validateItems(t, e) {\n    return this._fieldDataCache.has(e) || this._fieldDataCache.set(e, {\n      alias: e,\n      clause: i(e, this.fieldsIndex)\n    }), this._fieldDataCache.get(e)?.clause?.testSet(t, this.featureAdapter) ?? !1;\n  }\n  _processAttributesForOutFields(t) {\n    const e = this.outFields;\n    if (!e || !e.length) return this.featureAdapter.getAttributes(t);\n    const i = {};\n    for (const s of e) {\n      const {\n        alias: e,\n        clause: a\n      } = this._fieldDataCache.get(s);\n      i[e] = a ? a.calculateValue(t, this.featureAdapter) : this.featureAdapter.getAttribute(t, e);\n    }\n    return i;\n  }\n  _processAttributesForDistinctValues(e) {\n    if (t(e) || !this.returnDistinctValues) return e;\n    const i = this.outFields,\n      s = [];\n    if (i) for (const t of i) {\n      const {\n        alias: i\n      } = this._fieldDataCache.get(t);\n      s.push(e[i]);\n    } else for (const t in e) s.push(e[t]);\n    const a = `${(i || [\"*\"]).join(\",\")}=${s.join(\",\")}`;\n    let l = this._returnDistinctMap.get(a) || 0;\n    return this._returnDistinctMap.set(a, ++l), l > 1 ? null : e;\n  }\n}\nexport { r as default };","map":{"version":3,"names":["isNone","t","getExpressionFromFieldName","e","getWhereClause","i","getAliasFromFieldName","s","processNullValue","a","getNormalizedValue","l","r","constructor","_fieldDataCache","Map","_returnDistinctMap","returnDistinctValues","fieldsIndex","featureAdapter","outFields","includes","n","get","u","d","name","set","alias","clause","countDistinctValues","forEach","getAttributes","size","length","_processAttributesForOutFields","_processAttributesForDistinctValues","getFieldValue","has","getAttribute","calculateValue","getDataValue","normalizationType","normalizationTotal","field","field2","fieldDelimiter","field3","Number","isFinite","normalizationField","getExpressionValue","attributes","layer","fields","createExecContext","executeFunction","getExpressionValues","map","validateItem","testFeature","validateItems","testSet","push","join","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/layers/graphics/data/AttributesBuilder.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../../core/maybe.js\";import{getExpressionFromFieldName as e,getWhereClause as i,getAliasFromFieldName as s}from\"./attributeSupport.js\";import{processNullValue as a,getNormalizedValue as l}from\"../../../statistics/utils.js\";class r{constructor(t,a,l){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues??!1,this.fieldsIndex=l,this.featureAdapter=a;const r=t.outFields;if(r&&!r.includes(\"*\")){this.outFields=r;let t=0;for(const a of r){const r=e(a),n=this.fieldsIndex.get(r),u=n?null:i(r,l),d=n?n.name:s(a)||\"FIELD_EXP_\"+t++;this._fieldDataCache.set(a,{alias:d,clause:u})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,e,s){const a=s?s.name:e;let l=null;return this._fieldDataCache.has(a)?l=this._fieldDataCache.get(a)?.clause:s||(l=i(e,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:l})),s?this.featureAdapter.getAttribute(t,a):l?.calculateValue(t,this.featureAdapter)}getDataValue(t,e){const i=e.normalizationType,s=e.normalizationTotal;let r=e.field&&this.getFieldValue(t,e.field,this.fieldsIndex.get(e.field));if(e.field2&&(r=`${a(r)}${e.fieldDelimiter}${a(this.getFieldValue(t,e.field2,this.fieldsIndex.get(e.field2)))}`,e.field3&&(r=`${r}${e.fieldDelimiter}${a(this.getFieldValue(t,e.field3,this.fieldsIndex.get(e.field3)))}`)),i&&Number.isFinite(r)){const a=\"field\"===i&&e.normalizationField?this.getFieldValue(t,e.normalizationField,this.fieldsIndex.get(e.normalizationField)):null;r=l(r,i,a,s)}return r}getExpressionValue(t,e,i,s){const a={attributes:this.featureAdapter.getAttributes(t),layer:{fields:this.fieldsIndex.fields}},l=s.createExecContext(a,i);return s.executeFunction(e,l)}getExpressionValues(t,e,i,s){const a={fields:this.fieldsIndex.fields};return t.map((t=>{const l={attributes:this.featureAdapter.getAttributes(t),layer:a},r=s.createExecContext(l,i);return s.executeFunction(e,r)}))}validateItem(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:i(e,this.fieldsIndex)}),this._fieldDataCache.get(e)?.clause?.testFeature(t,this.featureAdapter)??!1}validateItems(t,e){return this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:i(e,this.fieldsIndex)}),this._fieldDataCache.get(e)?.clause?.testSet(t,this.featureAdapter)??!1}_processAttributesForOutFields(t){const e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(t);const i={};for(const s of e){const{alias:e,clause:a}=this._fieldDataCache.get(s);i[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return i}_processAttributesForDistinctValues(e){if(t(e)||!this.returnDistinctValues)return e;const i=this.outFields,s=[];if(i)for(const t of i){const{alias:i}=this._fieldDataCache.get(t);s.push(e[i])}else for(const t in e)s.push(e[t]);const a=`${(i||[\"*\"]).join(\",\")}=${s.join(\",\")}`;let l=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++l),l>1?null:e}}export{r as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}