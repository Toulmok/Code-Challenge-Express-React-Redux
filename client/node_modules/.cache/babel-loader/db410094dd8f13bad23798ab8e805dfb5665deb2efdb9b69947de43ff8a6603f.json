{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { handlesGroup as e } from \"../handleUtils.js\";\nimport t from \"../Logger.js\";\nimport { isPromiseLike as s, createAbortError as n, createDeferred as i, throwIfAborted as o } from \"../promiseUtils.js\";\nimport r from \"../Queue.js\";\nimport l from \"./RemoteClient.js\";\nclass h {\n  constructor() {\n    this._inUseClients = new Array(), this._clients = new Array(), this._clientPromises = new Array(), this._ongoingJobsQueue = new r();\n  }\n  destroy() {\n    this.close();\n  }\n  get closed() {\n    return !this._clients || !this._clients.length;\n  }\n  open(e, t) {\n    return new Promise((n, i) => {\n      let r = !0;\n      const h = e => {\n        o(t.signal), r && (r = !1, e());\n      };\n      this._clients.length = e.length, this._clientPromises.length = e.length, this._inUseClients.length = e.length;\n      for (let o = 0; o < e.length; ++o) {\n        const r = e[o];\n        s(r) ? this._clientPromises[o] = r.then(e => (this._clients[o] = new l(e, t, () => this._ongoingJobsQueue.pop() ?? null), h(n), this._clients[o]), () => (h(i), null)) : (this._clients[o] = new l(r, t, () => this._ongoingJobsQueue.pop() ?? null), this._clientPromises[o] = Promise.resolve(this._clients[o]), h(n));\n      }\n    });\n  }\n  broadcast(e, t, s) {\n    const n = new Array(this._clientPromises.length);\n    for (let i = 0; i < this._clientPromises.length; ++i) {\n      const o = this._clientPromises[i];\n      n[i] = o.then(n => n?.invoke(e, t, s));\n    }\n    return n;\n  }\n  close() {\n    let e;\n    for (; e = this._ongoingJobsQueue.pop();) e.deferred.reject(n(`Worker closing, aborting job calling '${e.methodName}'`));\n    for (const t of this._clientPromises) t.then(e => e?.close());\n    this._clients.length = 0, this._clientPromises.length = 0;\n  }\n  invoke(e, s, n) {\n    let o;\n    Array.isArray(n) ? (t.getLogger(\"esri.core.workers.Connection\").warn(\"invoke()\", \"The transferList parameter is deprecated, use the options object instead\"), o = {\n      transferList: n\n    }) : o = n;\n    const r = i();\n    this._ongoingJobsQueue.push({\n      methodName: e,\n      data: s,\n      invokeOptions: o,\n      deferred: r\n    });\n    for (let t = 0; t < this._clientPromises.length; t++) {\n      const e = this._clients[t];\n      e ? e.jobAdded() : this._clientPromises[t].then(e => e?.jobAdded());\n    }\n    return r.promise;\n  }\n  on(t, s) {\n    return Promise.all(this._clientPromises).then(() => e(this._clients.map(e => e.on(t, s))));\n  }\n  openPorts() {\n    return new Promise(e => {\n      const t = new Array(this._clientPromises.length);\n      let s = t.length;\n      for (let n = 0; n < this._clientPromises.length; ++n) {\n        this._clientPromises[n].then(i => {\n          i && (t[n] = i.openPort()), 0 == --s && e(t);\n        });\n      }\n    });\n  }\n  get test() {\n    return {\n      numClients: this._clients.length\n    };\n  }\n}\nexport { h as default };","map":{"version":3,"names":["handlesGroup","e","t","isPromiseLike","s","createAbortError","n","createDeferred","i","throwIfAborted","o","r","l","h","constructor","_inUseClients","Array","_clients","_clientPromises","_ongoingJobsQueue","destroy","close","closed","length","open","Promise","signal","then","pop","resolve","broadcast","invoke","deferred","reject","methodName","isArray","getLogger","warn","transferList","push","data","invokeOptions","jobAdded","promise","on","all","map","openPorts","openPort","test","numClients","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/core/workers/Connection.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{handlesGroup as e}from\"../handleUtils.js\";import t from\"../Logger.js\";import{isPromiseLike as s,createAbortError as n,createDeferred as i,throwIfAborted as o}from\"../promiseUtils.js\";import r from\"../Queue.js\";import l from\"./RemoteClient.js\";class h{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new r}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(e,t){return new Promise(((n,i)=>{let r=!0;const h=e=>{o(t.signal),r&&(r=!1,e())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let o=0;o<e.length;++o){const r=e[o];s(r)?this._clientPromises[o]=r.then((e=>(this._clients[o]=new l(e,t,(()=>this._ongoingJobsQueue.pop()??null)),h(n),this._clients[o])),(()=>(h(i),null))):(this._clients[o]=new l(r,t,(()=>this._ongoingJobsQueue.pop()??null)),this._clientPromises[o]=Promise.resolve(this._clients[o]),h(n))}}))}broadcast(e,t,s){const n=new Array(this._clientPromises.length);for(let i=0;i<this._clientPromises.length;++i){const o=this._clientPromises[i];n[i]=o.then((n=>n?.invoke(e,t,s)))}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.deferred.reject(n(`Worker closing, aborting job calling '${e.methodName}'`));for(const t of this._clientPromises)t.then((e=>e?.close()));this._clients.length=0,this._clientPromises.length=0}invoke(e,s,n){let o;Array.isArray(n)?(t.getLogger(\"esri.core.workers.Connection\").warn(\"invoke()\",\"The transferList parameter is deprecated, use the options object instead\"),o={transferList:n}):o=n;const r=i();this._ongoingJobsQueue.push({methodName:e,data:s,invokeOptions:o,deferred:r});for(let t=0;t<this._clientPromises.length;t++){const e=this._clients[t];e?e.jobAdded():this._clientPromises[t].then((e=>e?.jobAdded()))}return r.promise}on(t,s){return Promise.all(this._clientPromises).then((()=>e(this._clients.map((e=>e.on(t,s))))))}openPorts(){return new Promise((e=>{const t=new Array(this._clientPromises.length);let s=t.length;for(let n=0;n<this._clientPromises.length;++n){this._clientPromises[n].then((i=>{i&&(t[n]=i.openPort()),0==--s&&e(t)}))}}))}get test(){return{numClients:this._clients.length}}}export{h as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}