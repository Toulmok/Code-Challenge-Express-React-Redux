{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport t from \"../../../../core/Accessor.js\";\nimport r from \"../../../../core/Evented.js\";\nimport s from \"../../../../core/Logger.js\";\nimport { isNone as i } from \"../../../../core/maybe.js\";\nimport { property as o } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as n } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { F as a } from \"../../../../chunks/mat4.js\";\nimport { c } from \"../../../../chunks/mat4f64.js\";\nimport { m as l } from \"../../../../chunks/vec3.js\";\nimport { c as p } from \"../../../../chunks/vec3f64.js\";\nimport { empty as h, expand as m } from \"../../../../geometry/support/aaBoundingRect.js\";\nimport { newIntersector as d } from \"../../webgl-engine/lib/Intersector.js\";\nimport { StoreResults as f } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nconst u = h(),\n  v = c(),\n  _ = p(),\n  g = p(),\n  x = p();\nlet y = class extends r.EventedMixin(t) {\n  get spatialReference() {\n    return this.view?.elevationProvider?.spatialReference;\n  }\n  constructor(e) {\n    super(e), this._tmpEvent = {\n      spatialReference: null,\n      extent: u,\n      context: \"scene\"\n    };\n  }\n  initialize() {\n    this.view = this.layerView.view, this._renderCoordsHelper = this.view.renderCoordsHelper, this._intersector = d(this.view.state.viewingMode), this._intersector.options.store = f.MIN;\n    const e = this.layerView.i3slayer.fullExtent;\n    i(e) ? s.getLogger(this.declaredClass).error(\"I3SElevationProvider expected fullExtent on I3SLayer.\") : (this._zmin = e.zmin, this._zmax = e.zmax), this._tmpEvent.context = this.intersectionHandler.isGround ? \"ground\" : \"scene\";\n  }\n  getElevation(e, t, r, i) {\n    if (_[0] = e, _[1] = t, _[2] = r, !this._renderCoordsHelper.toRenderCoords(_, i, _)) return s.getLogger(this.declaredClass).error(\"could not project point to compute elevation\"), null;\n    const o = this.layerView.elevationOffset,\n      n = this._zmin + o,\n      a = this._zmax + o;\n    return this._renderCoordsHelper.setAltitude(g, a, _), this._renderCoordsHelper.setAltitude(x, n, _), this._intersector.reset(g, x, null), this.intersectionHandler.intersect(this._intersector, null, g, x), this._intersector.results.min.getIntersectionPoint(_) ? this._renderCoordsHelper.getAltitude(_) : null;\n  }\n  layerChanged() {\n    this.spatialReference && (this._tmpEvent.extent = this._computeLayerExtent(), this._tmpEvent.spatialReference = this.spatialReference, this.emit(\"elevation-change\", this._tmpEvent));\n  }\n  objectChanged(e) {\n    this.spatialReference && (this._tmpEvent.extent = this._computeObjectExtent(e), this._tmpEvent.spatialReference = this.spatialReference, this.emit(\"elevation-change\", this._tmpEvent));\n  }\n  _computeObjectExtent(e) {\n    return h(u), this._expandExtent(e, u), u;\n  }\n  _computeLayerExtent() {\n    h(u);\n    for (const e of this.layerView.getVisibleNodes()) this._expandExtent(e, u);\n    return u;\n  }\n  _expandExtent(e, t) {\n    const r = this.spatialReference;\n    if (i(r)) return;\n    const s = this.layerView.getNodeComponentObb(e);\n    if (!i(s)) {\n      a(v, s.quaternion), v[12] = s.center[0], v[13] = s.center[1], v[14] = s.center[2];\n      for (let e = 0; e < 8; ++e) _[0] = 1 & e ? s.halfSize[0] : -s.halfSize[0], _[1] = 2 & e ? s.halfSize[1] : -s.halfSize[1], _[2] = 4 & e ? s.halfSize[2] : -s.halfSize[2], l(_, _, v), this._renderCoordsHelper.fromRenderCoords(_, _, r), m(t, _, t);\n    }\n  }\n};\ne([o({\n  constructOnly: !0\n})], y.prototype, \"layerView\", void 0), e([o({\n  constructOnly: !0\n})], y.prototype, \"intersectionHandler\", void 0), e([o()], y.prototype, \"view\", void 0), e([o()], y.prototype, \"spatialReference\", null), y = e([n(\"esri.views.3d.layers.i3s.I3SElevationProvider\")], y);\nconst E = y;\nexport { E as default };","map":{"version":3,"names":["_","e","t","r","s","isNone","i","property","o","subclass","n","F","a","c","m","l","p","empty","h","expand","newIntersector","d","StoreResults","f","u","v","g","x","y","EventedMixin","spatialReference","view","elevationProvider","constructor","_tmpEvent","extent","context","initialize","layerView","_renderCoordsHelper","renderCoordsHelper","_intersector","state","viewingMode","options","store","MIN","i3slayer","fullExtent","getLogger","declaredClass","error","_zmin","zmin","_zmax","zmax","intersectionHandler","isGround","getElevation","toRenderCoords","elevationOffset","setAltitude","reset","intersect","results","min","getIntersectionPoint","getAltitude","layerChanged","_computeLayerExtent","emit","objectChanged","_computeObjectExtent","_expandExtent","getVisibleNodes","getNodeComponentObb","quaternion","center","halfSize","fromRenderCoords","constructOnly","prototype","E","default"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/i3s/I3SElevationProvider.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import r from\"../../../../core/Evented.js\";import s from\"../../../../core/Logger.js\";import{isNone as i}from\"../../../../core/maybe.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{F as a}from\"../../../../chunks/mat4.js\";import{c}from\"../../../../chunks/mat4f64.js\";import{m as l}from\"../../../../chunks/vec3.js\";import{c as p}from\"../../../../chunks/vec3f64.js\";import{empty as h,expand as m}from\"../../../../geometry/support/aaBoundingRect.js\";import{newIntersector as d}from\"../../webgl-engine/lib/Intersector.js\";import{StoreResults as f}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";const u=h(),v=c(),_=p(),g=p(),x=p();let y=class extends(r.EventedMixin(t)){get spatialReference(){return this.view?.elevationProvider?.spatialReference}constructor(e){super(e),this._tmpEvent={spatialReference:null,extent:u,context:\"scene\"}}initialize(){this.view=this.layerView.view,this._renderCoordsHelper=this.view.renderCoordsHelper,this._intersector=d(this.view.state.viewingMode),this._intersector.options.store=f.MIN;const e=this.layerView.i3slayer.fullExtent;i(e)?s.getLogger(this.declaredClass).error(\"I3SElevationProvider expected fullExtent on I3SLayer.\"):(this._zmin=e.zmin,this._zmax=e.zmax),this._tmpEvent.context=this.intersectionHandler.isGround?\"ground\":\"scene\"}getElevation(e,t,r,i){if(_[0]=e,_[1]=t,_[2]=r,!this._renderCoordsHelper.toRenderCoords(_,i,_))return s.getLogger(this.declaredClass).error(\"could not project point to compute elevation\"),null;const o=this.layerView.elevationOffset,n=this._zmin+o,a=this._zmax+o;return this._renderCoordsHelper.setAltitude(g,a,_),this._renderCoordsHelper.setAltitude(x,n,_),this._intersector.reset(g,x,null),this.intersectionHandler.intersect(this._intersector,null,g,x),this._intersector.results.min.getIntersectionPoint(_)?this._renderCoordsHelper.getAltitude(_):null}layerChanged(){this.spatialReference&&(this._tmpEvent.extent=this._computeLayerExtent(),this._tmpEvent.spatialReference=this.spatialReference,this.emit(\"elevation-change\",this._tmpEvent))}objectChanged(e){this.spatialReference&&(this._tmpEvent.extent=this._computeObjectExtent(e),this._tmpEvent.spatialReference=this.spatialReference,this.emit(\"elevation-change\",this._tmpEvent))}_computeObjectExtent(e){return h(u),this._expandExtent(e,u),u}_computeLayerExtent(){h(u);for(const e of this.layerView.getVisibleNodes())this._expandExtent(e,u);return u}_expandExtent(e,t){const r=this.spatialReference;if(i(r))return;const s=this.layerView.getNodeComponentObb(e);if(!i(s)){a(v,s.quaternion),v[12]=s.center[0],v[13]=s.center[1],v[14]=s.center[2];for(let e=0;e<8;++e)_[0]=1&e?s.halfSize[0]:-s.halfSize[0],_[1]=2&e?s.halfSize[1]:-s.halfSize[1],_[2]=4&e?s.halfSize[2]:-s.halfSize[2],l(_,_,v),this._renderCoordsHelper.fromRenderCoords(_,_,r),m(t,_,t)}}};e([o({constructOnly:!0})],y.prototype,\"layerView\",void 0),e([o({constructOnly:!0})],y.prototype,\"intersectionHandler\",void 0),e([o()],y.prototype,\"view\",void 0),e([o()],y.prototype,\"spatialReference\",null),y=e([n(\"esri.views.3d.layers.i3s.I3SElevationProvider\")],y);const E=y;export{E as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}