{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from \"../../../../core/Error.js\";\nimport t from \"../../../../core/Logger.js\";\nimport { getOrCreateMapValue as r } from \"../../../../core/MapUtils.js\";\nimport { eachAlwaysValues as o } from \"../../../../core/promiseUtils.js\";\nimport { isDataProtocol as n, dataComponents as s, dataToArrayBuffer as a, makeAbsolute as i } from \"../../../../core/urlUtils.js\";\nimport { Version as u } from \"../../../../core/Version.js\";\nimport { A as f, m as c, w as d, e as l, k as p } from \"../../../../chunks/mat4.js\";\nimport { c as h, b as m } from \"../../../../chunks/mat4f64.js\";\nimport { g as w } from \"../../../../chunks/quat.js\";\nimport { a as y } from \"../../../../chunks/quatf64.js\";\nimport { BufferViewUint32 as T, BufferViewUint16 as b, BufferViewUint8 as _, BufferViewVec3f as g, BufferViewVec4f as x, BufferViewVec2f as O, BufferViewVec4u8 as N, BufferViewVec4u16 as S, BufferViewVec3u8 as C, BufferViewVec3u16 as A, BufferViewVec2u32 as L, BufferViewVec2u16 as E, BufferViewVec2i16 as I, BufferViewVec2u8 as R, BufferViewVec2i8 as B } from \"../../../../geometry/support/buffer/BufferView.js\";\nimport { m as v } from \"../../../../chunks/scalar.js\";\nimport { BinaryStreamReader as U } from \"./BinaryStreamReader.js\";\nimport { AttributeType as D } from \"./enums.js\";\nimport { material as G, textureSampler as j } from \"./fillDefaults.js\";\nimport { splitURI as M } from \"./pathUtils.js\";\nimport { jsonFromBinaryData as F, EncodedMeshTexture as H, imageFromBinaryData as P, isEncodedMeshTexture as V } from \"./resourceUtils.js\";\nimport { DataType as k } from \"../../../webgl/enums.js\";\nconst K = {\n  MAGIC: 1179937895,\n  CHUNK_TYPE_JSON: 1313821514,\n  CHUNK_TYPE_BIN: 5130562,\n  MIN_HEADER_LENGTH: 20\n};\nclass Y {\n  constructor(t, r, o, n) {\n    if (this._context = t, this.uri = r, this.json = o, this._glbBuffer = n, this._bufferLoaders = new Map(), this._textureLoaders = new Map(), this._textureCache = new Map(), this._materialCache = new Map(), this._nodeParentMap = new Map(), this._nodeTransformCache = new Map(), this._supportedExtensions = [\"KHR_texture_basisu\"], this._baseUri = M(this.uri).dirPart, this._checkVersionSupported(), this._checkRequiredExtensionsSupported(), null == o.scenes) throw new e(\"gltf-loader-unsupported-feature\", \"Scenes must be defined.\");\n    if (null == o.meshes) throw new e(\"gltf-loader-unsupported-feature\", \"Meshes must be defined\");\n    if (null == o.nodes) throw new e(\"gltf-loader-unsupported-feature\", \"Nodes must be defined.\");\n    this._computeNodeParents();\n  }\n  static async load(e, t, r) {\n    if (n(t)) {\n      const r = s(t);\n      if (r && \"model/gltf-binary\" !== r.mediaType) try {\n        const o = JSON.parse(r.isBase64 ? atob(r.data) : r.data);\n        return new Y(e, t, o);\n      } catch {}\n      const o = a(t);\n      if (Y._isGLBData(o)) return this._fromGLBData(e, t, o);\n    }\n    if (t.endsWith(\".gltf\")) {\n      const o = await e.loadJSON(t, r);\n      return new Y(e, t, o);\n    }\n    const o = await e.loadBinary(t, r);\n    if (Y._isGLBData(o)) return this._fromGLBData(e, t, o);\n    const i = await e.loadJSON(t, r);\n    return new Y(e, t, i);\n  }\n  static _isGLBData(e) {\n    if (null == e) return !1;\n    const t = new U(e);\n    return t.remainingBytes() >= 4 && t.readUint32() === K.MAGIC;\n  }\n  static async _fromGLBData(e, t, r) {\n    const o = await Y._parseGLBData(r);\n    return new Y(e, t, o.json, o.binaryData);\n  }\n  static async _parseGLBData(r) {\n    const o = new U(r);\n    if (o.remainingBytes() < 12) throw new e(\"gltf-loader-error\", \"GLB binary data is insufficiently large.\");\n    const n = o.readUint32(),\n      s = o.readUint32(),\n      a = o.readUint32();\n    if (n !== K.MAGIC) throw new e(\"gltf-loader-error\", \"Magic first 4 bytes do not fit to expected GLB value.\");\n    if (r.byteLength < a) throw new e(\"gltf-loader-error\", \"GLB binary data is smaller than header specifies.\");\n    if (2 !== s) throw new e(\"gltf-loader-unsupported-feature\", \"An unsupported GLB container version was detected. Only version 2 is supported.\");\n    let i,\n      u,\n      f = 0;\n    for (; o.remainingBytes() >= 8;) {\n      const r = o.readUint32(),\n        n = o.readUint32();\n      if (0 === f) {\n        if (n !== K.CHUNK_TYPE_JSON) throw new e(\"gltf-loader-error\", \"First GLB chunk must be JSON.\");\n        if (r < 0) throw new e(\"gltf-loader-error\", \"No JSON data found.\");\n        i = await F(o.readUint8Array(r));\n      } else if (1 === f) {\n        if (n !== K.CHUNK_TYPE_BIN) throw new e(\"gltf-loader-unsupported-feature\", \"Second GLB chunk expected to be BIN.\");\n        u = o.readUint8Array(r);\n      } else t.getLogger(\"esri.views.3d.glTF\").warn(\"[Unsupported Feature] More than 2 GLB chunks detected. Skipping.\");\n      f += 1;\n    }\n    if (!i) throw new e(\"gltf-loader-error\", \"No GLB JSON chunk detected.\");\n    return {\n      json: i,\n      binaryData: u\n    };\n  }\n  async getBuffer(t, r) {\n    const o = this.json.buffers[t];\n    if (null == o.uri) {\n      if (null == this._glbBuffer) throw new e(\"gltf-loader-error\", \"GLB buffer not present\");\n      return this._glbBuffer;\n    }\n    const n = await this._getBufferLoader(t, r);\n    if (n.byteLength !== o.byteLength) throw new e(\"gltf-loader-error\", \"Buffer byte lengths should match.\");\n    return n;\n  }\n  async _getBufferLoader(e, t) {\n    const r = this._bufferLoaders.get(e);\n    if (r) return r;\n    const o = this.json.buffers[e].uri,\n      n = this._context.loadBinary(this._resolveUri(o), t).then(e => new Uint8Array(e));\n    return this._bufferLoaders.set(e, n), n;\n  }\n  async getAccessor(t, r) {\n    if (!this.json.accessors) throw new e(\"gltf-loader-unsupported-feature\", \"Accessors missing.\");\n    const o = this.json.accessors[t];\n    if (null == o?.bufferView) throw new e(\"gltf-loader-unsupported-feature\", \"Some accessor does not specify a bufferView.\");\n    if (o.type in [D.MAT2, D.MAT3, D.MAT4]) throw new e(\"gltf-loader-unsupported-feature\", `AttributeType ${o.type} is not supported`);\n    const n = this.json.bufferViews[o.bufferView],\n      s = await this.getBuffer(n.buffer, r),\n      a = X[o.type],\n      i = W[o.componentType],\n      u = a * i,\n      f = n.byteStride || u;\n    return {\n      raw: s.buffer,\n      byteStride: f,\n      byteOffset: s.byteOffset + (n.byteOffset || 0) + (o.byteOffset || 0),\n      entryCount: o.count,\n      isDenselyPacked: f === u,\n      componentCount: a,\n      componentByteSize: i,\n      componentType: o.componentType,\n      min: o.min,\n      max: o.max,\n      normalized: !!o.normalized\n    };\n  }\n  async getIndexData(e, t) {\n    if (null == e.indices) return;\n    const r = await this.getAccessor(e.indices, t);\n    if (r.isDenselyPacked) switch (r.componentType) {\n      case k.UNSIGNED_BYTE:\n        return new Uint8Array(r.raw, r.byteOffset, r.entryCount);\n      case k.UNSIGNED_SHORT:\n        return new Uint16Array(r.raw, r.byteOffset, r.entryCount);\n      case k.UNSIGNED_INT:\n        return new Uint32Array(r.raw, r.byteOffset, r.entryCount);\n    } else switch (r.componentType) {\n      case k.UNSIGNED_BYTE:\n        return v(this._wrapAccessor(_, r));\n      case k.UNSIGNED_SHORT:\n        return v(this._wrapAccessor(b, r));\n      case k.UNSIGNED_INT:\n        return v(this._wrapAccessor(T, r));\n    }\n  }\n  async getPositionData(t, r) {\n    if (null == t.attributes.POSITION) throw new e(\"gltf-loader-unsupported-feature\", \"No POSITION vertex data found.\");\n    const o = await this.getAccessor(t.attributes.POSITION, r);\n    if (o.componentType !== k.FLOAT) throw new e(\"gltf-loader-unsupported-feature\", \"Expected type FLOAT for POSITION vertex attribute, but found \" + k[o.componentType]);\n    if (3 !== o.componentCount) throw new e(\"gltf-loader-unsupported-feature\", \"POSITION vertex attribute must have 3 components, but found \" + o.componentCount.toFixed());\n    return this._wrapAccessor(g, o);\n  }\n  async getNormalData(t, r) {\n    if (null == t.attributes.NORMAL) throw new e(\"gltf-loader-error\", \"No NORMAL vertex data found.\");\n    const o = await this.getAccessor(t.attributes.NORMAL, r);\n    if (o.componentType !== k.FLOAT) throw new e(\"gltf-loader-unsupported-feature\", \"Expected type FLOAT for NORMAL vertex attribute, but found \" + k[o.componentType]);\n    if (3 !== o.componentCount) throw new e(\"gltf-loader-unsupported-feature\", \"NORMAL vertex attribute must have 3 components, but found \" + o.componentCount.toFixed());\n    return this._wrapAccessor(g, o);\n  }\n  async getTangentData(t, r) {\n    if (null == t.attributes.TANGENT) throw new e(\"gltf-loader-error\", \"No TANGENT vertex data found.\");\n    const o = await this.getAccessor(t.attributes.TANGENT, r);\n    if (o.componentType !== k.FLOAT) throw new e(\"gltf-loader-unsupported-feature\", \"Expected type FLOAT for TANGENT vertex attribute, but found \" + k[o.componentType]);\n    if (4 !== o.componentCount) throw new e(\"gltf-loader-unsupported-feature\", \"TANGENT vertex attribute must have 4 components, but found \" + o.componentCount.toFixed());\n    return new x(o.raw, o.byteOffset, o.byteStride, o.byteOffset + o.byteStride * o.entryCount);\n  }\n  async getTextureCoordinates(t, r) {\n    if (null == t.attributes.TEXCOORD_0) throw new e(\"gltf-loader-error\", \"No TEXCOORD_0 vertex data found.\");\n    const o = await this.getAccessor(t.attributes.TEXCOORD_0, r);\n    if (2 !== o.componentCount) throw new e(\"gltf-loader-unsupported-feature\", \"TEXCOORD_0 vertex attribute must have 2 components, but found \" + o.componentCount.toFixed());\n    if (o.componentType === k.FLOAT) return this._wrapAccessor(O, o);\n    if (!o.normalized) throw new e(\"gltf-loader-unsupported-feature\", \"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\");\n    return $(o);\n  }\n  async getVertexColors(t, r) {\n    if (null == t.attributes.COLOR_0) throw new e(\"gltf-loader-error\", \"No COLOR_0 vertex data found.\");\n    const o = await this.getAccessor(t.attributes.COLOR_0, r);\n    if (4 !== o.componentCount && 3 !== o.componentCount) throw new e(\"gltf-loader-unsupported-feature\", \"COLOR_0 attribute must have 3 or 4 components, but found \" + o.componentCount.toFixed());\n    if (4 === o.componentCount) {\n      if (o.componentType === k.FLOAT) return this._wrapAccessor(x, o);\n      if (o.componentType === k.UNSIGNED_BYTE) return this._wrapAccessor(N, o);\n      if (o.componentType === k.UNSIGNED_SHORT) return this._wrapAccessor(S, o);\n    } else if (3 === o.componentCount) {\n      if (o.componentType === k.FLOAT) return this._wrapAccessor(g, o);\n      if (o.componentType === k.UNSIGNED_BYTE) return this._wrapAccessor(C, o);\n      if (o.componentType === k.UNSIGNED_SHORT) return this._wrapAccessor(A, o);\n    }\n    throw new e(\"gltf-loader-unsupported-feature\", \"Unsupported component type for COLOR_0 attribute: \" + k[o.componentType]);\n  }\n  hasPositions(e) {\n    return void 0 !== e.attributes.POSITION;\n  }\n  hasNormals(e) {\n    return void 0 !== e.attributes.NORMAL;\n  }\n  hasVertexColors(e) {\n    return void 0 !== e.attributes.COLOR_0;\n  }\n  hasTextureCoordinates(e) {\n    return void 0 !== e.attributes.TEXCOORD_0;\n  }\n  hasTangents(e) {\n    return void 0 !== e.attributes.TANGENT;\n  }\n  async getMaterial(e, t, r) {\n    let o = e.material ? this._materialCache.get(e.material) : void 0;\n    if (!o) {\n      const n = null != e.material ? G(this.json.materials[e.material]) : G(),\n        s = n.pbrMetallicRoughness,\n        a = this.hasVertexColors(e),\n        i = this.getTexture(s.baseColorTexture, t),\n        u = this.getTexture(n.normalTexture, t),\n        f = r ? this.getTexture(n.occlusionTexture, t) : void 0,\n        c = r ? this.getTexture(n.emissiveTexture, t) : void 0,\n        d = r ? this.getTexture(s.metallicRoughnessTexture, t) : void 0,\n        l = null != e.material ? e.material : -1;\n      o = {\n        alphaMode: n.alphaMode,\n        alphaCutoff: n.alphaCutoff,\n        color: s.baseColorFactor,\n        doubleSided: !!n.doubleSided,\n        colorTexture: await i,\n        normalTexture: await u,\n        name: n.name,\n        id: l,\n        occlusionTexture: await f,\n        emissiveTexture: await c,\n        emissiveFactor: n.emissiveFactor,\n        metallicFactor: s.metallicFactor,\n        roughnessFactor: s.roughnessFactor,\n        metallicRoughnessTexture: await d,\n        hasVertexColors: a,\n        ESRI_externalColorMixMode: n.extras.ESRI_externalColorMixMode,\n        colorTextureTransform: s?.baseColorTexture?.extensions?.KHR_texture_transform,\n        normalTextureTransform: n.normalTexture?.extensions?.KHR_texture_transform,\n        occlusionTextureTransform: n.occlusionTexture?.extensions?.KHR_texture_transform,\n        emissiveTextureTransform: n.emissiveTexture?.extensions?.KHR_texture_transform,\n        metallicRoughnessTextureTransform: s?.metallicRoughnessTexture?.extensions?.KHR_texture_transform\n      };\n    }\n    return o;\n  }\n  async getTexture(t, o) {\n    if (!t) return;\n    if (0 !== (t.texCoord || 0)) throw new e(\"gltf-loader-unsupported-feature\", \"Only TEXCOORD with index 0 is supported.\");\n    const n = t.index,\n      s = this.json.textures[n],\n      a = j(null != s.sampler ? this.json.samplers[s.sampler] : {}),\n      i = this._getTextureSourceId(s),\n      u = this.json.images[i],\n      f = await this._loadTextureImageData(n, s, o);\n    return r(this._textureCache, n, () => {\n      const t = e => 33071 === e || 33648 === e || 10497 === e,\n        r = t => {\n          throw new e(\"gltf-loader-error\", `Unexpected TextureSampler WrapMode: ${t}`);\n        };\n      return {\n        data: f,\n        wrapS: t(a.wrapS) ? a.wrapS : r(a.wrapS),\n        wrapT: t(a.wrapT) ? a.wrapT : r(a.wrapT),\n        minFilter: a.minFilter,\n        name: u.name,\n        id: n\n      };\n    });\n  }\n  getNodeTransform(e) {\n    if (void 0 === e) return q;\n    let t = this._nodeTransformCache.get(e);\n    if (!t) {\n      const r = this.getNodeTransform(this._getNodeParent(e)),\n        o = this.json.nodes[e];\n      o.matrix ? t = c(h(), r, o.matrix) : o.translation || o.rotation || o.scale ? (t = m(r), o.translation && d(t, t, o.translation), o.rotation && (z[3] = w(z, o.rotation), l(t, t, z[3], z)), o.scale && p(t, t, o.scale)) : t = m(r), this._nodeTransformCache.set(e, t);\n    }\n    return t;\n  }\n  _wrapAccessor(e, t) {\n    return new e(t.raw, t.byteOffset, t.byteStride, t.byteOffset + t.byteStride * (t.entryCount - 1) + t.componentByteSize * t.componentCount);\n  }\n  _resolveUri(e) {\n    return i(e, this._baseUri);\n  }\n  _getNodeParent(e) {\n    return this._nodeParentMap.get(e);\n  }\n  _checkVersionSupported() {\n    const e = u.parse(this.json.asset.version, \"glTF\");\n    J.validate(e);\n  }\n  _checkRequiredExtensionsSupported() {\n    const t = this.json;\n    if (t.extensionsRequired) {\n      if (!t.extensionsRequired.every(e => this._supportedExtensions.includes(e))) throw new e(\"gltf-loader-unsupported-feature\", \"gltf loader was not able to load unsupported feature. Required extensions: \" + t.extensionsRequired.join(\", \"));\n    }\n  }\n  _computeNodeParents() {\n    this.json.nodes.forEach((e, t) => {\n      e.children && e.children.forEach(e => {\n        this._nodeParentMap.set(e, t);\n      });\n    });\n  }\n  async _loadTextureImageData(e, t, r) {\n    const o = this._textureLoaders.get(e);\n    if (o) return o;\n    const n = this._createTextureLoader(t, r);\n    return this._textureLoaders.set(e, n), n;\n  }\n  _getTextureSourceId(t) {\n    if (void 0 !== t.extensions && null !== t.extensions.KHR_texture_basisu) return t.extensions.KHR_texture_basisu.source;\n    if (null !== t.source) return t.source;\n    throw new e(\"gltf-loader-unsupported-feature\", \"Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.\");\n  }\n  async _createTextureLoader(t, r) {\n    const o = this._getTextureSourceId(t),\n      n = this.json.images[o];\n    if (n.uri) {\n      if (n.uri.endsWith(\".ktx2\")) {\n        const e = await this._context.loadBinary(this._resolveUri(n.uri), r);\n        return new H(new Uint8Array(e));\n      }\n      return this._context.loadImage(this._resolveUri(n.uri), r);\n    }\n    if (null == n.bufferView) throw new e(\"gltf-loader-unsupported-feature\", \"Image bufferView must be defined.\");\n    if (null == n.mimeType) throw new e(\"gltf-loader-unsupported-feature\", \"Image mimeType must be defined.\");\n    const s = this.json.bufferViews[n.bufferView],\n      a = await this.getBuffer(s.buffer, r);\n    if (null != s.byteStride) throw new e(\"gltf-loader-unsupported-feature\", \"byteStride not supported for image buffer\");\n    const i = a.byteOffset + (s.byteOffset || 0);\n    return P(new Uint8Array(a.buffer, i, s.byteLength), n.mimeType);\n  }\n  async getLoadedBuffersSize() {\n    if (this._glbBuffer) return this._glbBuffer.byteLength;\n    const e = await o(Array.from(this._bufferLoaders.values())),\n      t = await o(Array.from(this._textureLoaders.values()));\n    return e.reduce((e, t) => e + (t?.byteLength ?? 0), 0) + t.reduce((e, t) => e + (t ? V(t) ? t.data.byteLength : t.width * t.height * 4 : 0), 0);\n  }\n}\nconst q = f(h(), Math.PI / 2),\n  J = new u(2, 0, \"glTF\"),\n  z = y(),\n  X = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4\n  },\n  W = {\n    [k.BYTE]: 1,\n    [k.UNSIGNED_BYTE]: 1,\n    [k.SHORT]: 2,\n    [k.UNSIGNED_SHORT]: 2,\n    [k.FLOAT]: 4,\n    [k.UNSIGNED_INT]: 4\n  };\nfunction $(e) {\n  switch (e.componentType) {\n    case k.BYTE:\n      return new B(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n    case k.UNSIGNED_BYTE:\n      return new R(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n    case k.SHORT:\n      return new I(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n    case k.UNSIGNED_SHORT:\n      return new E(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n    case k.UNSIGNED_INT:\n      return new L(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n    case k.FLOAT:\n      return new O(e.raw, e.byteOffset, e.byteStride, e.byteOffset + e.byteStride * e.entryCount);\n  }\n}\nexport { Y as GLTFResource, q as TRANSFORM_GLTF_TO_ENGINE };","map":{"version":3,"names":["e","t","getOrCreateMapValue","r","eachAlwaysValues","o","isDataProtocol","n","dataComponents","s","dataToArrayBuffer","a","makeAbsolute","i","Version","u","A","f","m","c","w","d","l","k","p","h","b","g","y","BufferViewUint32","T","BufferViewUint16","BufferViewUint8","_","BufferViewVec3f","BufferViewVec4f","x","BufferViewVec2f","O","BufferViewVec4u8","N","BufferViewVec4u16","S","BufferViewVec3u8","C","BufferViewVec3u16","BufferViewVec2u32","L","BufferViewVec2u16","E","BufferViewVec2i16","I","BufferViewVec2u8","R","BufferViewVec2i8","B","v","BinaryStreamReader","U","AttributeType","D","material","G","textureSampler","j","splitURI","M","jsonFromBinaryData","F","EncodedMeshTexture","H","imageFromBinaryData","P","isEncodedMeshTexture","V","DataType","K","MAGIC","CHUNK_TYPE_JSON","CHUNK_TYPE_BIN","MIN_HEADER_LENGTH","Y","constructor","_context","uri","json","_glbBuffer","_bufferLoaders","Map","_textureLoaders","_textureCache","_materialCache","_nodeParentMap","_nodeTransformCache","_supportedExtensions","_baseUri","dirPart","_checkVersionSupported","_checkRequiredExtensionsSupported","scenes","meshes","nodes","_computeNodeParents","load","mediaType","JSON","parse","isBase64","atob","data","_isGLBData","_fromGLBData","endsWith","loadJSON","loadBinary","remainingBytes","readUint32","_parseGLBData","binaryData","byteLength","readUint8Array","getLogger","warn","getBuffer","buffers","_getBufferLoader","get","_resolveUri","then","Uint8Array","set","getAccessor","accessors","bufferView","type","MAT2","MAT3","MAT4","bufferViews","buffer","X","W","componentType","byteStride","raw","byteOffset","entryCount","count","isDenselyPacked","componentCount","componentByteSize","min","max","normalized","getIndexData","indices","UNSIGNED_BYTE","UNSIGNED_SHORT","Uint16Array","UNSIGNED_INT","Uint32Array","_wrapAccessor","getPositionData","attributes","POSITION","FLOAT","toFixed","getNormalData","NORMAL","getTangentData","TANGENT","getTextureCoordinates","TEXCOORD_0","$","getVertexColors","COLOR_0","hasPositions","hasNormals","hasVertexColors","hasTextureCoordinates","hasTangents","getMaterial","materials","pbrMetallicRoughness","getTexture","baseColorTexture","normalTexture","occlusionTexture","emissiveTexture","metallicRoughnessTexture","alphaMode","alphaCutoff","color","baseColorFactor","doubleSided","colorTexture","name","id","emissiveFactor","metallicFactor","roughnessFactor","ESRI_externalColorMixMode","extras","colorTextureTransform","extensions","KHR_texture_transform","normalTextureTransform","occlusionTextureTransform","emissiveTextureTransform","metallicRoughnessTextureTransform","texCoord","index","textures","sampler","samplers","_getTextureSourceId","images","_loadTextureImageData","wrapS","wrapT","minFilter","getNodeTransform","q","_getNodeParent","matrix","translation","rotation","scale","z","asset","version","J","validate","extensionsRequired","every","includes","join","forEach","children","_createTextureLoader","KHR_texture_basisu","source","loadImage","mimeType","getLoadedBuffersSize","Array","from","values","reduce","width","height","Math","PI","SCALAR","VEC2","VEC3","VEC4","BYTE","SHORT","GLTFResource","TRANSFORM_GLTF_TO_ENGINE"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/3d/glTF/internal/Resource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import t from\"../../../../core/Logger.js\";import{getOrCreateMapValue as r}from\"../../../../core/MapUtils.js\";import{eachAlwaysValues as o}from\"../../../../core/promiseUtils.js\";import{isDataProtocol as n,dataComponents as s,dataToArrayBuffer as a,makeAbsolute as i}from\"../../../../core/urlUtils.js\";import{Version as u}from\"../../../../core/Version.js\";import{A as f,m as c,w as d,e as l,k as p}from\"../../../../chunks/mat4.js\";import{c as h,b as m}from\"../../../../chunks/mat4f64.js\";import{g as w}from\"../../../../chunks/quat.js\";import{a as y}from\"../../../../chunks/quatf64.js\";import{BufferViewUint32 as T,BufferViewUint16 as b,BufferViewUint8 as _,BufferViewVec3f as g,BufferViewVec4f as x,BufferViewVec2f as O,BufferViewVec4u8 as N,BufferViewVec4u16 as S,BufferViewVec3u8 as C,BufferViewVec3u16 as A,BufferViewVec2u32 as L,BufferViewVec2u16 as E,BufferViewVec2i16 as I,BufferViewVec2u8 as R,BufferViewVec2i8 as B}from\"../../../../geometry/support/buffer/BufferView.js\";import{m as v}from\"../../../../chunks/scalar.js\";import{BinaryStreamReader as U}from\"./BinaryStreamReader.js\";import{AttributeType as D}from\"./enums.js\";import{material as G,textureSampler as j}from\"./fillDefaults.js\";import{splitURI as M}from\"./pathUtils.js\";import{jsonFromBinaryData as F,EncodedMeshTexture as H,imageFromBinaryData as P,isEncodedMeshTexture as V}from\"./resourceUtils.js\";import{DataType as k}from\"../../../webgl/enums.js\";const K={MAGIC:1179937895,CHUNK_TYPE_JSON:1313821514,CHUNK_TYPE_BIN:5130562,MIN_HEADER_LENGTH:20};class Y{constructor(t,r,o,n){if(this._context=t,this.uri=r,this.json=o,this._glbBuffer=n,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._supportedExtensions=[\"KHR_texture_basisu\"],this._baseUri=M(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),null==o.scenes)throw new e(\"gltf-loader-unsupported-feature\",\"Scenes must be defined.\");if(null==o.meshes)throw new e(\"gltf-loader-unsupported-feature\",\"Meshes must be defined\");if(null==o.nodes)throw new e(\"gltf-loader-unsupported-feature\",\"Nodes must be defined.\");this._computeNodeParents()}static async load(e,t,r){if(n(t)){const r=s(t);if(r&&\"model/gltf-binary\"!==r.mediaType)try{const o=JSON.parse(r.isBase64?atob(r.data):r.data);return new Y(e,t,o)}catch{}const o=a(t);if(Y._isGLBData(o))return this._fromGLBData(e,t,o)}if(t.endsWith(\".gltf\")){const o=await e.loadJSON(t,r);return new Y(e,t,o)}const o=await e.loadBinary(t,r);if(Y._isGLBData(o))return this._fromGLBData(e,t,o);const i=await e.loadJSON(t,r);return new Y(e,t,i)}static _isGLBData(e){if(null==e)return!1;const t=new U(e);return t.remainingBytes()>=4&&t.readUint32()===K.MAGIC}static async _fromGLBData(e,t,r){const o=await Y._parseGLBData(r);return new Y(e,t,o.json,o.binaryData)}static async _parseGLBData(r){const o=new U(r);if(o.remainingBytes()<12)throw new e(\"gltf-loader-error\",\"GLB binary data is insufficiently large.\");const n=o.readUint32(),s=o.readUint32(),a=o.readUint32();if(n!==K.MAGIC)throw new e(\"gltf-loader-error\",\"Magic first 4 bytes do not fit to expected GLB value.\");if(r.byteLength<a)throw new e(\"gltf-loader-error\",\"GLB binary data is smaller than header specifies.\");if(2!==s)throw new e(\"gltf-loader-unsupported-feature\",\"An unsupported GLB container version was detected. Only version 2 is supported.\");let i,u,f=0;for(;o.remainingBytes()>=8;){const r=o.readUint32(),n=o.readUint32();if(0===f){if(n!==K.CHUNK_TYPE_JSON)throw new e(\"gltf-loader-error\",\"First GLB chunk must be JSON.\");if(r<0)throw new e(\"gltf-loader-error\",\"No JSON data found.\");i=await F(o.readUint8Array(r))}else if(1===f){if(n!==K.CHUNK_TYPE_BIN)throw new e(\"gltf-loader-unsupported-feature\",\"Second GLB chunk expected to be BIN.\");u=o.readUint8Array(r)}else t.getLogger(\"esri.views.3d.glTF\").warn(\"[Unsupported Feature] More than 2 GLB chunks detected. Skipping.\");f+=1}if(!i)throw new e(\"gltf-loader-error\",\"No GLB JSON chunk detected.\");return{json:i,binaryData:u}}async getBuffer(t,r){const o=this.json.buffers[t];if(null==o.uri){if(null==this._glbBuffer)throw new e(\"gltf-loader-error\",\"GLB buffer not present\");return this._glbBuffer}const n=await this._getBufferLoader(t,r);if(n.byteLength!==o.byteLength)throw new e(\"gltf-loader-error\",\"Buffer byte lengths should match.\");return n}async _getBufferLoader(e,t){const r=this._bufferLoaders.get(e);if(r)return r;const o=this.json.buffers[e].uri,n=this._context.loadBinary(this._resolveUri(o),t).then((e=>new Uint8Array(e)));return this._bufferLoaders.set(e,n),n}async getAccessor(t,r){if(!this.json.accessors)throw new e(\"gltf-loader-unsupported-feature\",\"Accessors missing.\");const o=this.json.accessors[t];if(null==o?.bufferView)throw new e(\"gltf-loader-unsupported-feature\",\"Some accessor does not specify a bufferView.\");if(o.type in[D.MAT2,D.MAT3,D.MAT4])throw new e(\"gltf-loader-unsupported-feature\",`AttributeType ${o.type} is not supported`);const n=this.json.bufferViews[o.bufferView],s=await this.getBuffer(n.buffer,r),a=X[o.type],i=W[o.componentType],u=a*i,f=n.byteStride||u;return{raw:s.buffer,byteStride:f,byteOffset:s.byteOffset+(n.byteOffset||0)+(o.byteOffset||0),entryCount:o.count,isDenselyPacked:f===u,componentCount:a,componentByteSize:i,componentType:o.componentType,min:o.min,max:o.max,normalized:!!o.normalized}}async getIndexData(e,t){if(null==e.indices)return;const r=await this.getAccessor(e.indices,t);if(r.isDenselyPacked)switch(r.componentType){case k.UNSIGNED_BYTE:return new Uint8Array(r.raw,r.byteOffset,r.entryCount);case k.UNSIGNED_SHORT:return new Uint16Array(r.raw,r.byteOffset,r.entryCount);case k.UNSIGNED_INT:return new Uint32Array(r.raw,r.byteOffset,r.entryCount)}else switch(r.componentType){case k.UNSIGNED_BYTE:return v(this._wrapAccessor(_,r));case k.UNSIGNED_SHORT:return v(this._wrapAccessor(b,r));case k.UNSIGNED_INT:return v(this._wrapAccessor(T,r))}}async getPositionData(t,r){if(null==t.attributes.POSITION)throw new e(\"gltf-loader-unsupported-feature\",\"No POSITION vertex data found.\");const o=await this.getAccessor(t.attributes.POSITION,r);if(o.componentType!==k.FLOAT)throw new e(\"gltf-loader-unsupported-feature\",\"Expected type FLOAT for POSITION vertex attribute, but found \"+k[o.componentType]);if(3!==o.componentCount)throw new e(\"gltf-loader-unsupported-feature\",\"POSITION vertex attribute must have 3 components, but found \"+o.componentCount.toFixed());return this._wrapAccessor(g,o)}async getNormalData(t,r){if(null==t.attributes.NORMAL)throw new e(\"gltf-loader-error\",\"No NORMAL vertex data found.\");const o=await this.getAccessor(t.attributes.NORMAL,r);if(o.componentType!==k.FLOAT)throw new e(\"gltf-loader-unsupported-feature\",\"Expected type FLOAT for NORMAL vertex attribute, but found \"+k[o.componentType]);if(3!==o.componentCount)throw new e(\"gltf-loader-unsupported-feature\",\"NORMAL vertex attribute must have 3 components, but found \"+o.componentCount.toFixed());return this._wrapAccessor(g,o)}async getTangentData(t,r){if(null==t.attributes.TANGENT)throw new e(\"gltf-loader-error\",\"No TANGENT vertex data found.\");const o=await this.getAccessor(t.attributes.TANGENT,r);if(o.componentType!==k.FLOAT)throw new e(\"gltf-loader-unsupported-feature\",\"Expected type FLOAT for TANGENT vertex attribute, but found \"+k[o.componentType]);if(4!==o.componentCount)throw new e(\"gltf-loader-unsupported-feature\",\"TANGENT vertex attribute must have 4 components, but found \"+o.componentCount.toFixed());return new x(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount)}async getTextureCoordinates(t,r){if(null==t.attributes.TEXCOORD_0)throw new e(\"gltf-loader-error\",\"No TEXCOORD_0 vertex data found.\");const o=await this.getAccessor(t.attributes.TEXCOORD_0,r);if(2!==o.componentCount)throw new e(\"gltf-loader-unsupported-feature\",\"TEXCOORD_0 vertex attribute must have 2 components, but found \"+o.componentCount.toFixed());if(o.componentType===k.FLOAT)return this._wrapAccessor(O,o);if(!o.normalized)throw new e(\"gltf-loader-unsupported-feature\",\"Integer component types are only supported for a normalized accessor for TEXCOORD_0.\");return $(o)}async getVertexColors(t,r){if(null==t.attributes.COLOR_0)throw new e(\"gltf-loader-error\",\"No COLOR_0 vertex data found.\");const o=await this.getAccessor(t.attributes.COLOR_0,r);if(4!==o.componentCount&&3!==o.componentCount)throw new e(\"gltf-loader-unsupported-feature\",\"COLOR_0 attribute must have 3 or 4 components, but found \"+o.componentCount.toFixed());if(4===o.componentCount){if(o.componentType===k.FLOAT)return this._wrapAccessor(x,o);if(o.componentType===k.UNSIGNED_BYTE)return this._wrapAccessor(N,o);if(o.componentType===k.UNSIGNED_SHORT)return this._wrapAccessor(S,o)}else if(3===o.componentCount){if(o.componentType===k.FLOAT)return this._wrapAccessor(g,o);if(o.componentType===k.UNSIGNED_BYTE)return this._wrapAccessor(C,o);if(o.componentType===k.UNSIGNED_SHORT)return this._wrapAccessor(A,o)}throw new e(\"gltf-loader-unsupported-feature\",\"Unsupported component type for COLOR_0 attribute: \"+k[o.componentType])}hasPositions(e){return void 0!==e.attributes.POSITION}hasNormals(e){return void 0!==e.attributes.NORMAL}hasVertexColors(e){return void 0!==e.attributes.COLOR_0}hasTextureCoordinates(e){return void 0!==e.attributes.TEXCOORD_0}hasTangents(e){return void 0!==e.attributes.TANGENT}async getMaterial(e,t,r){let o=e.material?this._materialCache.get(e.material):void 0;if(!o){const n=null!=e.material?G(this.json.materials[e.material]):G(),s=n.pbrMetallicRoughness,a=this.hasVertexColors(e),i=this.getTexture(s.baseColorTexture,t),u=this.getTexture(n.normalTexture,t),f=r?this.getTexture(n.occlusionTexture,t):void 0,c=r?this.getTexture(n.emissiveTexture,t):void 0,d=r?this.getTexture(s.metallicRoughnessTexture,t):void 0,l=null!=e.material?e.material:-1;o={alphaMode:n.alphaMode,alphaCutoff:n.alphaCutoff,color:s.baseColorFactor,doubleSided:!!n.doubleSided,colorTexture:await i,normalTexture:await u,name:n.name,id:l,occlusionTexture:await f,emissiveTexture:await c,emissiveFactor:n.emissiveFactor,metallicFactor:s.metallicFactor,roughnessFactor:s.roughnessFactor,metallicRoughnessTexture:await d,hasVertexColors:a,ESRI_externalColorMixMode:n.extras.ESRI_externalColorMixMode,colorTextureTransform:s?.baseColorTexture?.extensions?.KHR_texture_transform,normalTextureTransform:n.normalTexture?.extensions?.KHR_texture_transform,occlusionTextureTransform:n.occlusionTexture?.extensions?.KHR_texture_transform,emissiveTextureTransform:n.emissiveTexture?.extensions?.KHR_texture_transform,metallicRoughnessTextureTransform:s?.metallicRoughnessTexture?.extensions?.KHR_texture_transform}}return o}async getTexture(t,o){if(!t)return;if(0!==(t.texCoord||0))throw new e(\"gltf-loader-unsupported-feature\",\"Only TEXCOORD with index 0 is supported.\");const n=t.index,s=this.json.textures[n],a=j(null!=s.sampler?this.json.samplers[s.sampler]:{}),i=this._getTextureSourceId(s),u=this.json.images[i],f=await this._loadTextureImageData(n,s,o);return r(this._textureCache,n,(()=>{const t=e=>33071===e||33648===e||10497===e,r=t=>{throw new e(\"gltf-loader-error\",`Unexpected TextureSampler WrapMode: ${t}`)};return{data:f,wrapS:t(a.wrapS)?a.wrapS:r(a.wrapS),wrapT:t(a.wrapT)?a.wrapT:r(a.wrapT),minFilter:a.minFilter,name:u.name,id:n}}))}getNodeTransform(e){if(void 0===e)return q;let t=this._nodeTransformCache.get(e);if(!t){const r=this.getNodeTransform(this._getNodeParent(e)),o=this.json.nodes[e];o.matrix?t=c(h(),r,o.matrix):o.translation||o.rotation||o.scale?(t=m(r),o.translation&&d(t,t,o.translation),o.rotation&&(z[3]=w(z,o.rotation),l(t,t,z[3],z)),o.scale&&p(t,t,o.scale)):t=m(r),this._nodeTransformCache.set(e,t)}return t}_wrapAccessor(e,t){return new e(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}_resolveUri(e){return i(e,this._baseUri)}_getNodeParent(e){return this._nodeParentMap.get(e)}_checkVersionSupported(){const e=u.parse(this.json.asset.version,\"glTF\");J.validate(e)}_checkRequiredExtensionsSupported(){const t=this.json;if(t.extensionsRequired){if(!t.extensionsRequired.every((e=>this._supportedExtensions.includes(e))))throw new e(\"gltf-loader-unsupported-feature\",\"gltf loader was not able to load unsupported feature. Required extensions: \"+t.extensionsRequired.join(\", \"))}}_computeNodeParents(){this.json.nodes.forEach(((e,t)=>{e.children&&e.children.forEach((e=>{this._nodeParentMap.set(e,t)}))}))}async _loadTextureImageData(e,t,r){const o=this._textureLoaders.get(e);if(o)return o;const n=this._createTextureLoader(t,r);return this._textureLoaders.set(e,n),n}_getTextureSourceId(t){if(void 0!==t.extensions&&null!==t.extensions.KHR_texture_basisu)return t.extensions.KHR_texture_basisu.source;if(null!==t.source)return t.source;throw new e(\"gltf-loader-unsupported-feature\",\"Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.\")}async _createTextureLoader(t,r){const o=this._getTextureSourceId(t),n=this.json.images[o];if(n.uri){if(n.uri.endsWith(\".ktx2\")){const e=await this._context.loadBinary(this._resolveUri(n.uri),r);return new H(new Uint8Array(e))}return this._context.loadImage(this._resolveUri(n.uri),r)}if(null==n.bufferView)throw new e(\"gltf-loader-unsupported-feature\",\"Image bufferView must be defined.\");if(null==n.mimeType)throw new e(\"gltf-loader-unsupported-feature\",\"Image mimeType must be defined.\");const s=this.json.bufferViews[n.bufferView],a=await this.getBuffer(s.buffer,r);if(null!=s.byteStride)throw new e(\"gltf-loader-unsupported-feature\",\"byteStride not supported for image buffer\");const i=a.byteOffset+(s.byteOffset||0);return P(new Uint8Array(a.buffer,i,s.byteLength),n.mimeType)}async getLoadedBuffersSize(){if(this._glbBuffer)return this._glbBuffer.byteLength;const e=await o(Array.from(this._bufferLoaders.values())),t=await o(Array.from(this._textureLoaders.values()));return e.reduce(((e,t)=>e+(t?.byteLength??0)),0)+t.reduce(((e,t)=>e+(t?V(t)?t.data.byteLength:t.width*t.height*4:0)),0)}}const q=f(h(),Math.PI/2),J=new u(2,0,\"glTF\"),z=y(),X={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},W={[k.BYTE]:1,[k.UNSIGNED_BYTE]:1,[k.SHORT]:2,[k.UNSIGNED_SHORT]:2,[k.FLOAT]:4,[k.UNSIGNED_INT]:4};function $(e){switch(e.componentType){case k.BYTE:return new B(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case k.UNSIGNED_BYTE:return new R(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case k.SHORT:return new I(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case k.UNSIGNED_SHORT:return new E(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case k.UNSIGNED_INT:return new L(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount);case k.FLOAT:return new O(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)}}export{Y as GLTFResource,q as TRANSFORM_GLTF_TO_ENGINE};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}