{"ast":null,"code":"import { GET_IDENTITY, LOAD_PORTAL } from '../constants/action-types';\n\n/**\r\n * Middleware function with the signature\r\n *\r\n * storeInstance =>\r\n * functionToCallWithAnActionThatWillSendItToTheNextMiddleware =>\r\n * actionThatDispatchWasCalledWith =>\r\n * valueToUseAsTheReturnValueOfTheDispatchCall\r\n *\r\n * Typically written as\r\n *\r\n * store => next => action => result\r\n */\nconst arcgisMiddleWare = store => next => action => {\n  switch (action.type) {\n    case GET_IDENTITY:\n      next(action);\n      return fetch('/refresh').then(res => res.json()) //.json is asynch; .parse is sync\n      .then(jsonRes => {\n        //console.log(jsonRes)\n        if (jsonRes.refresh) {\n          store.dispatch({\n            type: LOAD_PORTAL\n          });\n        }\n      });\n    default:\n      return next(action);\n  }\n};\nexport default arcgisMiddleWare;","map":{"version":3,"names":["GET_IDENTITY","LOAD_PORTAL","arcgisMiddleWare","store","next","action","type","fetch","then","res","json","jsonRes","refresh","dispatch"],"sources":["C:/code-challenge-react/client/src/middleware/arcgis-authentication.js"],"sourcesContent":["import {\r\n  GET_IDENTITY,\r\n  LOAD_PORTAL\r\n} from '../constants/action-types'\r\n\r\n/**\r\n * Middleware function with the signature\r\n *\r\n * storeInstance =>\r\n * functionToCallWithAnActionThatWillSendItToTheNextMiddleware =>\r\n * actionThatDispatchWasCalledWith =>\r\n * valueToUseAsTheReturnValueOfTheDispatchCall\r\n *\r\n * Typically written as\r\n *\r\n * store => next => action => result\r\n */\r\nconst arcgisMiddleWare = store => next => (action) => {\r\n  switch (action.type) {\r\n    case GET_IDENTITY:\r\n        next(action)\r\n        return fetch('/refresh')\r\n        .then(res => res.json()) //.json is asynch; .parse is sync\r\n        .then(jsonRes => { //console.log(jsonRes)\r\n            if(jsonRes.refresh){ store.dispatch({ type: LOAD_PORTAL })}\r\n        })\r\n        \r\n    default:\r\n      return next(action)\r\n  }\r\n}\r\n\r\nexport default arcgisMiddleWare"],"mappings":"AAAA,SACEA,YAAY,EACZC,WAAW,QACN,2BAA2B;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,gBAAgB,GAAGC,KAAK,IAAIC,IAAI,IAAKC,MAAM,IAAK;EACpD,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAKN,YAAY;MACbI,IAAI,CAACC,MAAM,CAAC;MACZ,OAAOE,KAAK,CAAC,UAAU,CAAC,CACvBC,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,IAAI,EAAE,CAAC,CAAC;MAAA,CACxBF,IAAI,CAACG,OAAO,IAAI;QAAE;QACf,IAAGA,OAAO,CAACC,OAAO,EAAC;UAAET,KAAK,CAACU,QAAQ,CAAC;YAAEP,IAAI,EAAEL;UAAY,CAAC,CAAC;QAAA;MAC9D,CAAC,CAAC;IAEN;MACE,OAAOG,IAAI,CAACC,MAAM,CAAC;EAAA;AAEzB,CAAC;AAED,eAAeH,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}