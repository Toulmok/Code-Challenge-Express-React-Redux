{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport { isSome as r } from \"../core/maybe.js\";\nimport { eachAlwaysValues as s } from \"../core/promiseUtils.js\";\nimport \"../core/Logger.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport \"../core/arrayUtils.js\";\nimport \"../core/Error.js\";\nimport \"../core/has.js\";\nimport { subclass as i } from \"../core/accessorSupport/decorators/subclass.js\";\nconst a = a => {\n  let p = class extends a {\n    async fetchPopupFeatures(e, r) {\n      await this.when();\n      const {\n          location: i,\n          queryArea: a,\n          layerViewsAndGraphics: p,\n          clientOnlyGraphics: t\n        } = await this._prepareFetchPopupFeatures(e, r),\n        o = Promise.resolve(t),\n        c = this._queryLayerPopupFeatures(a, p, r),\n        n = c.map(e => e.promise);\n      return {\n        location: i,\n        clientOnlyGraphics: t,\n        allGraphicsPromise: s([o, ...n]).then(e => Array.from(new Set(e.flat()))),\n        promisesPerLayerView: c\n      };\n    }\n    _queryLayerPopupFeatures(e, s, i) {\n      return s.map(_ref => {\n        let {\n          layerView: s,\n          graphics: a\n        } = _ref;\n        const p = {\n            clientGraphics: a,\n            event: r(i) ? i.event : void 0,\n            signal: r(i) ? i.signal : void 0,\n            defaultPopupTemplateEnabled: !!r(i) && !!i.defaultPopupTemplateEnabled\n          },\n          t = s.fetchPopupFeatures(e, p);\n        return {\n          layerView: s,\n          promise: t\n        };\n      });\n    }\n    _isValidPopupGraphic(e, s) {\n      return e && !!e.getEffectivePopupTemplate(r(s) && s.defaultPopupTemplateEnabled);\n    }\n    async _prepareFetchPopupFeatures(e, r) {\n      const {\n          clientGraphics: s,\n          queryArea: i,\n          location: a\n        } = await this._popupHitTestGraphics(e, r),\n        p = this._getFetchPopupLayerViews(),\n        {\n          layerViewsAndGraphics: t,\n          clientOnlyGraphics: o\n        } = this._graphicsPerFetchPopupLayerView(s, p);\n      return {\n        clientOnlyGraphics: o,\n        layerViewsAndGraphics: t,\n        queryArea: i,\n        location: a\n      };\n    }\n    async _popupHitTestGraphics(e, r) {\n      const s = await this.popupHitTest(e),\n        i = s.results,\n        a = s.mapPoint,\n        p = i.filter(e => \"graphic\" === e.type && this._isValidPopupGraphic(e.graphic, r)),\n        t = p.length ? p[0].mapPoint : null;\n      return {\n        clientGraphics: p.map(e => e.graphic),\n        queryArea: a,\n        location: a || t\n      };\n    }\n    _getFetchPopupLayerViews() {\n      const e = [];\n      return this.allLayerViews.forEach(r => {\n        this._isValidPopupLayerView(r) && e.push(r);\n      }), r(this.graphicsView) && this._isValidPopupLayerView(this.graphicsView) && e.push(this.graphicsView), e.reverse();\n    }\n    _isValidPopupLayerView(e) {\n      return r(e) && (!(\"layer\" in e) || !e.suspended) && \"fetchPopupFeatures\" in e;\n    }\n    _graphicsPerFetchPopupLayerView(e, r) {\n      const s = [],\n        i = new Map(),\n        a = r.map(e => {\n          const r = [];\n          return \"layer\" in e ? i.set(e.layer, r) : i.set(e.graphics, r), {\n            layerView: e,\n            graphics: r\n          };\n        });\n      for (const p of e) {\n        const e = i.get(p.layer) || i.get(p.sourceLayer) || null;\n        e ? e.push(p) : s.push(p);\n      }\n      return {\n        layerViewsAndGraphics: a,\n        clientOnlyGraphics: s\n      };\n    }\n  };\n  return p = e([i(\"esri.views.PopupView\")], p), p;\n};\nexport { a as PopupView };","map":{"version":3,"names":["_","e","isSome","r","eachAlwaysValues","s","subclass","i","a","p","fetchPopupFeatures","when","location","queryArea","layerViewsAndGraphics","clientOnlyGraphics","t","_prepareFetchPopupFeatures","o","Promise","resolve","c","_queryLayerPopupFeatures","n","map","promise","allGraphicsPromise","then","Array","from","Set","flat","promisesPerLayerView","_ref","layerView","graphics","clientGraphics","event","signal","defaultPopupTemplateEnabled","_isValidPopupGraphic","getEffectivePopupTemplate","_popupHitTestGraphics","_getFetchPopupLayerViews","_graphicsPerFetchPopupLayerView","popupHitTest","results","mapPoint","filter","type","graphic","length","allLayerViews","forEach","_isValidPopupLayerView","push","graphicsView","reverse","suspended","Map","set","layer","get","sourceLayer","PopupView"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/PopupView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import{isSome as r}from\"../core/maybe.js\";import{eachAlwaysValues as s}from\"../core/promiseUtils.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/arrayUtils.js\";import\"../core/Error.js\";import\"../core/has.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";const a=a=>{let p=class extends a{async fetchPopupFeatures(e,r){await this.when();const{location:i,queryArea:a,layerViewsAndGraphics:p,clientOnlyGraphics:t}=await this._prepareFetchPopupFeatures(e,r),o=Promise.resolve(t),c=this._queryLayerPopupFeatures(a,p,r),n=c.map((e=>e.promise));return{location:i,clientOnlyGraphics:t,allGraphicsPromise:s([o,...n]).then((e=>Array.from(new Set(e.flat())))),promisesPerLayerView:c}}_queryLayerPopupFeatures(e,s,i){return s.map((({layerView:s,graphics:a})=>{const p={clientGraphics:a,event:r(i)?i.event:void 0,signal:r(i)?i.signal:void 0,defaultPopupTemplateEnabled:!!r(i)&&!!i.defaultPopupTemplateEnabled},t=s.fetchPopupFeatures(e,p);return{layerView:s,promise:t}}))}_isValidPopupGraphic(e,s){return e&&!!e.getEffectivePopupTemplate(r(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:a}=await this._popupHitTestGraphics(e,r),p=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:t,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,p);return{clientOnlyGraphics:o,layerViewsAndGraphics:t,queryArea:i,location:a}}async _popupHitTestGraphics(e,r){const s=await this.popupHitTest(e),i=s.results,a=s.mapPoint,p=i.filter((e=>\"graphic\"===e.type&&this._isValidPopupGraphic(e.graphic,r))),t=p.length?p[0].mapPoint:null;return{clientGraphics:p.map((e=>e.graphic)),queryArea:a,location:a||t}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r)})),r(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r(e)&&(!(\"layer\"in e)||!e.suspended)&&\"fetchPopupFeatures\"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,a=r.map((e=>{const r=[];return\"layer\"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const p of e){const e=i.get(p.layer)||i.get(p.sourceLayer)||null;e?e.push(p):s.push(p)}return{layerViewsAndGraphics:a,clientOnlyGraphics:s}}};return p=e([i(\"esri.views.PopupView\")],p),p};export{a as PopupView};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}