{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as e, isNone as t } from \"../../../../core/maybe.js\";\nimport { ViewingMode as r } from \"../../../ViewingMode.js\";\nimport { isValidObb as i, isValidMbs as s } from \"./I3SUtil.js\";\nimport { I3sTarget as n } from \"./Intersector.js\";\nimport { intersectLine as o } from \"../../support/orientedBoundingBox.js\";\nimport { newIntersectorResult as l } from \"../../webgl-engine/lib/Intersector.js\";\nimport { IntersectorType as c, StoreResults as d } from \"../../webgl-engine/lib/IntersectorInterfaces.js\";\nimport { getVerticalOffsetI3S as a } from \"../../webgl-engine/lib/verticalOffsetUtils.js\";\nclass f {\n  constructor(e) {\n    this.type = c.I3S, this._needVerticalOffset = !1, this.layerUid = e.layerUid, this.sublayerUid = e.sublayerUid, this._collection = e.collection, this._traverseNodeHierarchy = e.traverseNodeHierarchy, this.slicePlaneEnabled = e.slicePlaneEnabled, this.isGround = e.isGround;\n  }\n  updateElevationAlignState(e, t) {\n    this._needVerticalOffset = e && t === r.Global;\n  }\n  intersect(r, c, f, u) {\n    const m = r.results,\n      h = r.options.store === d.ALL,\n      p = r.ray.direction,\n      y = r.tolerance;\n    let g = e => e,\n      O = e => e;\n    const v = a(e(r.verticalOffset) ? r.verticalOffset : this._needVerticalOffset ? 0 : null);\n    e(r.verticalOffset) && e(v) && (g = e => v.applyToMbs(e), O = e => v.applyToObb(e)), this._traverseNodeHierarchy((d, a) => {\n      if (0 === d.childrenLoaded) return !1;\n      const I = e(d.serviceObbInRenderSR) && i(d.serviceObbInRenderSR) ? d.serviceObbInRenderSR : null;\n      return !(e(I) && !o(O(I), f, p, y)) && (a && (e(I) || !s(d.renderMbs) || b(g(d.renderMbs), f, p, y)) && (t(d.geometryObb) || o(O(d.geometryObb), f, p, y)) && this._collection.intersect(a, f, u, y, v, (e, t, i, s) => {\n        if (t >= 0) {\n          if (null != c && !c(f, u, t)) return;\n          const o = r => {\n            const o = new n(this.layerUid, this.sublayerUid, d.index, e, s);\n            r.set(this.type, o, t, i);\n          };\n          if (this.isGround && (null == m.ground.dist || t < m.ground.dist) && o(m.ground), r.options.isFiltered) return;\n          if ((null == m.min.dist || t < m.min.dist) && o(m.min), (null == m.max.dist || t > m.max.dist) && o(m.max), h) {\n            const e = l(r.ray);\n            o(e), r.results.all.push(e);\n          }\n        }\n      }), !0);\n    });\n  }\n}\nfunction b(e, t, r) {\n  let i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n  const s = e[3] + i,\n    n = t[0] - e[0],\n    o = t[1] - e[1],\n    l = t[2] - e[2],\n    c = r[0],\n    d = r[1],\n    a = r[2],\n    f = c * n + d * o + a * l;\n  return f * f - (c * c + d * d + a * a) * (n * n + o * o + l * l - s * s) >= 0;\n}\nexport { f as I3SIntersectionHandler };","map":{"version":3,"names":["isSome","e","isNone","t","ViewingMode","r","isValidObb","i","isValidMbs","s","I3sTarget","n","intersectLine","o","newIntersectorResult","l","IntersectorType","c","StoreResults","d","getVerticalOffsetI3S","a","f","constructor","type","I3S","_needVerticalOffset","layerUid","sublayerUid","_collection","collection","_traverseNodeHierarchy","traverseNodeHierarchy","slicePlaneEnabled","isGround","updateElevationAlignState","Global","intersect","u","m","results","h","options","store","ALL","p","ray","direction","y","tolerance","g","O","v","verticalOffset","applyToMbs","applyToObb","childrenLoaded","I","serviceObbInRenderSR","renderMbs","b","geometryObb","index","set","ground","dist","isFiltered","min","max","all","push","arguments","length","undefined","I3SIntersectionHandler"],"sources":["C:/code-challenge-react/frontend/node_modules/@arcgis/core/views/3d/layers/i3s/I3SIntersectionHandler.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../../../core/maybe.js\";import{ViewingMode as r}from\"../../../ViewingMode.js\";import{isValidObb as i,isValidMbs as s}from\"./I3SUtil.js\";import{I3sTarget as n}from\"./Intersector.js\";import{intersectLine as o}from\"../../support/orientedBoundingBox.js\";import{newIntersectorResult as l}from\"../../webgl-engine/lib/Intersector.js\";import{IntersectorType as c,StoreResults as d}from\"../../webgl-engine/lib/IntersectorInterfaces.js\";import{getVerticalOffsetI3S as a}from\"../../webgl-engine/lib/verticalOffsetUtils.js\";class f{constructor(e){this.type=c.I3S,this._needVerticalOffset=!1,this.layerUid=e.layerUid,this.sublayerUid=e.sublayerUid,this._collection=e.collection,this._traverseNodeHierarchy=e.traverseNodeHierarchy,this.slicePlaneEnabled=e.slicePlaneEnabled,this.isGround=e.isGround}updateElevationAlignState(e,t){this._needVerticalOffset=e&&t===r.Global}intersect(r,c,f,u){const m=r.results,h=r.options.store===d.ALL,p=r.ray.direction,y=r.tolerance;let g=e=>e,O=e=>e;const v=a(e(r.verticalOffset)?r.verticalOffset:this._needVerticalOffset?0:null);e(r.verticalOffset)&&e(v)&&(g=e=>v.applyToMbs(e),O=e=>v.applyToObb(e)),this._traverseNodeHierarchy(((d,a)=>{if(0===d.childrenLoaded)return!1;const I=e(d.serviceObbInRenderSR)&&i(d.serviceObbInRenderSR)?d.serviceObbInRenderSR:null;return!(e(I)&&!o(O(I),f,p,y))&&(a&&(e(I)||!s(d.renderMbs)||b(g(d.renderMbs),f,p,y))&&(t(d.geometryObb)||o(O(d.geometryObb),f,p,y))&&this._collection.intersect(a,f,u,y,v,((e,t,i,s)=>{if(t>=0){if(null!=c&&!c(f,u,t))return;const o=r=>{const o=new n(this.layerUid,this.sublayerUid,d.index,e,s);r.set(this.type,o,t,i)};if(this.isGround&&(null==m.ground.dist||t<m.ground.dist)&&o(m.ground),r.options.isFiltered)return;if((null==m.min.dist||t<m.min.dist)&&o(m.min),(null==m.max.dist||t>m.max.dist)&&o(m.max),h){const e=l(r.ray);o(e),r.results.all.push(e)}}})),!0)}))}}function b(e,t,r,i=0){const s=e[3]+i,n=t[0]-e[0],o=t[1]-e[1],l=t[2]-e[2],c=r[0],d=r[1],a=r[2],f=c*n+d*o+a*l;return f*f-(c*c+d*d+a*a)*(n*n+o*o+l*l-s*s)>=0}export{f as I3SIntersectionHandler};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}