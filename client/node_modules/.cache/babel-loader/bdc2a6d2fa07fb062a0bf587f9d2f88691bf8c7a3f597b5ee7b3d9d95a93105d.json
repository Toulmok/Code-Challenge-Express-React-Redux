{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/Evented.js\";\nimport has from \"../../../../../core/has.js\";\nimport { r as t } from \"../../../../../chunks/rbush.js\";\nimport { Tile as s } from \"./Tile.js\";\nimport i from \"../../../tiling/TileCoverage.js\";\nimport o from \"../../../tiling/TileKey.js\";\nconst h = {\n    added: [],\n    removed: []\n  },\n  n = new Set(),\n  r = new o(0, 0, 0, 0);\nclass d extends e {\n  constructor(e) {\n    super(), this._tiles = new Map(), this._index = t(9, has(\"esri-csp-restrictions\") ? e => ({\n      minX: e.bounds[0],\n      minY: e.bounds[1],\n      maxX: e.bounds[2],\n      maxY: e.bounds[3]\n    }) : [\".bounds[0]\", \".bounds[1]\", \".bounds[2]\", \".bounds[3]\"]), this.tiles = [], this.tileScheme = e;\n  }\n  destroy() {\n    this.clear();\n  }\n  clear() {\n    this.tiles.length = 0, this._tiles.clear(), this._index.clear();\n  }\n  has(e) {\n    return this._tiles.has(e);\n  }\n  get(e) {\n    return this._tiles.get(e);\n  }\n  boundsIntersections(e) {\n    return this._index.search({\n      minX: e[0],\n      minY: e[1],\n      maxX: e[2],\n      maxY: e[3]\n    });\n  }\n  updateTiles(e) {\n    const t = {\n      added: [],\n      removed: []\n    };\n    for (const i of e.added) if (!this.has(i)) {\n      const e = new s(this.tileScheme, i);\n      this._tiles.set(i, e), this._index.insert(e), t.added.push(e);\n    }\n    for (const s of e.removed) if (this.has(s)) {\n      const e = this.get(s);\n      this._tiles.delete(s), this._index.remove(e), t.removed.push(e);\n    }\n    this.tiles.length = 0, this._tiles.forEach(e => this.tiles.push(e)), (t.added.length || t.removed.length) && this.emit(\"update\", t);\n  }\n  setViewState(e) {\n    const t = this.tileScheme.getTileCoverage(e, 0);\n    if (!t) return;\n    const {\n        spans: o,\n        lodInfo: d\n      } = t,\n      {\n        level: l\n      } = d;\n    if (o.length > 0) for (const {\n      row: i,\n      colFrom: a,\n      colTo: m\n    } of o) for (let e = a; e <= m; e++) {\n      const t = r.set(l, i, d.normalizeCol(e), d.getWorldForColumn(e)).id;\n      if (n.add(t), !this.has(t)) {\n        const e = new s(this.tileScheme, t);\n        this._tiles.set(t, e), this._index.insert(e), this.tiles.push(e), h.added.push(e);\n      }\n    }\n    for (let s = this.tiles.length - 1; s >= 0; s--) {\n      const e = this.tiles[s];\n      n.has(e.id) || (this._tiles.delete(e.id), this.tiles.splice(s, 1), this._index.remove(e), h.removed.push(e));\n    }\n    (h.added.length || h.removed.length) && this.emit(\"update\", h), i.pool.release(t), n.clear(), h.added.length = 0, h.removed.length = 0;\n  }\n}\nexport { d as default };","map":{"version":3,"names":["e","has","r","t","Tile","s","i","o","h","added","removed","n","Set","d","constructor","_tiles","Map","_index","minX","bounds","minY","maxX","maxY","tiles","tileScheme","destroy","clear","length","get","boundsIntersections","search","updateTiles","set","insert","push","delete","remove","forEach","emit","setViewState","getTileCoverage","spans","lodInfo","level","l","row","colFrom","a","colTo","m","normalizeCol","getWorldForColumn","id","add","splice","pool","release","default"],"sources":["C:/code-challenge-react/client/node_modules/@arcgis/core/views/2d/layers/features/support/TileStore.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Evented.js\";import has from\"../../../../../core/has.js\";import{r as t}from\"../../../../../chunks/rbush.js\";import{Tile as s}from\"./Tile.js\";import i from\"../../../tiling/TileCoverage.js\";import o from\"../../../tiling/TileKey.js\";const h={added:[],removed:[]},n=new Set,r=new o(0,0,0,0);class d extends e{constructor(e){super(),this._tiles=new Map,this._index=t(9,has(\"esri-csp-restrictions\")?e=>({minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}):[\".bounds[0]\",\".bounds[1]\",\".bounds[2]\",\".bounds[3]\"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const t={added:[],removed:[]};for(const i of e.added)if(!this.has(i)){const e=new s(this.tileScheme,i);this._tiles.set(i,e),this._index.insert(e),t.added.push(e)}for(const s of e.removed)if(this.has(s)){const e=this.get(s);this._tiles.delete(s),this._index.remove(e),t.removed.push(e)}this.tiles.length=0,this._tiles.forEach((e=>this.tiles.push(e))),(t.added.length||t.removed.length)&&this.emit(\"update\",t)}setViewState(e){const t=this.tileScheme.getTileCoverage(e,0);if(!t)return;const{spans:o,lodInfo:d}=t,{level:l}=d;if(o.length>0)for(const{row:i,colFrom:a,colTo:m}of o)for(let e=a;e<=m;e++){const t=r.set(l,i,d.normalizeCol(e),d.getWorldForColumn(e)).id;if(n.add(t),!this.has(t)){const e=new s(this.tileScheme,t);this._tiles.set(t,e),this._index.insert(e),this.tiles.push(e),h.added.push(e)}}for(let s=this.tiles.length-1;s>=0;s--){const e=this.tiles[s];n.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(s,1),this._index.remove(e),h.removed.push(e))}(h.added.length||h.removed.length)&&this.emit(\"update\",h),i.pool.release(t),n.clear(),h.added.length=0,h.removed.length=0}}export{d as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}